
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The User Story Mapping Tool for delivering the right product right on time" />
        <meta name="robots" content="noindex, nofollow">
    <title>Contratos Vector To Be - StoriesOnBoard</title>

<link href="/main/css-light?v=th-pUR2Px_ymMrRtpsq80SKWuBf50GIYG9wl9_w6DAc1" rel="stylesheet"/>
    

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=HgfhdfgHDFg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=HgfhdfgHDFg">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=HgfhdfgHDFg">
    <link rel="manifest" href="/site.webmanifest?v=HgfhdfgHDFg">
    <link rel="mask-icon" href="/safari-pinned-tab.svg?v=HgfhdfgHDFg" color="#284395">
    <link rel="shortcut icon" href="/favicon.ico?v=HgfhdfgHDFg">
    <meta name="msapplication-TileColor" content="#284395">
    <meta name="theme-color" content="#ffffff">
    <meta name="format-detection" content="telephone=no">

    <script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://eopw12jk1l3.storiesonboard.com/pcarvtbn.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-KPNJTRQ');</script>

        <div id="consent-container"></div>

            <!-- start Bugsnag -->
        <script src="//d2wy8f7a9ursnm.cloudfront.net/bugsnag-3.min.js" data-apikey="fb67c60e07bdc3e753d368a8c418ee2b"></script>
        <script type="text/javascript">

            Bugsnag.apiKey = '0906c68c0f085ae9756135d3c58746d3';
            Bugsnag.autoBreadcrumbs = false;
            Bugsnag.releaseStage = 'production';
            Bugsnag.user = {
                id: '0870d40d-d956-4257-dfb3-3a0afa16589a',
                shortId: 'DdRwCFbZV0LfszoK-hZYmg',
                name: 'linomarquez',
                email: 'lino.marquez@citi.com.mx'
            };
            Bugsnag.metaData = {
                workspace: {
                    workspaceSubdomain: 'vectorcb',
                    workspaceUrl: 'https://vectorcb.storiesonboard.com',
                    workspaceId: '120407',
                    userRoles: 'WorkspaceMember'
                },
                kind: {kind: "client-side"}
            };
            Bugsnag.context = "[vectorcb] " + location.pathname;
            Bugsnag.beforeNotify = function(payload, metadata) {
                if (payload.file != null) {
                    var root = 'https://vectorcb.storiesonboard.com';
                    var file = payload.file.replace(root, "");
                    metadata.groupingHash = JSON.stringify({file: file, line: payload.lineNumber, message: payload.message});
                }
            };
        </script>
        <!-- end Bugsnag -->



            <!-- start Intercom -->
        <script>
            (function () { var w = window; var ic = w.Intercom; if (typeof ic === "function") { ic('reattach_activator'); ic('update'); } else { var d = document; var i = function () { i.c(arguments) }; i.q = []; i.c = function (args) { i.q.push(args) }; w.Intercom = i; function l() { var s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://widget.intercom.io/widget/pi5obrpe'; var x = d.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); } if (w.attachEvent) { w.attachEvent('onload', l); } else { w.addEventListener('load', l, false); } } })()
        </script>

                    
                        <script>
                        var options = {
                            app_id: "pi5obrpe",
                            name: "linomarquez",
                            email: "lino.marquez@citi.com.mx", // Email address
                            user_id: "0870d40d-d956-4257-dfb3-3a0afa16589a",
                            created_at: 1683223052, // Signup date as a Unix timestamp
                            horizontal_padding: 20,
                            vertical_padding: 20
                        };
                            
                                options.company =
                                {
                                    id: "120407"
                                };
                            
                        window.Intercom("boot", options);
                        </script>
                    
                    <!-- end Intercom -->
    <script type="text/javascript">
        shutdownIntercom = function() {
                
                    window.Intercom('shutdown');
                
        }
    </script>

</head>

<body>

    <div id="header-background" class="default-sized"></div>
    <div id="application-host"></div>

    <!-- Start of client templates -->
    <script type="text/html" id="csrf-token-invalid-warning:csrf-token-invalid-reload-page">
    <div class="header">Session expired</div>
    <div class="content">
        We're sorry, but your session has expired. We kindly ask you to reload the page before continuing your work.
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="click: function() { location.reload(true); }">Reload now</button>
    </div>
</script>

    <script type="text/html" id="addattachment"> <span class="fileUpload" tabindex="0">
    {{#if params.toggleMenuCaption}}
    <a data-bind="click: onToggleContextMenu">{{params.toggleMenuCaption}}</a>
    {{/if}}
    <context-menu params="isOpen: isContexMenuOpen, direction: 'bottom'">
        <div class="menu-content">
            <ul>
                <li class="dropdown-menu-item">
                    <a data-bind="click: openFileUpload">Attach file from computer</a>
                </li>
                <li class="dropdown-menu-item">
                    <a data-bind="click: openAddWebLink">Attach web link</a>
                </li>
                <li>
                    <hr />
                </li>
                <li>
                    <hint>Hint: You can also drag and drop files and images on the card.</hint>
                </li>
            </ul>
        </div>
    </context-menu>

    <web-link-adder  params="isOpen: isAddWebLinkOpen, onSave: onSaveWebLink, onClose: onCloseWebLinkAdder"></web-link-adder>
</span>

</script>
<script type="text/html" id="additionallink"> <a class="link" data-bind="if: params.isVisible, click: linkClick" tabindex="0">
    <span data-bind="class: {name: params.iconClass}"></span>
    <span class="text">{{params.linkText}}</span>
</a></script>
<script type="text/html" id="attachmentlist"> <div class="attachments-block">
    <label class="label-small">Attachments</label>
    
    <a class="add-attachment" tabindex="1" data-bind="if: isAddButtonVisible, click: params.onAddAttachment"><i class="icon-add-attachment"></i></a>
    
    {{#ifnot hasAttachments}}
    <p class="no-items">There aren't any attachments yet.</p>
    {{/ifnot}}

    <ul data-bind="foreach: params.attachments">
        <attachment-item params="
            attachment: $data,
            listId: $parent.id,
            isEditEnabled: $parent.params.isEditEnabled,
            canComment: $parent.canComment,

            onDeleteAttachment: $parent.params.onDeleteAttachment,
            onNameChanged: $parent.params.onNameChanged,
            onCommentClick:  $parent.params.onCommentClick"></attachment-item>
    </ul>
</div></script>
<script type="text/html" id="attachmentitem"> 
<list-item params="contextMenuItems: [
             {caption: 'Copy Markdown to clipboard', callback: copyToClipboard, isVisible: true, hasTooltip: true, tooltip: tooltip},
             {caption: downloadStr, callback: downLoadImage, isVisible: true, hasSeparatorAfter: hasSeparator},
             {caption: 'Edit name', callback: editName, isVisible: params.isEditEnabled},
             {caption: 'Delete', callback: deleteAttachment, isVisible: params.isEditEnabled}
           ],
           tooltipPosition: 'top-right'">
 
    <div class="attachment-item-container">
        {{#if isPicture}}
        <a data-bind="attr: {href: params.attachment.pictureUrl, 'data-title': params.attachment.name, 'data-lightbox': lightboxGroup }" class="image-box">
            <img data-bind="attr: {src: params.attachment.thumbnailUrl}" />
        </a>
        {{/if}}

        {{#ifnot isPicture}}
        <div class="image-box" data-bind="click: downLoadImage">
            <i data-bind="attr: { class: params.attachment.fileIconClass }"></i>
        </div>
        {{/ifnot}}

        <div class="content-box">
            <div class="name-box">
                <inline-textarea params="
                             value: name,
                             editOnClick: true,
                             endEditOnEnterKey: true,
                             isInEditMode: isNameInEditeMode,
                             onEndEdit: saveName,
                             width: '90%',
                             height: '10px'
                             "></inline-textarea>
                <span class="validation-message" data-bind="validationMessage: name"></span>

            </div>
            <div class="owner-box">
                <span class="uploaded-info">ADDED BY {{params.attachment.uploadedBy}} <span class="attachment-item-time" data-bind="timeago: params.attachment.uploadedAt"></span></span>

                {{#if isReplyButtonVisible}}
                <additional-link params="
                                iconClass: 'comment-icon',
                                linkText: 'comment',
                                isVisible: true,
                                onClick: onComment
                                "></additional-link>
                {{/if}}
            </div>
        </div>
    </div>
</list-item></script>
<script type="text/html" id="boardactivitieslist"> {{#foreach params.boardActivities}}
<list-item>
    <div class="board-activities-panel-row">
        <div class="board-activity-details">
            <span class="board-activity-user" data-bind="text:username"></span>
            <span class="board-activities-panel-row-desc" data-bind="safeHtmlWithRestrictedMarkdown: { value: getDescription(), removeLineBreaks: true }"></span>

            <!-- ko if: $data.content && !getDescription().contains($data.content) -->
            <div class="board-activities-panel-row-desc-cnt">
                <expandable-container params="containerHeight: 100">
                    <span class="activity-content board-activities-panel-row-desc" data-bind="megamark:{ value: content }"></span>
                </expandable-container>
            </div>
            <!-- /ko -->

            <div class="actions">
                <div class="board-activities-panel-datetime" data-bind="timeago:datetime"></div>

                <div class="board-activity-buttons">
                    <!-- ko if: $data.cardId && !$data.deletedCard -->
                    <a data-bind="click:function() { $root.selectCardOnBoard($data.cardId) }">jump to card</a>
                    <!-- /ko -->
                    <!-- ko if: $data.cardId && $data.deletedCard && $data.canRestoreDeletedCard() && !$root.currentUserIsViewer() -->
                    <a data-bind="click: function() {$root.showConfirmForCardRestore($data);}">restore from trash</a>
                    <!-- /ko -->
                </div>
            </div>

        </div>


    </div>    
</list-item>
{{/foreach}}</script>
<script type="text/html" id="colorpicker"> <div class="color-picker">
    <div class="select-box-container">
        <span class="selected-color" data-bind="click: toggleOpen">
            <div class="color-box" data-bind="css: selectedColor().colorClass"></div>
            <div class="color-name" data-bind="text: selectedColor().name"></div>
        </span>
    </div>
    {{#if isOpen}}
    <div class="available-color-list" data-bind="foreach: params.availableColors">
        <div class="color-item" data-bind="click: $parent.select.bind($parent, $data)">
            <div class="color-box" data-bind="css: colorClass"></div>
            <div class="color-name" data-bind="text: name"></div>
        </div>
    </div>
    {{/if}}
</div></script>
<script type="text/html" id="commentlist"> {{#if hasComments}}
    <div class="comment-list" id="comment-list-{{params.correlationId}}">
        {{#if isBottomUp}}
        <div data-bind="inViewport: { viewport: 'comment-list-' + params.correlationId, observable: isScrolledToEnd }"></div>
        {{/if}}

        {{#foreach: params.comments}}
            <list-item params="contextMenuItems: [
             {caption: 'Edit', callback: $parent.editComment.bind($parent, $data), isVisible: $component.canEditComment.call($component, $data)},
             {caption: 'Delete', callback: $parent.deleteComment.bind($parent, $data), isVisible: $component.canRemoveComment.call($component, $data)}]">
                <div data-bind="
                         attr: {'class': $parents[2].getCommentClass.bind($parents[2])($data)},
                         scrollTo: {container: '#comment-list-' + $parents[2].params.correlationId, doScroll: isScrolledTo, noDelay: true}">
                    <div class="comment-head" data-bind="if: $parents[2].shouldShowCommenterName.call($parents[2], $index)">
                        <span class="commenter-name" data-bind="text: createdBy"></span> said
                    </div>
                    <div class="comment-body-border">
                        <pre class="comment-body"  data-bind="megamark:{ value: commentText }"></pre>
                        <span class="commenter-time2" data-bind="timeago: timeToDisplay"></span>
                        <span class="edited-indicator" data-bind="if: isEdited">(edited)</span>
                        <additional-link params="
                                iconClass: 'reply-icon',
                                linkText: 'reply',
                                isVisible: $parents[2].params.isCommentingEnabledForCurrentUser,
                                onClick: $parents[2].reply.bind($parents[2], $data)
                                "></additional-link>
                    </div>
                    {{#if isLastSeenComment && $parents[2].shouldShowNewMessagesIndicator}}
                    <div class="new-messages">
                        <span>New messages</span>
                    </div>
                    {{/if}}
                </div>
            </list-item>
        {{/foreach}}

        {{#if isBottomUp}}
        <div data-bind="scrollTo: {container: '#comment-list-' + params.correlationId, doScroll: isScrolledToStart, noDelay: true}"></div>
        {{/if}}

        {{#ifnot isBottomUp}}
        <div data-bind="inViewport: { viewport: 'comment-list-' + params.correlationId, observable: isScrolledToEnd }"></div>
        {{/ifnot}}
</div>
{{/if}}</script>
<script type="text/html" id="contextmenu"> {{#if params.isOpen}}
    <div class="menu-wrapper dropdown-menu " data-bind="class: {name: direction}">
        <div class="context-menu" data-bind="clickOut: hide.bind($data), clickStop: true">
            <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
        </div>
    </div>
{{/if}}</script>
<script type="text/html" id="copyToClipboard"> {{#if params.isAlternativeIcon}}
    <a class="d-flex align-items-center justify-content-center share-card-container" data-bind="click: onClick">
        <span class="share-card-icon d-flex align-items-center" style="font-size: 16px; height: 16px; width: 16px;">
            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="share-square" class="svg-inline--fa fa-share-square fa-w-18" role="img" viewBox="0 0 576 512" style="font-size: 16px; height: 16px; width: 16px;"><path fill="#667eaa" d="M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z" /></svg>
        </span>
    </a>
{{/if}}

{{#ifnot params.isAlternativeIcon}}
    <a class="btn-icon" data-bind="click: onClick">
        <i class="icon-copy-dialog-link"></i>
    </a>
{{/ifnot}}
<div class="copy-to-clipboard__tooltip" data-bind="html: tooltipHtml"></div></script>
<script type="text/html" id="customcontrol"> <div class="control">
    <label>{{params.label}}</label>
    <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
    {{#if showHelpText}}
    <span class="help-block">{{params.helpText}}</span>
    {{/if}}
</div></script>
<script type="text/html" id="deckcard"> <div class="card" data-bind="click: onClick, css: { clickable: params.hasOwnProperty('onClick') }">
    <div class="icon-container">
        <img class="card-icon" alt="logo" src="{{params.iconUrl}}">
    </div>
    <div class="card-texting-container">
        <div class="card-title">{{params.title}}</div>
        <div class="card-description">{{params.description}}</div>
    </div>
</div>
</script>
<script type="text/html" id="emojipicker"> <div class="emoji-picker">
    <span class="emoji-picker-icon" data-bind="click: toggle"></span>
    {{#if isOpen}}
        <ul class="available-emoji-list" data-bind="foreach: availableEmojis, clickOut: close">
            <li class="emoji-item" data-bind="click: $component.addEmoji">
                <div>{{unicode}} {{name}}</div>
            </li>
        </ul>
    {{/if}}
</div></script>
<script type="text/html" id="expandablecontainer"> <div class="gradient-container" data-bind="css: { 'show-all': showAll }, click: expand, style: { 'height' : containerHeight() }">
    
    <div class="inner-content">
        <!-- ko template: { nodes: $componentTemplateNodes, data: $parent,  afterRender: init} --><!-- /ko -->
    </div>

    <div class="view-more-wrapper" data-bind="style: { 'background' : linearBackground(), 'height' : containerHeight(), 'padding-top' : overlayPadding()  }">
        <a href="#" data-bind="click: expand">view more</a>
    </div>
</div>


</script>
<script type="text/html" id="hint"> <div class="help-block">
    <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
</div></script>
<script type="text/html" id="iconselector"> {{#if isOpen}}
    <div class="icon-selector" data-bind="style: {width: width}">
        {{#foreach params.items}}
        <a class="selectable-icon" data-bind="click: $parent.select.bind($parent, $data), css: {selected: $parent.selectedItem() == $data}">
            <!-- ko template: { nodes: $componentTemplateNodes, data: $data } --><!-- /ko -->
        </a>
        {{/foreach}}
    </div>
{{/if}}</script>
<script type="text/html" id="iconwithcounter"> <a class="btn-icon light" data-bind="attr: {'title': params.title}, qtip: { position: 'bottom', adjustY: 10, delay: 1 }, click: params.onClick">
    <i data-bind="attr: {'class': params.iconClass}"></i>
    {{#if isCounterVisible}}
        <span class="counter">{{params.counterValue}}</span>
    {{/if}}
</a></script>
<script type="text/html" id="inlinetextarea"> <span data-bind="inlineTextArea: { value: params.value,
        editmode: isInEditMode,
        emptyText: params.emptyText,
        selectTextOnFocus: false,
        editOnClick: params.editOnClick,
        onEndEdit: onEndEdit.bind($data),
        type: 'text',
        endEditOnEnterKey: true,
        maxlength: params.maxLength,
        selectTextOnFocus: true,
        width: params.width,
        height: params.height
    }"></span></script>
<script type="text/html" id="inlineExtraMarkdown"> {{#if shouldShow}}
<div class="extra-markdown-container">

    <span class="markdown-view-content" data-bind="css:{ editable: params.isEditEnabled }, inlineExtraMarkdown: {
          value: params.value,
          emptyText: emptyText,
          placeholderText: params.placeholderText,
          editOnClick: params.isEditEnabled,
          editmode: isInEditMode,

          onStartEdit: onStartEdit.bind($data),

          saveAction: saveAction,
          cancelAction: cancelAction,

          autoresize:true,
          selectTextOnFocus: false,

          emptyClass: 'inline-text-empty',
          inputClass: 'inline-textarea-autoresize',
          width: '100%',

          urlClickHandlerName: 'viewmodels.storymap.BoardNavigationHelper.openLinkFromBoard' ,
          urlDisplayCallback: viewmodels.storymap.BoardNavigationHelper.getNameOfItemOnBoard }"></span>

    {{#if isInEditMode}}
    <div class="editor-buttons">
        <a href="#" class="btn-action-primary button" data-bind="click: save">Save</a>
        <a href="#" class="cancel-btn" data-bind="click: cancel">Cancel</a>
        <span class="markdown-editor-formatting-help" data-bind="css:{ left: isHelperOnLeft }"><a title="<div class=&quot;markdown-help-tip-content&quot;> <br/># Heading1<br/><br/>## Heading2<br/><br/>*Italics* or _Italics_<br/><br/>**Bold** or __Bold__<br/><br/>> This is a block-quote <br/><br/>* Unordered list item 1<br/><br/>1. Ordered list item 1<br/><br/>```javascript<br/>var s = &quot;JavaScript syntax highlighting&quot;;<br/>```<br/><br/>[Link with custom text](http://www.storiesonboard.com)<br/><br/>![alt text](http://url-to-public-image.com/public-image.jpg &quot;title&quot;)<br/><br /><a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble =true;&quot; class=&quot;inline-text-empty-link&quot;  target=&quot;_blank&quot; onmousedown=&quot;return false;&quot;>More formatting options</a><br /><br/></div>" target="_blank" onmousedown=" return false; " onclick=" return false; " data-bind="qtip: { withEncode: false, position: params.helperPoz, classes: 'qtip-tipsy qtip-sob qtip-sob-markdownhelp', useWindowViewport : true }" href="https://storiesonboard.uservoice.com/knowledgebase/articles/488687-story-details-formating-options">formatting help</a></span>

    </div>
    {{/if}}
</div>
{{/if}}
</script>
<script type="text/html" id="listitem"> <li class="list-item">
    <div class="list-item-content">
        <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
    </div>
    
    {{#if showContextMenu}}
        <list-item-context-menu params="items: params.contextMenuItems, tooltipPosition: params.tooltipPosition"></list-item-context-menu>
    {{/if}}
</li></script>
<script type="text/html" id="listitemcontextmenu"> <div class="list-item-context-menu dropdown-menu" data-bind="dropdownmenu: true">
    <a class="trigger" tabindex="1">
        <i class="icon-panel-v-options"></i>
    </a>
    <div class="menu-content right-aligned">
        <ul data-bind="foreach: visibleItems">
            <li class="dropdown-menu-item">
                <a data-bind="click: callback">
                    {{caption}}

                    {{#if $data.hasTooltip}}
                    <div style="display: inline-block; padding-left: 10px" class="item-info" data-bind="attr:{ title: tooltip }, qtip: { position: $parent.tooltipPosition, qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }">
                        <i class="icon-info-circle" aria-hidden="true"></i>
                    </div>
                    {{/if}}
                </a>
            </li>

            {{#if $data.hasSeparatorAfter}}
            <li class="dropdown-menu-item separator"><hr /></li>
            {{/if}}
        </ul>
    </div>
</div></script>
<script type="text/html" id="manageworkspacedropdown"> <div class="more-dropdown-menu" data-bind="dropdownmenu: true, userRole:'WorkspaceAdmin,SubscriptionAdmin'">
    <a class="btn-icon" href="#" tabindex="1" title="Manage workspace" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }">
        <i class="icon-storymap-h-more"></i>
    </a>
    <div class="menu-content right-aligned">
        <div class="more-dropdown-menu-content">
            <ul>
                <li style="text-align: left"><a data-bind="go: { url: '/managepeople' }">Manage people</a></li>
                <li style="text-align: left"><a data-bind="go: { url: '/managestorymaps' }">Manage story maps</a></li>
                <li style="text-align: left"><a data-bind="go: { url: '/managestorymaps?p=collections' }">Story map collections</a></li>
                <li>
                    <hr>
                </li>
                <li style="text-align: left"><a data-bind="go: { url: '/integrationsettings' }">Jira integration settings</a></li>
                <li data-bind="userRole:'SubscriptionAdmin'" style="text-align: left"><a data-bind="go: { url: '/workspacesettings' }">Workspace settings</a></li>
                <li data-bind="userRole:'SubscriptionAdmin'">
                    <hr>
                </li>
                <li data-bind="userRole:'SubscriptionAdmin'" style="text-align: left"><a data-bind="go: { url: '/workspacesettings?p=billing' }">Plan & billing</a></li>
            </ul>
        </div>
    </div>
</div></script>
<script type="text/html" id="mentionsinput"> 
{{#if a}}
<div class="mentions-input" data-bind="mentionsInput: {
    value: params.value,
    emptyText: params.emptyText,
    onEndEdit: endEdit.bind($data),
    mentionOptions: params.mentionOptions,
    mentionsResult: mentionsResult,
    endEditOnEnterKey : true,
    endEditOnFocusOut : false,
    endEditOnBlur : true,
    focus: params.hasFocus,
    additionalElements: $componentTemplateNodes,
    showAvatars: params.showAvatars,
    mentionsExtractorFunction: getMentionsFromValue
}"></div>
{{/if}}
</script>
<script type="text/html" id="modal"> {{#if params.isOpen}}
<div data-bind="class: { name: cssClass }, attr: { id: id } " tabindex="0">
    <div class="modal-area animated bounce-in speedy">

        {{#ifnot isConfirm}}
        <div class="header">
            {{ params.title }}
            {{#ifnot params.disableClosingFromUi}}
            <a class="btn-icon" data-bind="click: close">
                <i class="icon-close-dialog"></i>
            </a>
            {{/ifnot}}
        </div>
        <div class="content">
            <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
        </div>
        {{/ifnot}}
        
        {{#if isConfirm}}
        <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
        {{/if}}

    </div>
</div>
{{/if}}</script>
<script type="text/html" id="multichooselisteditor"> 
{{#if hasSelectedItems() || isInEditMode() }}
<div class="multichoose-list-editor multichoose">
    {{#if params.canEdit() && isInEditMode() }}
    <select data-bind="tokenize2: {
                  items: params.items,
                  selectedItems: params.selectedItems,
                  isKeyboardMode:params.isInEditModeWithKeyboard,
                  switchToKeyboardMode: switchToKeyboardMode.bind($data),
                  onEndEdit: onEndEdit.bind($data)
            }"></select>

    {{/if}}

    {{#ifnot isInEditMode}}
    <div class="view-container" data-bind="click: swichToEditMode.bind($data)">
        {{#foreach params.selectedItems}}
        <span class="multichoose-list-item">

            {{#if $data.imagePath}}
            <span><img data-bind="attr: { src: $data.imagePath }"> </span>
            {{/if}}

            {{#if $data.iconClass}}
            <span class="small" data-bind="class: { name: $data.iconClass }"></span>
            {{/if}}
            
            {{#if $data.isEmoji}}
            <span class="emoji" data-bind="text: $data.emoji"></span>
            {{/if}}

            <span> {{$data.name}}</span>
        </span>
        {{/foreach}}
    </div>
    {{/ifnot}}

    <span data-bind="visible: isInEditMode" class="helper-text">{{params.helperText}}</span>
</div>
{{/if}}
</script>
<script type="text/html" id="newEditorCore"> <div class="markdown-editor-core" contenteditable="true" style="position: relative">
    <div class="embed-adder">
        <web-link-adder params="
            isOpen: isAddEmbedOpen, 
            onSave: onSaveEmbed, 
            onClose: onCloseEmbedAdder,
            config: { 
                link: {
                    placeholder: 'Paste Embed Link',
                    label: 'Embed Link'
                },
                linkName: {
                    hideField: true        
                },
                button: {
                    label: 'Insert embed link'
                },
                shouldShowEmbedHelp: true,
            }
        ">
        </web-link-adder>
    </div>
    <add-attachment params="onOpenFileUpload: openFileUpload, onWebLinkSave: saveWebLink, triggerOpenContextMenu: triggerOpenContextMenu"></add-attachment>
    <textarea data-bind="attr: {id: id}"></textarea>
</div></script>
<script type="text/html" id="panelsection"> <div class="panel-section">
    <div class="panel-section-title">{{params.title}}</div>
    <div class="panel-section-content">
        <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
    </div>
</div></script>
<script type="text/html" id="searchablelist"> <div class="menu-content">
    <ul>
        {{#if: shouldDisplaySearchAndList}}
            <li>
                <input class="search-input" type="text" tabindex="1" 
                       data-bind="attr: {'placeholder': params.searchFieldPlaceholder}, value: searchQuery, valueUpdate: 'keyup', hasFocus: true"/>
            </li>
            <li>
                <hr />
            </li>
            <li class="small-section-title">
                {{ listCaption }}
            </li>
            
            {{#if: isNoMatchingItems}}
                <li>
                    <span class="secondary-text" data-bind="text: params.noMatchingResultsCaption"></span>
                </li>
            {{/if}}
            
            {{#if: params.isLoading}}
                <li>
                    <span class="secondary-text" data-bind="text: params.isLoadingCaption"></span>
                </li>
            {{/if}}
            
            {{#ifnot: params.isLoading}}

                {{#foreach: visibleItems}}
                    <li class="dropdown-menu-item">
                        <!-- ko template: { nodes: $componentTemplateNodes, data: $data } --><!-- /ko -->
                    </li>
                {{/foreach}}
            
            {{/ifnot}}
            
            {{#if: isShowMoreLinkVisible}}
            <li class="dropdown-menu-item">
                <a class="show-more-link" data-bind="click: onToggleShowMoreItems">show more</a>
            </li>
            {{/if}}
        
            {{#if: hasActions}} 
                <li>
                    <hr />
                </li>
            {{/if}}
        {{/if}}
        

        {{#if: hasActions}} 
            {{#foreach: params.actions}}
                <li class="dropdown-menu-item">
                    <a data-bind="click: $data.action, text: $data.caption, visible: $data.isVisible"></a>
                </li>
            {{/foreach}}
        {{/if}}
    </ul>
</div></script>
<script type="text/html" id="slidingpanel"> 
<div id="{{params.elementId}}" data-bind="css: { open: params.isOpened, 'full-size': params.isFullSize  }" class="sliding-panel">
    {{#if params.isOpened }}
    <div class="cf">
        <div class="storymap-panel-close-button">
            <a href="/" data-bind="click: close">
                <i class="icon-panel-close"></i>
            </a>
        </div>
        <div class="storymap-panel-title"><span data-bind="text: params.title"></span></div>
    </div>

    <div class="sliding-panel-content">
        <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
    </div>
    {{/if}}
</div>

</script>
<script type="text/html" id="textboxcontrol"> <custom-control params="label: params.label, helpText: params.helpText">
    <input type="text" data-bind="value: params.value" />
    <span class="validation-message" data-bind="validationMessage: params.value"></span>
</custom-control></script>
<script type="text/html" id="usernotificationspanel"> {{#if params.isOpened}}
<sliding-panel params="
    title: 'Notifications',
    elementId: params.elementId,
    isFullSize: params.isFullSize,
    isOpened: params.isOpened,
    onClose: params.onClose">

    <div class="metro-pivot" data-bind="metroPivot: true">
        <div class="pivot-item">
            <track-page params="page: {{params.trackNotificationPanel}}"></track-page>

            <h3>{{allNotificationsHeader}}</h3>

            <user-notification-list params="
                notifications: allNotifications,
                includeWorkspaceInStorymapName: params.includeWorkspaceInStorymapName,
                isCommentingEnabledCallback: params.isCommentingEnabledCallback,
                dismissAll: dismissAll,
                actions: params.actions"></user-notification-list>
        </div>
        <div class="pivot-item">
            <track-page params="page: {{params.trackDirectMessagePanel}}"></track-page>

            <h3>{{directMessagesHeader}}</h3>

            <user-notification-list params="
                notifications: directMessages,
                includeWorkspaceInStorymapName: params.includeWorkspaceInStorymapName,
                isCommentingEnabledCallback: params.isCommentingEnabledCallback,
                dismissAll: dismissAllDirectMessage,
                actions: params.actions"></user-notification-list>
        </div>
    </div>
</sliding-panel>
{{/if}}</script>
<script type="text/html" id="notificationicon"> <icon-with-counter params="
        onClick: params.onClick,
        iconClass: 'icon-storymap-h-notification',
        title: 'Notifications',
        counterValue: params.numberOfNonDismissedNotifications">
</icon-with-counter></script>
<script type="text/html" id="usernotificationlist"> <div class="notification-list-header">
    {{#if params.notifications().length == 0}}
    <div class="notification-infos">
        You haven't received any notifications so far.
    </div>
    {{/if}}
    {{#ifnot params.notifications().length == 0}}
    {{#if isDismissAllButtonVisible}}
    <a data-bind="click: params.dismissAll">mark all as read</a>
    {{/if}}
    {{#if isDismissedNotificationsVisible}}
    <a data-bind="click: hideDismissed">show unread</a>
    {{/if}}
    {{#if !isDismissedNotificationsVisible() && !isDismissAllButtonVisible()}}
    <div class="notification-infos">
        <p>There are no unread notifications.</p><br />
        <p>Click <a data-bind="click: showAll">here</a> to view all read notifications.</p>
    </div>
    {{/if}}
    {{/ifnot}}
</div>

{{#foreach visibleNotifications}}
    <user-notification-item params="
        notification: $data,
        includeWorkspaceInStorymapName: $parent.params.includeWorkspaceInStorymapName,
        isCommentingEnabledCallback: $parent.params.isCommentingEnabledCallback,
        actions: $parent.params.actions"></user-notification-item>
{{/foreach}}
</script>
<script type="text/html" id="usernotificationitem"> <div class="notifications-panel-row" data-bind="css: {dismissed : notification.isDismissed, 'notification-without-replies' : notification.replies().length === 0 }">

    {{#if notificationHeader.content != null}}
        <div class="notification-header">
            {{#if notificationHeader.doIncludeSourceUser}}
            <span class="notification-user" data-bind="text: notification.sourceUserName"></span>
            {{/if}}
            {{notificationHeader.content}}
        </div>
    {{/if}}

    <div class="notification-details">
        {{#if notificationBody.doIncludeSourceUser}}
            <div><span class="notification-user" data-bind="text: notification.sourceUserName"></span> {{notificationBody.content}}</div>
        {{/if}}

        {{#ifnot notificationBody.doIncludeSourceUser}}
            {{#if notificationBody.isMarkdowContent}}
            <expandable-container params="containerHeight: 75">
                <span class="notification-text" data-bind="megamark:{ value: notificationBody.content }"></span>
            </expandable-container>
            {{/if}}

            {{#ifnot notificationBody.isMarkdowContent}}
            <span class="notification-text" data-bind="text: notificationBody.content"></span>
            {{/ifnot}}
        {{/ifnot}}

        {{#if isOpenStorymapButtonVisibe}}
        <div class="storymap-name-row">
            on <span class="storymap-name" data-bind="text: storymapNameToDisplay"></span>
        </div>
        {{/if}}
        <span class="notification-time" data-bind="timeago: notification.happenedAt"></span>
        <span class="edited-indicator" data-bind="if: notification.isUpdated">(edited)</span>
        
        <div class="replies" data-bind="foreach: notification.replies, css: { 'has-replies' : notification.replies().length }">
            <div class="reply">
                <span class="reply-icon"></span>
                <span class="reply-starting-text">Your reply was "</span>
                <span class="reply-text" data-bind="megamark:{ value: commentText }"></span>
                <span>" </span>
                <span data-bind="timeago: commentedAt"></span>
            </div>
        </div>
    </div>
    <div class="notification-buttons">
        {{#if isReplyButtonVisibe}}
        <a data-bind="click: showReplyField">reply</a>
        {{/if}}
        {{#if isSelectCardButtonVisibe}}
        <a data-bind="click: selectCard">select card</a>
        {{/if}}
        {{#if isOpenCardButtonVisibe}}
        <a data-bind="click: openCard">view card details</a>
        {{/if}}
        {{#if !isOpenCardButtonVisibe && isOpenStorymapButtonVisibe && !notification.isAcceptableInvitation()}}
        <a data-bind="click: openStorymap">open story map</a>
        {{/if}}
        {{#if isAcceptInviteButtonVisibe}}
        <a data-bind="click: acceptInvite">accept invitation</a>
        {{/if}}
        {{#if isDismissButtonVisibe}}
        <a data-bind="click: dismiss">mark as read</a>
        {{/if}}
    </div>
</div>

{{#if isReplyFieldVisibe}}
<div class="notification-reply">
    <input type="text" data-bind="value: replyText, valueUpdate: 'keyup', enterKey: reply, escKey: hideReplyField, focus: true"/>
</div>
{{/if}}
</script>
<script type="text/html" id="watch"> <a class="btn-icon" data-bind="click: onClick">
    <i class="icon-watch" data-bind="css: { watched: params.isWatched }"></i>
</a>
<div class="watch__tooltip">
    {{#if params.isWatched}} {{params.clickToUnwatchTooltip }} {{/if}}
    {{#ifnot params.isWatched}} {{params.clickToWatchTooltip }} {{/ifnot}}
</div></script>
<script type="text/html" id="weblinklist"> <div class="weblinks-block">
    <label class="label-small">Links</label>

    {{#if isAddButtonVisible}}
    <a class="add-weblink" tabindex="1" data-bind="click: openAddWebLink"><i class="icon-add-weblink"></i></a>
    <web-link-adder params="isOpen: isAddWebLinkOpen, onSave: onSaveWebLink, onClose: onCloseWebLinkAdder"></web-link-adder>
    {{/if}}

    {{#ifnot hasWeblinks}}
    <p class="no-items">There aren't any link attachments yet.</p>
    {{/ifnot}}

    <ul class="weblink-items" data-bind="foreach: params.webLinks">
        <weblink-item params="
            webLink: $data,
            isEditEnabled: $parent.params.isEditEnabled,
            canComment: $parent.canComment,

            onDelete: $parent.params.onDelete,
            onNameChange: $parent.params.onNameChange,
            onCommentClick: $parent.params.onCommentClick
            "></weblink-item>
    </ul>
</div></script>
<script type="text/html" id="weblinkitem"> 
<list-item params="contextMenuItems: [
             {caption: 'Copy Markdown to clipboard', callback: copyToClipboard, isVisible: true, hasTooltip: true, hasSeparatorAfter: hasSeparator, tooltip: 'You can paste formatted links into card details or comments by using this option...'},
             {caption: 'Edit name', callback: editName, isVisible: params.isEditEnabled},
             {caption: 'Delete', callback: deleteWebLink, isVisible: params.isEditEnabled}
           ],
           tooltipPosition: 'top-right'">
 
    <div class="weblink-item-container" data-bind="isScrolledIntoView: isScrolledTo">

        <div class="image-box">
            <!--<a target="_blank" data-bind="attr: {href: params.webLink.url}">-->
            <a data-bind="click: navigateToUrl">
                <img data-bind="attr: { src: params.webLink.faviconUrl }" />
            </a>
        </div>
        <div class="content-box">

            <div class="name-box">
                    
                    <inline-textarea params="
                             value: name,
                             editOnClick: true,
                             endEditOnEnterKey: true,
                             isInEditMode: isNameInEditMode,
                             onEndEdit: saveName,
                             width: '90%',
                             height: '10px'
                             "></inline-textarea>
                    <span class="validation-message" data-bind="validationMessage: name"></span>
               
            </div>
            <div class="owner-box">

                <span class="uploaded-info">ADDED BY {{params.webLink.createdBy}} <span class="weblink-item-time" data-bind="timeago: params.webLink.createdAt"></span></span>

                {{#if isReplyButtonVisible}}
                <additional-link params="
                                iconClass: 'comment-icon',
                                linkText: 'comment',
                                isVisible: true,
                                onClick: onComment
                                "></additional-link>
                {{/if}}
            </div>
        </div>
    </div>
</list-item></script>

    <script type="text/html" id="notificationsettings"> <modal params="{
       title: 'Notification settings',
       isOpen: isOpen,
       class: 'manage-account-dialog'
    }">

    <track-page params="page: track.UserNotificationSettings"></track-page>

    {{#if !shouldHideSlack() && !IsInIframe() }}
    <div class="slack-setting">
        <slack-connector></slack-connector>
    </div>
    {{/if}}

<div class="notifications-with-providers">
    <div class="provider-icons-container">
        <span class="provider-icon in-app-icon" title="In-app notification" data-bind="qtip: {position: 'top'}"></span>
        {{#if storeProps.isSlackConnected}}
        <span class="provider-icon slack-icon" title="Slack notification" data-bind="qtip: {position: 'top'}"></span>
        {{/if}}
        <span class="provider-icon email-icon" title="Email notification" data-bind="qtip: {position: 'top'}"></span>
    </div>

    <div class="activity-type-title">Team activity</div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: invitedMe.inApp}" disabled="disabled">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: invitedMe.slack}">
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: invitedMe.email}" disabled="disabled">
        </div>

        <span>Someone invites me to a workspace or share a story map with me</span>
    </div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: changeRights.inApp}" disabled="disabled">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: changeRights.slack}">
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: changeRights.email}">
        </div>

        <span>Someone makes any changes on my workspace or story map membership and access rights</span>
    </div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: someoneMentionedMe.inApp}" disabled="disabled">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: someoneMentionedMe.slack}">
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: someoneMentionedMe.email}">
        </div>

        <span>Someone @<strong>mentions</strong> me in a comment</span>
    </div>

    <div class="activity-type-title">Board activity</div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: firstTimeVisitedMyBoard.inApp}">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: firstTimeVisitedMyBoard.slack}">
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: firstTimeVisitedMyBoard.email}">
        </div>

        <span>Someone opens one of my boards for the first time</span>
    </div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: someoneCommentedOrChangedWatchedCards.inApp}">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: someoneCommentedOrChangedWatchedCards.slack}">
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: someoneCommentedOrChangedWatchedCards.email}" disabled="disabled">
        </div>

        <span>Someone comments or <span class="underlined" data-bind="qtip: {contentId: '#changes-tooltip-content', position: 'top'}">make changes</span> on my <strong>watched</strong> cards</span>
        <div id="changes-tooltip-content" style="display: none">
            <div>Comment on card or attachment</div>
            <div>Update card details</div>
            <div>Estimate card</div>
            <div>Schedule card to a release</div>
            <div>Change card status</div>
            <div>Add attachment to card</div>
            <div>Delete card</div>
        </div>
    </div>

    <div class="notification-type">
        <div class="notification-provider-checkboxes">
            <input type="checkbox" data-bind="checkbox: {checked: someonePostedOnBoardDiscussions.inApp}">
            {{#if storeProps.isSlackConnected}}
            <input type="checkbox" data-bind="checkbox: {checked: someonePostedOnBoardDiscussions.slack}">-->
            {{/if}}
            <input type="checkbox" data-bind="checkbox: {checked: someonePostedOnBoardDiscussions.email}" disabled="disabled">
        </div>

        <span>Someone post a message in board discussions</span>
    </div>
</div>

    <div class="general-notification-settings">
        <div class="section-title">General notification settings</div>

        <div>
            <input type="checkbox" data-bind="checkbox: {checked: autoWatchMyCards}">
            <span>Set cards I created automatically watched</span>
        </div>
    </div>

    <button class="btn-action-primary save-btn" data-bind="btnClick: save">Save</button>

    <hint class="hint">
        Hint: Please note that these settings will apply to all of your story maps.
    </hint>

</modal></script>
<script type="text/html" id="pageviewtracker"> <div data-bind="isVisibleOnScreen: updateVisibility"></div></script>
<script type="text/html" id="profileapitokentab"> <div>
    <span>Your token enables access to your data via the API, and needs to be kept private.</span>
    <a href="{{learnMoreUrl}}" target="_blank">Learn more</a>
</div>
<div class="input-and-buttons-container">
    <input type="text" data-bind="textInput: apiToken" disabled="disabled">
    <button class="btn-action-primary" data-bind="click: generateToken">Generate new token</button>
    <button class="btn-action-primary2" data-bind="click: revokeToken">Revoke token</button>
</div>
{{#if apiToken}}
    <div class="token-generated-at-container">
        <span>The API token was generated </span>
        <span data-bind="timeago: apiTokenGeneratedAt"></span>
    </div>
{{/if}}</script>
<script type="text/html" id="slackconnector"> {{#if !storeProps.isConnected() }}
    {{#if !isDismissed() }}
    <div class="slack slack-menu-item">
        <a data-bind="click: openSlackOauthWindow,attr: {'title': qtip}, qtip: { position: 'left', delay: 1}">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="20.4453125 20.4453125 34.109375 34.109375">
                <path fill="#e01e5a" d="M27.609375 42c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031h3.582031zm1.808594 0c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582031 1.609375 3.582031 3.582031v8.972656c0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032zm0 0"></path>
                <path fill="#36c5f0" d="M33 27.609375c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032v3.582031zm0 1.808594c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582031-3.582031 3.582031h-8.972656c-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031zm0 0"></path>
                <path fill="#2eb67d" d="M47.390625 33c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031h-3.582031zm-1.808594 0c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582031-1.609375-3.582031-3.582031v-8.972656c0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032zm0 0"></path>
                <path fill="#ecb22e" d="M42 47.390625c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032v-3.582031zm0-1.808594c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582031 3.582031-3.582031h8.972656c1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031zm0 0"></path>
            </svg>
            <span>Connect to Slack</span>
        </a>
        <span data-bind="click: dismiss">I don't use Slack.</span>
    </div>
    {{/if}}
    <div class="slack slack-notification-setting">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="20.4453125 20.4453125 34.109375 34.109375">
            <path fill="#e01e5a" d="M27.609375 42c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031h3.582031zm1.808594 0c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582031 1.609375 3.582031 3.582031v8.972656c0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032zm0 0"></path>
            <path fill="#36c5f0" d="M33 27.609375c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032v3.582031zm0 1.808594c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582031-3.582031 3.582031h-8.972656c-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031zm0 0"></path>
            <path fill="#2eb67d" d="M47.390625 33c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031h-3.582031zm-1.808594 0c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582031-1.609375-3.582031-3.582031v-8.972656c0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032zm0 0"></path>
            <path fill="#ecb22e" d="M42 47.390625c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032v-3.582031zm0-1.808594c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582031 3.582031-3.582031h8.972656c1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031zm0 0"></path>
        </svg>
        <span>To start using Slack for personal notifications, you should connect it.</span>
        <button data-bind="click: openSlackOauthWindow" class="btn btn-action-primary">Connect Slack</button>
    </div>
{{/if}}
{{#if storeProps.isConnected }}
    <div class="slack slack-notification-setting">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="20.4453125 20.4453125 34.109375 34.109375">
            <path fill="#e01e5a" d="M27.609375 42c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031h3.582031zm1.808594 0c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582031 1.609375 3.582031 3.582031v8.972656c0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032zm0 0"></path>
            <path fill="#36c5f0" d="M33 27.609375c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032v3.582031zm0 1.808594c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582031-3.582031 3.582031h-8.972656c-1.972656 0-3.582032-1.609375-3.582032-3.582031 0-1.972656 1.609376-3.582031 3.582032-3.582031zm0 0"></path>
            <path fill="#2eb67d" d="M47.390625 33c0-1.972656 1.609375-3.582031 3.582031-3.582031 1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031h-3.582031zm-1.808594 0c0 1.972656-1.609375 3.582031-3.582031 3.582031-1.972656 0-3.582031-1.609375-3.582031-3.582031v-8.972656c0-1.972656 1.609375-3.582032 3.582031-3.582032 1.972656 0 3.582031 1.609376 3.582031 3.582032zm0 0"></path>
            <path fill="#ecb22e" d="M42 47.390625c1.972656 0 3.582031 1.609375 3.582031 3.582031 0 1.972656-1.609375 3.582032-3.582031 3.582032-1.972656 0-3.582031-1.609376-3.582031-3.582032v-3.582031zm0-1.808594c-1.972656 0-3.582031-1.609375-3.582031-3.582031 0-1.972656 1.609375-3.582031 3.582031-3.582031h8.972656c1.972656 0 3.582032 1.609375 3.582032 3.582031 0 1.972656-1.609376 3.582031-3.582032 3.582031zm0 0"></path>
        </svg>
        <span>You have successfully connected Slack to StoriesOnBoard.</span>
        <button data-bind="click: disconnectSlack" class="btn btn-action-primary2">Disconnect Slack</button>
    </div>
{{/if}}</script>
<script type="text/html" id="testglobalstate"> 
<div>
    <h1>Na ez itt egy globalStates commponent: {{ params.message }} {{ storeProps.currentUserName }}</h1>
    <button data-bind="click: send">click to send action</button>
</div>
</script>
<script type="text/html" id="usergroupvalidation"> 
{{#if params.isCard}}
<div class="tile-cell" data-bind="click: openDialog">
    <div class="tile-add-people" style="width: 200px;">
        <div class="action">
            <div>
                <i class="icon-tile-add-big"></i>
                <span class="tile-add-button-text">Create a team and add or <br/> invite new members.</span>
                <span style="color: #e01e5a; background: white; padding: 2px 5px; border-radius: 20px; font-size: 8px; font-weight: 600; position: absolute; transform: translate(-1px, 0px);">NEW</span>
            </div>
        </div>
    </div>             
</div>
{{/if}}
{{#ifnot params.isCard}}
<a class="iconized-link-button btn-invite-people" data-bind="click: openDialog">
    <i class="icon-invite-member"></i>
    <span>Add Team </span><span style="color: #e01e5a; font-size: 8px; display: inline-block;  margin-top: -20px; margin-left: -10px">NEW</span>
</a>
{{/if}}


<modal params="{
       title: 'CREATE AND MANAGE TEAMS',
       isOpen: isOpen,
       class: 'user-group-dialog'
    }">
    <div class="feature-validation-dialog">
        <h6>This feature is under consideration. Please let us know what do you think about it.</h6>

        <div class="d-flex align-items-center mt-25">
            <div style="width: 50%;">
                <img style="max-width: 100%" src="/content/img/usergroupvalidation/createteam.png" />
            </div>
            <div class="ml-30" style="width: 50%;">
                <div style="font-size: 22px;"><span style="color: #2D7DD2; font-size: 22px;">Create</span> a Team</div>

                <div class="mt-15" style="font-size: 18px; line-height: 1.3;">
                    <strong style="font-size: 18px;">Add</strong> or <strong style="font-size: 18px;">invite</strong> new team members to your team effortlessly.
                </div>
            </div>
        </div>

        <div class="d-flex align-items-center mt-25">
            <div class="ml-30" style="width: 50%;">
                <div style="font-size: 22px;"><span style="color: #2D7DD2; font-size: 22px;">Assign</span> your team to any story map</div>

                <div class="mt-15" style="font-size: 18px; line-height: 1.3;">
                    Add <strong style="font-size: 18px;">multiple members</strong> to  a story map with a <strong style="font-size: 18px;">single click</strong>. You can also add multiple teams to a story map as well.
                </div>
            </div>
            <div style="width: 50%;">
                <img style="max-width: 100%" src="/content/img/usergroupvalidation/setrole.png" />
            </div>
        </div>
        
        <div class="d-flex align-items-center mt-25">
            <div style="width: 50%;">
                <img style="max-width: 100%"  src="/content/img/usergroupvalidation/setrole1.png" />
            </div>

            <div class="ml-30" style="width: 50%;">
                <div style="font-size: 22px;">
                    <span style="color: #2D7DD2; font-size: 22px;">Manage</span> your team member roles individually
                </div>

                <div class="mt-15" style="font-size: 18px; line-height: 1.3;">
                    Change the <strong style="font-size: 18px;">permission</strong> of each <strong style="font-size: 18px;">member</strong> and it will also become active on the assigned story maps.
                </div>
            </div>
        </div>

        <div class="control-group" style="margin-top: 100px; ">
            <h6 style="font-size: 22px; font-weight: bold;">Are you interested in this new feature?</h6>
            <div class="control mt-30" >
                <label>
                    Your feedback
                    <textarea data-bind="value: message"></textarea>
                </label>
            </div>
        </div>

        <button class="btn-action-primary" data-bind="btnClick: featureRequest">I want this feature</button>
        <button class="btn-action-primary2 mb-15" data-bind="btnClick: featureReject">No thanks</button>
    </div>
</modal></script>
<script type="text/html" id="workspacesnotificationpanel"> {{#if params.isOpened}}
<user-notifications-panel params="
        isOpened: params.isOpened,
        isFullSize: true,
        elementId: 'storymap-user-notification-panel',
        includeWorkspaceInStorymapName: true,
        onClose: params.onClose,
        notifications: notifications,
        isCommentingEnabledCallback: canCommentOnStorymap,
        onDismissAll: onDismissAll,
        trackPage: 'track.WorkspaceDashboardNotificationPanel',
        trackNotificationPanel: 'track.WorkspaceDashboardNotifications',
        trackDirectMessagePanel: 'track.WorkspaceDashboardDirectMessageNotifications',

        actions: {
            onDismiss: onDismiss,
            onOpenCard: onOpenCard,
            onOpenStorymap: onOpenStorymap,
            onReply: onReply,
            onAcceptInvite: onAcceptInvite
        }">
</user-notifications-panel>
{{/if}}</script>

    <script type="text/html" id="components:account-template">
    <div class="account-dropdown-menu" data-bind="dropdownmenu: true">
        <a class="x-menu-button" href="#" tabindex="1">
            <div class="initial-icon" data-bind="text: userInitials"></div>
        </a>     
        <div class="menu-content right-aligned">
            <div class="account-dropdown-menu-content">
                <ul>
                    <li>
                        <div class="heading" data-bind="text: userName"></div>
                        <div class="sub-heading" data-bind="text: email"></div>
                        <div class="details">
                            You're a(n) <span class="user-role" data-bind="text: workspace.workspaceRoleName"></span> on this workspace.
                            <a class="help-center-link" data-bind="redirect: {url: globalConfig.helpLinkWorkspaceRoles, openInNewTab: true}">Learn</a> about user roles.
                        </div>
                        <slack-connector></slack-connector>
                    </li>
                    <li>
                        <hr />
                    </li>
                    <li>
                        <a data-bind="modal: {
                            class: 'default no-footer manage-account-dialog',
                            template: 'components:edit-profile',
                            trigger: 'both',
                            data: $data,
                            beforeOpen: $data.beforeOpenModal,
                            beforeOpenCtx: $data
                        }">Profile</a>
                    </li>
                    <li>
                        <a data-bind="click: openNotificationSettings">Notification settings</a>
                    </li>
                    {{#if workspace.hasAdmins}}
                    <li data-bind="clickStop: true">
                        <a data-bind="qtip: {contentId: '#ws-admins', showOnClick: true, hideOnUnfocus: true, position: 'left', delay: 0}">View workspace admin(s)</a>
                        <div id="ws-admins" class="account-dropdown-admins" data-bind="clickStop: true">
                            <ul data-bind="foreach: workspace.admins">
                                <li>
                                    <span data-bind="text: name"></span><br>
                                    <a href="mailto:{{email}}" data-bind="text: email"></a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    {{/if}}
                    <li>
                        <a data-bind="redirect: globalConfig.workspacesUrl">Your workspaces (<!-- ko text: usersWorkspaceCount --><!-- /ko -->)</a>
                    </li>
                    {{#if controlledDomainsCount() > 0 }}
                    <li><a data-bind="redirect: domainControlUrl">Domain control</a></li>
                    {{/if}}
                    <li>
                        <hr />
                    </li>
                    <li><a data-bind="redirect: {url: globalConfig.helpLinkHelpCenter, openInNewTab: true}">Help center</a></li>
                    <li><a data-bind="click: onSupportClick">Support</a></li>
                    <li>
                        <hr />
                    </li>
                    <li><a data-bind="click: logout">Logout</a></li>
                </ul>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="components:account-on-board-template">
    <div class="account-on-board-dropdown-menu" data-bind="dropdownmenu: {afterOpened: dropdownOpenCallback, afterClosed: dropdownCloseCallback}">
        <a class="x-menu-button" href="#" tabindex="1">
            <div class="initial-icon" data-bind="text: userInitials"></div>
        </a>     
        <div class="menu-content right-aligned">
            <div class="account-on-board-dropdown-menu-content">
                <ul>
                    <li>
                        <div class="heading" data-bind="text: userName"></div>
                        <div class="sub-heading" data-bind="text: email"></div>
                        {{#if storymap.storymapRoleName}}
                        <div class="details">
                            You're a(n) <span class="user-role" data-bind="text: storymap.storymapRoleName"></span> on this board.
                            <a class="help-center-link" data-bind="redirect: {url: globalConfig.helpLinkStorymapRoles, openInNewTab: true}">Learn</a> about user roles.
                        </div>
                        {{/if}}
                        {{#if !shouldHideSlack() && !IsInIframe() }}
                        <slack-connector></slack-connector>
                        {{/if}}
                    </li>
                    <li>
                        <hr />
                    </li>
                    <li>
                        <a data-bind="modal: {
                            class: 'default no-footer manage-account-dialog',
                            template: 'components:edit-profile',
                            trigger: 'both',
                            data: $data,
                            beforeOpen: $data.beforeOpenModal,
                            beforeOpenCtx: $data
                        }">Profile</a>
                    </li>
                    <li>
                        <a data-bind="click: openNotificationSettings">Notification settings</a>
                    </li>
                    {{#if storymap.hasAdmins}}
                    <li data-bind="clickStop: true">
                        <a data-bind="qtip: {contentId: '#storymap-admins', showOnClick: true, hideOnUnfocus: true, position: 'left', delay: 0}">View board admin(s)</a>
                        <div id="storymap-admins" class="account-dropdown-admins" data-bind="clickStop: true">
                            <ul data-bind="foreach: storymap.admins">
                                <li>
                                    <span data-bind="text: name"></span><br>
                                    <a href="mailto:{{email}}" data-bind="text: email"></a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    {{/if}}
                    <li>
                        <hr />
                    </li>
                    <li><a data-bind="click: app.getCurrentViewModel().showKeyboardShortcutsHelp">Keyboard shortcuts</a></li>
                    <li><a data-bind="redirect: {url: globalConfig.helpLinkHelpCenter, openInNewTab: true}">Help center</a></li>
                    <li><a data-bind="click: onSupportClick">Support</a></li>
                    <li>
                        <hr />
                    </li>
                    <li><a data-bind="click: logout">Logout</a></li>
                </ul>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="components:edit-profile">
    <div class="header">
        Profile
        
        {{#if true}}   <!--e nlkl rosszul mr-->     
        <track-page params="page: track.UserProfile"></track-page>
        {{/if}}

        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        {{#ifnot globalConfig.ssoEnabledForCurrentUser }}
        {{#ifnot globalConfig.currentUserIsDomainControlled }}
        <div class="metro-pivot" data-bind="metroPivot: true">
            <div class="pivot-item">
                <h3>Account</h3>

                <div class="control-group">
                    <div class="control">
                        <label>
                            Your name
                            <input type="text" data-bind="value: editProfile.name" tabindex="1">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: editProfile.name"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Your email
                            <input type="text" data-bind="value: editProfile.email, valueUpdate: 'afterkeydown'" tabindex="2">
                        </label>
                        {{#if editProfile.hasPendingEmailAddressChange }}
                        <span class="email-change-request-info"><strong>Heads Up!</strong> An email address change request has been sent to {{ editProfile.requestedNewEmailAddress }}. To complete the request, click the link in the confirmation email. You may <a data-bind="click: cancelPendingEmailChangeRequest">cancel</a> this request if needed.</span>
                        {{/if}}
                        {{#ifnot editProfile.hasPendingEmailAddressChange }}
                        {{#if editProfile.emailAddressChangedByUser }}
                        <span class="email-change-request-info"><strong>Heads Up!</strong> Your email address is used as your account sign-on. If you change it, you need to respond to a confirmation email sent to the new address before the change is applied.</span>
                        {{/if}}
                        {{/ifnot}}
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: editProfile.email"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            <input type="checkbox" data-bind="checkbox:{checked: editProfile.subscribeToEmail}" tabindex="3">
                            Subscribe to newsletter
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control data-collection-pref-link">
                        <a data-bind="click: openConsentManager">Data collection preferences</a>
                    </div>
                </div>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="btnClickWithRemoteValidation: { handler: saveProfile, remoteValidated: editProfile.email }" tabindex="4">Save</button>
                    <button class="btn-action" data-bind="closeModal:true" tabindex="5">Cancel</button>
                </div>
            </div>

        <div class="pivot-item">
            <h3>Change password</h3>

                <div class="control-group">
                    <div class="control">
                        <label>
                            Current password
                            <input type="password" data-bind="value: changePassword.currentPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.currentPassword"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            New password
                            <input type="password" data-bind="value: changePassword.newPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.newPassword"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Confirm new password
                            <input type="password" data-bind="value: changePassword.confirmNewPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.confirmNewPassword"></span>
                    </div>
                </div>
                <div class="control-group" data-bind="if: changePassword.passwordFormatIsInvalid">
                    <div class="password-format-error">
                        Your password does not satisfy the current password policy requirements.
                        <ul>
                            {{#if changePassword.isMinCharCountInvalid}}
                            <li>{{changePassword.minCharCount}} characters</li>
                            {{/if}}
                            {{#if changePassword.isMinUpperCharCountInvalid}}
                            <li>{{changePassword.minUpperCharCount}} uppercase letters</li>
                            {{/if}}
                            {{#if changePassword.isMinLowerCharCountInvalid}}
                            <li>{{changePassword.minLowerCharCount}} lowercase letters</li>
                            {{/if}}
                            {{#if changePassword.isMinNumberCountInvalid}}
                            <li>{{changePassword.minNumberCount}} digits</li>
                            {{/if}}
                            {{#if changePassword.isMinSpecialCharsCountInvalid}}
                            <li>{{changePassword.minSpecialCharsCount}} special characters</li>
                            {{/if}}
                            {{#if changePassword.differentPasswordRequired}}
                            <li>must be different than a previous {{changePassword.differentPasswordCount}}</li>
                            {{/if}}
                        </ul>
                    </div>
                </div>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="btnClick: savePasswordChange">Save</button>
                    <button class="btn-action" data-bind="closeModal:true">Cancel</button>
                </div>
            </div>
            <div class="pivot-item">
                <h3>Theme</h3>
                {{#template 'components:theme-template' /}}
            </div>
            <div class="pivot-item">
                <h3>Delete your account</h3>
                <p>
                    By deleting your account, your membership will also be canceled in all workspaces where you are a member.
                </p>
                <p>
                    <br />
                    <span class="warning-text">THIS OPERATION CANNOT BE UNDONE!</span>
                    <br /> <br />
                </p>
                <form>
                    <div class="control-group">
                        <div class="control w-1-1">
                            <label>
                                <input type="checkbox" data-bind="checkbox: {checked: cancellationConfirmed}">
                                I understand, please delete my account.
                            </label>
                            <span class="validation-message" data-bind="validationMessage: cancellationConfirmed"></span>
                        </div>
                    </div>
                    <div class="form-action-buttons">
                        <button data-bind="btnClick: deleteUserAccount, css: {disabled: !cancellationConfirmed()}" class="btn-action-primary">Delete your account</button>
                    </div>
                </form>
            </div>
            <div class="pivot-item">
                <h3>Advanced</h3>
                {{#template 'components:advanced-tab-content-template'/}}
            </div>
            <div class="pivot-item">
                <h3>Api Token</h3>
                <profile-api-token-tab params="{
                                apiToken: apiToken,
                                apiTokenGeneratedAt: apiTokenGeneratedAt
                               }">
                </profile-api-token-tab>
            </div>
        </div>
        {{/ifnot}}
        {{#if globalConfig.currentUserIsDomainControlled }}
        <div class="metro-pivot" data-bind="metroPivot: true">
            <div class="pivot-item">
                <h3>Account</h3>
                <div class="inline-hint">
                    Hint: You can't change your email address because your account is under domain control and managed by your company.
                    <br /><br />
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Your name
                            <input type="text" data-bind="value: editProfile.name" tabindex="1">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: editProfile.name"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Your email
                            <input type="text" data-bind="value: editProfile.email, disable: true" tabindex="2">
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            <input type="checkbox" data-bind="checkbox:{checked: editProfile.subscribeToEmail}" tabindex="3">
                            Subscribe to newsletter
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control data-collection-pref-link">
                        <a data-bind="click: openConsentManager">Data collection preferences</a>
                    </div>
                </div>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="btnClickWithRemoteValidation: { handler: saveProfile, remoteValidated: editProfile.email }" tabindex="4">Save</button>
                    <button class="btn-action" data-bind="closeModal:true" tabindex="5">Cancel</button>
                </div>
            </div>

    <div class="pivot-item">
        <h3>Change password</h3>

                <div class="control-group">
                    <div class="control">
                        <label>
                            Current password
                            <input type="password" data-bind="value: changePassword.currentPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.currentPassword"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            New password
                            <input type="password" data-bind="value: changePassword.newPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.newPassword"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Confirm new password
                            <input type="password" data-bind="value: changePassword.confirmNewPassword">
                        </label>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: changePassword.confirmNewPassword"></span>
                    </div>
                </div>
                <div class="control-group" data-bind="if: changePassword.passwordFormatIsInvalid">
                    <div class="password-format-error">
                        Your password does not satisfy the current password policy requirements.
                        <ul>
                            {{#if changePassword.isMinCharCountInvalid}}
                            <li>{{changePassword.minCharCount}} characters</li>
                            {{/if}}
                            {{#if changePassword.isMinUpperCharCountInvalid}}
                            <li>{{changePassword.minUpperCharCount}} uppercase letters</li>
                            {{/if}}
                            {{#if changePassword.isMinLowerCharCountInvalid}}
                            <li>{{changePassword.minLowerCharCount}} lowercase letters</li>
                            {{/if}}
                            {{#if changePassword.isMinNumberCountInvalid}}
                            <li>{{changePassword.minNumberCount}} digits</li>
                            {{/if}}
                            {{#if changePassword.isMinSpecialCharsCountInvalid}}
                            <li>{{changePassword.minSpecialCharsCount}} special characters</li>
                            {{/if}}
                            {{#if changePassword.differentPasswordRequired}}
                            <li>must be different than a previous {{changePassword.differentPasswordCount}}</li>
                            {{/if}}
                        </ul>
                    </div>
                </div>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="btnClick: savePasswordChange">Save</button>
                    <button class="btn-action" data-bind="closeModal:true">Cancel</button>
                </div>
            </div>
            <div class="pivot-item">
                <h3>Theme</h3>
                {{#template 'components:theme-template' /}}
            </div>
            <div class="pivot-item">
                <h3>Api Token</h3>
                <profile-api-token-tab params="{
                                apiToken: apiToken,
                                apiTokenGeneratedAt: apiTokenGeneratedAt
                               }">
                </profile-api-token-tab>
            </div>
        </div>
        {{/if}}
        {{/ifnot}}
        {{#if globalConfig.ssoEnabledForCurrentUser}}
        <div class="metro-pivot" data-bind="metroPivot: true">
            <div class="pivot-item">
                <h3>Account</h3>
                <div class="inline-hint">
                    Hint: You can't change your account details because your account is under domain control and managed by your company.
                    <br /><br />
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Your name
                            <input type="text" data-bind="value: editProfile.name, disable: globalConfig.ssoEnabledForCurrentUser">
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            Your email
                            <input type="text" data-bind="value: editProfile.email, disable: globalConfig.ssoEnabledForCurrentUser">
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control">
                        <label>
                            <input type="checkbox" data-bind="checkbox: {checked: editProfile.subscribeToEmail}">
                            Subscribe to newsletter
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control data-collection-pref-link">
                        <a data-bind="click: openConsentManager">Data collection preferences</a>
                    </div>
                </div>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="btnClickWithRemoteValidation: { handler: saveProfile, remoteValidated: editProfile.email }">Save</button>
                    <button class="btn-action" data-bind="closeModal:true">Cancel</button>
                </div>
            </div>
            <div class="pivot-item">
                <h3>Theme</h3>
                {{#template 'components:theme-template' /}}
            </div>
            <div class="pivot-item">
                <h3>Api Token</h3>
                <profile-api-token-tab params="{
                                apiToken: apiToken,
                                apiTokenGeneratedAt: apiTokenGeneratedAt
                               }">
                </profile-api-token-tab>
            </div>
        </div>
        {{/if}}
    </div>
</script>
<script type="text/html" id="components:advanced-tab-content-template">
    <fieldset>
        <legend>
            Setup domain control
        </legend>
        Domain control allows you to manage and supervise user accounts that belong to your corporate domain.
        You may require users to log in to StoriesOnBoard through your Corporate Identity Provider's interface using SAML SSO protocol,
        create password policy rules and monitor their activities.
        This configuration is workspace independent, belongs to your company and managed by dedicated domain admins.
        <br><br>
        Click <a data-bind="redirect: domainControlUrl">here</a> to setup domain control.
    </fieldset>
</script>
<script type="text/html" id="components:notifications-template">
    <!-- ko if: hasNew -->
    <div class="notifications-dropdown" data-bind="dropdownmenu: true">
        <a class="menu-button-notification" href="#" tabindex="1" data-bind="click: openNotifications">
            <i class="icon-header-notification"></i><span>What's new</span>
        </a>
        <div class="menu-content right-aligned">
            <div class="notifications-dropdown-content">
                <div class="content">
                    <div data-bind="foreach: notifications">
                        <div class="title" data-bind="text:title"></div>
                        <div class="text" data-bind="text:message"></div>
                        <div class="published" data-bind="timeago:published"></div>
                        <div class="btns">
                            <!-- ko if: HasLink() -->
                            <a target="_blank" data-bind="attr: { href : link }">learn more</a>
                            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
                            <!-- /ko -->
                            <a data-bind="clickAndStop:function() { $parent.dismissMessage($data.id, $data) }">dismiss</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /ko -->
</script>
<script type="text/html" id="components:theme-template">
    <p>
        Change theme to
    </p>
    <form>
        <div class="control-group">
            <div class="control w-1-1">
                <label>
                    <select data-bind="options: themes, optionsText: 'name', value: selectedTheme, select: true"></select>
                </label>
            </div>
        </div>
        {{#if selectedThemeChanged}}
        <br/>
        <span>
            Theme has been successfully updated! Please click <a data-bind="click: reloadApplication">here</a> to reload the application and apply the new theme.
        </span>
        {{/if}}
        <div class="form-action-buttons">
            <button data-bind="btnClick: updateTheme" class="btn-action-primary">Update theme</button>
        </div>
    </form>
</script>
<script type="text/html" id="components"> <!-- Account links template -->



<!-- Account on board links template -->



<!-- Edit profile modals template -->







<!-- Notifications links template -->



<!-- Theme template -->


</script>
<script type="text/html" id="dashboard:header-title-section">
    <a data-bind="redirect: globalConfig.workspacesUrl" class="navigate-back btn-icon light" href="/">
        <i class="icon-header-nav-back"></i>
    </a>
    
    <workspace-navigator params="workspaceName: workspaceName"></workspace-navigator>
</script>
<script type="text/html" id="dashboard:header-menu-section">
    <!-- Menu section -->
    <!-- SYSTEM NOTIFICATIONS -->
    <a class="header-menu-item" data-bind="component: 'notifications'"></a>

    <!-- USER NOTIFICATIONS -->
    <icon-with-counter params="
        onClick: toggleNotificationPanel,
        iconClass: 'icon-storymap-h-notification',
        title: 'Notifications',
        counterValue: numberOfNonDismissedNotifications">
    </icon-with-counter>

    <!-- MANAGE WORKSPACE -->
    <manage-workspace-dropdown></manage-workspace-dropdown>

    <!-- ACCOUNT MENU -->
    <a class="header-menu-item" data-bind="component: 'account'"></a>
</script>
<script type="text/html" id="dashboard:sub-header-section">
    <!--{{#template 'templates:trial-alert' /}}
    {{#template 'templates:limits-exceed-alert' /}}
    {{#template 'templates:email-confirmation-alert' /}}-->
</script>
<script type="text/html" id="dashboard:search-result-template">
    <li data-bind="showElementOnHover: { selector: '.panel-favorite-storymap,.panel-favorite-storymap-pinned', delay: 100 }">
        <a href="#" data-bind="clickAndStop: function(data,event) { goToStorymapIfNotArchived(event); }, attr: { tabindex: 0 }, text: name"></a>
        {{#if isFavoritingEnabledOnThisMap}}
            {{#ifnot isFavorite}}
            <div class="panel-favorite-storymap" data-bind="clickAndStop: function() { $root.favoriteStorymap($data) }">
                <i class="icon-dash-favorite" title="Favorite this story map. Favorited items will be shown at the top of your story map list." data-bind="qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap'  }"></i>
            </div>
            {{/ifnot}}

            {{#if isFavorite}}
            <div class="panel-favorite-storymap-pinned" data-bind="clickAndStop:  function() { $root.unfavoriteStorymap($data) }">
                <i class="icon-dash-favorite-pinned" title="Unfavorite this story map" data-bind="qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }"></i>
            </div>
            {{/if}}
        {{/if}}
    </li>
</script>
<script type="text/html" id="dashboard:main-section">
    <div id="dashboard-container">
        <div class="wrapper-inner" data-bind="css: { 'dashboard-right-for-pinned-search' : isSearchPanelPinned() }, winSize: winSize">

            {{#template 'templates:trial-alert' /}}
            {{#template 'templates:limits-exceed-alert' /}}
            {{#template 'templates:email-confirmation-alert' /}}

<div id="main" class="dashboard-content cf" data-bind="css: {'vertical-align-center': !hasStoryMaps() && storymapCreationEnabled()}">

<!-- No story maps -->
{{#ifnot hasStoryMaps}}
{{#if storymapCreationEnabled}}
<div class="onboarding-no-story-maps">
    <div class="deck-cards-with-title">
        <strong class="onboarding-title">How would you like to begin?</strong>
        <div class="deck-card-container">
            <deck-card params="
              onClick: createSampleStorymap, 
              title: 'Start with our example map', 
              description: 'Quick overview of a story map with top-notch hints and tricks',
              iconUrl: '../../../content/img/example-map-icon.svg'"></deck-card>
            <deck-card params="
              onClick: goToCreateNewStorymap,
              title: 'Create a new map from scratch',
              description: 'Start mapping your own product',
              iconUrl: '../../../content/img/new-map-icon.svg'"></deck-card>
            <deck-card params="
              onClick: openVideo,
              title: 'See StoriesOnBoard in action',
              description: 'Watch our short product tour',
              iconUrl: '../../../content/img/video-icon.svg'"></deck-card>
        </div>
    </div>
    <img class="stob-logo" alt="logo" src="../../../content/img/stob-logo.png">

    <div class="trailer-embed" style="display: none;">
        <a href="" class="close" data-bind="click: closeVideo"></a>
        <div class="trailer-overlay"></div>
    </div>
</div>
{{/if}}
{{#ifnot storymapCreationEnabled}}
<div>
    <div class="alert">
        <div class="alert-title">
            Welcome {{userName}}!
        </div>
        <div class="alert-description">
            Sorry, you can't access any story maps yet.
            <br /><br />
            Please contact this workspace's administrator to get appropriate access rights.
        </div>
    </div>
</div>
{{/ifnot}}
{{/ifnot}}
    

                {{#if hasStoryMaps}}

                <!-- Favorite story maps -->
                {{#if hasFavoriteStorymaps}}
                <div class="tile-group-row cf tile-group-favorite-storymaps">

                    <!-- Storymaps -->

                    <div id="dashboard-storymaps" class="tile-group one-column" data-bind="visible: hasStoryMaps(), css: {
                 'one-column' : dashboardHasOneColumn,
                 'two-column' : dashboardHasTwoColumn,
                 'three-column' : dashboardHasThreeColumn,
                 'four-column' : dashboardHasFourColumn }">

                        <div class="tile-group-header">
                            <div class="tile-group-header-left dashboard-heading-text">
                                <i class="icon-dash-favorite-storymaps"></i>
                                Favorite story maps
                            </div>
                            <div class="tile-group-header-right">
                                <div data-bind="visible: favoriteStoryMaps.pageCount() > 1">
                                    <div class="tile-pager">
                                        {{#if favoriteStoryMapsPageSize() > 1 }}
                                        <div class="tile-paging-info">
                                            <span data-bind="text: favoriteStoryMaps.pagingInfo()"></span>
                                        </div>
                                        {{/if}}
                                        <a class="btn-icon opacitied">
                                            <i class="pager-left" data-bind="click: favoriteStoryMaps.movePrevious"></i>
                                        </a>
                                        <a class="btn-icon opacitied">
                                            <i class="pager-right" data-bind="click: favoriteStoryMaps.moveNext"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tile-group-content" id="storymaps-content">
                            {{#foreach: favoriteStoryMaps.currentPageData }}
                            <div class="tile-cell">
                                <div class="tile-favorite-storymap" data-bind="showElementOnHover: { selector: '.favorite-storymap', delay: 100 }, clickAndStop: function(data,event) { goToStorymapIfNotArchived(event); }">
                                    {{#if storymap.isFavoritingEnabledOnThisMap}}
                                    {{#if $parent.isFavoritingVisible }}
                                    {{#if storymap.isFavorite}}
                                    <div class="favorite-storymap-pinned" data-bind="clickAndStop:  function() { $root.unfavoriteStorymap(storymap) }">
                                        <i class="icon-dash-favorite-pinned" title="Unfavorite this story map" data-bind="qtip: { position: 'right', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }"></i>
                                    </div>
                                    {{/if}}
                                    {{/if}}
                                    {{/if}}

                                    {{#if storymap.isPublic}}
                                    <i class="icon-dash-tile-public-storymap" title="Public story map"></i>
                                    {{/if}}
                                    {{#if storymap.isWorkspaceVisible}}
                                    <i class="icon-dash-tile-ws-visible-storymap" title="Workspace visible story map"></i>
                                    {{/if}}
                                    <span class="caption" data-bind="truncate: {text: storymap.name, height: 43} , css: { tile-indent-caption : storymap.isPublic() || storymap.isWorkspaceVisible() }"></span>
                                    <span class="description" data-bind="truncate: {text: storymap.description, height: 42}"></span>
                                    {{#ifnot storymap.isArchived}}
                                    <div>
                                        <span class="bottom_left">
                                            <span class="h5" data-bind="text: collaboratorsCount"></span>
                                            <i class="icon-dash-collaborators" title="Collaborators"></i>
                                        </span>
                                        <span class="bottom_right">
                                            <span class="h5" data-bind="text: storymap.releasesCount"></span>
                                            <span class="extra-small-font">releases</span>
                                            <span class="h5">|</span>
                                            <span class="h5" data-bind="text: storymap.allStoriesCount"></span>
                                            <span class="extra-small-font">stories</span>
                                        </span>
                                    </div>
                                    {{/ifnot}}
                                </div>
                            </div>
                            {{/foreach}}
                        </div>
                    </div>
                </div>
                {{/if}}

                <!-- All story maps -->

                <div class="tile-group-row cf">

                    <!-- Storymaps -->

                    <div id="dashboard-storymaps" class="tile-group one-column" data-bind="visible: hasStoryMaps(), css: {
                 'one-column' : dashboardHasOneColumn,
                 'two-column' : dashboardHasTwoColumn,
                 'three-column' : dashboardHasThreeColumn,
                 'four-column' : dashboardHasFourColumn }">

                        <div class="tile-group-header" data-bind="css: {'collection-tile-header' : showCollectionContent() }">
                            <div class="tile-group-header-left dashboard-heading-text">
                                {{#if showCollectionContent }}
                                <span class="dashboard-path-start">
                                    <i class="icon-dash-collections"></i>
                                    /
                                </span>
                                <span class="collection-name" data-bind="visible: showCollectionContent(), text: selectedCollection().name"></span>
                                {{/if}}
                                {{#ifnot showCollectionContent }}
                                <i class="icon-dash-storymaps"></i>
                                Your story maps
                                {{/ifnot}}
                            </div>
                            <div class="tile-group-header-right">
                                <div data-bind="visible: visibleDashboardItems.pageCount() > 1">
                                    <div class="tile-pager">
                                        <div class="tile-paging-info">
                                            <span data-bind="text: visibleDashboardItems.pagingInfo()"></span>
                                        </div>
                                        <a class="btn-icon opacitied">
                                            <i class="pager-left" data-bind="click: visibleDashboardItems.movePrevious"></i>
                                        </a>
                                        <a class="btn-icon opacitied">
                                            <i class="pager-right" data-bind="click: visibleDashboardItems.moveNext"></i>
                                        </a>
                                    </div>
                                </div>
                                {{#if hasMoreThanOneStoryMaps}}
                                <div>
                                    <div class="storymap-order-dropdown-menu" data-bind="dropdownmenu:true">
                                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                            <span data-bind="text: sortOrderName()"></span>
                                            <span class="caret"></span>
                                        </a>
                                        <div class="menu-content right-aligned">
                                            <ul>
                                                <li class="dropdown-items-heading">
                                                    Order Story Maps by ...
                                                </li>
                                                <li><a data-bind="clickAndStop: function () { $data.changeOrder(viewmodels.dashboard.SortOrderType.Alphabetical); }">abc</a></li>
                                                <li><a data-bind="clickAndStop: function () { $data.changeOrder(viewmodels.dashboard.SortOrderType.Recent); }">recent</a></li>
                                                <li><a data-bind="clickAndStop: function () { $data.changeOrder(viewmodels.dashboard.SortOrderType.Latest); }">latest</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <span class="tile-menu-separator" data-bind="visible: visibleDashboardItems.pageCount() > 1">|</span>
                                </div>
                                {{/if}}

                                {{#if isToggleArchivesLinkVisible }}
                                <div>
                                    <a class="showArchives" data-bind="click: toggleArchives, text: showArchivedStorymaps() ? 'hide archives' : 'show archives'"></a>
                                </div>
                                {{/if}}
                            </div>
                        </div>

                        <div class="tile-group-content" id="storymaps-content">
                            <div class="tile-cell" data-bind="visible: showCollectionContent()">
                                <div class="tile-storymaps tile-back">
                                    <a data-bind="click: closeCollection">
                                        <div class="action">
                                            <div>
                                                <i class="icon-dash-collection-back"></i>
                                                <span class="dash-collection-back">Back to dashboard</span>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>

                            {{#foreach: visibleDashboardItems.currentPageData }}
                            {{#if isCollection}}
                            {{#if $parent.storymapCountsInCollections()[id] > 0 }}
                            <div class="tile-cell">
                                <div class="tile-storymap-collection" data-bind="clickAndStop: function(data,event) { $root.openCollection(data,event); }">
                                    <div class="collection-header-bar">
                                        <div class="collection-header-bar-content">
                                            collection
                                        </div>
                                    </div>
                                    <div class="collection-title">
                                        <span class="collection-title caption" data-bind="truncate: {text: name, height: 43}"></span>
                                    </div>

                                    <span class="bottom_left">
                                        <span class="h5" data-bind="text: $parent.storymapCountsInCollections()[id]"></span>
                                        <span class="extra-small-font">story maps</span>
                                    </span>
                                </div>
                            </div>
                            {{/if}}
                            {{/if}}

                            <!-- ko ifnot: isCollection -->
                            <div class="tile-cell" data-bind="css: storymap.isArchived() ? ' archived' : ''">
                                <div class="tile-storymaps" data-bind="showElementOnHover: { selector: '.favorite-storymap', delay: 100 }, clickAndStop: function(data,event) { goToStorymapIfNotArchived(event); }">

                                    {{#if storymap.isFavoritingEnabledOnThisMap}}
                                    {{#if $parent.isFavoritingVisible }}
                                    {{#ifnot storymap.isArchived }}
                                    {{#ifnot storymap.isFavorite}}
                                    <div class="favorite-storymap" data-bind="clickAndStop: function() { $root.favoriteStorymap(storymap) }">
                                        <i class="icon-dash-favorite" title="Favorite this story map. Favorited items will be shown at the top of your story map list." data-bind="qtip: { position: 'right', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap'  }"></i>
                                    </div>
                                    {{/ifnot}}

                                    {{#if storymap.isFavorite}}
                                    <div class="favorite-storymap-pinned" data-bind="clickAndStop:  function() { $root.unfavoriteStorymap(storymap) }">
                                        <i class="icon-dash-favorite-pinned" title="Unfavorite this story map" data-bind="qtip: { position: 'right', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }"></i>
                                    </div>
                                    {{/if}}
                                    {{/ifnot}}
                                    {{/if }}
                                    {{/if}}

                                    {{#if storymap.isPublic}}
                                    <i class="icon-dash-tile-public-storymap" title="Public story map"></i>
                                    {{/if}}
                                    {{#if storymap.isWorkspaceVisible}}
                                    <i class="icon-dash-tile-ws-visible-storymap" title="Workspace visible story map"></i>
                                    {{/if}}
                                    <span class="caption" data-bind="truncate: {text: storymap.name, height: 43} , css: { tile-indent-caption : storymap.isPublic() || storymap.isWorkspaceVisible() }"></span>
                                    <span class="description" data-bind="truncate: {text: storymap.description, height: 42}"></span>
                                    <span data-bind="visible: storymap.isArchived()">
                                        <div>
                                            <span class="extra-small-font">Archived </span>
                                            <span class="extra-small-font" data-bind="timeago: storymap.archivedAt"></span>
                                            <span class="extra-small-font">by</span>
                                            <span class="extra-small-font" data-bind="text:storymap.archivedBy"></span>
                                        </div>
                                    </span>
                                    {{#ifnot storymap.isArchived}}
                                    <div>
                                        <span class="bottom_left">
                                            <span class="h5" data-bind="text: collaboratorsCount"></span>
                                            <i class="icon-dash-collaborators" title="Collaborators"></i>
                                        </span>
                                        <span class="bottom_right">
                                            <span class="h5" data-bind="text: storymap.releasesCount"></span>
                                            <span class="extra-small-font">releases</span>
                                            <span class="h5">|</span>
                                            <span class="h5" data-bind="text: storymap.allStoriesCount"></span>
                                            <span class="extra-small-font">stories</span>
                                        </span>
                                    </div>
                                    {{/ifnot}}

                                    {{#if storymap.isArchived}}
                                    <div>
                                        <span class="bottom_right">
                                            <span class="extra-small-font" style="cursor: pointer" data-bind="clickAndStop: function() { $data.storymap.restore(); }">restore from archive</span>
                                        </span>
                                    </div>
                                    {{/if}}
                                </div>
                            </div>
                            <!-- /ko -->
                            {{/foreach}}
                        </div>
                    </div>

                    <div class="dashboard-action-buttons tile-group btn-column" data-bind="style: { float: showHorizontalActionButtons() ? 'none' : 'left'}">
                        <div class="tile-group-header">
                            <div class="tile-group-header-left  dashboard-heading-text">
                                Actions
                            </div>
                        </div>
                        <div class="tile-group-content" id="storymaps-content" data-bind="css: { 'horizontal-buttons' : showHorizontalActionButtons }">

                            <div data-bind="css: { 'horizontal-buttons' : showHorizontalActionButtons  }">
                                {{#ifnot isSearchPanelPinned}}
                                <div id="search-panel-on-dashboard" class="tile-action-btn" href="#storymap-search-panel" data-bind="panelslider: { isPanelOpened: $root.searchPanelIsOpened, onComplete: function () { setSearchFieldFocused(); }, duration: panelSliderDuration }">
                                    <div class="action">
                                        <div>
                                            <i class="icon-dash-search-storymap"></i>
                                            <div class="action-button-text">Find map</div>
                                        </div>
                                    </div>
                                </div>
                                {{/ifnot}}
                                {{#if isSearchPanelPinned}}
                                <div class="tile-action-btn" href="#storymap-search-panel" data-bind="click: function() { isPinnedSearchFieldFocused(true); }">
                                    <div class="action">
                                        <div>
                                            <i class="icon-dash-search-storymap"></i>
                                            <div class="action-button-text">Find map</div>
                                        </div>
                                    </div>
                                </div>
                                {{/if}}
                            </div>

                            {{#if storymapCreationEnabled}}

                            <div id="new-storymap-button" data-bind="css: { 'horizontal-buttons' : showHorizontalActionButtons }">
                                <div class="tile-action-btn" data-bind="go: { url: newStorymapUrl }, qtip: { contentId: '#new-storymap-tooltip-content', position: 'right' }">
                                    <div class="action">
                                        <div>
                                            <i class="icon-dash-new-storymap"></i>
                                            <div class="action-button-text">New map</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="new-storymap-tooltip-content">
                                <span class="new-storymap-tooltip-content-item">You can create a new story map from scratch, import it from an XLSX file or create by copying an existing one.</span>
                                <br /><br />
                                <span class="new-storymap-tooltip-content-item"> You can also create a new sample story map by clicking </span>
                                <a class="new-storymap-tooltip-content-item" data-bind="click: $root.createSampleStorymap">here</a><span class="new-storymap-tooltip-content-item">.</span>
                            </div>

                            {{/if}}

                        </div>
                    </div>

                </div>


                {{/if}}
            </div>




            <!-- Storymap search panel -->

            <div id="storymap-search-panel">
                <div class="cf">
                    <div class="storymap-search-panel-button">
                        <a href="/" data-bind="clickAndStop: closeSearchPanel">
                            <i class="icon-panel-close"></i>
                        </a>
                    </div>
                    <div class="storymap-search-panel-title">Find story map</div>
                    <div class="storymap-search-panel-pin"><i title="Pin search panel" data-bind="click: pinSearchPanel, qtip: { position: 'bottom-right', adjustY: 5, adjustX: -15, delay: 1 } " class="icon-panel-pin"></i></div>
                </div>
                <div class="storymap-search-panel-content">
                    {{#if searchPanelIsOpened}}
                    <track-page params="page: track.FindStorymapsOnDashboard"></track-page>
                    {{/if}}

                    <input class="storymap-search-keywords" type="text" name="keywords" data-bind="value: searchKeywords, valueUpdate: 'keyup', hasFocus: isSearchFieldFocused, key: { keyCode: 70, keyModifier: 'ctrlKey', action: function() { searchPanelIsOpened(false); return false;  }}, escKey: function() { searchPanelIsOpened(false); }" placeholder="Type story map's name" />

                    <div class="search-result-container" data-bind="heightResizer: { selector: '#storymap-search-panel', relative: -145 }">
                        <!-- ko foreach: searchResults -->

                        <div class="section-title" data-bind="visible: $root.showSearchResultSectionTitles">
                            <i data-bind="attr: { class: icon }"></i>
                            <span data-bind="text: name"></span>
                        </div>

                        <ul class="matching-storymap-lists">

                            <!-- ko foreach: storymaps -->

                            <li data-bind="showElementOnHover: { selector: '.panel-favorite-storymap,.panel-favorite-storymap-pinned', delay: 100 }">
                                {{#if isArchived}}
                                <a href="#" class="archived-search-result-item" data-bind="clickAndStop: restoreAndOpen, attr: { tabindex: 0 }, text: name"></a>
                                {{/if}}
                                {{#ifnot isArchived}}
                                <a href="#" data-bind="clickAndStop: function(data,event) { goToStorymapIfNotArchived(event); }, attr: { tabindex: 0 }, text: name"></a>
                                {{/ifnot}}
                                {{#if isFavoritingEnabledOnThisMap}}
                                <!-- ko ifnot: isFavorite -->
                                <div class="panel-favorite-storymap">
                                    <i class="icon-panel-favorite" title="Favorite this story map. Favorited items will be shown at the top of your story map list." data-bind="clickAndStop: function() { $root.favoriteStorymap($data) }, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap'  }"></i>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: isFavorite -->
                                <div class="panel-favorite-storymap-pinned">
                                    <i class="icon-panel-favorite-pinned" title="Unfavorite this story map" data-bind="clickAndStop:  function() { $root.unfavoriteStorymap($data) }, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }"></i>
                                </div>
                                <!-- /ko -->
                                {{/if}}
                            </li>
                            <!-- /ko -->
                        </ul>
                        <!-- /ko -->
                        {{#if searchResults().length == 0}}
                        <div class="search-no-matching-text">There aren't any story maps matching your query.</div>
                        {{/if}}
                        {{#if showToggleArchivesLinkInSearch }}
                        <p>
                            {{#ifnot showArchivedStorymapsInSearchResults}}
                            <a href="" class="show-more-storymaps" data-bind="click: toggleArchivesInSearchResults, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob' }" title="Also list story maps you archived previously.">Search among archived story maps</a>
                            {{/ifnot}}
                            {{#if showArchivedStorymapsInSearchResults}}
                            <a href="" class="show-more-storymaps" data-bind="click: toggleArchivesInSearchResults">Hide archived story maps</a>
                            {{/if}}
                        </p>
                        {{/if}}
                    </div>
                </div>
            </div>


            <!-- Pinned storymap search panel -->
            {{#if isSearchPanelPinned}}
            <div id="pinned-storymap-search-panel">
                <div class="storymap-search-panel-pin"><i title="Unpin search panel" data-bind="click: unpinSearchPanel, qtip: { position: 'bottom-right', adjustY: 5, adjustX: -15, delay: 1 }" class="icon-panel-pin-pinned"></i></div>
                <div class="storymap-search-panel-content">
                    <input class="storymap-search-keywords" type="text" name="keywords" data-bind="value: searchKeywords, valueUpdate: 'keyup', hasFocus: isPinnedSearchFieldFocused, key: { keyCode: 70, keyModifier: 'ctrlKey', action: function() { searchPanelIsOpened(false); return false;  }}, escKey: function() { searchPanelIsOpened(false); }" placeholder="Find story map by name" />

                    <div class="search-result-container" data-bind="heightResizer: { selector: '#pinned-storymap-search-panel', relative: -155 }">
                        <!-- ko foreach: searchResults -->
                        <!--<div class="section-title" data-bind="text: name"></div>-->
                        <div class="section-title" data-bind="visible: $root.showSearchResultSectionTitles">
                            <i data-bind="attr: { class: icon }"></i>
                            <span data-bind="text: name"></span>
                        </div>
                        <ul class="matching-storymap-lists">

                            <!-- ko foreach: storymaps -->

                            <li data-bind="showElementOnHover: { selector: '.panel-favorite-storymap,.panel-favorite-storymap-pinned', delay: 100 }">
                                {{#if isArchived}}
                                <a href="#" class="archived-search-result-item" data-bind="clickAndStop: restoreAndOpen, attr: { tabindex: 0 }, text: name"></a>
                                {{/if}}
                                {{#ifnot isArchived}}
                                <a href="#" data-bind="clickAndStop: function(data,event) { goToStorymapIfNotArchived(event); }, attr: { tabindex: 0 }, text: name"></a>
                                {{/ifnot}}
                                {{#if isFavoritingEnabledOnThisMap}}
                                <!-- ko ifnot: isFavorite -->
                                <div class="panel-favorite-storymap">
                                    <i class="icon-panel-favorite" title="Favorite this story map. Favorited items will be shown at the top of your story map list." data-bind="clickAndStop: function() { $root.favoriteStorymap($data) }, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap'  }"></i>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: isFavorite -->
                                <div class="panel-favorite-storymap-pinned">
                                    <i class="icon-panel-favorite-pinned" title="Unfavorite this story map" data-bind="clickAndStop:  function() { $root.unfavoriteStorymap($data) }, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }"></i>
                                </div>
                                <!-- /ko -->
                                {{/if}}
                            </li>
                            <!-- /ko -->
                        </ul>
                        <!-- /ko -->
                        {{#if searchResults().length == 0}}
                        <div class="search-no-matching-text">There aren't any story maps matching your query.</div>
                        {{/if}}
                        {{#if showToggleArchivesLinkInSearch }}
                        <p>
                            {{#ifnot showArchivedStorymapsInSearchResults}}
                            <a href="" class="show-more-storymaps" data-bind="click: toggleArchivesInSearchResults, qtip: { position: 'left', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob' }" title="Also list story maps you archived previously.">Search among archived story maps</a>
                            {{/ifnot}}
                            {{#if showArchivedStorymapsInSearchResults}}
                            <a href="" class="show-more-storymaps" data-bind="click: toggleArchivesInSearchResults">Hide archived story maps</a>
                            {{/if}}
                        </p>
                        {{/if}}
                    </div>
                </div>
            </div>
            {{/if}}

        </div>
        <main-notification-panel params="
            numberOfNonDismissedNotifications: numberOfNonDismissedNotifications,
            isOpened: notificationPanelIsOpened,
            onClose: closeNotificationPanel"></main-notification-panel>
    </div>
    <sign-up-onboarding-modal></sign-up-onboarding-modal>
</script>
<script type="text/html" id="dashboard"> <!-- Title -->


<!-- Menu -->







</script>
<script type="text/html" id="editstorymap:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Edit ' + $data.name() + ' storymap',
        description: 'Change story map settings, add or remove collaborators or share storymap with wider audience',
        goBackByHistory: true
        } }"></div>
</script>
<script type="text/html" id="editstorymap:main-section">

    <div id="main" class="cf">

        <div class="metro-pivot" data-bind="metroPivot: { startIndex: startTabIndex }">

            <!-- Edit name and description -->

            <div class="pivot-item">
                <h3>Name and description</h3>
                <form>
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Name
                                <input type="text" data-bind="value: name" tabindex="1" maxlength="200">
                            </label>
                            <span class="help-block">Name can't be longer than 200 character.</span>
                        </div>
                        <div class="control w-2-3" style="position: relative">
                            <span class="validation-message" data-bind="validationMessage: name"></span>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Description
                                <textarea data-bind="value: description"></textarea>
                            </label>
                            <span class="help-block">Description is optional.</span>
                        </div>
                        <div class="control w-2-3" style="position: relative">
                            <span></span>
                        </div>
                    </div>
                    {{#if hasCollections}}
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Collection
                                <select class="collection-select-component" data-bind="options: collections, optionsText: 'truncatedName', value: selectedCollection, optionsCaption: 'Choose collection...', select: true"></select>
                            </label>
                            <span class="help-block">Collections help you organize your story maps</span>
                        </div>
                    </div>
                    {{/if}}
                    <div class="form-action-buttons">
                        <button type="submit" class="btn-action-primary" data-bind="btnClick: save">Save</button>
                        <button type="button" class="btn-action" data-bind="go: { url: '/managestorymaps' }">Cancel</button>
                    </div>
                </form>
            </div>

            <!-- Edit collaborators -->

            <div class="pivot-item">
                <h3>Collaborators</h3>
                Add or remove workspace member, change roles or send invitation email for new people to become collaborator of this story map.<br/>New story map viewers will be observers on the workspace by default.
                <br/>
                <br/>
                <a class="iconized-link-button btn-invite-member" data-bind="click: toggleAddWorkspaceMember">
                    <i class="icon-invite-member"></i>
                    <span>Add a workspace member</span>
                </a>
                &nbsp;&nbsp;
                <a class="iconized-link-button btn-invite-people" data-bind="click: toggleInvitation">
                    <i class="icon-invite-people"></i>
                    <span>Invite new people</span>
                </a>

                <div class="add-member-box" data-bind="visible: isAddWorkspaceMemberVisible">
                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Add workspace member
                                <select data-bind="options: availableWorkspaceMembers, optionsText: 'name', value: selectedWorkspaceMember, select: true"></select>
                            </label>
                            <span class="validation-message" data-bind="validationMessage: selectedWorkspaceMember"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                as a(n)
                                <select data-bind="options: rolesForMember, optionsText: 'name', value: selectedRole, select: true"></select>
                            </label>
                        </div>
                        {{#if selectedWorkspaceMemberIsObserver }}
                        <div class="add-workspace-memeber-observer">
                            The selected member is observer on this workspace, so she can only be a viewer of the story map.
                            <!--Click <a>here</a> if you want to upgrade her workspace role to memeber.-->
                        </div>
                        {{/if}}
                    </div>

                    <div class="buttons">
                        <a class="btn-action-primary button" data-bind="debouncedAjaxBtnClick: addWorkspaceMember"><span>Add</span></a>
                        <a class="btn-action-primary2 button" data-bind="debouncedClick: toggleAddWorkspaceMember"><span>Close</span></a>
                    </div>
                </div>

                <div class="invite-people-box" data-bind="visible: isInvitationVisible">
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Invite new people by email
                                
                                {{#if: isBulkInvitation}}
                                <textarea data-bind="value: invitationEmails, hasFocus: invitationEmailFocused"></textarea>
                                {{/if}}
                                {{#ifnot: isBulkInvitation}}
                                <input type="text" data-bind="value: invitationEmail, hasFocus: invitationEmailFocused">
                                {{/ifnot}}
                            </label>
                            
                            {{#if: isBulkInvitation}}
                            <span class="validation-message" data-bind="validationMessage: invitationEmails"></span>
                            {{/if}}
                            {{#ifnot: isBulkInvitation}}
                            <span class="validation-message" data-bind="validationMessage: invitationEmail"></span>
                            {{/ifnot}}


                            <span class="help-block">
                                {{#if: isBulkInvitation}}
                                Add multiple e-mail addresses separated by a comma (,).
                                {{/if}}
                                {{#ifnot: isBulkInvitation}}
                                Click here to <a href="#" data-bind="click: toggleBulkInvitation">bulk invite people</a> by adding multiple e-mail addresses.
                                {{/ifnot}}
                            </span>
                        </div>
                        <div class="control w-1-3">
                            <label>
                                as a(n)
                                <select data-bind="options: roles, optionsText: 'name', value: selectedRole, select: true"></select>
                            </label>
                        </div>
                    </div>

                    <div class="buttons">
                        {{#if: isBulkInvitation}}
                        <a class="btn-action-primary button" data-bind="click: invite"><span>Invite</span></a>
                        {{/if}}
                        {{#ifnot: isBulkInvitation}}
                        <a class="btn-action-primary button" data-bind="btnClickWithRemoteValidation: {remoteValidated: invitationEmail, handler: invite}"><span>Invite</span></a>
                        {{/ifnot}}
                        <a class="btn-action-primary2 button" data-bind="debouncedClick: toggleInvitation"><span>Close</span></a>
                    </div>
                </div>

                <div class="tile-group-row">
                    <div class="tile-group four-column">
                        <!--Header -->
                        <div class="tile-group-header">
                            <div class="tile-group-header-right">
                                <div data-bind="visible: collaborators.pageCount() == 1">
                                    <br/>
                                </div>
                                <div data-bind="visible: collaborators.pageCount() > 1">
                                    <div class="tile-pager">
                                        <div class="tile-paging-info">
                                            <span data-bind="text: collaborators.pagingInfo()"></span>
                                        </div>
                                        <a class="btn-icon opacitied">
                                            <i class="pager-left" data-bind="click: collaborators.movePrevious"></i>
                                        </a>
                                        <a class="btn-icon opacitied">
                                            <i class="pager-right" data-bind="click: collaborators.moveNext"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Content -->
                        <div class="tile-group-content" data-bind="foreach: collaborators.currentPageData">
                            <div class="tile-cell">
                                <div class="tile-collaborator">
                                    <span class="caption" data-bind="text: name, attr: { title: name }"></span>
                                    <span class="description" data-bind="text: email, attr: { title: email }"></span>
                                    <div class="center_content">
                                        <div data-bind="visible: isInInvitedState">
                                            <span class="center_content_label">Invited</span>
                                            <span class="value" data-bind="timeago: invitedAt"></span>
                                        </div>
                                        <div data-bind="visible: !isInInvitedState">
                                            <span class="center_content_label">Added</span>
                                            <span class="value" data-bind="timeago: addedAt"></span>
                                        </div>
                                        
                                        {{#if $data.isInInvitedState }}
                                        <span class="center_content_label"><a class="small-font dotted-link" data-bind="click: function () { $root.resendInvitation($data); }">Resend</a> or</span>
                                        <span class="show-invitation-link dotted-link" data-bind="qtip: { contentId: '.get-invite-link-content', position: 'top', showOnClick: true, hideOnUnfocus: true, classes: 'qtip-tipsy qtip-sob qtip-sob-light invitation-link-tooltip' }">show</span>
                                        <span> invitation link</span>
                                        <div class="get-invite-link-content">
                                            <div class="get-invite-link-description">Click on the link below & press CTRL+C to copy to clipboard, or click <a href="{{invitationMailtoLink}}">here</a> to send the invitation with your email client.</div>
                                            <textarea class="invitation-url" readonly="readonly" data-bind="value: acceptInviteUrl, click: function(data, event) { $root.selectInvitationLink(event); }"></textarea>
                                        </div>
                                        {{/if }}
                                    </div>
                                    <div class="bottom_left">
                                        {{#if $data.isObserver }}
                                        <div class="menu-content left-aligned">
                                            <span class="small-font">Observer / Viewer</span>
                                        </div>
                                        {{/if}}
                                        {{#ifnot $data.isObserver }}
                                        <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                                <span class="small-font" data-bind="text: role().name"></span>
                                                <span class="caret"></span>
                                            </a>
                                            <div class="menu-content left-aligned">
                                                <ul>
                                                    <li class="dropdown-items-heading">
                                                        Change role to ...
                                                    </li>
                                                    <!-- ko foreach: $root.roles -->
                                                    <li><a data-bind="text: name, clickAndStop: function () { $parent.changeRole($data) }"></a></li>
                                                    <!-- /ko -->
                                                </ul>
                                            </div>
                                        </div>
                                        {{/ifnot}}
                                    </div>
                                    <div class="bottom_right">
                                        <div>
                                            <!-- ko ifnot: $data.isInInvitedState -->
                                            <span class="small-font link" data-bind="click: function () { $root.removeCollaborator($data); }">Remove</span>
                                            <!-- /ko -->
                                            <!-- ko if: $data.isInInvitedState -->
                                            <span class="small-font link" data-bind="click: function () { $root.removeCollaborator($data); }">Cancel invitation</span>
                                            <!-- /ko -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>                
                <!-- ko if: hasInvitedCollaborators -->
                <div id="resend-all-link">
                    Click <a data-bind="click: resendAllInvitations">here</a> to resend all pending invitations.
                </div>
                <!-- /ko -->
                <div class="enable-commenting-for-viewers-container control-group control-group-with-2row-hint-above">
                    <div class="control w-2-3">
                        <label>
                            <input type="checkbox" data-bind="checkbox: {checked: viewersCanCommentOnCards}" />
                            Enable commenting and discussion for viewer collaborators
                        </label>
                    </div>
                </div>
                {{#if showViewersCanCommentNotAvaliable}}
                    <div class="control-group">
                        <div class="control w-2-3">
                            <div class="subscription-info-hint">
                                Hint: This feature is not avaliable in the current subscription plan. Please upgrade your subscription plan to use this feature.
                            </div>
                        </div>
                    </div>
                {{/if}}


            </div>
            <div class="pivot-item moreshring-options">
                <h3>More sharing options</h3>
                <div class="description">
                    Change your story maps visibility or share it with private links.
                </div>
                <div class="control-group">
                    <div class="control w-1-5">
                        <label>
                            Visibility
                            <select data-bind="options: visibilityOptions, optionsText: 'name', optionsValue: 'value', value: visibility, select: true"></select>
                        </label>
                    </div>
                    <span class="help-block" data-bind="html: visibilityOptionHelp"></span>
                </div>
                {{#if workspaceMembersCommentCheckboxVisible }}
                    <div class="control-group">
                        <div class="control">
                            <label>
                                <input type="checkbox" data-bind="checkbox:{checked: canWorkspaceMembersComment}" tabindex="1">
                                Enable commenting and discussion for everyone on this workspace
                            </label>
                        </div>
                    </div>
                {{/if}}

                {{#if hasVisibiltySettingsUnavailableCommentingFeature}}
                    <div class="control-group wsmember-commenting-hint-wrapper">
                        <div class="control w-2-3">
                            <div class="subscription-info-hint" style="display: block;">
                                Hint: The workspace members' commenting feature is not available in the current subscription plan. Please upgrade your subscription plan to use this feature.
                            </div>
                        </div>
                    </div>
                {{/if}}

                <div class="control-group save-changes-btn-container">
                    <button type="button" class="btn-action-primary save-changes-btn" data-bind="btnClick: updateBoardVisibilityParams, css: {disabled: hasVisibiltySettingsUnavailableCommentingFeature}">Update visibility</button>
                </div>


                <div class="enable-private-link-wrapper">

                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                <input type="checkbox" data-bind="checkbox: {checked: isSharingWithPrivateLinkEnabled}, click: togglePrivateLinkSharing" />
                                Enable sharing story map with private link
                            </label>
                        </div>
                    </div>

                    <div class="control-group private-link" data-bind="visible: isSharingWithPrivateLinkEnabled">
                        {{#if privateLinkSharingFeatureAvailable}}
                        <div class="w-2-3 private-link-url-wrapper">
                            <input readonly="true" onclick="this.focus(); this.select();" type="text" data-bind="value: privateLinkUrl">
                        </div>
                        <div class="w-1-3 generate-token-button-wrapper">
                            <button type="button" class="btn-action-primary" data-bind="btnClick: generateNewPrivateLinkToken">Revoke & generate new</button>
                        </div>
                        <span class="help-block">Anyone who has the link can view the map in read-only mode. No sign-in required.</span>
                        <p class="info-text" data-bind="if: hasPrivateLinkCreationDetails">The private link was generated by <span data-bind="text: privateLinkCreatedByUser"></span> <span data-bind="timeago: privateLinkCreatedAt"></span>.</p>
                        <div class="control w-2-3">
                            <label>
                                <input type="checkbox" data-bind="checkbox: {checked: isPrivateLinkCommentingEnabled}, click: togglePrivateLinkCommenting" />
                                Enable commenting and discussion over private link access
                            </label>
                        </div>
                        {{/if}}


                        {{#ifnot privateLinkSharingFeatureAvailable}}
                            <div class="control w-2-3">
                                <div class="subscription-info-hint" style="display: block;">
                                    Hint: Sharing your story map with a private link is not available in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
                                </div>
                            </div>
                        {{/ifnot}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="editstorymap"> <!-- Sub header -->



<!-- Main -->


</script>
<script type="text/html" id="integrationsettings:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Jira integration settings',
        description: 'Setup and manage workspace level integration settings for Atlassian Jira. Only Atlassian Jira requires configuration at a workspace level. All other project management tools we currently support only need to be configured on the Board Settings page of your story map.'
        } }">
    </div>
</script>
<script type="text/html" id="integrationsettings:main-section">

<div id="main" class="cf">
        <!--<p class="info-text">Hint: Only Atlassian Jira requires configuration at a workspace level. All other project management tools we currently support only need to be configured on the Board Settings page of your story map.</p>-->
        <div class="metro-pivot" data-bind="metroPivot: true">
            <div class="pivot-item">
                {{#if hasJiraCloudOrOnPremiseFeature}}

                <h3>Workspace level Jira {{#if isJiraCloudOnly}}Cloud{{/if}} integration settings</h3>

                {{#ifnot isConnected()}}
                For a two-way synchronisation you'll need to set up an
                <a target="_blank" href="https://confluence.atlassian.com/display/JIRA060/Configuring+Application+Links">
                    application link
                </a>
                between Jira and StoriesOnBoard. An application link is a trusted relationship between StoriesOnBoard and Jira.
                You'll need a user with Administrator role in Jira for setting this up.
                {{#ifnot isJiraCloudOnly}}
                <br />
                <br />
                If you are integrating with an on-premise Jira instance, you may need to whitelist StoriesOnBoard
                in your firewall so that it can make connections to your Jira server.
                StoriesOnBoard is using the following IP addresses for the connections: <strong data-bind="text:outboundIpAdresses"></strong>.
                <br />
                <br />
                Please note, on-premise integration requires at least Jira Software version 6.1. Jira Cloud instances are always running the latest Jira Software version.
                {{/ifnot}}
                <br />
                <br />
                {{#if isJiraCloudOnly}}
                To start, please type in your Jira Cloud subdomain:
                {{/if}}
                {{#ifnot isJiraCloudOnly}}
                To start, please type in your Jira instance URL:
                {{/ifnot}}
                <br /> <br />
                <div class="control-group">
                    {{#if isJiraCloudOnly}}
                    <div class="control">
                        <label>
                            Jira Cloud subdomain
                            <input type="text" data-bind="value: jiraCloudUrl,valueUpdate: ['afterkeydown', 'input']">
                        </label>
                        <span class="help-block">Your url looks similar to this: https://{yourcompanynamehere}.atlassian.net</span>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: jiraCloudUrl"></span>
                    </div>
                    {{/if}}
                    {{#ifnot isJiraCloudOnly}}
                    <div class="control">
                        <label>
                            Jira instance URL
                            <input type="text" data-bind="value: jiraInstanceUrl,valueUpdate: ['afterkeydown', 'input']">
                        </label>
                        <span class="help-block">This is the URL to your specific Jira instance. If you have a locally hosted version, it must be visible to StoriesOnBoard. If you have a hosted instance, your url looks similar to this: https://{yourcompanynamehere}.atlassian.net</span>
                    </div>
                    <div class="control" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: jiraInstanceUrl"></span>
                    </div>
                    {{/ifnot}}
                </div>


                {{#if isShowUpgradeInfo()}}
                <br />
                Hint: You can also integrate with on-premise Jira instance if you upgrade your subscription plan.
                {{/if}}

                {{#if isShowAppLinkAuth()}}

                <br />
                Great start! {{#if isJiraCloudOnly}}Your Jira Cloud URL is <strong>{{jiraFullUrl}}</strong>.{{/if}} To continue, please follow the next configuration steps:
                <br />
                <br />
                <br />

                <ol>
                    <li>
                        Log into Jira as an Administrator and go to
                        <a target="_blank" data-bind="attr: { href: jiraAppLinkSettingsUrl }">Application Links</a> inside Jira Add-on settings
                    </li>
                    <li>
                        Create a new application link by entering StoriesOnBoard url:
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input normal" type="text" data-bind="value: newJiraSetupAppUrl">
                        and clicking "Create new link" button
                    </li>
                    <li>
                        If a popup window Configure Application URL appears with the error message No response was received from the URL, then just click Continue
                    </li>
                    <li>
                        In the "Link applications" popup for "Application Name" enter
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input normal" type="text" data-bind="value: newJiraSetupAppName"> and click "Continue"
                    </li>
                    <li>
                        If the application link is created successfully, edit it by clicking the "Edit" button next to it
                    </li>
                    <li>
                        Choose "Incoming Authentication" in the popup
                    </li>
                    <li>
                        For the Consumer Key and for Consumer Name, enter
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input normal" type="text" data-bind="value: newJiraSetupConsumerKey">
                    </li>
                    <li>
                        For the Public Key, copy and paste
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input big area" data-bind="value: newJiraSetupPublicKey"></textarea>
                    </li>
                    <li>
                        Click "Save" and close the popup to finish Jira application link configuration
                    </li>
                </ol>
                <p>
                    Congratulations! Now StoriesOnBoard is able to connect to Jira with OAuth, which means you dont need to give your Jira password to StoriesOnBoard. <br />
                    Now we need to set up the other way, Jira should be able to send updates to StoriesOnBoard when an issue has been changed.
                </p><br />
                <p>
                    This can be set up in two ways. The easy way is to let StoriesOnBoard set it up for you by giving the permission, the hard way is to do it manually.<br />
                    If you let StoriesOnBoard to do it for you, we'll open a window and ask you to authenticate yourself in Jira. Just log in and leave the rest of the setup process to us.<br /><br />
                    Please keep in mind that you need to log in to Jira with a user that has <i>Jira Administrator</i> role.
                </p><br />

                <button class="btn-action-primary" data-bind="click: connectToJiraInitateOauth">Please set it up for me!</button>
                &nbsp;
                <button class="btn-action" data-bind="click: function() { goManually();}">I'll do it manually</button>

                <br />
                <br />
                <br />


                <!--
    EZ ESETLEG KSBB:
    or
    <   button class="btn-action" data-bind="click: function() { connectToJiraInitateOauth();}">Save and contuniue manually</button>
    -->
                {{/if}}
                {{/ifnot}}


                {{#if isConnected()}}

                {{#ifnot isManuallyConfigured()}}


                {{#ifnot isIntegrationEnabled()}}
                Jira connection is established to
                <strong data-bind="text: jiraFullUrl"></strong>.
                You can enable integration right now. By pressing the "Enable integration" button StoriesOnBoard will automatically create a
                <a target="_blank" href="https://confluence.atlassian.com/display/Cloud/Managing+Webhooks">Jira webhook</a> in your Jira instance.
                This webhook is necessary for the synchronisation between the two system, so please don't delete or modify it manually!
                If you later disable integration or disconnect Jira, StoriesOnBoard will delete this webhook for you automatically.
                <br />
                <br />
                {{#ifnot isJiraCloudOnly}}
                If you are integrating with an on-premise Jira system, you may need to whitelist StoriesOnBoard
                in your firewall so that it can make connections to your Jira server.
                StoriesOnBoard is using the following IP addresses for the connections: <strong data-bind="text:outboundIpAdresses"></strong>.
                <br />
                <br />
                {{/ifnot}}
                <button class="btn-action-primary" data-bind="click: function() { enableIntegration();}">Enable integration</button>
                &nbsp;
                {{#ifnot isJiraCloudOnly}}
                <button class="btn-action" data-bind="click: function() { openChangeInstanceUrlModal();}">Modify Jira instance URL</button>
                &nbsp;
                {{/ifnot}}
                <button class="btn-action" data-bind="click: function() { disconnect();}">Disconnect Jira</button>
                {{/ifnot}}

                {{#if isIntegrationEnabled()}}
                Jira integration is established to
                <strong data-bind="text: jiraFullUrl"></strong>.
                <br />
                <br />
                {{#ifnot isJiraCloudOnly}}
                If you are integrating with an on-premise Jira system, you may need to whitelist StoriesOnBoard
                in your firewall so that it can make connections to your Jira server.
                StoriesOnBoard is using the following IP addresses for the connections: <strong data-bind="text:outboundIpAdresses"></strong>.
                <br />
                <br />
                {{/ifnot}}
                <button class="btn-action-primary" data-bind="click: function() { disableIntegration();}">Disable integration</button>
                &nbsp;
                {{#ifnot isJiraCloudOnly}}
                <button class="btn-action" data-bind="click: function() { openChangeInstanceUrlModal();}">Modify Jira instance URL</button>
                &nbsp;
                {{/ifnot}}

                <button class="btn-action" data-bind="click: function() { disconnect();}">Disconnect Jira</button>

                {{/if}}

                {{/ifnot}}

                {{/if}}

                {{#if isManuallyConfigured()}}

                {{#ifnot isIntegrationEnabled()}}

                Jira url is saved as <strong data-bind="text: jiraFullUrl"></strong>.
                Before enabling integration, you have to configure a webhook in your Jira instance.
                <br />
                <br />
                {{#ifnot isJiraCloudOnly}}
                If you are integrating with an on-premise Jira system, you may need to whitelist StoriesOnBoard
                in your firewall so that it can make connections to your Jira server.
                StoriesOnBoard is using the following IP addresses for the connections: <strong data-bind="text:outboundIpAdresses"></strong>.
                <br />
                <br />
                {{/ifnot}}
                <ol>
                    <li>
                        First, open Jira's
                        <a target="_blank" data-bind="attr: { href: jiraWebhookSettingsUrl }">Webhook management</a> inside Jira System settings
                    </li>
                    <li>
                        Press "Create a webhook" button
                    </li>
                    <li>
                        Name your new webhook like this
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input long" data-bind="value: webhookName"></textarea>
                    </li>
                    <li>
                        Copy the following link into the URL field
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input long" data-bind="value: webhookUrl"></textarea>
                    </li>

                    <li>
                        In the "Events" section check the following "Issue related events": Issue / created, updated, deleted. Also make sure to check Version / released, updated and deleted events under "Project related events" :
                    </li>
                    <li>
                        Press "Create" button
                    </li>
                    <li>
                        If the webhook is successfully created in Jira, press "Enable integration" button below.
                    </li>
                </ol>

                <br />
                <br />
                <button class="btn-action-primary" data-bind="click: function() { enableIntegration();}">Enable integration</button>
                &nbsp;
                {{#ifnot isJiraCloudOnly}}
                <button class="btn-action" data-bind="click: function() { openChangeInstanceUrlModal();}">Modify Jira instance URL</button>
                &nbsp;
                {{/ifnot}}

                <button class="btn-action" data-bind="click: function() { disconnect();}">Disconnect Jira</button>

                {{/ifnot}}

                {{#if isIntegrationEnabled()}}
                Jira integration is established to
                <strong data-bind="text: jiraFullUrl"></strong>.
                If integration is not working properly, please check that all the settings have the following values in Jira.
                <br />
                <br />
                {{#ifnot isJiraCloudOnly}}
                If you are integrating with an on-premise Jira system, you may need to whitelist StoriesOnBoard
                in your firewall so that it can make connections to your Jira server.
                StoriesOnBoard is using the following IP addresses for the connections: <strong data-bind="text:outboundIpAdresses"></strong>.
                <br />
                <br />
                {{/ifnot}}
                <strong>AppLink settings</strong> at <a target="_blank" data-bind="attr: { href: jiraAppLinkSettingsUrl }">here</a>
                <br />
                <br />
                <ol>
                    <li>
                        Application Name
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input normal" type="text" data-bind="value: newJiraSetupAppName">
                    </li>
                    <li>
                        Display URL and Application URL url
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input big" type="text" data-bind="value: newJiraSetupAppUrl">
                    </li>
                    <li>
                        Consumer Key and Consumer Name
                        <br />
                        <input readonly="true" onclick="this.focus(); this.select();" class="to-copy-input normal" type="text" data-bind="value: newJiraSetupConsumerKey">
                    </li>
                    <li>
                        Public Key
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input big area" data-bind="value: newJiraSetupPublicKey"></textarea>
                    </li>
                </ol>
                <strong>Webhook settings</strong> at <a target="_blank" data-bind="attr: { href: jiraWebhookSettingsUrl }">here</a>
                <br />
                <br />
                <ol>
                    <li>
                        Webhook name
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input big area" data-bind="value: webhookName"></textarea>
                    </li>
                    <li>
                        Webhook URL
                        <br />
                        <textarea readonly="true" onclick="this.focus(); this.select();" class="to-copy-input big area" data-bind="value: webhookUrl"></textarea>
                    </li>
                    <li>
                        "Issue related events" which need to be enabled: created, updated, deleted<br />
                        "Version related events" which need to be enabled: released, updated, deleted
                    </li>
                </ol>
                <br />
                <br />
                <button class="btn-action-primary" data-bind="click: function() { disableIntegration();}">Disable integration</button>
                &nbsp;
                {{#ifnot isJiraCloudOnly}}
                <button class="btn-action" data-bind="click: function() { openChangeInstanceUrlModal();}">Modify Jira instance URL</button>
                &nbsp;
                {{/ifnot}}
                <button class="btn-action" data-bind="click: function() { disconnect();}">Disconnect Jira</button>
                <br />
                <br />
                {{/if}}

                {{/if}}

                {{/if}}
                {{#ifnot hasJiraCloudOrOnPremiseFeature}}
                Subscription admin need to upgrade workspace subscription plan to enable Jira integration. {{#if globalConfig.userRoles === "SubscriptionAdmin"}}Click <a data-bind="go: { url: '/workspacesettings?p=billing' }">here</a> to upgrade now.{{/if}}
                {{/ifnot}}
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="integrationsettings:change-jira-instanceurl">
    <div class="header">
        Modify Jira instance url
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <div class="description">
            Use this option only if your Jira installation URL is changed! If you want to enable integration with a new Jira instance, you need to disconnect first, and connect to the new Jira instance.
        </div>

        <form>
            {{#ifnot jiraCloudOnly}}
            <div class="control-group">
                <div class="control">
                    <label>
                        Enter a new URL for your Jira installation
                        <input type="text" data-bind="value: url">
                    </label>
                    <span class="validation-message" data-bind="validationMessage: url"></span>
                </div>
            </div>
            {{/ifnot}}
            {{#if jiraCloudOnly}}
            <div class="control-group">
                <div class="control">
                    <label>
                        Enter a new subdomain for your Jira Cloud service
                        <input type="text" data-bind="value: subdomain">
                    </label>
                    <span class="validation-message" data-bind="validationMessage: subdomain"></span>
                </div>
            </div>
            {{/if}}
        </form>

    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="btnClick: save">Save</button>
        <button class="btn-action" data-bind="btnClick: close">Cancel</button>
    </div>
</script>
<script type="text/html" id="integrationsettings:jiraoauth"></script>
<script type="text/html" id="integrationsettings"> <!-- Sub header -->


<!-- Main -->







</script>
<script type="text/html" id="layout"> <div id="header" data-bind="disableContextMenu:true">
    <div id="header-title" data-bind="section: { name: 'header-title-section', optional: true }">
        <a data-bind="redirect: globalConfig.workspacesUrl" class="navigate-back btn-icon light" href="/"></a>
        <a class="brand" data-bind="text: workspaceName, go:'/'"></a>&nbsp;<span class="brand-subtext">workspace on StoriesOnBoard</span>
    </div>
    <div id="header-menu" data-bind="section: { name: 'header-menu-section', optional: true }">
        <!-- MANAGE WORKSPACE -->
        <manage-workspace-dropdown></manage-workspace-dropdown>

        <a class="header-menu-item" data-bind="component: 'account'"></a>
    </div>
</div>
<div id="wrapper" data-bind="disableContextMenu:true">
    <!--<div class="header-shadow"></div>-->
    <div data-bind="section: { name: 'sub-header-section', optional: true }">
    </div>
    <!-- Main section -->
    <div class="main-section-container cf" data-bind="section: { view: view, name: 'main-section' }"></div>
</div>
<notification-settings></notification-settings></script>
<script type="text/html" id="learn:subheader-section">
    <div id="subheader">
        <span class="h3">Learn Storymam Tool</span>
        <span class="small-font">Learn how can use this app</span>
    </div>
</script>
<script type="text/html" id="learn:main-section">
    <div id="main">
        Coming soon...    
    </div>
</script>
<script type="text/html" id="managepeople:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Manage people',
        description: 'There are ' + membersCount() + ' editors (including members, admins, invited and locked out members) and ' + observablesCount() + ' viewers (observers) on this workspace. Observers can only view story maps on this workspace, while members can collaborate on several story maps.'
        } }"></div>
    
  
</script>
<script type="text/html" id="managepeople:main-section">
    <div id="main" class="cf" data-bind="winSize: winSize">
        <div class="tile-group-row">
            <div class="tile-group four-column" data-bind=" css: {'five-column' : isFiveColumn }">
                <!-- Header -->
                <div class="tile-group-header">
                    <div class="tile-group-header-left tile-filter">
                            Show
                            &nbsp;
                            <div class="tile-filter-dropdown-menu" data-bind="dropdownmenu:true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                    <span data-bind="text: selectedFilter().name"></span>
                                    <span class="caret"></span>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul>
                                        <li><a data-bind="click: function () { $data.changeFilter(0); }">all people</a></li>
                                        <li class="dropdown-menu-line">
                                            <hr>
                                        </li>
                                        <li><a data-bind="click: function () { $data.changeFilter(1); }">active people</a></li>
                                        <li><a data-bind="click: function () { $data.changeFilter(2); }">invited people</a></li>
                                        <li><a data-bind="click: function () { $data.changeFilter(3); }">locked out people</a></li>
                                    </ul>
                                </div>
                            </div>

                            with
                            &nbsp;
                            <div class="tile-filter-dropdown-menu" data-bind="dropdownmenu:true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                    <span data-bind="text: selectedRoleFilter().name"></span>
                                    <span class="caret"></span>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul>
                                        <li><a data-bind="click: function () { $data.changeRoleFilter(0); }">all roles</a></li>
                                        <li class="dropdown-menu-line">
                                            <hr>
                                        </li>
                                        <li><a data-bind="click: function () { $data.changeRoleFilter(1); }">observer role</a></li>
                                        <li><a data-bind="click: function () { $data.changeRoleFilter(2); }">member role</a></li>
                                        <li><a data-bind="click: function () { $data.changeRoleFilter(3); }">admin role</a></li>
                                        <li><a data-bind="click: function () { $data.changeRoleFilter(4); }">subscription admin role</a></li>
                                    </ul>
                                </div>
                            </div>
                    </div>
                    <div class="tile-group-header-right">
                        
                        <div class="pager-wrapper" data-bind="visible: displayedWorkspaceMembers.pageCount() > 1">
                            <div class="tile-pager">
                                <div class="tile-paging-info">
                                    <span data-bind="text: displayedWorkspaceMembers.pagingInfo()"></span>
                                </div>
                                <a class="btn-icon opacitied">
                                    <i class="pager-left" data-bind="click: displayedWorkspaceMembers.movePrevious"></i>
                                </a>
                                <a class="btn-icon opacitied">
                                    <i class="pager-right" data-bind="click: displayedWorkspaceMembers.moveNext"></i>
                                </a>
                            </div>
                        </div>
                        <div class="manage-people-search-wrapper" data-bind="visible: isSearchVisible">
                            <input type="text" data-bind="value: searchKeyword, valueUpdate: 'keyup', visible: isSearchFieldVisible, hasFocus: isSearchFieldFocused" class="manage-people-search" placeholder="name or email address"/>
                            <i class="icon-tile-search" title="Search by name<br>or email address" data-bind="click: showSearchField, qtip: { position: 'bottom', delay: 1 }" ></i>
                        </div>
                    </div>
                </div>
                <!-- Content -->
                <div class="tile-group-content" id="manage-people-content">
                    <div class="tile-cell">
                        <div class="tile-add-people" data-bind="modal: {
                            class: 'default',
                            template: 'new-member',
                            trigger: 'both',
                            data: $data,
                            beforeOpen: beforeOpenModal
                            }">
                            <div class="action">
                                <div>
                                    <i class="icon-tile-add-big"></i>
                                    <span class="tile-add-button-text">Invite person to become workspace member</span>
                                </div>
                            </div>
                        </div>
                        
                       
                    </div>

                    <!-- ko template: { name: currentTemplateName,  foreach: displayedWorkspaceMembers.currentPageData } -->
                    <!-- /ko -->
                </div>
            </div>
        </div>
        <!-- ko if: hasInvitedMember -->
        <div id="resend-all-link">
            Click <a data-bind="click: resendAllInvitations">here</a> to resend all pending invitations.
        </div>
        <!-- /ko -->
    </div>
</script>
<script type="text/html" id="managepeople:new-member">
    <track-page params="page: track.ManagePeopleInvite"></track-page>

    <div class="header">
        Invite person
        <a class="btn-icon" data-bind="closeModal: true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <div class="description">
            Type the email address and select a role for the person you want to invite. After accepting your invitation she will have access to your workspace. Please note observers may only view while members can contribute to your workspace. You will be able to control access to your story maps at a story map level as well.
        </div>
        
        <div class="control-group invitation-address">
            <div class="control">
                <label>
                    {{#if: isBulkInvitation}}
                    Email addresses
                    <textarea data-bind="value: addNewMemberModel.emails" tabindex="1"></textarea>
                    {{/if}}
                    {{#ifnot: isBulkInvitation}}
                    Email
                    <input type="text" id="invite-email" data-bind="value: addNewMemberModel.email" tabindex="1">
                    {{/ifnot}}
                    <span class="help-block">
                        {{#if: isBulkInvitation}}
                        Add multiple e-mail addresses separated by a comma (,).
                        {{/if}}
                        {{#ifnot: isBulkInvitation}}
                        Click here to <a href="#" data-bind="click: toggleBulkInvitation">bulk invite people</a> by adding multiple e-mail addresses.
                        {{/ifnot}}
                    </span>
                </label>
            </div>
            <div class="control">
                {{#if: isBulkInvitation}}
                    <span class="validation-message" data-bind="validationMessage: addNewMemberModel.emails"></span>
                {{/if}}
                {{#ifnot: isBulkInvitation}}
                    <span class="validation-message" data-bind="validationMessage: addNewMemberModel.email"></span>
                {{/ifnot}}
            </div>
        </div>
        <div class="control-group">
            <div class="control">
                <label>
                    Role
                    <!-- ko if: executorRole == 3 -->
                    <select data-bind="optionsCaption: 'Choose...', options: roles, optionsText: 'name', value: addNewMemberModel.role, select:true" tabindex="2"></select>
                    <!-- /ko -->
                    <!-- ko ifnot: executorRole == 3 -->
                    <select data-bind="optionsCaption: 'Choose...', options: rolesForAdmin, optionsText: 'name', value: addNewMemberModel.role, select: true" tabindex="3"></select>
                    <!-- /ko -->
                </label>
            </div>
            <div class="control" style="position: relative">
                <span class="validation-message" data-bind="validationMessage: addNewMemberModel.role"></span>
            </div>
        </div>
        {{#if addNewMemberModel.isCanCreateStorymapVisible }}
        <div class="control-group invite-people-control-group" data-bind="visible: addNewMemberModel.isCanCreateStorymapVisible">
            <div class="control">               
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: addNewMemberModel.canInviteObserver }">
                    <span>Can invite viewers to storymaps. Invited story map viewers will become observers in the workspace.</span>
                </label>
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: addNewMemberModel.canInviteMember }">
                    <span>Can invite admins and editors to story maps. Invited story map admins and editors will become members in the workspace.</span>
                </label>
            </div>
        </div>       
        {{/if}}
    </div>
    <div class="footer">
        {{#if: isBulkInvitation}}
        <button class="btn-action-primary" data-bind="click: saveNewMember" tabindex="4">Invite</button>
        {{/if}}
        {{#ifnot: isBulkInvitation}}
        <button class="btn-action-primary" data-bind="btnClickWithRemoteValidation: {remoteValidated: addNewMemberModel.email, handler: saveNewMember}" tabindex="4">Invite</button>
        {{/ifnot}}
        
        <button class="btn-action" data-bind="closeModal: true" tabindex="5">Close</button>
    </div>
</script>
<script type="text/html" id="managepeople:EnabledMember">
    <div class="tile-cell">
        <div class="tile-people">
            <!--<span class="caption" data-bind="truncate: { text: name, height: 55 }"></span>-->
            <span class="caption" data-bind="text:name, attr: { title: name}"></span>
            <!--<div class="description" data-bind="truncate: { text: emailAddress, height : 15 }"></div>-->
            <div class="description" data-bind="text: emailAddress, attr: { title: emailAddress}"></div>
            <div class="center_content">
                <span class="center_content_label">Joined </span><span class="value" data-bind="timeago: joinedAt"></span><br/>
                <span class="center_content_label" data-bind="css: { disabled : !canInviteObserver() }, visible: isMember(), text: canInviteObserver() ? 'Can invite board viewer as observer' : 'Can\'t invite viewer as observer'"></span>
                <span class="center_content_label" data-bind="css: { disabled : !canInviteMember() }, visible: isMember(), text: canInviteMember() ? 'Can invite board editor as member' : 'Can\'t invite editor as member'"></span>
                <!--<br/>
                <span class="center_content_label">last activity: </span><span class="value" data-bind="timeago: lastActivityAt"></span>-->
            </div>
            <div class="bottom_left">
                <!-- ko ifnot: $parent.canEditMember($data) -->
                <span class="small-font" data-bind="text: role().name"></span>
                <!-- /ko -->
                <!-- ko if: $parent.canEditMember($data) -->
                <div>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="trigger" tabindex="1">
                            <span class="small-font" data-bind="text: role().name"></span>
                            <span class="caret"></span>
                        </a>
                        <div class="menu-content left-aligned">
                            <ul>
                                <li class="dropdown-items-heading">
                                   Change user's role to ...
                                </li>
                                <li><a data-bind="click: function () { $data.changeRole($parent.getRoleById(0)); }">Observer</a></li>
                                <li><a data-bind="click: function () { $data.changeRole($parent.getRoleById(1)); }">Member</a></li>
                                <li><a data-bind="click: function () { $data.changeRole($parent.getRoleById(2)); }">Admin</a></li>
                                <!-- ko if: $parent.executorRole == 3 -->
                                <li><a data-bind="clickAndStop: function () { $data.changeRole($parent.getRoleById(3)); }">Subscription Admin</a></li>
                                <!-- /ko -->
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
            <div class="bottom_right" style="width: 40%">
                <!-- ko if: $parent.canEditMember($data) -->
                <div>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                            <i class="icon-tile-options"></i>
                            <!--<span class="small-font">More</span>
                            <span class="caret"></span>-->
                        </a>
                        <div class="menu-content right-aligned">
                            <ul>
                                <li><a data-bind="clickAndStop: lockOut ">Lock out</a></li>
                                <li><a data-bind="clickAndStop: function () { $parent.removeMemeber($data); }">Delete</a></li>
                                <!-- ko if: isMember() -->
                                <li><a data-bind="clickAndStop: toggleInviteObserver, text: canInviteObserver() ? 'Disable inviting observers' : 'Enable inviting observers'"></a></li>
                                <li><a data-bind="clickAndStop: toggleInviteMember, text: canInviteMember() ? 'Disable inviting members' : 'Enable inviting members'"></a></li>
                                <!-- /ko -->
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="managepeople:InvitedMember">
    <div class="tile-cell">
        <div class="tile-people">
            <!-- <span class="invitated_info">Invited</span>-->
            <div class="caption" data-bind="truncate: { text: invitedEmailAddress, height: 71 }"></div>
            <div class="center_content invited">
                <span class="center_content_label">Invited </span><span class="value" data-bind="timeago: invitedAt"></span><br/>
                
                <span class="center_content_label"><a class="small-font dotted-link" data-bind="click: function () {  $parent.resendInvitation($data); }">Resend</a> or</span>
                <span class="show-invitation-link dotted-link" data-bind="qtip: { contentId: '.get-invite-link-content', position: 'top', showOnClick: true, hideOnUnfocus: true, classes: 'qtip-tipsy qtip-sob qtip-sob-light invitation-link-tooltip' }">show</span>
                <span class="small-font">invitation link</span>
                <br />
                <div class="get-invite-link-content">
                    <div class="get-invite-link-description">Click on the link below & press CTRL+C to copy to clipboard, or click <a href="{{invitationMailtoLink}}">here</a> to send the invitation with your email client.</div>
                    <textarea class="invitation-url" readonly="readonly" data-bind="value: acceptInviteUrl, click: function(data, event) { $root.selectInvitationLink(event); }"></textarea>
                </div>
                <span class="center_content_label" data-bind="css: { disabled : !canInviteObserver() }, visible: isMember(), text: canInviteObserver() ? 'Can invite board viewer as observer' : 'Can\'t invite viewer as observer'"></span>
                <span class="center_content_label" data-bind="css: { disabled : !canInviteMember() }, visible: isMember(), text: canInviteMember() ? 'Can invite board editor as member' : 'Can\'t invite editor as member'"></span>
            </div>
            <div class="bottom_left">
                <!-- ko ifnot: $parent.canEditMember($data) -->
                <span class="small-font" data-bind="text: role().name"></span>
                <!-- /ko -->
                <!-- ko if: $parent.canEditMember($data) -->
                <div>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                            <span class="small-font" data-bind="text: role().name"></span>
                            <span class="caret"></span>
                        </a>
                        <div class="menu-content left-aligned">
                            <ul>
                                <li class="dropdown-items-heading">
                                    Change user's role to ...
                                </li>
                                <li><a data-bind="click: function () { $data.changeRole($parent.getRoleById(0)); }">Observer</a></li>
                                <li><a data-bind="clickAndStop: function () { $data.changeRole($parent.getRoleById(1)); }">Member</a></li>
                                <li><a data-bind="clickAndStop: function () { $data.changeRole($parent.getRoleById(2)); }">Admin</a></li>
                                <!-- ko if: $parent.executorRole == 3 -->
                                <li><a data-bind="clickAndStop: function () { $data.changeRole($parent.getRoleById(3)); }">Subscription Admin</a></li>
                                <!-- /ko -->
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
            <div class="bottom_right">
                <!-- ko if: $parent.canEditMember($data) -->
                <div>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                            <!--<span class="small-font">More</span>
                            <span class="caret"></span>-->
                            <i class="icon-tile-options"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <ul>
                                <li><a data-bind="clickAndStop: function () { $parent.resendInvitation($data); }">Resend invitation</a></li>
                                <li><a data-bind="clickAndStop: function () { $parent.cancelInvitation($data); }">Cancel invitation</a></li>
                                <!-- ko if: isMember() -->
                                <li class="dropdown-menu-line">
                                    <hr>
                                </li>
                                <li><a data-bind="clickAndStop: toggleInviteObserver, text: canInviteObserver() ? 'Disable inviting observers' : 'Enable inviting observers'"></a></li>
                                <li><a data-bind="clickAndStop: toggleInviteMember, text: canInviteMember() ? 'Disable inviting members' : 'Enable inviting members'"></a></li>
                                <!-- /ko -->
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="managepeople:LockedOutMeber">
    <div class="tile-cell">
        <div class="tile-people">
            <span class="caption" data-bind="truncate: { text: name, height: 55 }"></span>
            <div class="description" data-bind="truncate: { text: emailAddress, height : 15 }"></div>
            <div class="center_content">
                <span class="center_content_label">Locked out </span><span class="value" data-bind="timeago: lastLockOutAt()"></span>
                <br />
                <span class="center_content_label">Joined </span><span class="value" data-bind="timeago: joinedAt"></span>
            </div>
            <div class="bottom_left">
                <!--<span class="locked_out_info">Locked out</span>-->
                <span class="small-font">Locked</span>
                <br/>
                <span class="small-font" data-bind="text: role().name"></span>
            </div>

            <div class="bottom_right" style="width: 50%">
                <!-- ko ifnot: $parent.executorRole == 2 &&  $data.role().id == 3-->
                <div>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                            <!--<span class="small-font">More</span>
                            <span class="caret"></span>-->
                            <i class="icon-tile-options"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <ul>
                                <li><a data-bind="clickAndStop: unlock ">Unlock</a></li>
                                <li><a data-bind="clickAndStop: function () { $parent.removeMemeber($data); }">Delete</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="managepeople"> <!-- Sub header -->


<!-- Main -->


<!-- Inivite new member dialog -->



<!-- Enabled member tile -->




<!-- Invited member tile -->




<!-- Locked out member tile -->



</script>
<script type="text/html" id="managestorymaps:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Manage story maps and collections',
        description: 'This is an overview of all the story maps of the workspace. You can create, archive or delete story maps. You can also set appropriate permissions for existing story map collaborators or invite new ones. Collections let you organize your story maps into groups.'
        } }"></div>
</script>
<script type="text/html" id="managestorymaps:main-section">
    <div id="main" class="cf" data-bind="winSize: winSize">
        <div class="metro-pivot" data-bind="metroPivot: { tabClass: '.pivot-item-'+startTabIndex, goToTabByDataName: tabToShow, delayedTabHide: true }">
                {{#if startTabIndex == 0 }}
                <div class="pivot-item-0" data-bind="visible: startTabIndex == 0">
                    <h3 data-name="storymaps">Story maps</h3>
                    <div data-bind="template: { name: 'managestorymaps:storymaps-tab-template' }"></div>
                    <track-page params="page: track.ManageStorymaps"></track-page>
                </div>
                <div class="pivot-item-0" data-bind="visible: startTabIndex == 0">
                    <h3 data-name="collections">Collections</h3>
                    <div data-bind="template: { name: 'managestorymaps:collections-tab-template' }"></div>
                    <track-page params="page: track.ManageStorymapCollections"></track-page>
                </div>
                {{/if}}
                {{#if startTabIndex == 1 }}
                <div class="pivot-item-1" data-bind="visible: startTabIndex == 1">
                    <h3 data-name="collections">Collections</h3>
                    <div data-bind="template: { name: 'managestorymaps:collections-tab-template' }"></div>
                    <track-page params="page: track.ManageStorymapCollections"></track-page>
                </div>
                <div class="pivot-item-1" data-bind="visible: startTabIndex == 1">
                    <h3 data-name="storymaps">Story maps</h3>
                    <div data-bind="template: { name: 'managestorymaps:storymaps-tab-template' }"></div>
                    <track-page params="page: track.ManageStorymaps"></track-page>
                </div>
                {{/if}}
        </div>
        
 
    </div>
</script>
<script type="text/html" id="managestorymaps:storymaps-tab-template">
    

        <div class="tile-group-row">

            <!-- Storymaps -->

            <div class="tile-group four-column" data-bind=" css: {'five-column' : isFiveColumn }">

                <!-- Header -->
                <div class="tile-group-header">
                    <div class="tile-group-header-left tile-filter">
                        Show
                        &nbsp;
                        <div class="tile-filter-dropdown-menu" data-bind="dropdownmenu: true">
                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                <span data-bind="text: storymapsTab.storymapFilterName"></span>
                                <span class="caret"></span>
                            </a>
                            <div class="menu-content left-aligned">
                                <ul>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.All); }">all story maps</a></li>
                                    <li class="dropdown-menu-line">
                                        <hr>
                                    </li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.Active); }">active story maps</a></li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.Archived); }">archived story maps</a></li>
                                    <li class="dropdown-menu-line">
                                        <hr>
                                    </li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.Private); }">private story maps</a></li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.PrivateLinkShared); }">story maps shared with private links</a></li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.WorkspaceVisible); }">workspace visible story maps</a></li>
                                    <li><a data-bind="clickAndStop: function () { $root.storymapsTab.applyFilter(viewmodels.managestorymaps.StorymapFilter.Public); }">public story maps</a></li>
                                </ul>
                            </div>
                        </div>

                        <!-- ko if: storymapsTab.hasCollections() -->
                        from
                        &nbsp;
                        <div class="tile-filter-dropdown-menu" data-bind="dropdownmenu: true">
                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                <span class="current-collection-filter-name" data-bind="text: storymapsTab.currentCollectionFilterName"></span>
                                <span class="caret"></span>
                            </a>
                            <div class="menu-content left-aligned filter-collections">
                                <ul>
                                    <li><a data-bind="clickAndStop: function () { storymapsTab.changeCollectionFilter(null); }">everywhere</a></li>
                                    <li class="dropdown-menu-line">
                                        <hr>
                                    </li>
                                    <li class="dropdown-items-heading">
                                        From collection ... 
                                    </li>
                                    <!-- ko foreach: storymapsTab.filterCollections -->
                                    <li><a data-bind="click: function () { $root.storymapsTab.changeCollectionFilter($data); }, text: name, css: { 'dropdown-fixed-item': isFixedItem} "></a></li>
                                    <!-- /ko -->
                                </ul>
                            </div>
                        </div>
                        <span data-bind="visible: storymapsTab.isPostfixInFilterVisible">collection</span>
                        <!-- /ko -->

                    </div>
                    <div class="tile-group-header-right">

                        <div class="pager-wrapper" data-bind="visible: storymapsTab.visibleStorymaps.pageCount() > 1">
                            <div class="tile-pager">
                                <div class="tile-paging-info">
                                    <span data-bind="text: storymapsTab.visibleStorymaps.pagingInfo()"></span>
                                </div>
                                <a class="btn-icon opacitied">
                                    <i class="pager-left" data-bind="click: storymapsTab.visibleStorymaps.movePrevious"></i>
                                </a>
                                <a class="btn-icon opacitied">
                                    <i class="pager-right" data-bind="click: storymapsTab.visibleStorymaps.moveNext"></i>
                                </a>
                            </div>
                        </div>

                        <div class="search-wrapper" data-bind="visible: storymapsTab.isStorymapSearchVisible">
                            <input type="text" data-bind="value: storymapsTab.storymapSearchKeyword, valueUpdate: 'keyup', visible: storymapsTab.isStorymapSearchFieldVisible, hasFocus: storymapsTab.isStorymapSearchFieldFocused" class="search" placeholder="story map's name" />
                            <i class="icon-tile-search" title="Search by storymap name" data-bind="click: storymapsTab.showStorymapSearchField, qtip: { position: 'bottom', delay: 1 }"></i>
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="tile-group-content" id="manage-storymaps-content">
                    <div class="tile-cell">
                        <div class="tile-add" data-bind="go: { url: '/newstorymap' }">
                            <div class="action">
                                <div>
                                    <i class="icon-tile-add-big"></i>
                                    <span class="tile-add-button-text">Add a new story map</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ko foreach: storymapsTab.visibleStorymaps.currentPageData -->
                    <div class="tile-cell">
                        <div class="tile-storymap">
                            <span class="caption pointer" data-bind="style: { 'text-indent': iconCount() * 18 + 'px'  }, truncate: {text: name, height: 40, skipLength: 19 }, go: { url: '/editstorymap/{0}', data: slug }"></span>
                            {{#if isPublic}}
                            <i class="icon-tile-public-storymap" title="Public story map"></i>
                            {{/if}}
                            {{#if isWorkspaceVisible}}
                            <i class="icon-tile-ws-visible-storymap" title="Workspace visible story map"></i>
                            {{/if}}
                            {{#if isSharingWithPrivateLinkEnabled}}
                            <i class="icon-tile-private-link-shared-storymap" title="Shared with a private link"></i>
                            {{/if}}                            
                            
                            <div class="center_content archived_label" data-bind="visible: isArchived()">
                                <div>
                                    <span class="extra-small-font">Archived </span>
                                    <span class="extra-small-font" data-bind="timeago: archivedAt"></span>
                                    <span class="extra-small-font">by</span>
                                    <span class="extra-small-font" data-bind="text: archivedBy"></span>
                                </div>
                            </div>
                            
                            <!-- ko if: !isArchived() -->
                            <div class="center_content">
                                <div class="center_content_label"
                                     style="cursor: pointer"
                                     data-bind="go: { url: '/editstorymap/{0}?collaborators=true', data: slug }">
                                    <span class="extra-small-font" data-bind="text: collaboratorsCount"></span>
                                    <span class="extra-small-font">collaborators</span>
                                </div>
                                <div class="center_content_label" data-bind="visible: hasIntegrations()">
                                    <div>
                                        <span class="extra-small-font" data-bind="text: integrations"></span>
                                        <span class="extra-small-font">integration</span>
                                    </div>
                                </div>

                                <div class="center_content_label" data-bind="if: selectedCollection() != null">
                                    <div class="extra-small-font" data-bind="text: selectedCollection().name() + ' collection' , attr: { title: name }"></div>
                                </div>
                            </div>
                            <!-- /ko -->
                            
                            <div class="tile-bottom-container">
                                <div class="tile-bottom-wrapper">
                                    <!-- ko if: $root.storymapsTab.hasCollections() -->
                                    <div class="bottom_left">
                                        <div class="dropdown-menu collection-dropdown" data-bind="dropdownmenu: { dontCloseOnClick: true }">
                                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                                <span class="small-font">Change collection</span>
                                                <span class="caret"></span>
                                            </a>
                                            <div class="menu-content collection-menu">
                                                <div class="">
                                                    <div class="control">
                                                        <label>
                                                            Select a collection
                                                        </label>

                                                        <select class="collection-select-component" data-bind="options: $root.storymapsTab.collections, optionsText: 'truncatedName', value: selectedCollection, optionsCaption: 'Choose collection...', select: true, event:{ change: selectCollection }" tabindex="2"></select>

                                                        <!-- ko if: $root.storymapsTab.hasRecentlyUsedCollections() -->
                                                        <div class="info-text">or choose the recently selected</div>
                                                        <!-- /ko -->
                                                        <!-- ko foreach: $root.storymapsTab.topRecentlyUsedCollections -->
                                                        <a data-bind="truncate: { text: name, height: 18 }, clickAndStop: function () { $parent.selectRecentCollection($data); }" class="recently-selected-collection"></a>
                                                        <!-- /ko -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /ko -->

                                    <div class="bottom_right">
                                        <div>
                                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                                <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                                    <i class="icon-tile-options"></i>
                                                    <!--<span class="small-font">Options</span>
                        <span class="caret"></span>-->
                                                </a>
                                                <div class="menu-content right-aligned">
                                                    <ul>
                                                        <li><a data-bind="go: { url: '/editstorymap/{0}', data: slug }">Edit</a></li>
                                                        <li><a data-bind="click: toggleArchivedState, text: (isArchived() ? 'Restore from archive' : 'Archive')">Archive</a></li>
                                                        {{#if $root.storymapsTab.isExportOptionVisible }}
                                                        <li>
                                                            <a data-bind="fileDownloadButton: {
                                                        url: exportUrl,
                                                        csrfTokenKey: globalConfig.csrfTokenHeaderKey,
                                                        currentCsrfToken: globalConfig.currentCsrfToken,
                                                        onSuccess: function () { $root.storymapsTab.onSuccessfulExport($data.id) },
                                                        onFail:  function(html, url, failReason) { app.flash.showError(failReason != undefined ? failReason : 'Sorry, something went wrong. Please try again later.'); }
                                                    }">Export</a>
                                                        </li>
                                                        {{/if}}
                                                        {{#if hasIssueTrackerIntegration}}
                                                        <li><a data-bind="click: function () { $root.storymapsTab.removeIssuTrackerIntegration($data) }">Disconnect {{issueTrackerIntegration}}</a></li>
                                                        {{/if}}
                                                        {{#if hasTeamChatIntegration}}
                                                        <li><a data-bind="click: function () { $root.storymapsTab.removeTeamChatIntegration($data) }">Disconnect {{teamChatIntegration}}</a></li>
                                                        {{/if}}
                                                        <li><a data-bind="click: function () { $root.storymapsTab.deleteStoryMap($data) }">Delete</a></li>
                                                        {{#if $root.storymapsTab.canMoveStorymapToOtherWorkspace}}
                                                        <li class="dropdown-menu-line">
                                                            <hr>
                                                        </li>
                                                        <li>
                                                            <a data-bind="modal: {
                                                                        class: 'move-storymap-confirm modal-confirmation',
                                                                        template: 'storymap.move-storymap-confirm',
                                                                        data: $data,
                                                                        trigger: 'both'}">Transfer to other workspace</a>
                                                        </li>
                                                        {{/if}}
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- /ko -->
                </div>
            </div>
        </div>
</script>
<script type="text/html" id="managestorymaps:collections-tab-template">
    
        <div class="tile-group-row">

            <!-- Collections -->

            <div class="tile-group four-column" data-bind=" css: {'five-column' : isFiveColumn }">

                <!-- Header -->
                <div class="tile-group-header">
                    <div class="tile-group-header-left tile-filter">
                    </div>
                    <div class="tile-group-header-right">

                        <div class="pager-wrapper" data-bind="visible: collectionsTab.visibleCollections.pageCount() > 1">
                            <div class="tile-pager">
                                <div class="tile-paging-info">
                                    <span data-bind="text: collectionsTab.visibleCollections.pagingInfo()"></span>
                                </div>
                                <a class="btn-icon opacitied">
                                    <i class="pager-left" data-bind="click: collectionsTab.visibleCollections.movePrevious"></i>
                                </a>
                                <a class="btn-icon opacitied">
                                    <i class="pager-right" data-bind="click: collectionsTab.visibleCollections.moveNext"></i>
                                </a>
                            </div>
                        </div>

                        <div class="search-wrapper" data-bind="visible: collectionsTab.isCollectionSearchVisible">
                            <input type="text" data-bind="value: collectionsTab.collectionSearchKeyword, valueUpdate: 'keyup', visible: collectionsTab.isCollectionSearchFieldVisible, hasFocus: collectionsTab.isCollectionSearchFieldFocused" class="search" placeholder="collection's name" />
                            <i class="icon-tile-search" title="Search by collection name" data-bind="click: collectionsTab.showCollectionSearchField, qtip: { position: 'bottom', delay: 1 }"></i>
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="tile-group-content" id="manage-collections-content">
                    <div class="tile-cell">
                        <div class="tile-add" data-bind="click: $root.collectionsTab.openAddCollectionDialog">
                            <div class="action">
                                <div>
                                    <i class="icon-tile-add-big"></i>
                                    <span class="tile-add-button-text">Add a new collection</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ko foreach: collectionsTab.visibleCollections.currentPageData -->
                    <div class="tile-cell">
                        <div class="tile-storymap collection">
                            <div class="collection-header-bar">
                                <div class="collection-header-bar-content">
                                    collection
                                </div>
                            </div>

                            <a class="caption" data-bind="truncate: {text: name(), height: 70, skipLength: 19}, clickAndStop: function() { $root.collectionsTab.openRenameCollectionDialog($data) }"></a>

                            <div class="bottom_left">
                                <a data-bind="clickAndStop: function() { $root.storymapsTab.showStorymapsOfCollection($data); }">
                                    <span class="h5" data-bind="text: numberOfStorymaps"></span>
                                    <span class="extra-small-font">story maps</span>
                                </a>
                            </div>

                            <div class="bottom_right">
                                <div>
                                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                        <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                            <i class="icon-tile-options"></i>
                                            <!--<span class="small-font">Options</span>
                                            <span class="caret"></span>-->
                                        </a>
                                        <div class="menu-content right-aligned">
                                            <ul>
                                                <li><a data-bind="clickAndStop: function() { $root.storymapsTab.showStorymapsOfCollection($data); }">View story maps</a></li>
                                                <li><a data-bind="clickAndStop: function() { $root.collectionsTab.openAddStorymapsToCollectionDialog($data); }">Add or remove story maps</a></li>
                                                <li class="dropdown-menu-line">
                                                    <hr>
                                                </li>
                                                <li><a data-bind="clickAndStop: function() { $root.collectionsTab.openRenameCollectionDialog($data) }">Rename</a></li>
                                                <li><a data-bind="clickAndStop: function() { $root.collectionsTab.deleteCollection(id) }">Delete</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /ko -->
                </div>
            </div>
        </div>
</script>
<script type="text/html" id="managestorymaps:new-collection">
    <track-page params="page: track.ManageStorymapCollectionsAddNew"></track-page>

    <div class="header">
        Add a new collection
        <a class="btn-icon" data-bind="closeModal: true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    
    <div class="content multiselect-allowed-overflow">
        
        {{#if showCollectionsFeatureNotAvaliable}}
            <div class="subscription-info-hint-in-dialog">
                Story map collections feature is not available in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
            </div>
        {{/if}}
        
        {{#ifnot showCollectionsFeatureNotAvaliable}}
        <div class="control-group">
            <div class="control">
                <label>
                    Collection name
                    <input type="text" id="collection-name" data-bind="value: name, hasFocus: true" tabindex="100">
                </label>
            </div>
            <div class="control">
                <span class="validation-message" data-bind="validationMessage: name"></span>
            </div>
        </div>
        <div class="control-group">
            <div class="control">
                <label>
                    Add storymaps
                    <select multiple="multiple" data-bind="foreach: storymapsGroupedByCollections, selectedOptions: newCollectionSelectedStorymaps, multiselect: { includeSelectAllOption: false, enableClickableOptGroups: true, numberDisplayed: 10, nonSelectedText: 'Select story maps' }">
                        <optgroup data-bind="attr: {label: name}, foreach: storymaps">
                            <option data-bind="attr: {value: id}, text: name"></option>
                        </optgroup>
                    </select>
                </label>
            </div>
        </div>
        
        {{/ifnot}}

    </div>
    <div class="footer">
        {{#ifnot showCollectionsFeatureNotAvaliable}}
        <button class="btn-action-primary" data-bind="debouncedAjaxBtnClick: saveNewCollection" tabindex="101">Save</button>
        {{/ifnot}}
    </div>
</script>
<script type="text/html" id="managestorymaps:add-storymaps-to-collection">

    <div class="header">
        Add storymaps to collection
        <a class="btn-icon" data-bind="closeModal: true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content multiselect-allowed-overflow">

        <div class="description">Add or remove multiple story maps at once from '<span data-bind="text: collection.name()"></span>' collection.</div>

        <div class="control-group">
            <div class="control">
                <label>
                    Story maps
                    <select multiple="multiple" data-bind="foreach: storymapsGroupedByCollections, selectedOptions: collectionSelectedStorymaps, multiselect: { includeSelectAllOption: false, enableClickableOptGroups: true, numberDisplayed: 10, nonSelectedText: 'Select story maps' }">
                        <optgroup data-bind="attr: {label: name}, foreach: storymaps">
                            <option data-bind="attr: {value: id}, text: name"></option>
                        </optgroup>
                    </select>
                </label>
            </div>
        </div>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="debouncedAjaxBtnClick: saveStorymapsOfCollection" tabindex="4">Save</button>
    </div>
</script>
<script type="text/html" id="managestorymaps:rename-collection">
    <div class="header">
        Change collection's name
        <a class="btn-icon" data-bind="closeModal: true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <form data-bind="submit: renameCollection">
            <div class="control-group">
                <div class="control">
                    <label>
                        Enter a new name for your collection
                        <input type="text" data-bind="value: name, hasFocus: true">
                    </label>
                    <span class="validation-message" data-bind="validationMessage: name"></span>
                </div>
            </div>
        </form>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="btnClick: renameCollection">Save</button>
        <button class="btn-action" data-bind="closeModal: true">Cancel</button>
    </div>
</script>
<script type="text/html" id="managestorymaps"> <!-- Sub header -->



<!-- Main -->







<!-- Add new collection dialog -->






</script>
<script type="text/html" id="newstorymap:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Create a new story map',
        description: '',
        goBackByHistory: true
        } }"></div>
</script>
<script type="text/html" id="newstorymap:main-section">
    <div id="main" class="cf">
        <form>
            <fieldset>
                <legend>
                    {{#ifnot hasCollections}} Name and description {{/ifnot}}
                    {{#if hasCollections}} Name, description and collection {{/if}}
                    <span></span>
                </legend>
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Name
                            <input type="text" id="storymap-name" data-bind="value: name, hasFocus: isNameFieldFocused" tabindex="1" maxlength="200">
                        </label>
                        <span class="help-block">Name can't be longer than 200 character.</span>
                    </div>
                    <div class="control w-2-3" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: name"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Description
                            <textarea data-bind="value: description" tabindex="2" maxlength="4000"></textarea>
                        </label>
                        <span class="help-block">Description is optional.</span>
                    </div>
                    <div class="control w-2-3" style="position: relative"></div>
                </div>
                
                {{#if !isAddCollectionFormVisible() }}
                    {{#if isCollectionsFeatureAvaliable }}
                    {{#if hasCollections }}
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Collection
                                <select class="collection-select-component" tabindex="3" data-bind="options: collections, optionsText: 'truncatedName', value: selectedCollection, optionsCaption: 'Choose collection...', select: true"></select>
                            </label>
                            <span class="help-block">Collection is optional. Collections help you organize your story maps. <span data-bind="userRole:'WorkspaceAdmin,SubscriptionAdmin'">Select a collection from the list or click <a href="#" tabindex="4" data-bind="clickOrKey: function() { isAddCollectionFormVisible(true); isCollectionNameFieldFocused(true); }">here</a> to create a new one.</span></span>
                        </div>
                    </div>                
                    {{/if}}
                    {{/if}}
                    {{#if isCollectionsFeatureAvaliable }}
                    {{#ifnot hasCollections }}
                        <div class="control-group" data-bind="userRole:'WorkspaceAdmin,SubscriptionAdmin'">
                            <div class="control">
                                <br/>
                                <span class="inline-feature-onboard">To get a better overview of your story maps you can organize them into collections. Simply click <a href="#"  tabindex="5" data-bind="clickOrKey: function() { isAddCollectionFormVisible(true); isCollectionNameFieldFocused(true); }">here</a> to create your first collection.</span>
                            </div>
                        </div>            
                    {{/ifnot}}
                    {{/if}}
                {{/if}}
                
                {{#if isAddCollectionFormVisible() }}
                <div class="control-group"">
                    <div class="control w-2-3">
                        <label>
                            Name of the new collection
                            <input type="text" data-bind="value: collectionName, hasFocus: isCollectionNameFieldFocused" tabindex="6" maxlength="200">
                        </label>
                        <span class="help-block">Tip: As an administrator you can manage your collections in the 'Manage workspace / Story map collections' menu.</span>
                    </div>
                    <div class="control w-2-3" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: collectionName"></span>
                    </div>
                </div>
                
                <div class="buttons">
                    <a tabindex="7" class="btn-action-primary button" data-bind="clickAndStop: function() { addCollection() }, enterKey: function() { addCollection() }"><span>Save collection</span></a>
                    <a tabindex="8" class="btn-action-primary2 button" data-bind="clickOrKey: function() { isAddCollectionFormVisible(false) }"><span>Cancel</span></a>
                </div>                
                {{/if}}

            </fieldset>

            <fieldset>
                <legend>Collaborators<span></span></legend>
                <span class="legend-description">Add an existing workspace member or send invitation email for new people to become collaborator of this story map</span>
                <br /> <br />
                <a tabindex="9" class="iconized-link-button btn-invite-member" data-bind="clickOrKey: function() { toggleAddWorkspaceMember() }">
                    <i class="icon-invite-member"></i>
                    <span>Add workspace member</span>
                </a>

                {{#if currentUserCanInvite}}
                &nbsp;&nbsp;
                <a tabindex="14" class="iconized-link-button btn-invite-people" data-bind="clickOrKey: function() { toggleInvitePeople() }">
                    <i class="icon-invite-people"></i>
                    <span>Invite new people</span>
                </a>
                {{/if}}

                <div class="add-member-box" data-bind="visible: addWorkspaceMemberIsShowing">
                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Add a workspace member
                                <select tabindex="10" data-bind="options: availableWorkspaceMembers, optionsText: 'name', value: selectedWorkspaceMember, select: true, hasFocus: isAvailableWorkspaceMembersFieldFocused"></select>
                            </label>
                            <span class="validation-message" data-bind="validationMessage: selectedWorkspaceMember"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                as a(n)
                                <select tabindex="11" data-bind="options: rolesForMember, optionsText: 'name', value: selectedRole, select: true"></select>
                            </label>
                        </div>
                        {{#if selectedWorkspaceMemberIsObserver }}
                        <div class="add-workspace-memeber-observer">
                            The selected member is observer on this workspace, so she can only be a viewer of the story map.
                            <!--Click <a>here</a> if you want to upgrade her workspace role to memeber.-->
                        </div>
                        {{/if}}
                    </div>

                    <div class="buttons">
                        <a tabindex="12" class="btn-action-primary button" data-bind="clickOrKey: function() { addWorkspaceMember() }"><span>Add</span></a>
                        <a tabindex="13" class="btn-action-primary2 button" data-bind="clickOrKey: function() { addWorkspaceMemberIsShowing(false); }"><span>Close</span></a>
                    </div>
                </div>

                {{#if currentUserCanInvite}}
                <div class="invite-people-box" data-bind="visible: invitePeopleIsShowing">
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label>
                                Invite new people by email

                                {{#if: isBulkInvitation}}
                                <textarea tabindex="15" data-bind="value: invitationEmails, hasFocus: isInvitationEmailFieldFocused"></textarea>
                                {{/if}}
                                {{#ifnot: isBulkInvitation}}
                                <input tabindex="15" type="text" id="invite-email" data-bind="value: invitationEmail, hasFocus: isInvitationEmailFieldFocused">
                                {{/ifnot}}

                            </label>

                            {{#if: isBulkInvitation}}
                            <span class="validation-message" data-bind="validationMessage: invitationEmails"></span>
                            {{/if}}
                            {{#ifnot: isBulkInvitation}}
                            <span class="validation-message" data-bind="validationMessage: invitationEmail"></span>
                            {{/ifnot}}

                            <span class="help-block">
                                {{#if: isBulkInvitation}}
                                Add multiple e-mail addresses separated by a comma (,).
                                {{/if}}
                                {{#ifnot: isBulkInvitation}}
                                Click here to <a href="#" data-bind="click: toggleBulkInvitation">bulk invite people</a> by adding multiple e-mail addresses.
                                {{/ifnot}}
                            </span>
                        </div>
                        <div class="control w-1-3">
                            <label>
                                as a(n)
                                <select tabindex="16" data-bind="options: rolesForInvite, optionsText: 'name', value: selectedRole, select: true"></select>
                            </label>
                        </div>
                    </div>

                    <div class="buttons">
                        <a tabindex="17" class="btn-action-primary button" data-bind="clickOrKey: function() { invite() }"><span>Invite</span></a>
                        <a tabindex="18" class="btn-action-primary2 button" data-bind="clickOrKey: function() { toggleInvitePeople() }"><span>Close</span></a>
                    </div>
                </div>
                {{/if}}

                <br />

                <div class="tile-group-row">

                    <!-- Storymaps -->
                    <div class="tile-group four-column">

                        <!--Header -->
                        <div class="tile-group-header">
                            <div class="tile-group-header-right">
                                <div data-bind="visible: collaborators.pageCount() == 1">
                                    <br />
                                </div>
                                <div data-bind="visible: collaborators.pageCount() > 1">
                                    <div class="tile-pager">
                                        <div class="tile-paging-info">
                                            <span data-bind="text: collaborators.pagingInfo()"></span>
                                        </div>
                                        <a tabindex="19" class="btn-icon opacitied">
                                            <i class="pager-left" data-bind="clickOrKey: function() { collaborators.movePrevious }"></i>
                                        </a>
                                        <a tabindex="20" class="btn-icon opacitied">
                                            <i class="pager-right" data-bind="clickOrKey: function() { collaborators.moveNext }"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="tile-group-content" data-bind="foreach: collaborators.currentPageData">
                            <div class="tile-cell">
                                <div class="tile-collaborator">
                                    <span class="caption" data-bind="truncate: { text: name, height:71 }"></span>
                                    <br />

                                    <div class="bottom_left">
                                        {{#ifnot: $parent.canEditCollaborator($data) }}
                                        {{#if $data.isObserver }}
                                        <span class="small-font">Observer / Viewer</span>
                                        {{/if}}
                                        {{#ifnot $data.isObserver }}
                                        <span class="small-font" data-bind="text: role().name"></span>
                                        {{/ifnot}}
                                        {{/ifnot}}

                                        {{#if $parent.canEditCollaborator($data) }}
                                        {{#if $data.isObserver }}
                                        <span class="small-font">Observer / Viewer</span>
                                        {{/if}}
                                        {{#ifnot $data.isObserver }}
                                        <div class="dropdown-menu" data-bind="dropdownmenu:true">
                                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                                <span class="small-font" data-bind="text: role().name"></span>
                                                <span class="caret"></span>
                                            </a>
                                            <div class="menu-content left-aligned">
                                                <ul>
                                                    <li class="dropdown-items-heading">
                                                        Change role to ...
                                                    </li>
                                                    <!-- ko foreach: $root.roles -->
                                                    <li><a data-bind="click: function () { $parent.role($data); }, text: name"></a></li>
                                                    <!-- /ko -->
                                                </ul>
                                            </div>
                                        </div>
                                        {{/ifnot}}
                                        {{/if}}
                                    </div>
                                    <div class="bottom_right">
                                        <!-- ko if: $parent.canEditCollaborator($data) -->
                                        <div>
                                            <span class="link" data-bind="ifnot: $data.isInvited, click: function () { $root.removeCollaborator($data); }">Remove</span>
                                            <span class="link" data-bind="if: $data.isInvited, click: function () { $root.removeCollaborator($data); }">Cancel invitation</span>
                                        </div>
                                        <!-- /ko -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="control-group can-comment-cb">
                    <div class="control w-1-1">
                        <label>
                            <input type="checkbox" tabindex="21" data-bind="checkbox: {checked: viewersCanCommentOnCards}" />
                            Enable commenting and discussion for viewer collaborators
                        </label>
                    </div>
                </div>

                {{#if showViewersCanCommentNotAvaliable}}
                <div class="control-group can-comment-cb-hint">
                    <div class="control">
                        <div class="subscription-info-hint">
                            Hint: This feature is not avaliable in the current subscription plan. Please upgrade your subscription plan to use this feature.
                        </div>
                    </div>
                </div>
                {{/if}}

            </fieldset>

            <fieldset>
                <a tabindex="22" class="iconized-link-button" data-bind="if: showAdvancedOptions() == false, clickOrKey: function() { showAdvancedOptions(true); isAdvancedOptionEstimationUnitFieldFocused(true); }">
                    <i class="icon-advanced-settings"></i>
                    <span class="adv-settings">Show advanced settings & options...</span>
                </a>
                <div data-bind="if: showAdvancedOptions() == false" class="adv-settings-description">
                    Edit estimation unit, setup import from Excel file or copy from another story map
                </div>
                
                <div class="advanced-options" data-bind="slideVisible:showAdvancedOptions, slideDuration:100">
                    <label class="">
                        <span class="advanced-options-head">
                            Advanced settings & options
                        </span>
                    </label>
                    <br />

                    <!--  Visibility    -->
                    <div class="control-group">
                        <div class="control w-2-3">
                            <label class="adv-option-no-chk-label">
                                Visibility
                                <select data-bind="options: visibilityOptions, optionsText: 'name', optionsValue: 'value', value: visibility, select: true"></select>
                            </label>
                            <span class="adv-opt-help-block" data-bind="html: visibilityOptionHelp"></span>
                            {{#if workspaceMembersCommentCheckboxVisible }}
                            <label class="adv-option-label after-adv-opt-help-block">
                                <input type="checkbox" data-bind="checkbox:{checked: canWorkspaceMembersComment}" tabindex="1">
                                Enable commenting and discussion for everyone on this workspace
                            </label>
                            {{/if}}

                            {{#if showWorkspaceMembersCanCommentNotAvaliable}}
                            <div class="subscription-info-hint adv-option-hint">
                                Hint: This feature is not avaliable in the current subscription plan. Please upgrade your subscription plan to use this feature.
                            </div>
                            {{/if}}
                        </div>
                    </div>

                    <!-- /Visibility-->

                    <label class="adv-option-no-chk-label">
                        Estimation unit
                        <input tabindex="23" type="text" data-bind="value:advancedOptionEstimationUnit, hasFocus: isAdvancedOptionEstimationUnitFieldFocused" />
                    </label>
                    <span class="adv-opt-help-block">for example: hours, story points, ideal days etc.</span>

                    <label class="adv-option-label">
                        <input type="checkbox" tabindex="24" data-bind="checkbox: {checked: advancedOptionIsImport}" />Create by Import
                    </label>
                    <div class="adv-option">
                        Want to start with some inital data? Import it from an MS Excel (xlsx) file
                    </div>
                    {{#if showExcelImportFeatureNotAvaliable}}
                    <div class="adv-option subscription-info-hint" data-bind="slideVisible:advancedOptionIsImport, slideDuration:100">
                        Hint: Excel import feature not avaliable in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
                    </div>
                    <br />
                    {{/if}}
                    {{#ifnot showExcelImportFeatureNotAvaliable}}
                    <div class="adv-option" data-bind="slideVisible:advancedOptionIsImport, slideDuration:100">
                        Just drop an MS Excel file into this window or
                        <span class="fileUpload">
                            <a tabindex="25">click here</a>
                            <input tabindex="25" id="fileupload" type="file" name="file" data-bind="ajaxupload: {
                            url: '/UploadImportFile',
                            enable:advancedOptionIsImport,
                            onAdd: function(data) { onAddUploadFile(data[0].name); },
                            onSuccess : function(data) { onUploadSuccessResult(data.IsSuccess,data.Id,data.Name, data.Message, data.Model, data.PreviewAvailable); },
                            onFail : function(data) { onUploadFailResult(); },
                        }">
                        </span> to upload it.
                        <br /><br />
                        Download <a tabindex="26" href="/downloadimportsample">this</a> sample XLSX file for easy start.
                        <div class="adv-upl-msg" data-bind="slideVisible:showUploadMessage, text: uploadMessage">
                        </div>
                        <div class="adv-upl-msg" data-bind="if:showUploadPreviewButton">
                            <button tabindex="27" class="btn-action-primary" data-bind="click:openPreviewModal">Preview</button>
                        </div>
                    </div>
                    {{/ifnot}}

                    <label class="adv-option-label">
                        <input type="checkbox" tabindex="28" data-bind="checkbox:{checked: advancedOptionIsCopy}" />Create by Copy
                    </label>
                    <div class="adv-option">
                        Create new story map by copying an existing one
                    </div>
                    <div class="adv-option" data-bind="slideVisible:advancedOptionIsCopy, slideDuration:100">
                        <select tabindex="29" class="adv-option-select" data-bind="options:storymaps, optionsText: 'name', value:advancedOptionCopySelectedStorymap, optionsCaption:'Choose source story map...',select:true"></select>
                    </div>
                </div>

                <a class="adv-option-hide" tabindex="30" data-bind="if: showAdvancedOptionsCloseButton, clickOrKey: function() { showAdvancedOptions(false); }"> hide & reset changes ...</a>
            </fieldset>


            <div class="form-action-buttons">
                <button type="submit" class="btn-action-primary" data-bind="btnClick: saveAndGoToStoryMap, btnClickDisabled: shouldSaveButtonBeDisabled, css: {disabled: shouldSaveButtonBeDisabled}" tabindex="100">Save</button>
                <button type="button" class="btn-action" data-bind="go: { url: '/managestorymaps', goBackByHistory: true }" tabindex="100">Cancel</button>
            </div>
        </form>
    </div>
</script>
<script type="text/html" id="newstorymap"> <!-- Sub header -->



<!-- Main -->

</script>
<script type="text/html" id="pagenotfound"> Page not found.
<br />
<br />
<span data-bind="text: path"></span>
<br />
<br />
<!--<a data-bind="go: { url: '/'}">Go to main</a>-->
<a href="/">Go to main</a></script>
<script type="text/html" id="resourcenotfound"> Resource not found.
<br />
<br />
The requested resource not found.
<br />
<br />
<!--<a data-bind="go: { url: '/'}">Go to main</a>-->
<a href="/">Go to main</a></script>
<script type="text/html" id="storymap"> {{#if isActive}}

<!-- Header -->
<div id="header-wrapper" data-bind="disableContextMenu:true">
    <!-- IE alert -->
    {{#if $root. isIeAlertShow}}
    <div class="ie-alert">
        <div>
            <p>
                For much better performance and experience please consider to use a modern web browser like Chrome, Firefox or Edge. Microsoft also says IE is an obsolete technology.
                You can read more about this  <a target="_blank" href="https://www.theverge.com/2019/2/8/18216767/microsoft-internet-explorer-warning-compatibility-solution">here</a>.
            </p>
            <p>
                <a href="" data-bind="click: $root.closeIeAlert">remind me later</a> |  <a href="" data-bind="click: $root.dismissIeAlert">don't show this message again</a>
            </p>
        </div>
        <a class="btn-close-alert btn-icon" data-bind="click: $root.closeIeAlert "><i class="icon-close-alert"></i></a>
    </div>
    {{/if}}

    {{#template: { name: $root.workAreaIsIncreased() == false || $root.isTemplate ? "storymap.board.header" : "storymap.board.headercompact" } /}}
</div>


<div id="wrapper" data-bind="
     css: $root.board.zoomCssClass, css: {
        'narrowed-by-panel': $root.isNarrowedBySidePanel,
        compact: $root.workAreaIsIncreased(),
        'wrapper-pinned': $root.isTopLevelCardsArePinned() },
        clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) }
     } ,
     disableContextMenu:true,
     showSpinnerWhenOffline: true,
     dragBoardFromBackbone: { targetToScroll: $root.board.targetToScroll  }">

    <!-- Main board area -->
    <div id="main" data-bind="visible: $root.board.showBoard, css: { 'main-pinned': $root.board.boardLevel() == 3 && $root.isTopLevelCardsArePinned() }">
        {{#template: { name: $root.board.boardLevel() == 2 ? 'storymap.board.board2level' : 'storymap.board.board3level', afterRender: afterChangeBoardLevel } /}}
    </div>

    <board-quick-tip params="parentModel: $root"></board-quick-tip>

    {{#if $root.isShowOnlineUsers}}
    <div class="storymap-onlie-users-button" title="Online users" data-bind="css: { presenting: isOnlinePresenting, following: isFollowOthersChanges }, click: toggleShowOnlineCollabDetails, qtip: { position: 'left', delay: 1 }">
        <span data-bind="text: $root.onlineUserCount"></span> &nbsp; <i class="icon-board-online-users"></i>
    </div>
    {{/if}}
    {{#if $root.isShowOnlineCollaborationDetails}}
    <div id="storymap-onlie-users-content">
        <table>
            <thead>
                <tr><th colspan="3">Online users</th>
            </thead>
            <tbody data-bind="foreach: onlineUsers">
                <tr>
                    <td>
                        {{#if isOnlinePresenting}}
                        <i title="Presenting" data-bind="qtip: { position: 'left', classes:'qtip-tipsy qtip-sob-board'  }, css: { currently-presenting: isMeOnlinePresenting, currently-following: isFollowedByMe }" class="icon-board-user-online-presenting"></i>
                        {{/if}}
                        {{#if isFollowingMe}}
                        <i title="Following you" data-bind="qtip: { position: 'left', classes:'qtip-tipsy qtip-sob-board'  }" class="icon-board-user-online-following"></i>
                        {{/if}}
                    </td>
                    <td data-bind="text: fullName"></td>
                    <td data-bind="if: isShowFollowLink">
                        <a data-bind="ifnot: isFollowedByMe, click: toggleFollowing">follow</a>
                        <a data-bind="if: isFollowedByMe, click: toggleFollowing">unfollow</a>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="button-panel cf">
            {{#ifnot $root.isOnlinePresenting}}
            <button class="btn btn-action-primary" data-bind="click: function() { $root.toggleOnlinePresenting(); }">Start presentation</button>
            {{/ifnot}}
            {{#if $root.isOnlinePresenting}}
            <button class="btn btn-action-primary" data-bind="click: function() { $root.toggleOnlinePresenting(); }">Stop presentation</button>
            {{/if}}
        </div>

        <a class="close-details-link" data-bind="click: $root.toggleShowOnlineCollabDetails">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    {{/if}}
</div>

<!-- Persona left panel -->
<div id="persona-panel" data-bind="css: { 'persona-panel-top-on-increased': $root.workAreaIsIncreased()  }">
    {{#if $root.board.isPersonaPanelOpened}} <!-- Template binding kltsges, csak akkor bindoljunk brmilyen template-et ha ltszik is a felleten. -->
    <!-- ko template: { name: 'storymap.slidingpanels.persona', data: $root.personaPanel } --><!-- /ko -->
    {{/if}}
</div>

<!-- Board activities left panel -->
<sliding-panel params="{
            title: 'Activity feed',
            elementId: 'board-activities-panel',
            isFullSize: $root.workAreaIsIncreased,
            isOpened: $root.isBoardActivitiesPanelOpened,
            onClose: $root.closeBoardActivities
    }" data-bind="css: { 'board-activities-panel-top-on-increased': $root.workAreaIsIncreased()">
    <!-- ko template: { name: 'storymap.slidingpanels.board-activities', data: $root } --><!-- /ko -->
</sliding-panel>

<!-- Search and filter left panel -->
<div id="search-and-filter-panel" data-bind="css: { 'search-and-filter-panel-top-on-increased': $root.workAreaIsIncreased()  }">
    {{#if $root.isSearchAndFilterPanelOpened}}
    <!-- ko template: { name: 'storymap.slidingpanels.search-and-filter', data: $root.searchAndFilterPanel } --><!-- /ko -->
    {{/if}}
</div>

<about-board params="
    storymapId: $root.storymapId,
    storymapSlug: $root.storymapSlug,
    isOpened: $root.isAboutBoardPanelOpened,
    isOpenedAutomatically: $root.isAboutBoardPanelOpenedAutomatically,
    onDismissAutoOpen: $root.disableAutomaticallyAboutBoardPanelOpen.bind($root),
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeAboutBoard.bind($root),
    colorMappings: $root.colorMappings,
    annotations: $root.annotations">
</about-board>

<annotation-panel params="
    isOpened: $root.isAnnotationPanelOpened,
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeAnnotationPanel.bind($root),
    isEditEnabled: $root.currentUserIsEditor">
</annotation-panel>

<idea-panel params="
    isOpened: $root.isIdeaPanelOpened,
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeIdeaPanel.bind($root)">
</idea-panel>

{{#if $root.currentUserIsAdmin()}}
<user-story-templates params="
    isOpened: $root.isStoryTemplatesPanelOpened,
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeStoryTemplatesPanel.bind($root)">
</user-story-templates>
{{/if}}

<discussion-panel params="
    isOpened: $root.isDiscussionPanelOpened,
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeDiscussionPanel.bind($root)">

</discussion-panel>

<storymap-user-notification-panel params="
    isOpened: $root.isNotificationPanelOpened,
    isFullSize: $root.workAreaIsIncreased,
    onClose: $root.closeNotificationPanel.bind($root)">
</storymap-user-notification-panel>

<multi-selection-panel params="
    isFullSize: $root.workAreaIsIncreased,
    parentModel: $root">
</multi-selection-panel>

<notification-settings params="
    shouldHideSlack: $root.isPublicMapViewer || $root.isPrivateLinkSharedAccess">
</notification-settings>

<delete-storymap></delete-storymap>

<move-storymap></move-storymap>

<workflow-settings></workflow-settings>
{{/if}}
</script>
<script type="text/html" id="templates:sub-header">
    <div id="sub-header">
        <div class="sub-header-btn">
            <a href="{{$data.url || '/'}}" data-bind="go: { url: $data.url || '/', goBackByHistory: (($data.goBackByHistory !== undefined) ? $data.goBackByHistory : false) }">
                <i class="icon-subheader-nav-back"></i>
            </a>
        </div>
        <div class="sub-header-title" data-bind="text:title"></div>
        <div class="sub-header-description" data-bind="text:description"></div>
    </div>
</script>
<script type="text/html" id="templates:coloreditor">
    <div class="color-editor" data-bind="visible: isColorEditorOpen, hasFocus: isColorEditorOpen(), event: { blur: function(data, event) { if (!$root.isColorEditorInEditMode() && !$root.hasNotUserDefinedColorMappings()) { $root.closeColorEditor(event); } } }" tabindex="-1">
        <div class="color-rows" data-bind="visible: $root.isColorEditorInEditMode() || !hasNotUserDefinedColorMappings(), css: { colorInEditMode: $root.isColorEditorInEditMode }">

            <div data-bind="visible: $root.isColorEditorInEditMode()" class="color-editor-help-in-editmode-head">
                <i class="icon-back-in-dropdown" data-bind="clickAndStop: function() { $root.isColorEditorInEditMode(false); }"></i> Choose colors & set labels
            </div>
            <div data-bind="visible: $root.isColorEditorInEditMode() == false && hasArrow == false" class="color-editor-help-in-editmode-head">
                Change color
            </div>
            {{#foreach: colorMappings}}
            <div class="color-row" data-bind="visible: ($root.isColorEditorInEditMode() && !isDefault) || (isEnabled() && !$root.isColorEditorInEditMode()), click: function() { $root.colorBoxSelected(color()); }">
                <div data-bind="css: colorClass">
                    <div class="color-box-checkmark" data-bind="visible: $root.isColorEditorInEditMode() && isEnabled() && !isDefault"></div>
                </div>
                <span class="color-label" data-bind="inlineTextArea: {
                                                    value: colorLabel,
                                                    trigger: 'triggerClick',
                                                    triggerElement: '.edit-color-link',
                                                    type: 'input',
                                                    inputClass: 'color-label-input',
                                                    emptyText: colorLabel(),
                                                    emptyClass: 'color-label-text-empty',
                                                    editOnClick: true,
                                                    endEditOnEnterKey: true,
                                                    onEndEdit: function(event) { $root.updateColorLabel(color()); },
                                                    width: '150px',
                                                    selectTextOnFocus: true,
                                                    autoresize: false,
                                                    unitString: '',
                                                    numbersOnly: false,
                                                    maxlength: 27 }">
                </span>
                <div class="transparent-color-info" data-bind="visible: $root.isColorEditorInEditMode() && isTransparentAnnotation" data-tip="Transparent cards are for adding notes & placeholders to the board">
                    <i class="icon-info-circle" aria-hidden="true"></i>
                </div>
                <a class="edit-color-link" data-bind="visible: $root.isColorEditorInEditMode() && isEnabled() && !isDefault && !isTransparentAnnotation">edit</a>
            </div>
            {{/foreach}}
            {{#if $root.isColorEditorInEditMode() }}
            <div class="color-editor-actions">
                <a data-bind="click: function() { setAllColorBoxCheckStateTo(true); }">select all</a> &nbsp;<span class="color-editor-actions-separator">|</span>&nbsp; <a data-bind="click: function() { setAllColorBoxCheckStateTo(false); }">unselect all</a>
            </div>
            {{/endif}}
        </div>

        <div class="color-editor-help color-rows" data-bind="visible: !$root.isColorEditorInEditMode() && hasNotUserDefinedColorMappings()">
            <div data-bind="visible: !$root.isColorEditorInEditMode()" class="color-editor-help-in-editmode-head">
                Change color
            </div>
            <span class="help-text">
                You don't have any card colors defined yet.
                <br /><br />
                Please click <a data-bind="click: $root.startColorEdit">here</a> to setup your card colors and labels.
            </span>
        </div>

        <a class="customize-color-editor-link" data-bind="click: $root.startColorEdit, visible: !$root.isColorEditorInEditMode() && !hasNotUserDefinedColorMappings()">customize colors</a>
        <a class="close-color-editor-link" data-bind="click: $root.closeColorEditor">
            <i class="icon-close-dropdown"></i>
        </a>
    </div>
</script>
<script type="text/html" id="templates:coloreditor-for-board">
    <div class="color-editor color-editor-for-board" tabindex="-1">
        <div class="color-rows" data-bind="visible: $root.isColorEditorInEditMode() || !$root.hasNotUserDefinedColorMappings(), css: { colorInEditMode: $root.isColorEditorInEditMode }">

            <div data-bind="visible: $root.isColorEditorInEditMode()" class="color-editor-help-in-editmode-head">
                <i class="icon-back-in-dropdown" data-bind="click: function() { $root.isColorEditorInEditMode(false); }"></i> Choose colors & set labels
            </div>
            <div data-bind="visible: $root.isColorEditorInEditMode() == false && $root.hasArrow == false" class="color-editor-help-in-editmode-head">
                Change color
            </div>
            {{#foreach: $root.colorMappings}}
            <div class="color-row" data-bind="visible: ($root.isColorEditorInEditMode() && !isDefault) || (isEnabled() && !$root.isColorEditorInEditMode()), clickAndStop: function() { $root.colorBoxSelected(color()); }, clickCloseTemplatedContextmenu: { ifnot: $root.isColorEditorInEditMode }">
                <div data-bind="css: colorClass">
                    <div class="color-box-checkmark" data-bind="visible: $root.isColorEditorInEditMode() && isEnabled() && !isDefault"></div>
                </div>
                <span class="color-label" data-bind="inlineTextArea: {
                                                    value: colorLabel,
                                                    trigger: 'triggerClick',
                                                    triggerElement: '.edit-color-link',
                                                    type: 'input',
                                                    inputClass: 'color-label-input',
                                                    emptyText: colorLabel(),
                                                    emptyClass: 'color-label-text-empty',
                                                    editOnClick: true,
                                                    endEditOnEnterKey: true,
                                                    onEndEdit: function(event) { $root.updateColorLabel(color()); },
                                                    width: '150px',
                                                    selectTextOnFocus: true,
                                                    autoresize: false,
                                                    unitString: '',
                                                    numbersOnly: false,
                                                    maxlength: 27 }">
                </span>
                <div class="transparent-color-info" data-bind="visible: $root.isColorEditorInEditMode() && isTransparentAnnotation" data-tip="Transparent cards are for adding notes & placeholders to the board">
                    <i class="icon-info-circle" aria-hidden="true"></i>
                </div>
                <a class="edit-color-link" data-bind="visible: $root.isColorEditorInEditMode() && isEnabled() && !isDefault && !isTransparentAnnotation">edit</a>
            </div>
            {{/foreach}}
            {{#if $root.isColorEditorInEditMode() }}
            <div class="color-editor-actions">
                <a data-bind="click: function() { $root.setAllColorBoxCheckStateTo(true); }">select all</a> &nbsp;<span class="color-editor-actions-separator">|</span>&nbsp; <a data-bind="click: function() { $root.setAllColorBoxCheckStateTo(false); }">unselect all</a>
            </div>
            {{/endif}}
        </div>
        
        
        <!-- No color selected -->
        

        <div class="color-editor-help color-rows" data-bind="visible: !$root.isColorEditorInEditMode() && $root.hasNotUserDefinedColorMappings()">
            <div data-bind="visible: !$root.isColorEditorInEditMode()" class="color-editor-help-in-editmode-head">
                Change color
            </div>
            <span class="help-text">
                You don't have any card colors defined yet.
                <br /><br />
                Please click <a data-bind="click: $root.startColorEdit">here</a> to setup your card colors and labels.
            </span>
        </div>
        <a class="customize-color-editor-link" data-bind="click: $root.startColorEdit, visible: !$root.isColorEditorInEditMode() && !$root.hasNotUserDefinedColorMappings()">customize colors</a>
        <a class="close-color-editor-link" data-bind="click: $root.closeColorEditor, clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">
            <i class="icon-close-dropdown"></i>
        </a>
    </div>
</script>
<script type="text/html" id="templates:trial-alert">
    {{#if globalConfig.isShowTrialPeriodIsExpired == 'True' && globalConfig.trialAlertIsClosed() === false }}
    <div class="trial-expired-alert">
        <p class="tiral-header">Free Trial Expired!</p>
        <div>
            <p>
                Story maps in this workspace have been set to read-only because its free trial expired {{globalConfig.trialPeriodExpiredDays}} day(s) ago. Please upgrade to a paid plan to continue working on this workspace.
            </p>
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                <button class="btn btn-action-primary" data-bind="go: { url: '/upgrade' }">Upgrade</button>
            </p>
            <p>
                If you need more time for trying out StoriesOnBoard, please contact us using the <a href="" data-bind="click: $root.onSupportClick">chat</a>
                or in email at <a href="mailto:sales@storiesonboard.com">sales@storiesonboard.com</a>. <strong>We'd be happy to extend your trial.</strong>
            </p>
            {{/if}}
            {{#ifnot globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                Please ask an administrator to upgrade subscription for this workspace.
            </p>
            {{/ifnot}}
        </div>
        <a class="btn-close-alert btn-icon" data-bind="click: function() { globalConfig.trialAlertIsClosed(true); } ">
            <i class="icon-close-alert"></i>
        </a>
    </div>
    {{/if}}

    {{#if globalConfig.isShowSubcriptionIsSuspended == 'True' && globalConfig.suspendAlertIsClosed() === false }}
    <div class="trial-expired-alert">
        <p class="tiral-header">Subscription is suspended!</p>
        <div>
            <p>
                This workspace has been suspended on {{globalConfig.suspendedAt}} You can activate this workspace by purchasing a new subscription. Have a question? Contact us using the support widget or at support@storiesonboard.oom
            </p>
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                <button class="btn btn-action-primary" data-bind="go: { url: '/upgrade' }">Purchase subscription</button>
            </p>
            {{/if}}
            {{#ifnot globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                Please ask an administrator to purchase subscription for this workspace.
            </p>
            {{/ifnot}}
        </div>
        <a class="btn-close-alert btn-icon" data-bind="click: function() { globalConfig.suspendAlertIsClosed(true); } ">
            <i class="icon-close-alert"></i>
        </a>
    </div>
    {{/if}}

    {{#if globalConfig.isShowTrialPeriodExpireSoon == 'True' && globalConfig.trialAlertIsClosed() === false }}
    <div class="trial-expired-alert">
        <p>
            Your free trial expires in {{globalConfig.trialPeriodExpireSoonDays}} day(s).
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}
            Click <a style="color:white; text-decoration: underline" data-bind="go: { url: '/upgrade' }">here</a> to upgrade.
            Have a question? Contact us using the <a href="" style="color:white; text-decoration: underline" data-bind="click: $root.onSupportClick">chat</a>
            or in email at <a style="color: white; text-decoration: underline" href="mailto:sales@storiesonboard.com ">sales@storiesonboard.com</a>
            {{/if}}
            {{#ifnot globalConfig.userRoles === "SubscriptionAdmin"}}
            Please ask an administrator to upgrade. Have a question? Contact us using the <a href="" style="color:white; text-decoration: underline" data-bind="click: $root.onSupportClick">chat</a>
            or in email at <a style="color: white" href="mailto:info@storiesonboard.com ">sales@storiesonboard.com</a>
            {{/ifnot}}
        </p>
        <a class="btn-close-alert btn-icon" data-bind="click: function() { globalConfig.trialAlertIsClosed(true); } ">
            <i class="icon-close-alert"></i>
        </a>
    </div>
    <!--<div class="trial-expired-alert">
        {{#if globalConfig.trialPeriodExpireSoonDays == 0}}
            <p class="tiral-header">Your free trial period ends today!</p>
        {{/if}}
        {{#if globalConfig.trialPeriodExpireSoonDays > 0}}
            <p class="tiral-header">You have {{globalConfig.trialPeriodExpireSoonDays}} day(s) left from your free trial!</p>
        {{/if}}
        <div>
            <p>
                Story maps in this workspace will be set to read-only when the free trial expires. Please upgrade to a paid plan to continue working on this workspace.
            </p>
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                <button class="btn btn-action-primary" data-bind="go: { url: '/upgrade' }">Upgrade</button>
            </p>
            <p>
                If you need more time for trying out StoriesOnBoard, please let us known at <a href="mailto:sales@storiesonboard.com">sales@storiesonboard.com</a>. <strong>We'd be happy to extend your trial.</strong>
            </p>
            {{/if}}
            {{#ifnot globalConfig.userRoles === "SubscriptionAdmin"}}
            <p>
                Please ask an administrator to upgrade subscription for this workspace.
            </p>
            {{/ifnot}}
        </div>
        <a class="btn-close-alert btn-icon" data-bind="click: function() { globalConfig.trialAlertIsClosed(true); } ">
            <i class="icon-close-dialog"></i>
        </a>
    </div>-->
    {{/if}}
</script>
<script type="text/html" id="templates:limits-exceed-alert">
     {{#if globalConfig.subscriptionLimitsAreExceed == 'True' && globalConfig.subscriptionLimitsAreExceedAlertIsClosed() === false }}
    <div class="trial-expired-alert">
        <p>
            Your workspace exceeds the limits of the current subscription plan! 
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}Please upgrade your subscription.{{/if}}
            {{#ifnot globalConfig.userRoles === "SubscriptionAdmin"}}Please ask an administrator to upgrade the subscription for this workspace.{{/ifnot}}
            {{#if globalConfig.userRoles === "SubscriptionAdmin"}}Click <a data-bind="go: { url: '/workspacesettings?p=billing' }">here</a> to upgrade now.{{/if}}
        </p>
        <a class="btn-close-alert btn-icon" data-bind="click: function() { globalConfig.subscriptionLimitsAreExceedAlertIsClosed(true); } ">
            <i class="icon-close-alert"></i>
        </a>
    </div>
    {{/if}}
</script>
<script type="text/html" id="templates:email-confirmation-alert">
    {{#ifnot isUserEmailConfirmed }}
    <div class="dashboard-alert">
        <p>
            Please confirm your email address by clicking the link in your registration email. If you haven't received the email please click <a data-bind="click: resendConfirmationEmail">here</a> to resend it.
        </p>
    </div>
    {{/ifnot}}
</script>
<script type="text/html" id="templates"> <!-- Subheader template -->


<!--Color editor template-->




<!--Color editor for board template-->



<!-- Trial expired -->






</script>
<script type="text/html" id="upgradeplan:header-title-section">
    <a class="brand" data-bind="text: workspaceName, redirect:globalConfig.appUrl"></a>&nbsp;
    <span class="brand-subtext">workspace on StoriesOnBoard</span>
</script>
<script type="text/html" id="upgradeplan:header-menu-section">

</script>
<script type="text/html" id="upgradeplan:main-section">
<div id="main">
<div id="upgrade-main">

{{#if wizardStep() === 1}}
<div class="upgrade-head">
    Purchase workspace subscription
    
    <track-page params="page: track.UpgradeSubscription"></track-page>
 
</div>
{{#ifnot hasCardPayableCustomPlan}}
<div class="current-plan-wrapper">
    <div class="current-plan-details">
        <div class="current-plan-sub2">
            Your workspace currently contains <b>{{members}} editor(s)</b>{{#ifnot usingFeatureAddOns}}.{{featureAddOns}}{{/ifnot}}
            {{#if usingFeatureAddOns}} and using the following features(s): <b>{{featureAddOns}}</b>.{{/if}}
        </div>
    </div>
</div>
<div class="current-workspace">
    <div class="faq-head">
        Please choose from the plans below and select the number of editors.
    </div>
    <br />
    <div class="data-section-info">
        All plans include <b>unlimited story maps</b> and <b>unlimited viewers</b>. You can change or cancel your subscription anytime.
        {{#if hasExceedPlan}}
        If you want to subscribe to a smaller plan please
        {{#if hasExceedMembersCount}}<a data-bind="go: { url: '/managepeople' }">manage</a> your workspace members{{/if}}
        <span data-bind="if: shouldShowCommaInExceedMessage">,</span>
        {{#if hasExceedStorymapsCount}}remove unnecessary features{{/if}}
        <span data-bind="if: shouldShowAndInExceedMessage">and</span>
        {{#if hasJiraIntegration}}<a data-bind="go: { url: '/integrationsettings' }">disconnect</a> Jira server{{/if}}.
        {{/if}}
    </div>
</div>
{{/ifnot}}
<br />
<br />
{{#ifnot hasCardPayableCustomPlan}}
<div class="subscription-switch-plan-groups">
    {{#ifnot showAnnualPlan}}
    <div>Switch to <a data-bind="click: function() { $root.showAnnualPlan(true); }">annual plans</a> to get <span class="subscription-plan-discount-text">20%</span> discount</div>
    {{/ifnot}}
    {{#if showAnnualPlan}}
    <div>Switch to <a data-bind="click: function() { $root.showAnnualPlan(false); }">monthly plans</a></div>
    {{/if}}
</div>
<br />
{{/ifnot}}

<!-- Pricing Table Section -->
{{#ifnot showAnnualPlan}}
<div class="subscription-plan-box-list cf" data-bind="foreach: $root.monthlyPlans">
    {{#ifnot isContactUsPlan}}
    <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
        {{#if isCustomCardPayable}}
        <div class="subscription-plan-box-custom-card">
            {{#if isRecurring}}
            Customized plan
            {{/if}}
            {{#ifnot isRecurring}}
            Customized plan
            {{/ifnot}}
        </div>
        {{/if}}
        <div class="subscription-plan-box-name">{{planName}}</div>
        <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
            {{#ifnot isCustomCardPayable}}
            {{{description}}}
            {{/ifnot}}
            {{#if isCustomCardPayable}}
            {{#if isExpires}}
            <br/><br/>
            expires {{expiresAt}}
            {{/if}}
            {{#ifnot isExpires}}
            <br/><br/>
            never expires
            {{/ifnot}}
            {{/if}}
        </div>
        {{#ifnot isCustomCardPayable}}
        <div class="subscription-plan-box-editor-price-more-info" data-bind="equalHeight: '.subscription-plan-box-editor-price-more-info'">
            <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
            <a target="_blank" href="{{$root.pricingPageUrl}}">Learn more</a>
        </div>
        {{/ifnot}}
        <div class="subscription-plan-box-price" data-bind="visible: !isInsufficient">

            {{#if avaliableEditorCounts.length > 1}}
            <select data-bind="options: avaliableEditorCounts, optionsText: 'text', optionsAfterRender: disableUnavailableEditorCount, value: selected"></select>
            {{/if}}
            {{#if avaliableEditorCounts.length < 2}}
            <div class="subscription-plan-box-price-sum-per-month">{{firstEditorCountItemValue()}}</div>
            {{/if}}

            <div class="subscription-plan-box-price-sum">{{currentPrice}}</div>
            <div class="subscription-plan-box-price-sum-per-month">per month</div>
                                            
        </div>
        <div class="subscription-plan-box-button-container" data-bind="visible: !isInsufficient">
            <div class="subscription-plan-box-price-button">
                <button data-bind="visible: !isInsufficient,  css: { disabled: isInsufficient }, click: function() { $data.choosePlan($data.planId); }" class="btn btn-action-primary">Choose</button>
            </div>
        </div>
        <div class="subscription-plan-box-price" data-bind="visible: isInsufficient, css: { 'insufficient' : isInsufficient }">
            <span data-bind="visible: isInsufficient">
                Some <a data-bind="qtip: {contentId: '.unavailable-features', classes: 'unavailable-features-tooltip qtip-tipsy qtip-sob'}">features you're currently using <i class="icon-info-circle" aria-hidden="true"></i></a> are not available in this plan. Consider disabling them to make this plan available.

                <div class="unavailable-features">
                    <strong>Currently used features from higher plan(s)</strong>
                    <ul data-bind="foreach: unavailableFeatures">
                        <li>{{$data}}</li>
                    </ul>
                    <div class="contact-info">For more information please read our FAQ below or contact us with the support widget or at support@storiesonboard.com</div>
                </div>
            </span>
        </div>
    </div>
    {{/ifnot}}
    {{#if isContactUsPlan}}
    <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
        <div class="subscription-plan-box-name">{{planName}}</div>
        <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
            {{{description}}}
        </div>
        <div class="subscription-plan-box-for-contact-us">
            <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
        </div>
        <div class="subscription-plan-box-button-container" >
            <div class="subscription-plan-box-price-button">
                <button data-bind="click: $root.onSupportClick" class="btn btn-action-primary">Contact Us</button>
            </div>
        </div>
    </div>
    {{/if}}
</div>
{{/ifnot}}
{{#if showAnnualPlan}}
<div class="subscription-plan-box-list cf" data-bind="foreach: $root.annualPlans">
    {{#ifnot isContactUsPlan}}
    <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
        {{#if isCustomCardPayable}}
        <div class="subscription-plan-box-custom-card">
            {{#if isRecurring}}
            Customized plan
            {{/if}}
            {{#ifnot isRecurring}}
            Customized plan
            {{/ifnot}}
        </div>
        {{/if}}
        <div class="subscription-plan-box-name">{{planName}}</div>
        <div class="subscription-plan-box-editor-price"  data-bind="equalHeight: 'subscription-plan-box-editor-price'">
            {{#ifnot isCustomCardPayable}}
            {{{description}}}
            {{/ifnot}}
            {{#if isCustomCardPayable}}
            {{#if isExpires}}
            <div>
                <br/><br/>
                expires {{expiresAt}}
            </div>
            {{/if}}
            {{#ifnot isExpires}}
            <div>
                <br/><br/>
                never expires
            </div>
            {{/ifnot}}
            {{/if}}
        </div>
        {{#ifnot isCustomCardPayable}}
        <div class="subscription-plan-box-editor-price-more-info" data-bind="equalHeight: '.subscription-plan-box-editor-price-more-info'">
            <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
            <a target="_blank" href="{{$root.pricingPageUrl}}">Learn more</a>
        </div>
        {{/ifnot}}
        <div class="subscription-plan-box-price" data-bind="visible: !isInsufficient">
                        
            {{#if avaliableEditorCounts.length > 1}}
            <select data-bind="options: avaliableEditorCounts, optionsText: 'text', optionsAfterRender: disableUnavailableEditorCount, value: selected"></select>
            {{/if}}
            {{#if avaliableEditorCounts.length < 2}}
            <div class="subscription-plan-box-price-sum-per-month">{{firstEditorCountItemValue()}}</div>
            {{/if}}

            <div class="subscription-plan-box-price-sum">{{currentPrice}}</div>
            <div class="subscription-plan-box-price-sum-per-month">per year</div>

        </div>
        <div class="subscription-plan-box-button-container" data-bind="visible: !isInsufficient">
            <div class="subscription-plan-box-price-button">
                <button data-bind="visible: !isInsufficient,  css: { disabled: isInsufficient }, click: function() { $data.choosePlan($data.planId); }" class="btn btn-action-primary">Choose</button>
            </div>
        </div>
        <div class="subscription-plan-box-price" data-bind="visible: isInsufficient, css: { 'insufficient' : isInsufficient }">
            <span data-bind="visible: isInsufficient">
                Some <a data-bind="qtip: {contentId: '.unavailable-features', classes: 'unavailable-features-tooltip qtip-tipsy qtip-sob'}">features you're currently using <i class="icon-info-circle" aria-hidden="true"></i></a> are not available in this plan. Consider disabling them to make this plan available.

                <div class="unavailable-features">
                    <strong>Currently used features from higher plan(s)</strong>
                    <ul data-bind="foreach: unavailableFeatures">
                        <li>{{$data}}</li>
                    </ul>
                    <div class="contact-info">For more information please read our FAQ below or contact us with the support widget or at support@storiesonboard.com</div>
                </div>
            </span>
        </div>
    </div>
    {{/ifnot}}
    {{#if isContactUsPlan}}
    <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
        <div class="subscription-plan-box-name">{{planName}}</div>
        <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
            {{{description}}}
        </div>
        <div class="subscription-plan-box-for-contact-us">
            <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
        </div>
        <div class="subscription-plan-box-button-container">
            <div class="subscription-plan-box-price-button">
                <button data-bind="click: $root.onSupportClick" class="btn btn-action-primary">Contact Us</button>
            </div>
        </div>
    </div>
    {{/if}}
</div>
{{/if}}           

<br />
<br />

<div class="faq-head">Frequently Asked Questions</div>
<br />
<div class="faqs">
    <label class="faq" for="faq1">What does the term editor mean? How is the number of editors are calculated in a subscription?</label><input id="faq1" type="checkbox">
    <p class="three">An editor is a user account in a given workspace whos role is member, admin or subscription admin in the workspace. All members of the workspace with these roles are counted as editors against your subscription plan. Editors in a workspace can have admin, members or viewer roles on the story maps in the workspace.</p>

    <label class="faq" for="faq2">What does it mean that a subscription can have unlimited number of observers?</label><input id="faq2" type="checkbox">
    <p class="three">An observer is a user account in a workspace whos role is observer. Observers in a workspace can only have viewer role on the story maps in the workspace. Viewers can access any contents of a story map and comment on the cards, but they cant add or modify any content on the map.</p>

    <label class="faq" for="faq3">How are accounts on paid plans billed?</label><input id="faq3" type="checkbox">
    <p class="three">Once you have upgraded to a paid plan from a trial account your billing period will begin immediately and your credit card will be charged for the first period. Each subsequent period after the first you will be charged the rate of the selected plan.</p>

    <label class="faq" for="faq4">How can I get a receipt for charges from StoriesOnBoard?</label><input id="faq4" type="checkbox">
    <p class="two">Subscription admin(s) will get a receipt in e-mail when a charge is made on the credit card. They can also download the receipts from workspace / Manage / Manage workspace menu / Plan and Billing tab.</p>

    <label class="faq" for="faq5">Can my company pay by Purchase Order or receive invoices?</label><input id="faq5" type="checkbox">
    <p class="two">Currently our billing is entirely paperless and requires a credit card, either personal or corporate. Please contact us if you need other options.</p>

    <label class="faq" for="faq7">Which forms of payment do you accept?</label><input id="faq7" type="checkbox">
    <p class="two">We accept payments with major credit cards, including Visa, MasterCard, Maestro, Discover, AMEX.</p>
    <br/>
    <p class="two">For more questions and answers please see our <a target="_blank" href="http://docs.storiesonboard.com/subscription-pricing-billing">Subscription, pricing, billing knowledge base articles</a>.</p>

</div>
<br />
<br />
{{/if}}
{{#if wizardStep() === 2}}
<div class="upgrade-head">
    Purchase workspace plan
    
    <track-page params="page: track.UpgradeSubscriptionPaymentForm"></track-page>
</div>
<div class="current-plan-wrapper cf">
    <div class="cf pull-child-left">
        <div class="current-plan-box">
            <div class="current-plan">
                <span class="current-plan-label">Selected plan</span>
                <br />
                <b>"{{selectedPlanName}}" plan with {{selectedEditorCount}} editors</b>
            </div>
            {{#if hasSelectedPlan}}
            <!--<div class="current-plan-sub">
                for ${{selectedPlan().cyclePriceAsString}} per editor / {{#ifnot selectedPlan().isAnnual}}month{{/ifnot}}{{#if selectedPlan().isAnnual}}year{{/if}}
            </div>-->
            <div class="current-plan-sub">
                for {{selectedPlan().currentPrice}} per / {{#ifnot selectedPlan().isAnnual}}month{{/ifnot}}{{#if selectedPlan().isAnnual}}year{{/if}}
            </div>
            {{/if}}
                    </div>
                    <div class="current-plan-change">
                        <a data-bind="click: prevStep">change plan & number of editors</a>
                    </div>
                </div>

                <div class="current-plan-details">
                    {{#if hasSelectedPlan}}
                    <div class="current-plan-sub2">
                        With the selected <a target="_blank" href="{{$root.pricingPageUrl}}">subscription plan</a> and number of editors you will be charged for <b>{{selectedPrice}}</b> in each billing period.
                    </div>
                    {{/if}}
                </div>
                <div class="current-plan-vat-info">
                    Prices are in USD and may be subject to VAT (Value Added Tax), depending on where are you located.
                </div>
                <br/>
                <div class="current-plan-details">
                        If you have questions, please see our <a target="_blank" href="http://docs.storiesonboard.com/subscription-pricing-billing">Subscription, pricing, billing knowledge base</a> or <a href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">contact us</a>.
                </div>
            </div>
            <div class="data-section-head">
                Billing information
            </div>
            <div class="data-section">
                <form lpformnum="1">
                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Company name / Your name
                                <input type="text" id="billingName" data-bind="value: billingName" tabindex="1" maxlength="50">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingName"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                E-mail
                                <input type="text" id="billingEmail" data-bind="value: billingEmail" tabindex="3" maxlength="100">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingEmail"></span>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Address
                                <input type="text" id="billingAddress" data-bind="value: billingAddress" tabindex="4" maxlength="50">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingAddress"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                City
                                <input type="text" id="billingCity" data-bind="value: billingCity" tabindex="5" maxlength="100">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingCity"></span>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                State / Province
                                <input type="text" id="billingStateProvince" data-bind="value: billingStateProvince" tabindex="6" maxlength="100">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingStateProvince"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                ZIP / Postal code
                                <input type="text" id="billingZIP" data-bind="value: billingZIP" tabindex="7" maxlength="20">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingZIP"></span>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Country
                                <select id="countryCode" data-bind="options: availableCountries, optionsValue: 'countryCode', optionsText: 'countryName', optionsCaption: 'Please choose...', value: billingCountry, select: true" tabindex="8"></select>
                            </label>
                            <span class="validation-message" data-bind="validationMessage: billingCountry"></span>
                        </div>
                        <div class="control w-1-2">
                            <label>
                                EU VAT number
                                <input id="billingVatNumber" type="text" data-bind="value: billingVatNumber" tabindex="9" maxlength="40">
                            </label>
                            <span class="validation-message" data-bind="text: euVatNumberValidationMessage, style: { color: euVatNumberIsValid() ? 'green' : 'red' }"></span>
                        </div>
                    </div>
                    {{#if isShownHungarianVat}}
                    <div class="control-group">
                        <div class="control w-1-2">
                           
                          
                        </div>
                        <div class="control w-1-2">
                            <label>
                                Magnszemly
                                <input type="checkbox" data-bind="checkbox: { checked: isIndividual }">
                            </label>
                            {{#ifnot isIndividual}}
                            <label>
                                Adszm
                                <input id="hungarianVatNumber" type="text" data-bind="value: hungarianVatNumber, enable: !isIndividual()" tabindex="11" maxlength="40">
                            </label>
                            <span class="validation-message" data-bind="validationMessage: hungarianVatNumber"></span>
                            {{/if}}
                        </div>
                    </div>
                    {{/if}}
                </form>
            </div>
            <div class="data-section-head">
                Payment
            </div>
            <div class="data-section">
                <a href="https://www.braintreegateway.com/merchants/{{braintreeMerchantId}}/verified" target="_blank">
                    <img src="https://s3.amazonaws.com/braintree-badges/braintree-badge-light.png" width="104px" height="24px" border="0" />
                </a> 
                <span class="we-accept">
                    We accept payments with major credit cards, including Visa, MasterCard, Discover, Maestro, AMEX.
                </span>
                <br />
                {{#if hasCardError}}
                <br />
                <span class="validation-message" style="text-align: left">{{cardError}}</span>
                {{/if}}
                <br />
                <form onsubmit="return false" action="/" id="my-sample-form" method="post">
                    <div class="control-group">
                        <div class="control w-1-1 cf">
                            <div class="card-line-card-number cf">
                                <label for="card-number">Card Number</label>
                                <div id="card-number"></div>
                            </div>
                            <div class="card-line-other-item cf">
                                <label for="expiration-month">Expiration Month</label>
                                <div id="expiration-month"></div>
                            </div>
                            <div class="card-line-other-item cf">
                                <label for="expiration-year">Expiration Year</label>
                                <div id="expiration-year"></div>
                            </div>
                            <div class="card-line-other-item cf">
                                <label for="cvv">CVV</label>
                                <div id="cvv"></div>
                            </div>
                        </div>
                    </div>
                    <input id="sbmit" style="visibility: hidden" type="submit" value="Pay" />
                </form>
                <div data-bind="if: priceWithVat() > 0">
                    <p class="amount-to-be-charged-notice">
                    You'll be charged $<span data-bind="text:priceWithVat"></span>
                    {{#if vat() > 0}}
                    (including $<span data-bind="text:vat"></span> VAT)
                    {{/vat}}
                    today for the next billing period and again in periods.<br/></p>
                    You can change your plan or cancel your subscription any time. There are no cancellation fees, though no refunds are provided for prorated periods.
                </div>
                <br />
                <button class="btn btn-action-primary" data-bind="btnClick: purchase">Purchase</button>
                &nbsp;&nbsp;
                <a data-bind="go:'/'">cancel</a>
            </div>
            {{/if}}
            {{#if wizardStep() === 3}}
            <div class="upgrade-head">
                Thank you for subscribing to our service
                
                <track-page params="page: track.UpgradeSubscriptionSuccess"></track-page>

            </div>
            <div class="current-plan">
                <button class="btn btn-action-primary" data-bind="click: redirectToDashboard">Continue</button>
            </div>
            {{/if}}
            <br />
            <br />
        </div>
    </div>
</script>
<script type="text/html" id="upgradeplan"> <!-- Title -->



<!-- Menu -->




</script>
<script type="text/html" id="workspacesettings:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Workspace settings',
        description: ''
        } }"></div>
</script>
<script type="text/html" id="workspacesettings:main-section">

    <div id="main" class="cf">

        <div class="metro-pivot" data-bind="metroPivot: { startIndex: startTabIndex }">
            <div class="pivot-item">
                <h3>Workspace details</h3>
                <track-page params="page: track.WorkspaceDetails"></track-page>
                <table>
                    <tr>
                        <td>
                            Workspace name
                        </td>
                        <td>
                            <span data-bind="text: name" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Description
                        </td>
                        <td>
                            <span data-bind="text: description" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Address
                        </td>
                        <td>
                            https://<span data-bind="text: address" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Created at
                        </td>
                        <td>
                            <span data-bind="timeago: createdAt" />
                            <span class="secondary-text">by</span> <span class="secondary-text" data-bind="text: createdBy"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Subscription admins
                        </td>
                        <td>
                            <span data-bind="text: subscriptionManagers"></span>
                            <!--<span class="secondary-text">Click <a data-bind="go: { url: '/managepeople' }">here</a> to edit subscription managers.</span>-->
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Workspace admins
                        </td>
                        <td>
                            <span data-bind="text: workspaceManagers"></span>
                            <!--<span class="secondary-text">Click <a data-bind="go: { url: '/managepeople' }">here</a> to edit workspace managers.</span>-->
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Members
                        </td>
                        <td>
                            <span data-bind="text: numberOfMembers + ' workspace member'"></span>
                            <span class="secondary-text"> where <span data-bind="text: numberOfActiveMembers"></span> active, <span data-bind="text: numberOfInvitedMembers"></span> invited and <span data-bind="text: numberOfLockedOutMembers"></span> locked out.</span>
                            <!--<span class="secondary-text">Click <a data-bind="go: { url: '/managepeople' }">here</a> to edit members.</span>-->
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Storymaps
                        </td>
                        <td>
                            <span data-bind="text: numberOfStorymaps + ' story map'"></span>
                            <span class="secondary-text"> where <span data-bind="text: numberOfActiveStorymaps"></span> active and <span data-bind="text: numberOfArchivedStorymaps"></span> archived.</span>
                            <!--<span class="secondary-text">Click <a data-bind="go: { url: '/managestorymaps' }">here</a> to edit story maps.</span>-->
                        </td>
                    </tr>
                </table>
                <div class="form-action-buttons">
                    <button class="btn-action-primary" data-bind="modal: {
                            class: 'edit_ws_name small',
                           template: 'edit-ws-name',
                           data: $data,
                           trigger: 'both' }" class="btn-action">
                        Edit workspace name
                    </button>
                    <button class="btn-action-primary" data-bind="modal: {
                            class: 'change_subdomain small medium',
                            template: 'change_subdomain',
                            data: $data,
                            trigger: 'both' }" class="btn-action">
                        Change address
                    </button>
                    <button class="btn-action-primary" data-bind="modal: {
                            class: 'edit_ws_description small',
                           template: 'edit-ws-description',
                           data: $data,
                           trigger: 'both' }" class="btn-action">
                        Edit workspace description
                    </button>
                </div>
            </div>

            <div class="pivot-item plan-and-billing">
                <h3>Plan and Billing</h3>
                <track-page params="page: track.WorkspacePlansAndBilling"></track-page>

                {{#if isCustomPlan}}

                <div class="legend-details">
                    <span class="legend-details-head">"{{currentSubscriptionName}}" plan</span>
                    for <b>{{currentSubscriptionMembers}} editors</b>
                    <br>
                    {{#ifnot isResellerManagedSubscription}}
                    <span class="legend-details-price">
                        Paid amount is {{currentSubscriptionCostWithVat}}
                    </span>
                    <br>
                    {{/ifnot}}
                    <span class="legend-details-price">
                        Expires on {{customPlanEndAt}}
                    </span>
                    <p>
                        Please <a style="font-weight: bold;text-decoration: underline" href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">contact us</a> if you'd like to change it.
                    </p>
                </div>

                {{#if: currentSubscriptionsLimitIsExceed}}
                <div class="limit-exceed-box">
                    <p>Workspace exceeds the limits of the current subscription!</p>
                    <p>
                        It contains <b>{{workspaceMemberCount}}</b> editors{{#ifnot workspaceUsingFeatureAddOns}}.{{/ifnot}}
                        {{#if workspaceUsingFeatureAddOns}} and using the following features(s): <b>{{workspaceFeatureAddOns}}</b>.{{/if}}
                    </p>
                    <p>
                        Please click <a style="color:#fff;font-weight: bold;text-decoration: underline" href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">here</a> to contact us.
                    </p>
                </div>
                {{/if}}

                {{/if}}
                {{#ifnot isCustomPlan}}

                <p class="contact-us">If you have questions, please see our <a target="_blank" href="http://docs.storiesonboard.com/subscription-pricing-billing">Subscription, pricing, billing knowledge base articles</a> or <a href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">contact us</a>.</p>

                <div class="free-trial-section" data-bind="if: isFreeTrialPlan">
                    <br />
                    You haven't subscribed to a plan yet.
                    <br />
                    <br />
                    {{#if isSuspended}}
                        Please upgrade to a paid plan to continue working on this workspace.
                    {{/if}}
                    
                    {{#ifnot isSuspended}}
                        Your {{freeTiralPlanName}}
                        {{#ifnot freeTrialIsExpired}}
                        will end in {{freeTrialLeftDays}} days.
                        {{/ifnot}}
                        {{#if freeTrialIsExpired}}
                        is expired {{freeTrialExpiredDays}} days ago.
                        Please upgrade to a paid plan to continue working on this workspace.
                        {{/if}}
                    {{/ifnot}}
                    <br /><br /><button class="btn btn-action-primary" data-bind="go: { url: '/upgrade' }">Upgrade</button>
                </div>
              
                <div data-bind="ifnot: isFreeTrialPlan">
                    <form>
                        <fieldset>
                            <legend>Subscription plan</legend>
                            {{#ifnot planIsEditing}}
                            <div class="legend-details">
                                <span class="legend-details-head">"{{currentSubscriptionName}}" plan</span>
                                for <b>{{currentSubscriptionMembers}} editors</b>
                                <br>
                                {{#ifnot currentSubscriptionIsAnnual}}
                                <span class="legend-details-price">
                                    {{currentSubscriptionCostWithVat}} / month
                                    {{#if currentSubscriptionHasVat}}
                                    ({{currentSubscriptionCost}} + {{currentSubscriptionTaxRate}}% VAT)
                                    {{/if}}
                                </span>
                                {{/ifnot}}
                                {{#if currentSubscriptionIsAnnual}}
                                <span class="legend-details-price">
                                    {{currentSubscriptionCostWithVat}} / year
                                    {{#if currentSubscriptionHasVat}}
                                    ({{currentSubscriptionCost}} + {{currentSubscriptionTaxRate}}% VAT)
                                    {{/if}}
                                </span>
                                {{/if}}

                                {{#if currentSubscriptionWillExpires}}
                                <br />
                                Expires {{currentSubscriptionExpiresAt}}
                                {{/if}}
                            </div>
                            {{#if: currentSubscriptionsLimitIsExceed}}
                            <div class="limit-exceed-box">
                                <p>Workspace exceeds the limits of the current subscription!</p>
                                <p>
                                    It contains <b>{{workspaceMemberCount}}</b> editors{{#ifnot workspaceUsingFeatureAddOns}}.{{/ifnot}}
                                    {{#if workspaceUsingFeatureAddOns}} and using the following features(s): <b>{{workspaceFeatureAddOns}}</b>.{{/if}}
                                </p>
                                <button class="btn btn-action-primary" data-bind="click: function() { $root.planIsEditing(true); }">Upgrade now</button>
                                <br />
                            </div>
                            {{/if}}
                            {{#ifnot: currentSubscriptionsLimitIsExceed}}
                            <div>
                                <button class="btn btn-action-primary" data-bind="click: function() { $root.planIsEditing(true); }">Change</button>
                                <button class="btn btn-action" data-bind="triggerClickOnElement: {selector: '.header[index=\'3\']'}">Cancel subscription</button>
                                <br /><br />
                            </div>
                            {{/ifnot}}
                            {{/ifnot}}

                            {{#if planIsEditing}}

                            {{#if !currentSubscriptionHasBalance || currentSubscriptionBalance() >= 0}}
                            <p>
                                Your current subscription plan is <b>"{{currentSubscriptionName}}"</b> with <b>{{currentSubscriptionMembers}} editors.</b>
                                Your workspace currently contains <b>{{workspaceMemberCount}} editors</b>
                                {{#if workspaceUsingFeatureAddOns}} and using the following features(s): <b>{{workspaceFeatureAddOns}}</b>.{{/if}}
                                {{#ifnot workspaceUsingFeatureAddOns}}.{{/ifnot}}
                                <br />
                                <br />
                            </p>
                            {{#if currentSubscriptionIsOnDeprecatedPlan}}
                            <div class="deprecated-plan-box legend-details">
                                <p>
                                    <b>Important!</b>
                                    <br /><br />
                                    We changed our pricing and your current subscription belongs to a deprecated plan.
                                    <br /><br />
                                    As our loyal customer you can continue using your current subscription plan, you can
                                    upgrade or downgrade the number of paid editors, but please note that once you change 
                                    the plan to another one, <b>you will not be able to switch back</b> again.
                                </p>
                                <p class="contact-us">
                                    If you have any questions feel free to <a href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">contact us</a> with the support widget or at support@storiesonboard.com.
                                </p>
                            </div>
                            {{/if}}

                            <!-- Pricing Table Section -->
                            {{#ifnot hasCardPayableCustomPlan}}
                            
                            <div class="subscription-switch-plan-groups">
                                {{#ifnot showAnnualPlan}}
                                <div>Switch to <a data-bind="click: function() { $root.showAnnualPlan(true); }">annual plans</a> to get <span class="subscription-plan-discount-text">20%</span> discount</div>
                                {{/ifnot}}
                                {{#if showAnnualPlan}}
                                <div>Switch to <a data-bind="click: function() { $root.showAnnualPlan(false); }">monthly plans</a></div>
                                {{/if}}
                            </div>

                            <br />
                            {{/ifnot}}

                            {{#ifnot $root.showAnnualPlan}}
                            <div class="subscription-plan-box-list cf" data-bind="foreach: $root.monthlyPlans">
                                {{#ifnot isContactUsPlan}}
                                <div class="subscription-plan-box" data-bind="css: { 'selected-plan': $data.isSelectedPlan }, equalHeight: '.subscription-plan-box'">
                                    {{#if isCustomCardPayable}}
                                    <div class="subscription-plan-box-custom-card">
                                        {{#if isRecurring}}
                                        Customized plan
                                        {{/if}}
                                        {{#ifnot isRecurring}}
                                        Customized plan
                                        {{/ifnot}}
                                    </div>
                                    {{/if}}
                                    <div class="subscription-plan-box-name">{{planName}}</div>
                                    <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
                                        {{#if (isDeprecatedPlan && isCustomCardPayable == false)}}
                                        <br>
                                        <b>Deprecated subscription plan!</b>
                                        <br />
                                        {{/if}}
                                        {{#ifnot isCustomCardPayable}}
                                        {{#ifnot isDeprecatedPlan}}
                                        {{{description}}}
                                        {{/ifnot}}
                                        {{/ifnot}}
                                        {{#if isCustomCardPayable}}
                                        {{#if isExpires}}
                                        <div>
                                            <br /><br />
                                            expires {{expiresAt}}
                                        </div>
                                        {{/if}}
                                        {{#ifnot isExpires}}
                                        <div>
                                            <br /><br />
                                            never expires
                                        </div>
                                        {{/ifnot}}
                                        {{/if}}
                                    </div>
                                    {{#ifnot isCustomCardPayable}}
                                    <div class="subscription-plan-box-editor-price-more-info" data-bind="equalHeight: '.subscription-plan-box-editor-price-more-info'">
                                        {{#ifnot isDeprecatedPlan}}
                                        <a target="_blank" href="{{$root.pricingPageUrl}}">Learn more</a>
                                        {{/ifnot}}
                                    </div>
                                    {{/ifnot}}
                                    <div class="subscription-plan-box-price" data-bind="visible: !isInsufficient">

                                        {{#if avaliableEditorCounts.length > 1}}
                                        <select data-bind="options: avaliableEditorCounts, optionsText: 'text', optionsAfterRender: disableUnavailableEditorCount, value: selected"></select>
                                        {{/if}}
                                        {{#if avaliableEditorCounts.length < 2}}
                                        <div class="subscription-plan-box-price-sum-per-month">{{firstEditorCountItemValue()}}</div>
                                        {{/if}}

                                        <div class="subscription-plan-box-price-sum">{{currentPrice}}</div>
                                        <div class="subscription-plan-box-price-sum-per-month">per month</div>

                                    </div>
                                    <div class="subscription-plan-box-button-container" data-bind="visible: !isInsufficient">
                                        <div class="subscription-plan-box-price-button">
                                            <button data-bind="visible: !isInsufficient,  css: { disabled: isInsufficient }, click: function() { $root.updatePlan($data.planId, $data.selected().value); }" class="btn btn-action-primary">Choose</button>
                                        </div>
                                    </div>
                                    <div class="subscription-plan-box-price" data-bind="visible: isInsufficient, css: { 'insufficient' : isInsufficient }">
                                        <span data-bind="visible: isInsufficient">
                                            Some <a data-bind="qtip: {contentId: '.unavailable-features', classes: 'unavailable-features-tooltip qtip-tipsy qtip-sob'}">features you're currently using <i class="icon-info-circle" aria-hidden="true"></i></a> are not available in this plan. Consider disabling them to make this plan available.

                                            <div class="unavailable-features">
                                                <strong>Currently used features from higher plan(s)</strong>
                                                <ul data-bind="foreach: unavailableFeatures">
                                                    <li>{{$data}}</li>
                                                </ul>
                                                <div class="contact-info">For more information please read our FAQ below or contact us with the support widget or at support@storiesonboard.com</div>
                                            </div>
                                        </span>
                                    </div>
                                </div>
                                {{/ifnot}}
                                {{#if isContactUsPlan}}
                                <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
                                    <div class="subscription-plan-box-name">{{planName}}</div>
                                    <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
                                        {{{description}}}
                                    </div>
                                    <div class="subscription-plan-box-for-contact-us">
                                        <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
                                    </div>
                                    <div class="subscription-plan-box-button-container" >
                                        <div class="subscription-plan-box-price-button">
                                            <button data-bind="click: $root.onSupportClick" class="btn btn-action-primary">Contact Us</button>
                                        </div>
                                    </div>
                                </div>
                                {{/if}}
                            </div>
                            {{/ifnot}}
                            {{#if $root.showAnnualPlan}}
                            <div class="subscription-plan-box-list cf" data-bind="foreach: $root.annualPlans">
                                {{#ifnot isContactUsPlan}}
                                <div class="subscription-plan-box" data-bind="css: { 'selected-plan': $data.isSelectedPlan }, equalHeight: '.subscription-plan-box'">
                                    {{#if isCustomCardPayable}}
                                    <div class="subscription-plan-box-custom-card">
                                        {{#if isRecurring}}
                                        Customized plan
                                        {{/if}}
                                        {{#ifnot isRecurring}}
                                        Customized plan
                                        {{/ifnot}}
                                    </div>
                                    {{/if}}
                                    <div class="subscription-plan-box-name">{{planName}}</div>
                                    <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
                                        {{#if (isDeprecatedPlan && isCustomCardPayable == false)}}
                                        <br>
                                        <b>Deprecated subscription plan!</b>
                                        <br />
                                        {{/if}}
                                        {{#ifnot isCustomCardPayable}}
                                        {{#ifnot isDeprecatedPlan}}
                                        {{{description}}}
                                        {{/ifnot}}
                                        {{/ifnot}}
                                        {{#if isCustomCardPayable}}
                                        {{#if isExpires}}
                                        <div>
                                            <br /><br />
                                            expires {{expiresAt}}
                                        </div>
                                        {{/if}}
                                        {{#ifnot isExpires}}
                                        <div>
                                            <br /><br />
                                            never expires
                                        </div>
                                        {{/ifnot}}
                                        {{/if}}
                                    </div>
                                    {{#ifnot isCustomCardPayable}}
                                    <div class="subscription-plan-box-editor-price-more-info" data-bind="equalHeight: '.subscription-plan-box-editor-price-more-info'">
                                        <a target="_blank" href="{{$root.pricingPageUrl}}">Learn more</a>
                                    </div>
                                    {{/ifnot}}
                                    <div class="subscription-plan-box-price" data-bind="visible: !isInsufficient">
                                        {{#if avaliableEditorCounts.length > 1}}
                                        <select data-bind="options: avaliableEditorCounts, optionsText: 'text', optionsAfterRender: disableUnavailableEditorCount, value: selected"></select>
                                        {{/if}}
                                        {{#if avaliableEditorCounts.length < 2}}
                                        <div class="subscription-plan-box-price-sum-per-month">{{firstEditorCountItemValue()}}</div>
                                        {{/if}}

                                        <div class="subscription-plan-box-price-sum">{{currentPrice}}</div>
                                        <div class="subscription-plan-box-price-sum-per-month">per year</div>

                                    </div>
                                    <div class="subscription-plan-box-button-container" data-bind="visible: !isInsufficient">
                                        <div class="subscription-plan-box-price-button">
                                            <button data-bind="visible: !isInsufficient,  css: { disabled: isInsufficient }, click: function() { $root.updatePlan($data.planId, $data.selected().value); }" class="btn btn-action-primary">Choose</button>
                                        </div>
                                    </div>
                                    <div class="subscription-plan-box-price" data-bind="visible: isInsufficient, css: { 'insufficient' : isInsufficient }">
                                        <span data-bind="visible: isInsufficient">
                                            Some <a data-bind="qtip: {contentId: '.unavailable-features', classes: 'unavailable-features-tooltip qtip-tipsy qtip-sob'}">features you're currently using <i class="icon-info-circle" aria-hidden="true"></i></a> are not available in this plan. Consider disabling them to make this plan available.

                                            <div class="unavailable-features">
                                                <strong>Currently used features from higher plan(s)</strong>
                                                <ul data-bind="foreach: unavailableFeatures">
                                                    <li>{{$data}}</li>
                                                </ul>
                                                <div class="contact-info">For more information please read our FAQ below or contact us with the support widget or at support@storiesonboard.com</div>
                                            </div>
                                        </span>
                                    </div>
                                </div>
                                {{/ifnot}}
                                {{#if isContactUsPlan}}
                                <div class="subscription-plan-box" data-bind="equalHeight: '.subscription-plan-box'">
                                    <div class="subscription-plan-box-name">{{planName}}</div>
                                    <div class="subscription-plan-box-editor-price" data-bind="equalHeight: '.subscription-plan-box-editor-price'">
                                        {{{description}}}
                                    </div>
                                    <div class="subscription-plan-box-for-contact-us">
                                        <!--Click <a target="_blank" href="{{$root.pricingPageUrl}}">here</a> for more details about this plan.-->
                                    </div>
                                    <div class="subscription-plan-box-button-container">
                                        <div class="subscription-plan-box-price-button">
                                            <button data-bind="click: $root.onSupportClick" class="btn btn-action-primary">Contact Us</button>
                                        </div>
                                    </div>
                                </div>
                                {{/if}}
                            </div>
                            {{/if}}

                            <div class="current-plan-vat-info">
                                Prices are in USD and may be subject to VAT (Value Added Tax), depending on where you are located.
                            </div>

                            <br />
                            <a data-bind="click: function() { $root.planIsEditing(false); }">close</a>
                            {{/if}}
                            {{#if (currentSubscriptionHasBalance && currentSubscriptionBalance() < 0) || (currentSubscriptionDaysPastDue() > 0)}}
                            <div class="current-subscription-days-past-due-info legend-details">
                                <p>
                                    Your subscription is past due by <strong>{{currentSubscriptionDaysPastDue}}</strong> days. Your current balance is <strong>{{currentSubscriptionBalance}} USD</strong>. You can't modify your subscription plan with an unsettled account.
                                </p>
                                <p class="contact-us">
                                    Please <a href="mailto:feedback@storiesonboard.com" data-bind="click: $root.onSupportClick">contact us</a> with the support widget or at support@storiesonboard.com.
                                </p>
                            </div>
                            {{/if}}
                            {{/if}}
                        </fieldset>
                    </form>

                    <form>
                        <fieldset>
                            <legend>Billing information<span></span></legend>
                            {{#ifnot billingInfoIsEditing}}
                            <div class="legend-details">
                                {{billingName}}<br />
                                {{billingAddress}}, {{billingCity}}, {{billingCountryName}}<br />
                                {{#if billingHasVATNumber}}
                                VAT Number: {{billingVATNumber}}<br />
                                {{/if}}
                            </div>
                            <button class="btn btn-action-primary" data-bind="click: function() { $root.billingInfoIsEditing(true); }">Update</button>
                            <br /><br />
                            {{/ifnot}}

                            {{#if billingInfoIsEditing}}
                            <div class="control-group">
                                <div class="control w-1-2">
                                    <label>
                                        Company name / Your name
                                        <input type="text" id="billing-name" data-bind="value: billingName" tabindex="1" maxlength="50">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingName"></span>
                                </div>
                                <div class="control w-1-2">
                                    <label>
                                        E-mail
                                        <input type="text" id="billing-email" data-bind="value: billingEmail" tabindex="1" maxlength="100">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingEmail"></span>
                                </div>
                            </div>

                            <div class="control-group">
                                <div class="control w-1-2">
                                    <label>
                                        Address
                                        <input type="text" id="billing-address" data-bind="value: billingAddress" tabindex="2" maxlength="50">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingAddress"></span>
                                </div>
                                <div class="control w-1-2">
                                    <label>
                                        City
                                        <input type="text" id="billing-city" data-bind="value: billingCity" tabindex="3" maxlength="100">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingCity"></span>
                                </div>
                            </div>

                            <div class="control-group">
                                <div class="control w-1-2">
                                    <label>
                                        State / Province
                                        <input type="text" id="billing-state" data-bind="value: billingStateProvince" tabindex="4" maxlength="100">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingStateProvince"></span>
                                </div>
                                <div class="control w-1-2">
                                    <label>
                                        ZIP / Postal code
                                        <input type="text" id="billing-zip" data-bind="value: billingZIP" tabindex="5" maxlength="20">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingZIP"></span>
                                </div>
                            </div>

                            <div class="control-group">
                                <div class="control w-1-2">
                                    <label>
                                        Country
                                        <select id="billing-country" data-bind="options: availableCountries, optionsValue: 'countryCode', optionsText: 'countryName', optionsCaption: 'Please choose...', value: billingCountry, select: true" tabindex="6"></select>
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingCountry"></span>
                                </div>
                                <div class="control w-1-2">
                                    <label>
                                        EU VAT number
                                        <input type="text" id="billing-vat" data-bind="value: billingVATNumber" tabindex="7" maxlength="40">
                                    </label>
                                    <span class="validation-message" data-bind="text: euVatNumberValidationMessage, style: { color: euVatNumberIsValid() ? 'green' : 'red' }"></span>
                                </div>
                            </div>

                            {{#if billingIsShownHungarianVat}}
                            <div class="control-group">
                                <div class="control w-1-2">
                                </div>
                                <div class="control w-1-2">
                                    <label>
                                        Magnszemly
                                        <input type="checkbox" data-bind="checkbox: { checked: billingIsIndividual }">
                                    </label>
                                    {{#ifnot billingIsIndividual}}
                                    <label>
                                        Adszm
                                        <input id="hungarianVatNumber" type="text" data-bind="value: billingHungarianVatNumber, enable: !billingIsIndividual()" tabindex="11" maxlength="40">
                                    </label>
                                    <span class="validation-message" data-bind="validationMessage: billingHungarianVatNumber"></span>
                                    {{/if}}
                                </div>
                            </div>
                            {{/if}}

                            <div class="form-action-buttons billing">
                                <button data-bind="btnClickWithRemoteValidation: { handler: saveBillingInfo, remoteValidated: billingVATNumber }" class="btn-action-primary">Save</button>
                                <a data-bind="click: function() { $root.billingInfoIsEditing(false); }">cancel</a>
                            </div>
                            {{/if}}

                        </fieldset>
                    </form>

                    <form onsubmit="return false" action="/" id="my-sample-form" method="post">
                        <fieldset>
                            <legend>Payment <span></span></legend>

                            <a href="https://www.braintreegateway.com/merchants/{{braintreeMerchantId}}/verified" target="_blank">
                                <img src="https://s3.amazonaws.com/braintree-badges/braintree-badge-light.png" width="104px" height="24px" border="0" />
                            </a>
                            <br /><br />

                            {{#ifnot paymentIsEditing}}
                            <div class="legend-details">
                                Using {{currentCardsType}} ending with {{currentCardsLast4Number}}
                                <br />
                                <span class="legend-details-sub">Next payment on {{currentSubscriptionNextPaymentDate}}. Next amount: {{currentSubscriptionNextAmount}} USD. {{#if currentSubscriptionHasBalance}} Balance: {{currentSubscriptionBalance}} USD. {{/if}}</span>
                            </div>
                            <button class="btn btn-action-primary" data-bind="click: function() { $root.startUpdateCard(); }">Update</button>
                            <br />
                            {{/ifnot}}
                            {{#if paymentIsEditing}}
                            {{#if hasCardError}}
                            <br />
                            <span class="validation-message" style="text-align: left">{{cardError}}</span>
                            <br />
                            {{/if}}
                            <div class="control-group">
                                <div class="control w-1-1 cf">
                                    <div class="card-line-card-number cf">
                                        <label for="card-number">Card Number</label>
                                        <div id="card-number"></div>
                                    </div>
                                    <div class="card-line-other-item cf">
                                        <label for="expiration-month">Expiration Month</label>
                                        <div id="expiration-month"></div>
                                    </div>
                                    <div class="card-line-other-item cf">
                                        <label for="expiration-year">Expiration Year</label>
                                        <div id="expiration-year"></div>
                                    </div>
                                    <div class="card-line-other-item cf">
                                        <label for="cvv">CVV</label>
                                        <div id="cvv"></div>
                                    </div>
                                </div>
                            </div>
                            <input id="sbmit" style="visibility: hidden" type="submit" value="Pay" />

                            <div class="form-action-buttons billing">
                                <button class="btn-action-primary" data-bind="btnClick: submitCardUpdate">Save</button>
                                <a data-bind="click: $root.cancelUpdateCard">cancel</a>
                            </div>
                            {{/if}}
                            <!--<p>
                                Your card will be charged $<span data-bind="text: priceWithVAT"></span> <span data-bind="visible: hasVAT()">(including $<span data-bind="text: VAT"></span> VAT)</span> today for your next month and again in each further months.
                            </p>-->

                        </fieldset>
                    </form>

                    {{#if hasInvoice}}
                    <form>
                        <fieldset>
                            <legend>Invoices<span></span></legend>
                            {{#ifnot showInvoices}}
                            <div class="legend-details">
                                <a data-bind="click: function() { $root.showInvoices(true); }">Show {{invoiceCount}} invoices</a>
                            </div>
                            {{/ifnot}}
                            {{#if showInvoices}}
                            <table class="invoice-table">
                                <thead>
                                    <tr>
                                        <th><span>Date</span></th>
                                        <th><span>Invoice</span></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody data-bind="foreach: invoices">
                                    <tr>
                                        <td><span data-bind="text: invoiceDate"></span></td>
                                        <td><span data-bind="text: invoiceNumber"></span></td>
                                        <td>
                                            <a data-bind="fileDownloadButton: {
                                                url: url,
                                                csrfTokenKey: globalConfig.csrfTokenHeaderKey,
                                                currentCsrfToken: globalConfig.currentCsrfToken,
                                                onSuccess: function() { app.flash.showSuccess('Invoice was downloaded successfully.'); },
                                                onFail:  function(html, url, failReason) { app.flash.showError(failReason != undefined ? failReason : 'Sorry, something went wrong. Please try again later.'); }
                                            }">
                                                Download
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <br />
                            <br />
                            <br />
                            {{/if}}
                        </fieldset>
                    </form>
                    {{/if}}
                </div>

                {{/ifnot}}
            </div>

            <div class="pivot-item">
                <h3>Advanced security</h3>
                <track-page params="page: track.WorkspaceAdvancedSecurity"></track-page>

                {{#if showUpgradeToProPlanMessage}}
                <br />
                <div class="subscription-info-hint-in-dialog">
                    Hint: This feature is not avaliable in the current subscription plan. Please upgrade to the Pro subscription plan to use this feature.
                </div>
                {{/if}}
                {{#ifnot showUpgradeToProPlanMessage}}
                <div id="domain-access-settings" data-bind="template: { name: 'workspacesettings.domain-access-settings', data: domainSettings }"></div>
                <div id="ip-access-settings" data-bind="template: { name: 'workspacesettings.ip-access-settings', data: ipSettings }"></div>
                <div id="static-content" data-bind="template: { name: 'workspacesettings.static-content' }"></div>
                {{/ifnot}}
            </div>

            <div class="pivot-item">
                <h3>Close workspace</h3>
                <track-page params="page: track.WorkspaceClose"></track-page>

                {{#if canCloseWorkspace}}
                <p>
                    This workspace has <span data-bind="text: numberOfStorymaps"></span> story maps defined in it. If you delete this workspace, all story maps and any data contained therein will be immediately and irrecoverably destroyed.
                </p>
                <p>
                    If this is a paid workspace, your subscription will no longer be billed.
                </p>
                <p>
                    <br />
                    <span class="warning-text">THIS OPERATION CANNOT BE UNDONE!</span>
                    <br /> <br />
                </p>
                <form>
                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                Help us improve! Why are you canceling your account? (optional, but appreciated!)
                                <textarea data-bind="value: cancellationCause"></textarea>
                            </label>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="control w-1-2">
                            <label>
                                <input type="checkbox" data-bind="checkbox: {checked: cancellationConfirmed}">
                                I understand, please delete my workspace.
                            </label>
                            <span class="validation-message" data-bind="validationMessage: cancellationConfirmed"></span>
                        </div>
                    </div>
                    <div class="info-box" data-bind="visible: cancellationConfirmed()">
                        Project on pause?<br /><br />
                        If you wish to keep all your story maps and data, we can cancel your subscription and set the workspace to read-only. You can view all the story maps
                        and have the option to reactivate your subscription anytime.<br />
                        Contact us via e-mail at <a href="mailto:sales@storiesonboard.com">sales@storiesonboard.com</a> or using the in-app
                        <a href="" data-bind="$root.onSupportClick">chat</a>.
                    </div>
                    <div class="form-action-buttons">
                        <button data-bind="btnClick: deleteWorkspace, css: {disabled: !cancellationConfirmed()}" class="btn-action-primary">Delete workspace</button>
                    </div>
                </form>
                {{/if}}

                {{#ifnot canCloseWorkspace}}
                    <div id="cancellation-request">
                        <h3>Cancellation request</h3>
                        <p>To cancel your subscription, please contact our Customer Service team.</p>
                        <div class="control-group">
                            <div class="control">
                                <a class="button btn-action-primary" data-bind="click: requestSubscriptionCancellation">Submit Request via chat</a> or send email to <a href="mailto:support@storiesonboard.com">support@storiesonboard.com</a>
                            </div>
                        </div>
                        <p>Well do our best to respond within a few minutes.</p>
                    </div>
                {{/ifnot}}
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="workspacesettings:edit-ws-name">
    <div class="header">
        Change workspace name
        <a class="btn-icon" data-bind="click: closeEditName">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <form>
            <div class="control-group">
                <div class="control">
                    <label>
                        Enter a new name for your workspace
                        <input type="text" data-bind="value: name, valueUpdate: 'afterkeydown'">
                    </label>
                    <span class="validation-message" data-bind="validationMessage: name"></span>
                </div>
            </div>
        </form>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="btnClick: editName, css: {disabled: !workspaceNameValidationGroup.validate().isValid()}">Save</button>
        <button class="btn-action" data-bind="btnClick: closeEditName">Cancel</button>
    </div>
</script>
<script type="text/html" id="workspacesettings:edit-ws-description">
    <div class="header">
        Change workspace description
        <a class="btn-icon" data-bind="click: closeEditDescription">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <form>
            <div class="control-group">
                <div class="control">
                    <label>
                        Enter a new description for your workspace
                        <textarea data-bind="value: description, valueUpdate: 'afterkeydown'" maxlength="4000"></textarea>
                    </label>
                    <span class="validation-message" data-bind="validationMessage: description"></span>
                </div>
            </div>
        </form>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="btnClick: editDescription">Save</button>
        <button class="btn-action" data-bind="btnClick: closeEditDescription">Cancel</button>
    </div>
</script>
<script type="text/html" id="workspacesettings:change_subdomain">
    <div class="header">
        Change workspace's subdomain
        <a class="btn-icon" data-bind="click: closeChangeAddress">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <div class="description">
            With the subdomain changed, the workspace <b>will no longer be available</b> on it's former URL. After save, you will be redirected to the new address.
        </div>
        <form>
            <div class="control-group">
                <div class="control">
                    <label class="cf">
                        Enter a new subdomain for your workspace
                        <input type="text" class="subdomain-field" data-bind="value: subdomain">
                        <strong class="domain" data-bind="text: domain"></strong>
                    </label>
                    <span class="validation-message" data-bind="validationMessage: subdomain"></span>
                </div>
            </div>
        </form>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="btnClickWithRemoteValidation: { handler: changeAddress, remoteValidated: subdomain }">Save</button>
        <button class="btn-action" data-bind="btnClick: closeChangeAddress">Cancel</button>
    </div>
</script>
<script type="text/html" id="workspacesettings"> <!-- Sub header -->


<!-- Main -->







</script>
<script type="text/html" id="newstorymap.importpreviewdialog"> 
<div class="header">
    Preview of the imported story map
    <a class="btn-icon" data-bind="closeModal:true">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <div class="map">
        <div data-bind="foreach:Rows">
            <!-- ko ifnot:IsReleaseRow -->
            <div class="cf" data-bind="foreach:Cols">

                <!-- ko if:IsEmpty -->
                <div class="preview-card-empty">
                </div>
                <!-- /ko -->
                <!-- ko ifnot:IsEmpty -->
                <div class="preview-card card-tooltip" data-bind='attr: {"data-tip": Name }'>
                    <!--<span data-bind="text:Name"></span>-->
                </div>
                <!-- /ko -->
            </div>
            <!-- /ko -->
            <!-- ko if:IsReleaseRow -->
                <div class="cf preview-release" data-bind="text:Cols[0].Name"></div>
            <!-- /ko -->
        </div>
    </div>
</div>
</script>
<script type="text/html" id="storymap.archivereleases:releases-dialog">
    <track-page params="page: track.StorymapArchiveReleases"></track-page>

    <div class="header">
        Archived releases
        <a class="btn-icon" data-bind="click: close">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        {{#if hasRelease}}
        <div class="description">You can view your archived releases and restore them so they become visible on the board again.</div>
        {{/if}}
        {{#ifnot hasRelease}}
        <div class="description">You don't have any archived releases yet.</div>
        {{/ifnot}}
        <div class="tile-group three-column">
            <div class="tile-group-header">
                <div class="tile-group-header-right">
                    <div data-bind="visible: visibleReleases.pageCount() == 1">
                        <br/>
                    </div>
                    <div data-bind="visible: visibleReleases.pageCount() > 1">
                        <div class="tile-pager">
                            <div class="tile-paging-info">
                                <span data-bind="text: visibleReleases.pagingInfo()"></span>
                            </div>
                            <a class="btn-icon opacitied">
                                <i class="pager-left" data-bind="click: visibleReleases.movePrevious"></i>
                            </a>
                            <a class="btn-icon opacitied">
                                <i class="pager-right" data-bind="click: visibleReleases.moveNext"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tile-group-content" data-bind="foreach: visibleReleases.currentPageData">
                <div class="tile-cell">
                    <div class="tile-release">
                        <span class="caption" data-bind="inlineTextArea: {
                            value: name,
                            emptyText: 'Click to add name',
                            emptyClass: 'inline-text-empty',
                            selectTextOnFocus: true,
                            autoresize:false,
                            editmode: editing,
                            endEditOnEnterKey: true,
                            inputClass: 'inline-textarea-autoresize',
                            onEndEdit: function(isCanceled) { saveName(isCanceled); },
                            width: '100%'
                          }"></span>
                        <div class="archived-at">
                            <span>Archived 
                                <span data-bind="timeago: archivedAt"></span>{{#ifnot archivedBy}}.{{/ifnot}}
                                {{#if archivedBy}} by <span data-bind="text: archivedBy"></span>.{{/if}}
                            </span>
                            <br/>
                            <span>Contains <span data-bind="text: cardsCount"></span> cards.</span>
                        </div>
                        <div class="bottom_right">
                            <a>
                                <span class="small-font link" data-bind="click: function () { reactivate(); }">Restore release</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    <div class="footer"></div>
</script>
<script type="text/html" id="storymap.boardsharingdialog"> 
<div class="header">
    {{parentModel.isTemplate ? 'Collaborators' : 'Share'}}
    <a class="btn-icon" data-bind="closeModal:true">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <div class="metro-pivot" data-bind="metroPivot: true">
        <div class="pivot-item">
            <track-page params="page: track.StorymapShare"></track-page>
            <h3>Collaborators</h3>

            <div class="description">
                {{#if parentModel.isTemplate}}
                Add or remove workspace members so they can collaborate on story maps created by this template.
                {{/if}}
                {{#ifnot parentModel.isTemplate}}
                Share your story map with others. Add or remove members or change roles so they can collaborate on this story map.
                {{/if}}
            </div>
            <!--<br/>
    <br/>-->
            <div>
                <a tabindex="1" class="iconized-link-button btn-invite-member" data-bind="click: toggleAddWorkspaceMember">
                    <i class="icon-dialog-invite-member"></i>
                    <span>Add member</span>
                </a>

            </div>

            <div class="add-member-box" data-bind="visible: isAddWorkspaceMemberVisible">
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Add workspace member
                            <select tabindex="1" data-bind="optionsCaption: 'Choose...', options: availableWorkspaceMembers, optionsText: 'name', value: selectedWorkspaceMember, select: true"></select>
                        </label>
                        <span class="validation-message" data-bind="validationMessage: selectedWorkspaceMember"></span>
                    </div>
                    <div class="control w-1-3">
                        <label>
                            as a(n)
                            <select tabindex="1" data-bind="options: visibleRoles, optionsText: 'name', value: selectedWorkspaceMemberRole, select: true"></select>
                        </label>
                        <span class="validation-message" data-bind="validationMessage: selectedWorkspaceMemberRole"></span>
                    </div>
                </div>
                {{#if selectedWorkspaceMemberIsObserver}}
                <div class="add-member-observer-info">The selected workspace member can only be viewer of this story map because she is observer on this workspace!</div>
                {{/if}}
                <div class="buttons">
                    <a tabindex="1" class="btn-action-primary button" data-bind="debouncedAjaxBtnClick: addWorkspaceMember"><span>Add</span></a>
                    <a tabindex="1" class="btn-action-primary2 button" data-bind="debouncedClick: toggleAddWorkspaceMember"><span>Close</span></a>
                </div>
            </div>
            

            <div class="tile-group three-column">
                <!--Header -->
                <div class="tile-group-header">
                    <div class="tile-group-header-right">
                        <div data-bind="visible: collaborators.pageCount() == 1">
                            <br />
                        </div>
                        <div data-bind="visible: collaborators.pageCount() > 1">
                            <div class="tile-pager">
                                <div class="tile-paging-info">
                                    <span data-bind="text: collaborators.pagingInfo()"></span>
                                </div>
                                <a class="btn-icon opacitied">
                                    <i class="pager-left" data-bind="click: collaborators.movePrevious"></i>
                                </a>
                                <a class="btn-icon opacitied">
                                    <i class="pager-right" data-bind="click: collaborators.moveNext"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Content -->
                <div class="tile-group-content" data-bind="foreach: collaborators.currentPageData">
                    <div class="tile-cell">
                        <div class="tile-collaborator">
                            <span class="caption" data-bind="truncate: { text: name, height: 54 }"></span>
                            <!--<span class="description" data-bind="truncate: { text: email, height: 17 }"></span>-->
                            <div class="center_content">
                                <div data-bind="visible: isInInvitedState">
                                    <span class="center_content_label">Invited</span>
                                    <span class="value" data-bind="timeago: invitedAt"></span>
                                </div>
                                <div data-bind="visible: !isInInvitedState">
                                    <span class="center_content_label">Added</span>
                                    <span class="value" data-bind="timeago: addedAt"></span>
                                </div>
                                {{#if isInInvitedState }}
                                <span class="center_content_label"><a class="small-font dotted-link" data-bind="click: function () { $root.resendInvitation($data); }">Resend</a> or</span>
                                <span class="show-invitation-link dotted-link" data-bind="qtip: { contentId: '.get-invite-link-content', position: 'top', showOnClick: true, classes: 'qtip-tipsy qtip-sob qtip-sob-light invitation-link-tooltip' }">show</span>
                                <span> invitation link</span>
                                <div class="get-invite-link-content">
                                    <div class="get-invite-link-description">Click on the link below & press CTRL+C to copy to clipboard, or click <a href="{{invitationMailtoLink}}">here</a> to send the invitation with your email client.</div>
                                    <textarea class="invitation-url" readonly="readonly" data-bind="value: acceptInviteUrl, click: function(data, event) { $root.selectInvitationLink(event); }"></textarea>
                                </div>
                                {{/if }}
                            </div>
                            <!-- ko ifnot: $data.isMe -->
                            <div class="bottom_left">
                                {{#if $data.isObserver }}
                                <div class="menu-content left-aligned">
                                    <span class="small-font">Observer / Viewer</span>
                                </div>
                                {{/if}}
                                {{#ifnot $data.isObserver }}
                                <div class="dropdown-menu" data-bind="dropdownmenu: { closeOnClickSelector: '.modal-dialog.storymap-collaborators .modal-area' }">
                                    <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                        <span class="small-font" data-bind="text: role().name"></span>
                                        <span class="caret"></span>
                                    </a>
                                    <div class="menu-content left-aligned">
                                        <ul>
                                            <li class="dropdown-items-heading">
                                                Change role to
                                            </li>
                                            <li><a data-bind="click: $data.changeRoleToViewer.bind($data)">Viewer</a></li>
                                            <li><a data-bind="click: $data.changeRoleToMember.bind($data)">Editor</a></li>
                                            <li><a data-bind="click: $data.changeRoleToAdmin.bind($data)">Admin</a></li>
                                        </ul>
                                    </div>
                                </div>
                                {{/ifnot}}
                            </div>
                            <div class="bottom_right">
                                <div>
                                    <!-- ko ifnot: $data.isInInvitedState -->
                                    <span class="small-font link" data-bind="click: function () { $root.removeCollaborator($data); }">Remove</span>
                                    <!-- /ko -->
                                    <!-- ko if: $data.isInInvitedState -->
                                    <span class="small-font"><a class="small-font" data-bind="click: function () { $root.removeCollaborator($data); }">Cancel invitation</a></span>
                                    <!-- /ko -->
                                </div>
                            </div>
                            <!-- /ko -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- ko if: hasInvitedCollaborators -->
            <div id="resend-all-link">
                Click <a data-bind="click: resendAllInvitations">here</a> to resend all pending invitations.
            </div>
            <!-- /ko -->
            <div class="enable-commenting-for-viewers-container control-group control-group-with-2row-hint-above">
                <div class="control">
                    <label>
                        <input type="checkbox" data-bind="checkbox: {checked: viewersCanCommentOnCards}" />
                        Enable commenting and discussion for viewer collaborators
                    </label>
                </div>
                {{#if showViewersCanCommentNotAvaliable}}
                <div class="subscription-info-hint-in-dialog">
                    Hint: This feature is not avaliable in the current subscription plan. Please upgrade your subscription plan to use this feature.
                </div>
                {{/if}}
            </div>
        </div>
        <div class="pivot-item moreshring-options">
            <track-page params="page: track.StorymapMoreSharing"></track-page>

            <h3>More sharing options</h3>
            {{#ifnot parentModel.isTemplate}}
            <div class="description">
                Change your story maps visibility or share it with private links.
            </div>
            {{/ifnot}}
            <div class="control-group">
                <div class="control w-1-3">
                    <label>
                        Visibility
                        <select data-bind="options: visibilityOptions, optionsText: 'name', optionsValue: 'value', value: visibility, select: true"></select>
                    </label>
                </div>
                <span class="help-block" data-bind="html: visibilityOptionHelp"></span>
            </div>
            {{#if workspaceMembersCommentCheckboxVisible }}
            <div class="control-group">
                <div class="control">
                    <label>
                        <input type="checkbox" data-bind="checkbox:{checked: canWorkspaceMembersComment}" tabindex="1">
                        Enable commenting and discussion for everyone on this workspace
                    </label>
                </div>
            </div>
            {{/if}}

            {{#if hasVisibiltySettingsUnavailableCommentingFeature}}
            <div class="subscription-info-hint-in-dialog commenting-feature-hint" style="display: block;">
                Hint: The workspace members' commenting feature is not available in the current subscription plan. Please upgrade your subscription plan to use this feature.
            </div>
            {{/if}}

            <div class="control-group save-changes-btn-container">
                <button type="button" class="btn-action-primary save-changes-btn" data-bind="btnClick: updateBoardVisibilityParams, css: {disabled: hasVisibiltySettingsUnavailableCommentingFeature}">Update visibility</button>
            </div>

            {{#ifnot parentModel.isTemplate}}
            <div class="enable-private-link-wrapper">

                <div class="control w-2-3">
                    <label>
                        <input type="checkbox" data-bind="checkbox: {checked: isSharingWithPrivateLinkEnabled}, click: togglePrivateLinkSharing" />
                        Enable sharing story map with private link
                    </label>
                </div>

                <div class="control-group private-link" data-bind="visible: isSharingWithPrivateLinkEnabled">
                    {{#if privateLinkSharingFeatureAvailable}}
                    <div class="w-2-3 private-link-url-wrapper">
                        <input readonly="true" onclick="this.focus(); this.select();" type="text" data-bind="value: privateLinkUrl">
                    </div>
                    <div class="w-1-3 generate-token-button-wrapper">
                        <button type="button" class="btn-action-primary" data-bind="btnClick: generateNewPrivateLinkToken">Revoke & generate new</button>
                    </div>
                    <span class="help-block">Anyone who has the link can view the map in read-only mode. No sign-in required.</span>
                    <p class="info-text" data-bind="if: hasPrivateLinkCreationDetails">The private link was generated by <span data-bind="text: privateLinkCreatedByUser"></span> <span data-bind="timeago: privateLinkCreatedAt"></span>.</p>

                    <div class="control w-2-3">
                        <label>
                            <input type="checkbox" data-bind="checkbox: {checked: isPrivateLinkCommentingEnabled}, click: togglePrivateLinkCommenting" />
                            Enable commenting and discussion over private link access
                        </label>
                    </div>
                    {{/if}}

                    {{#ifnot privateLinkSharingFeatureAvailable}}
                    <div class="subscription-info-hint-in-dialog" style="display: block;">
                        Hint: Sharing your story map with a private link is not available in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
                    </div>
                    {{/ifnot}}
                </div>
            </div>
            {{/ifnot}}
        </div>
    </div>
</div>
</script>
<script type="text/html" id="storymap.carddetailsdialog:card-details-dialog">
{{#if izze}}
<div class="header">
    Card
    <div class="d-flex align-items-center justify-content-center header-buttons">
        {{#ifnot isReadOnlyAccessOfPublishedBoard}}
        <watch params="
                   isWatched: isWatched,
                   onWatch: onWatchCard,
                   onUnwatch: onUnwatchCard,
                   clickToWatchTooltip: 'Click to watch and receive notifications of the card changes',
                   clickToUnwatchTooltip: 'Click to stop receiving notifications of the card changes'
                   "></watch>
        {{/ifnot}}
        <copy-to-clipboard params="
                           valueToCopy:window.location.href
                           "></copy-to-clipboard>
        {{#ifnot isReadOnlyAccessOfPublishedBoard}}
        <copy-to-clipboard params="
                           valueToCopy:cardShareableUrl(),
                           isAlternativeIcon:true,
                           tooltipHtml:'Click to copy the shareable link to clipboard'
                           "></copy-to-clipboard>
        {{/ifnot}}
        <a class="btn-icon" data-bind="click: close">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
</div>

<handle-text-paste params="onPaste: handleUrlPaste"></handle-text-paste>

<file-uploader params="
        correlationId: fileUploaderCorrelationId,
        sendConfig: {
            url: '/UploadAttachment',
            extraFormData: { cardId: $root.id, storymapId: $root.storymapId }
        }
        dropZoneSelector: '.modal-dialog.card-details .modal-area',
        onSuccessUpload: onAttachmentUploadSucess">

    <div class="content">
        <div class="dialog_top">
            {{#if shouldShowCardAnnotations}}
            <multichoose-list-editor params="
                    items: $data.availableAnnotations,
                    selectedItems: $data.cardAnnotations,
                    canEdit: $data.canEditAnnotation,
                    isInEditModeWithKeyboard: $data.isAnnotationInEditModeWithKeyboard,
                    isInEditModeWithMouse: $data.isAnnotationInEditModeWithMouse,
                    onEndEdit: function(result) { $data.updateCardAnnotations.bind($data, result)() },
                    helperText: 'Start typing to add annotation. Reorder with Drag & Drop also supported.'
                "></multichoose-list-editor>
            {{/if}}

            {{#if shouldShowPersonas}}
            <multichoose-list-editor params="
                    items: $data.personas,
                    selectedItems: $data.selectedPersonas,
                    canEdit: $data.canEditPersonas,
                    isInEditModeWithKeyboard: $data.arePersonasInEditModeWithKeyboard,
                    isInEditModeWithMouse: $data.arePersonasInEditModeWithMouse,
                    onEndEdit: function(result) { $data.updateCardPersonas.bind($data, result)() },
                    helperText: 'Start typing to assign persona. Reorder with Drag & Drop also supported.'
                "></multichoose-list-editor>
            {{/if}}

            <div class="name_container card-details-dialog-card-title ">
                <div class="name_display" data-bind="inlineRestrictedMarkdownEditor: {
                    value: name,
                    inputClass: 'inline-input',
                    emptyText: $root.currentUserIsViewer() ? 'Untitled card' : 'Click or press T to add title.',
                    emptyClass: 'inline-text-empty',
                    editOnClick: $root.currentUserIsViewer() === false,
                    endEditOnEnterKey: true,
                    onStartEdit: function() { pubsub.publish(new viewmodels.storymap.CardTitleEditingStarted($root.id)); },
                    onEndEdit: function(event) { $root.saveName($root.name());  pubsub.publish(new viewmodels.storymap.CardTitleEditingFinished($root.id)); },
                    width: '100%',
                    autoresize:true,
                    editmode: $root.titleInEditMode
                    }">
                </div>
            </div>
        </div>

        <div class="dialog_left">
            <div class="description_container card-details-dialog-card-description">
                <rich-markdown-editor params="
                                          value: description,
                                          id: id,
                                          isInEditMode: $root.descInEditMode,
                                          isEditEnabled: $root.currentUserIsViewer()===false,
                                          hasMentions: false,
                                          fileUploadConfig:{
                                          url: '/UploadAttachment' ,
                                          extraFormData: { cardId: $root.id, storymapId: $root.storymapId },
                                          onSuccessUpload: onAttachmentUploadSucess
                                          },
                                          addAttachmentConfig: {
                                          onOpenFileUpload: openFileUploadByDescription,
                                          onWebLinkSave: saveWebLink,
                                          position: 'bottom'
                                          },
                                          isBoardCard: true,
                                          emptyTextWithTemplate:{
                                          textTemplate: 'Click or press D to add details. $0 is supported! <br/><br/>Embed your mockups, product videos or other resources (Figma, Youtube, Vimeo, Prezi)' ,
                                          links: [{ text: 'Markdown' , href: 'http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown' }],
                                          isVisible: $root.currentUserIsViewer()===false
                                          },
                                          onStartEdit: $root.startDescriptionEdit,
                                          onCancel: $root.cancelDescriptionEdit,
                                          onSave: $root.onSaveDescription,
                                          onOpenTemplateSettings: $root.onOpenTemplateSettings"></rich-markdown-editor>
            </div>


            <!-- ko if: hasAttachments -->
            <attachment-list params="
                     isEditEnabled: !$root.currentUserIsViewer(),
                     attachments: attachments,
                     isCommentingEnabledForCurrentUser: canCommentOnCard(),

                     onAddAttachment: openFileUpload,
                     onDeleteAttachment: onDeleteAttachment,
                     onNameChanged: onNameChanged,
                     onCommentClick: onCommentClick"></attachment-list>
            <!-- /ko -->
            <!-- ko if: hasWebLinks -->
            <weblink-list params="
                                 isEditEnabled: !$root.currentUserIsViewer(),
                                 webLinks: webLinks,
                                 isCommentingEnabledForCurrentUser: canCommentOnCard(),

                                 onAddWebLink: saveWebLink,
                                 onNameChange: changeWebLinkName,
                                 onDelete: deleteWebLink,
                                 onCommentClick: onWebLinkCommentClick"></weblink-list>
            <!-- /ko -->

            <card-comments params="
                   cardId: id,
                   cardName: name,
                   comments: comments,
                   isCommentingEnabledForCurrentUser: canCommentOnCard(),
                   isCurrentUserAdmin: currentUserIsAdmin(),
                   fileUploadConfig: {
                     url: '/UploadAttachment',
                     extraFormData: { cardId: $root.id, storymapId: $root.storymapId },
                     onSuccessUpload: onAttachmentUploadSucess
                   },
                   addAttachmentConfig: {
                     onOpenFileUpload: openFileUploadByComment,
                     onWebLinkSave: saveWebLink,
                     position: 'top'
                   }"></card-comments>

        </div>

        <div class="dialog_right">
            <div class="details-container">
                <!-- ko if: isSubtask()  && color() !== 99 -->
                <div class="details-row">
                    <label class="label-small">Status</label>

                    <!-- ko if: currentUserIsViewer() == false && (isIntegrationEnabled() == false || isLinkedToIntegratedToolsItem() == false)-->

                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger">
                            <span class="small-font board-subtask-statuses-menu-selected-option"
                                  style="color: white; left: 0; padding: 3px 6px; border-radius: 2px;"
                                  data-bind="style: { 'background-color': $data.status().color } ,text: $data.status().name | fit:30"></span>
                        </a>
                        <div class="menu-content left-aligned">
                            <ul data-bind="foreach: $root.allStatus">
                                <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: () => $root.saveStatus(key)">
                                    <div class="status-menu-item__color-box"
                                         data-bind="style: { 'background-color': color }"></div>
                                    <a class="ml-5" data-bind="text: name"></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- /ko -->
                    <!-- ko if: currentUserIsViewer() || (isIntegrationEnabled() && isLinkedToIntegratedToolsItem())   -->
                    <span class="small-font board-subtask-statuses-menu-selected-option"
                          style="position: static; display: inline-block; color: white; left: 0; padding: 3px 6px; border-radius: 2px;"
                          data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() }, style: { 'background-color': $data.status().color } ,text: $data.status().name | fit:25"></span>
                    <!-- /ko -->
                </div>
                <!-- /ko -->
                <!-- ko if: shouldShowAssignees() -->
                <div class="details-row" style="position: relative;">
                    <label class="label-small">Assignee</label>

                    <div data-bind="click: onOpenAssignee">{{assigneeName}}</div>

                    <context-menu params="{isOpen: isAssigneeDropdownOpen, direction: 'bottom'}">
                        <searchable-list params="
                                         items: assignees,
                                         excludedItemsWhenNotSearching: ko.computed(()=>
                            []),
                            searchKey: 'name' ,
                            initialNumberOfItems: 999,
                            extendedNumberOfItems: 999,
                            isLoading: ko.observable(false),
                            isLoadingCaption: 'Loading...',
                            searchFieldPlaceholder: 'Search for assignee...',
                            resultListCaption: 'Assignee',
                            itemsCaption: 'Assignee',
                            noMatchingResultsCaption: 'No matching assignee...'",
                            actions: []>
                            <a data-bind="click: () => $root.onAssigneeChanged($data)">{{name}}</a>

                        </searchable-list>
                    </context-menu>
                </div>
                <!-- /ko -->
                <!-- ko if: isSubtask() && (color() !== 99 || estimation() !== null) -->
                <div class="details-row">
                    <label class="label-small">Estimation</label>
                    <!-- ko ifnot: currentUserIsViewer() -->
                    <div data-bind="numericInput: true">
                        <div class="estimation-inline-text" data-bind="inlineTextArea: {
                        value: estimation,
                        type: 'input',
                        inputClass: 'estimation-inline-input',
                        emptyText: '?',
                        emptyClass: 'estimation-inline-text-empty',
                        editOnClick: $root.currentUserIsViewer() === false,
                        endEditOnEnterKey: true,
                        onEndEdit: function(isCanceled) { if (!isCanceled) { $root.saveEstimation($root.estimation()); }; },
                        width: '30px',
                        selectTextOnFocus:true,
                        autoresize:false,
                        unitString: $root.estimationUnit,
                        editmode: $root.estimationInEditMode,
                        maxlength: 16
                        }">
                        </div>
                    </div>
                    <!-- /ko -->
                    <!-- ko if: currentUserIsViewer() -->
                    <div data-bind="text:estimation"></div>
                    <!-- /ko -->
                </div>
                <div class="details-row">
                    <label class="label-small">Release</label>
                    {{#ifnot currentUserIsViewer()}}
                    <div id="card-details-release-select" data-bind="inlineSelect: { value: release, options: availableReleases, textField: 'displayName', afterSelect: changeRelease.bind($root) }"></div>
                    {{/ifnot}}
                    {{#if currentUserIsViewer()}}
                    <div id="card-details-release-text" data-bind="text: release().displayName"></div>
                    {{/if}}
                </div>
                <!-- /ko -->
                <div class="details-row">
                    <label class="label-small">Created by</label>
                    <div data-bind="text: createdBy"></div>
                </div>
                <div class="details-row">
                    <label class="label-small">Created</label>
                    <div data-bind="timeago: createdAt"></div>
                </div>
                <div class="details-row">
                    <label class="label-small">Card color</label>
                    <div class="card-type">
                        <div data-bind="click: $root.openColorEditor">
                            <div class="color-box-small" data-bind="css: selectedCardTypeCss"></div>
                            <div class="card-color-label" data-bind="text: selectedCardTypeName"></div>
                        </div>
                        {{#template 'templates:coloreditor'/}}
                    </div>
                </div>
                {{#ifnot isReadOnlyAccessOfPublishedBoard}}
                {{#if canBeLinkedToIntegrationTool}}
                <div class="details-row">

                    {{#if isLinkedToIntegratedToolsItem() ||  !isTransparentAnnotation() }}
                    <label class="label-small">Integration</label>
                    {{/if}}

                    {{#if isLinkedToIntegratedToolsItem}}
                    <div>
                        Linked to <a data-bind="attr: { href: linkedIntegratedToolsItemLink(), target: '_blank' }"><span data-bind="text: integrationToolName()"></span></a>
                    </div>
                    {{/if}}
                    {{#ifnot isTransparentAnnotation}}
                    {{#ifnot isLinkedToIntegratedToolsItem}}
                    <div>
                        {{#if currentUserIsViewer() }}
                        Not linked to <span data-bind="text: integrationToolName()"></span> item
                        {{/if}}
                        {{#ifnot currentUserIsViewer() }}
                        Click <a data-bind="click: pushCardToIntegratedTool">here</a> to push to <span data-bind="text: integrationToolName()"></span>
                        {{/ifnot}}
                    </div>
                    {{/ifnot}}
                    {{/ifnot}}
                </div>
                {{/if}}
                {{/ifnot}}
            </div>
            </div>

            <div class="separator"></div>
        </div>

    </file-uploader>


    <div class="footer">
        <div class="pull-left">
            {{#if canEditAnnotation() && !hasCardAnnotations() && color() !== 99}}
            <a data-bind="click: editAnnotationWithMouse">add annotation</a>
            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
            {{/if}}

            {{#if !currentUserIsViewer() && shouldShowPersonas() && $root.personas().length > 0 && !$root.hasCardPersonas() && color() !== 99  }}
            <a data-bind="click: function() {$data.isPersonaEditorVisible(true); $data.arePersonasInEditModeWithMouse(true); }">assign persona</a>
            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
            {{/if}}

            {{#if isCommentingProTipVisible}}
            <span class="pro-tip">
                ProTip &nbsp;
                <a data-bind="click: close, triggerClickOnElement: {selector: '.signup-dropdown > a', delay: 300}">Sign up</a> or
                <a data-bind="click: close, triggerClickOnElement: {selector: '.login-dropdown > a', delay: 300}">log in</a> to add your own comments. It only takes a few seconds.
            </span>
            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
            {{/if}}

            <!-- ko ifnot: currentUserIsViewer() -->
            <!-- ko if: showAddAttachment -->
            <add-attachment params="toggleMenuCaption: 'add attachment', onOpenFileUpload: openFileUpload, onWebLinkSave: saveWebLink"></add-attachment>
            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
            <!-- /ko -->
            <!-- ko if: isSubtaskButNotUnscheduled()  && color() !== 99 -->
            <a data-bind="click: unscheduleCard">unschedule card</a>
            <span class="link-btn-separator"> &nbsp;|&nbsp; </span>
            <!-- /ko -->
            <a data-bind="click: deleteCard">delete card</a>
            <!-- /ko -->
        </div>
    </div>
    {{/if}}
</script>
<script type="text/html" id="storymap.corporate-lincese-missing">     <div class="header">
        Request a corporate license
        <a class="btn-icon" data-bind="closeModal: function() {}">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <p data-bind="megamark: {value: instructions}">
        </p>
    </div>
    <div class="footer left">
        <button class="btn-view btn-action-primary" data-bind="click: app.modal.closeCurrentOpened">Continue</button>
    </div>
</script>
<script type="text/html" id="storymap.exportdialog"> <track-page params="page: track.StorymapExport"></track-page>

<div class="header">
    Export & print
    <a class="btn-icon" data-bind="closeModal:true">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <div class="description">
        Save your story map in the file format you like. We support xlsx, png, pdf.
    </div>
    <form>
        <div class="control-group export-option-row">
            <div class="control">
                <label class="export-option">
                    <input type="radio" name="exportType" value="xlsx" data-bind="checked: exportType, radio:true">
                    Export to Office Open XML Workbook (XLSX) file
                </label>
                {{#if showExcelExportFeatureNotAvaliable}}
                <div class="export-suboption-first subscription-info-hint-in-dialog" data-bind="slideVisible: exportType() == 'xlsx'">
                    Hint: Excel export feature not avaliable in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
                </div>
                {{/if}}
                {{#ifnot showExcelExportFeatureNotAvaliable}}
                <div class="export-suboption-first" data-bind="slideVisible: exportType() == 'xlsx'">
                    <label class="export-suboption">
                        Format:
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="xlsxFormat" value="backlog" data-bind="checked: xlsxFormat, radio:true">
                        Backlog
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="xlsxFormat" value="map" data-bind="checked: xlsxFormat, radio:true">
                        Map
                    </label>
                    <br>
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeArchivedReleases}">
                        Include archived releases
                    </label>
                    <br>
                    <label class="export-suboption" data-bind="visible: xlsxFormat() == 'map'">
                        <input type="checkbox" data-bind="checkbox: {checked: includeStatuses}">
                        Include subtask statuses (as colored left borders)
                    </label>
                    <br>
                    <label class="export-suboption" data-bind="visible: xlsxFormat() == 'map'">
                        <input type="checkbox" data-bind="checkbox: {checked: includeEstimation}">
                        Include estimation (as prefix in title)
                    </label>
                </div>
                {{/ifnot}}
            </div>
        </div>
        <div class="control-group export-option-row">
            <div class="control">
                <label class="export-option">
                    <input type="radio" name="exportType" value="png" data-bind="checked: exportType, radio:true">
                    Export to PNG image file
                </label>
                <div class="export-suboption-first" data-bind="slideVisible: exportType() == 'png'">
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeArchivedReleases}">
                        Include archived releases
                    </label>
                    <br>
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeStatuses}">
                        Include subtask statuses (as colored left borders)
                    </label>
                    <br>
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeEstimation}">
                        Include estimation (as prefix in title)
                    </label>
                </div>
            </div>
        </div>
        <div class="control-group export-option-row">
            <div class="control">
                <label class="export-option">
                    <input type="radio" name="exportType" value="pdf" data-bind="checked: exportType, radio:true">
                    Export to multi page PDF file for printing
                </label>

                <div class="export-suboption-first" data-bind="slideVisible: exportType() == 'pdf'">
                    <div>
                        <label class="export-suboption-pagesize" style="vertical-align: top;">
                            Page size
                            <select data-bind="options: ['Letter','A4','A3'], value: selectedPageSize, select: true"></select>
                            <span class="validation-message"></span>
                        </label>
                        <label class="export-suboption" style="vertical-align: top;">
                            Top & bottom margin (mm): <input type="text" name="export-subotion" data-bind="value:topMargin">
                            <span class="validation-message" data-bind="validationMessage: topMargin"></span>
                        </label>
                        <label class="export-suboption" style="vertical-align: top;">
                            Left & right margin (mm): <input type="text" name="export-subotion" data-bind="value:leftMargin">
                            <span class="validation-message" data-bind="validationMessage: leftMargin"></span>
                        </label>
                    </div>
                    <br />
                    <label class="export-suboption">
                        Cards per page:
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="extra-large" data-bind="checked: pdfCardPerPage, radio:true">
                        3x3
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="large" data-bind="checked: pdfCardPerPage, radio:true">
                        4x4
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="normal" data-bind="checked: pdfCardPerPage, radio:true">
                        5x5
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="medium" data-bind="checked: pdfCardPerPage, radio:true">
                        6x6
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="small" data-bind="checked: pdfCardPerPage, radio:true">
                        7x7
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="extra-small" data-bind="checked: pdfCardPerPage, radio:true">
                        8x8
                    </label>
                    <label class="export-suboption">
                        <input type="radio" name="pdfCardPerPage" value="ultra-small" data-bind="checked: pdfCardPerPage, radio:true">
                        9x9
                    </label>
                    <br /><br />
                    <label class="export-msg">
                        You will print <span class="printed-pages-cnt" data-bind="text:pdfExportPageCount"></span> pages with the current settings.
                    </label>
                    <br>
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeStatuses}">
                        Include subtask statuses (as colored left borders)
                    </label>
                    <br>
                    <label class="export-suboption">
                        <input type="checkbox" data-bind="checkbox: {checked: includeEstimation}">
                        Include estimation (as prefix in title)
                    </label>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="footer left">
    {{#ifnot exportType() == 'xlsx' && showExcelExportFeatureNotAvaliable}}
    <button type="submit" class="btn-action-primary" data-bind="fileDownloadButton: {
            url: exportUrl,
            csrfTokenKey: globalConfig.csrfTokenHeaderKey,
            currentCsrfToken: globalConfig.currentCsrfToken,
            onSuccess: onSuccessfulExport.bind($root),
            onFail:  function(html, url, failReason) { app.flash.showError(failReason != undefined ? failReason : 'Sorry, something went wrong. Please try again later.'); }
        }">
        Export
    </button>
    {{/ifnot}}
    <!--<button type="button" class="btn-action" data-bind="click: function() {app.modal.closeCurrentOpened();}">Close</button>-->
</div>
</script>
<script type="text/html" id="storymap.github-expiredauthentication:github-token">
    <div class="header">
        GitHub authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    
    {{#if parentModel.currentUserIsOriginallyAdmin }}
    <!--Adminoknak szl, tokent kr ablak-->
    <div class="content">
        <p>Your GitHub personal access token has expired.</p>
        <br />
        <p>To make changes on this story map you need to provide a new personal access token from GitHub first. <br />Collaborators can't make changes on this story map until that.</p>
        <br />
        <br />
        <div class="control-group">
            <div class="control">
                <label>
                    Personal access token
                    <input tabindex="2" type="text" data-bind="value: personalAccessToken, hasFocus: true">
                </label>
                <span class="validation-message" data-bind="validationMessage: personalAccessToken"></span>
                <span class="help-block">Your token must have [repo] scope enabled. <a href="" data-bind="attr: {href: gitHubPersonalAccessTokenUrl}" target="_blank">Create a Personal access token</a></span>
            </div>
        </div>
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateWithPersonalAccessToken">Authenticate</button>
        <button class="btn-action" data-bind="click: continueInViewOnlyMode, visible: showContinueInReadOnlyModeButton">Continue in read-only mode</button>
        <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened, visible: showLaterButton">Later</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable GitHub integration</a>
    </div>
    {{/if}}
    
    {{#ifnot parentModel.currentUserIsOriginallyAdmin }}
    <!--Editornak szl, tokent nem kr ablak-->
    <div class="content">
        <p>This storymap is integrated with GitHub, but the authentication token has expired.</p>
        <br />
        <p>To make changes on this storymap, the authentication token needs to be renewed.<br/>
            Please ask a storymap administrator to re-authenticate.</p>
        <br />
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: continueInViewOnlyMode">Continue in read-only mode</button>
    </div>
    {{/ifnot}}


</script>
<script type="text/html" id="storymap.github-expiredauthentication:jiraoauth"></script>
<script type="text/html" id="storymap.impersonation:jira-auth">
    <div class="header">
        {{#if isOpenedManually}}Authenticate in Jira{{/if}}
        {{#ifnot isOpenedManually}}Jira authentication required{{/ifnot}}
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    <div class="content">
        <p>            
            {{#if: isTriggeredByAnotherUser}}
            <span class="warning-text">{{triggererUser}} has just enabled impersonation in Jira.</span>
            {{/if}}
            {{#ifnot: isTriggeredByAnotherUser}}
            This story map is integrated with Jira and impersonation is also enabled. 
            {{/ifnot}}
            This means that all changes you make on the story map will be synchronized to Jira on behalf of your account.</p>
        <br />
        <p>To make changes on this story map you need to authenticate in Jira first. Unauthenticated collaborators can't make changes on this story map.</p>
        <br />  
    </div>

    <div class="footer left">
        {{#if isJiraCloud}}
            <jira-oauth2-connector params="successCallback: oauth2Success, isAlreadyAuthenticated: false"></jira-oauth2-connector>
        {{/if}}
        {{#ifnot isJiraCloud}}
            <button class="btn-action-primary" data-bind="click: initiateOauth">Authenticate in Jira</button>
        {{/ifnot}}

        {{#ifnot isOpenedManually}}
        <button class="btn-action" data-bind="click: authenticateLater">Later</button>
        <a data-bind="click: dontRemindMe">Don't remind me</a>
        {{/ifnot}}
    </div>
</script>
<script type="text/html" id="storymap.impersonation:jiraoauth"></script>
<script type="text/html" id="storymap.jira-expiredauthentication:jira-auth">
    <div class="header">
        Jira authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>


    {{#if: canAuthenticate}}
    <div class="content">
        <p>
            Your Jira authentication token has expired.
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Jira first.{{#if: parentModel.currentUserIsOriginallyAdmin}} Please note that the collaborators of this storymap also cannot make any changes until the successful renewal of authentication token.{{/if}}</p>
        <br />
    </div>

    <div class="footer left">
        {{#if isJiraCloud}}
            <jira-oauth2-connector params="successCallback: oauth2Success, isAlreadyAuthenticated: false"></jira-oauth2-connector>
        {{/if}}
        {{#ifnot isJiraCloud}}
            <button class="btn-action-primary" data-bind="click: initiateOauth">Authenticate in Jira</button>
        {{/ifnot}}

        <button class="btn-action" data-bind="click: authenticateLater">Continue in read-only mode</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable Jira integration</a>
    </div>
    {{/if}}


    {{#ifnot: canAuthenticate}}
    <div class="content">
        <p>
            This storymap is integrated with Attlassian Jira, but unfortunately the autentication token is expired.
        </p>
        <br />
        <p>To make changes on this storymap the authentication token need to be renewed. <br />Please ask a storymap admin to reauthenticate.</p>
        <br />
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateLater">Continue in read-only mode</button>
    </div>
    {{/ifnot}}

</script>
<script type="text/html" id="storymap.jira-expiredauthentication:jiraoauth">
</script>
<script type="text/html" id="storymap.jira-import-failed-dialog"> <div class="header">
    Welcome to your story map
    <a class="btn-icon" data-bind="closeModal: function() {}">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <p style="line-height: 1.5">
        Your story map is successfully created but the import process failed.
    </p>
    <br />
    <p class="warning-text">
        {{message}}
    </p>
</div>
<div class="footer left">
    <button class="btn-view btn-action-primary p" data-bind="click: app.modal.closeCurrentOpened">View Storymap</button>
</div></script>
<script type="text/html" id="storymap.move-storymap-confirm"> <div class="header">Confirmation</div>
<div class="content">
    <div>
        <div class="confirm-messages">
            You can transfer your story map to any <strong>non-trial</strong> workspace where you have the necessary permissions to create one.<br>
            <span class="warning-text">After moving this story map to a new workspace it won't be accessible with it's current URL anymore.</span><br />
            <span class="warning-text">Also please note that every collaborator of the story map will be removed, existing integration settings will be permanently deleted and the sharing options will be reset to their default values.</span><br />
        </div>

        <div class="control-group move-to-workspace">
            <div class="control">
                <label>
                    To which workspace would you like to transfer your story map?
                </label>
                <select data-bind="options: parentModel.otherManagedWorkspaces, optionsText: 'workspaceName', value: parentModel.workspaceToMoveStorymap, select: true, optionsAfterRender: parentModel.setTrialWorkspacesDisabled, optionsCaption: 'Please choose a workspace'"></select>
            </div>
            <div class="control">
                <span class="validation-message" data-bind="validationMessage: parentModel.workspaceToMoveStorymap"></span>
            </div>
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn-action-primary" data-bind="inlineConfirm: ['Transfer story map', 'Are you really sure?', 'Transferring story map'], submitFunction: function() { $data.parentModel.moveStorymap($data) }, showTimer: 'true'"></button>
    <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Cancel</button>
</div></script>
<script type="text/html" id="storymap.pivotal-expiredauthentication:pivotal-token">
    <div class="header">
        Pivotal Tracker authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    
    {{#if parentModel.currentUserIsOriginallyAdmin }}
    <!--Adminoknak szl, tokent kr ablak-->
    <div class="content">
        <p>Your Pivotal Tracker personal access token has expired.</p>
        <br />
        <p>To make changes on this story map you need to provide a new personal access token from Pivotal Tracker first. <br />Collaborators can't make changes on this story map until that.</p>
        <br />
        <br />
        <div class="control-group">
            <div class="control">
                <label>
                    Personal access token
                    <input tabindex="2" type="text" data-bind="value: personalAccessToken, hasFocus: true">
                </label>
                <span class="help-block"><a href="" data-bind="attr: { href: globalConfig.helpLinkPivotalTrackerApiToken }" target="_blank">Where can I find my API Token?</a></span>
                <span class="validation-message" data-bind="validationMessage: personalAccessToken"></span>
            </div>
        </div>
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateWithPersonalAccessToken">Authenticate</button>
        <button class="btn-action" data-bind="click: continueInViewOnlyMode, visible: showContinueInReadOnlyModeButton">Continue in read-only mode</button>
        <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened, visible: showLaterButton">Later</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable Pivotal Tracker integration</a>
    </div>
    {{/if}}
    
    {{#ifnot parentModel.currentUserIsOriginallyAdmin }}
    <!--Editornak szl, tokent nem kr ablak-->
    <div class="content">
        <p>This storymap is integrated with Pivotal Tracker, but the authentication token has expired.</p>
        <br />
        <p>To make changes on this storymap, the authentication token needs to be renewed.<br/>
            Please ask a storymap administrator to re-authenticate.</p>
        <br />
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: continueInViewOnlyMode">Continue in read-only mode</button>
    </div>
    {{/ifnot}}


</script>
<script type="text/html" id="storymap.pivotal-expiredauthentication:jiraoauth"></script>
<script type="text/html" id="storymap.private-link-shared-storymap:onboard-dialog">
    <div class="header">
        Welcome to "{{storymapName}}"
        <a class="btn-icon" data-bind="closeModal: function() {}">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
    <div class="content">
        <p>
            {{storymapSharedBy}} shared the product vision of "{{storymapName}}" with you.
        </p>
        {{#if commentingEnabled}}
        <p class="pro-tip">
            <strong>ProTip</strong>
            After a quick sign up process, you can give feedbacks to {{storymapSharedBy}} by commenting on cards.
        </p>
        {{/if}}
    </div>
    <div class="footer left">
        <button class="btn-view btn-action-primary" data-bind="click: app.modal.closeCurrentOpened">View</button>
    </div>
</script>
<script type="text/html" id="storymap.releasedetailsdialog:release-details-dialog">
    <div class="header">
        Release
        <div class="header-buttons">
            {{#ifnot isReadOnlyAccessOfPublishedBoard}}
            <watch params="
                   isWatched: isWatched,
                   onWatch: onWatchRelease,
                   onUnwatch: onUnwatchRelease,
                   clickToWatchTooltip: 'Watch card changes in this release',
                   clickToUnwatchTooltip: 'Stop watching this release'
                           "></watch>
            {{/ifnot}}

            <copy-to-clipboard params="
                           valueToCopy:window.location.href
                           "></copy-to-clipboard>
            <a class="btn-icon" data-bind="click: close">
                <i class="icon-close-dialog"></i>
            </a>
        </div>
    </div>

    <div class="content">

        <div class="dialog_top">
            <div class="name_container release-details-dialog-release-title ">
                {{#ifnot isStatusReportVisible}}
                <track-page params="page: track.StorymapReleaseDetails"></track-page>
                {{/ifnot}}
                <div class="release-details-prefix" data-bind="text: displayPrefix"></div>
                <div class="name_display" data-bind="inlineRestrictedMarkdownEditor: {
                    value: name,
                    inputClass: 'inline-input',
                    emptyText: currentUserIsViewer ? 'Untitled release' : 'Click to add title.',
                    emptyClass: 'inline-text-empty',
                    editOnClick: currentUserIsViewer === false,
                    endEditOnEnterKey: true,
                    onEndEdit: saveName.bind($root),
                    width: '65%',
                    autoresize:true,
                    editmode: $root.nameInEditMode
                    }">
                </div>
            </div>
        </div>

        {{#if isGoalsVisible}}
        <div class="dialog_left goals">
            <div class="description_container release-details-dialog-release-description">                
                <rich-markdown-editor params="
                              value: goal,
                              id: editorId,
                              isInEditMode: goalInEditMode,
                              hasMentions: false,
                              isEditEnabled: currentUserIsViewer === false,
                              emptyText: descEmptyText,
                              isBoardCard: false,
                              onSave: saveGoal"></rich-markdown-editor>
                    
            </div>
        </div>
        {{/if}}
        
        {{#if isStatusReportVisible}}
        <div class="dialog_left status-report">
            
            <div class="status-report-title">
                <div class="status-report-title-text">Release status report</div>
                <track-page params="page: track.StorymapReleaseReports"></track-page>

                <div class="status-report-title-buttons">
                    {{#if showCardsInStatusReport}}
                    <a class="disabled">by cards</a>
                    <span class="separator">|</span>
                    <a data-bind="click: showStatusReportWithEstimates">by estimated effort</a>
                    {{/if}}
                    {{#if showEstimatesInStatusReport}}
                    <a class="disabled">by estimated effort</a>
                    <span class="separator">|</span>
                    <a data-bind="click: showStatusReportWithCards">by cards</a>
                    {{/if}}
                </div>            
            </div>
            
            {{#ifnot statusReport.doesEveryCardHaveEstimate || showCardsInStatusReport}}
            <div class="missing-estimates-warning">
                Hint: Some cards in this release haven't been estimated yet. Click <a data-bind="click: showCardsWithMissingEstimatesOnBoard">here</a> to find them.
            </div>
            {{/ifnot}}

            <div class="status-report-details">
                <div class="status-report-chart" data-bind="pieChart: {data: statusReport.chartData, borderColor: '#f9f9f9', tooltipTemplateName: 'storymap.releasedetailsdialog:chart-tooltip', onClick: applyFilterOnBoard.bind($data)}"></div>
            </div>
        </div>
        {{/if}}
        

        <div class="dialog_right">
            <div class="details-container">

                <div class="details-row datepicker-container">
                    <label class="label-small">Start date</label>
                    <!-- ko ifnot: currentUserIsViewer -->

                    <div data-bind="datepicker: {
                            value: startDate,
                            onEndEdit: saveStartDate.bind($root),
                            editmode: startDateInEditMode,
                            validationMethod: isDateRangeValid
                        }"></div>
                    <span class="validation-message" data-bind="validationMessage: startDate"></span>
                    <!-- /ko -->
                    <!-- ko if: currentUserIsViewer -->
                    <div data-bind="text:startDateToDisplay"></div>
                    <!-- /ko -->
                </div>


                <div class="details-row datepicker-container">
                    <label class="label-small">Release date</label>
                    <!-- ko ifnot: currentUserIsViewer -->
                    <div data-bind="datepicker: {
                            value: releaseDate,
                            onEndEdit: saveReleaseDate.bind($root),
                            editmode: releaseDateInEditMode,
                            validationMethod: isDateRangeValid
                        }"></div>
                    <span class="validation-message" data-bind="validationMessage: releaseDate"></span>
                    <!-- /ko -->
                    <!-- ko if: currentUserIsViewer -->
                    <div data-bind="text:releaseDateToDisplay"></div>
                    <!-- /ko -->
                </div>

                <div class="details-row">
                    <label class="label-small">Status</label>
                    <!-- ko if: currentUserIsViewer == false -->
                    <div class="release-details-status-select" data-bind="inlineSelect: { value: status, options: statuses, textField: 'name', afterSelect: saveStatus.bind($root) }"></div>
                    <!-- /ko -->
                    <!-- ko if: currentUserIsViewer -->
                    <div data-bind="text: status().name"></div>
                    <!-- /ko -->
                </div>

                {{#ifnot isReadOnlyAccessOfPublishedBoard}}
                {{#if isIntegrationEnabled}}
                <div class="details-row">
                    <label class="label-small">Integration</label>
                    {{#if isLinkedToIntegratedToolsItem}}
                    <div>
                        Linked to <a data-bind="attr: { href: linkedItemUrl, target: '_blank' }"><span data-bind="text: integrationToolName"></span></a>
                    </div>
                    {{/if}}
                    {{#ifnot isLinkedToIntegratedToolsItem}}
                    <div class="detail-value">
                        {{#if currentUserIsViewer }}
                        Not linked to <span data-bind="text: integrationToolName"></span> item
                        {{/if}}
                        {{#ifnot currentUserIsViewer }}
                        Click <a data-bind="click: pushReleaseToIntegratedTool">here</a> to push to <span data-bind="text: integrationToolName"></span>
                        {{/ifnot}}
                    </div>
                    {{/ifnot}}
                </div>
                {{/if}}
                {{/ifnot}}

                <div class="status-report-statuses">

                    <!--<div class="description"></div>-->
                    <div class="status-report-status-list" data-bind="css: {byCard: showCardsInStatusReport, byEstimate: showEstimatesInStatusReport}">
                        <div class="status-list-row">
                            <div class="status-list-label label-small"><a data-bind="click: showCardsOnBoard">All cards</a></div>
                            <div class="status-list-value">
                                {{#ifnot showEstimatesInStatusReport}}<span class="number">{{statusReport.numberOfCards}}</span> <span class="estimation-unit">card(s)</span>{{/ifnot}}
                                {{#if showEstimatesInStatusReport}}<span class="number">{{statusReport.sumEstimateOfCards}}</span>  <span class="estimation-unit">{{estimationUnit | fit: 12}}</span>{{/if}}
                            </div>
                        </div>

                        {{#foreach statusReport.statusesWithCategories}}
                        <div class="status-list-row">
                            <div class="status-list-label label-small"><a data-bind="click: $parent.showCardsOfStatusCategoryOnboard">{{name}}</a></div>
                            <div class="status-list-value">
                                {{#ifnot $parent.showEstimatesInStatusReport}}<span class="number">{{numberOfCards}}</span> <span class="estimation-unit">card(s)</span>{{/ifnot}}
                                {{#if $parent.showEstimatesInStatusReport}}<span class="number">{{sumEstimation}}</span>  <span class="estimation-unit">{{$parent.estimationUnit | fit: 12}}</span>{{/if}}
                            </div>
                        </div>

                        {{#foreach statuses}}
                        <div class="status-list-row sub-status">
                            <div class="status-list-label label-small"><a data-bind="click: $parents[1].showCardsOfStatusOnboard">{{name}}</a></div>
                            <div class="status-list-value">
                                {{#ifnot $parents[1].showEstimatesInStatusReport}}<span class="number">{{numberOfCards}}</span> <span class="estimation-unit">card(s)</span>{{/ifnot}}
                                {{#if $parents[1].showEstimatesInStatusReport}}<span class="number">{{sumEstimateOfCards}}</span>  <span class="estimation-unit">{{$parents[1].estimationUnit | fit: 12}}</span>{{/if}}
                            </div>
                        </div>
                        {{/foreach}}
                        {{/foreach}}

                    </div>
                </div>
            </div>
        </div>

        <div class="separator"></div>
    </div>

    <div class="footer">
        <div class="pull-left">
            {{#if isStatusReportVisible}}
                <a data-bind="click: showGoals, changeUrlQueryTo: null">release goal & details</a>
            {{/if}}
            {{#if isGoalsVisible}}
                <a data-bind="click: showStatusReport">release status report</a>
            {{/if}}
        </div>
    </div>
</script>
<script type="text/html" id="storymap.releasedetailsdialog:chart-tooltip">
    <span class="tooltip-key" data-bind="style: {'background-color': color}"></span>
    {{#if percent > 0}}
        <div class="tooltip-main">
            <span class="caption">{{caption}}:</span>
            {{percent}}%
        </div>
        {{#ifnot hideValueInTooltip}}
            <div class="tooltip-sub">{{value}} {{unit}}</div>
        {{/ifnot}}
    {{/if}}
    {{#if percent == 0}}
        <div class="tooltip-main">
            <span class="caption">{{caption}}</span>
            {{#ifnot hideValueInTooltip}}
                : {{value}} {{unit}}
            {{/ifnot}}
        </div>
    {{/if}}

    <div class="tooltip-click">Click to view on board</div>
</script>
<script type="text/html" id="storymap.settingsdialog:settings-dialog-general-tab">
            <track-page params="page: track.StorymapBoardSettings"></track-page>
            <form>
                <div class="control-group url-control">
                    <div class="control w-3-3">
                        <label>Url</label>
                        <span class="url-block" data-bind="text: url"></span>
                        <a class="url-edit-link" data-bind="click: editUrl, visible: !isInUrlEditMode()">change</a>
                        <input type="text" class="slug-edit" data-bind="value: slug, visible: isInUrlEditMode, focusSelect: isInUrlEditMode" />
                        <span class="validation-message slug-validation-message" data-bind="validationMessage: slug, visible: isInUrlEditMode"></span>
                    </div>
                    <div class="url-edit-block" data-bind="visible: isInUrlEditMode">
                        <div class="url-edit-warning">
                            Please consider that by changing the url of your story map, you will break existing
                            bookmark links! If you really want to continue, press change button. After pressing
                            change, you will be redirected to the new URL.
                        </div>
                        <button type="submit" class="btn-action-primary" data-bind="btnClick: changeUrl">Change</button>
                        <button type="button" class="btn-action" data-bind="btnClick: cancelEdit">Cancel</button>
                    </div>
                </div>
            </form>
            <form>
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Name
                            <input type="text" data-bind="value: name" tabindex="1" maxlength="200">
                        </label>
                        <span class="help-block">Name can't be longer than 200 character.</span>
                    </div>
                    <div class="control w-2-3" style="position: relative">
                        <span class="validation-message" data-bind="validationMessage: name"></span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Description
                            <textarea data-bind="value: description"></textarea>
                        </label>
                        <span class="help-block">Description is optional.</span>
                    </div>
                    <div class="control w-2-3" style="position: relative"></div>
                </div>
                {{#if hasCollections() && !$root.isTemplate}}
                <div class="control-group">
                    <div class="control w-2-3">
                        <label>
                            Collection
                            <select class="collection-select-component" data-bind="options: collections, optionsText: 'truncatedName', value: $root.selectedCollection, optionsCaption: 'Choose collection', select: true"></select>
                        </label>
                        <span class="help-block">Collections help you organize your story maps</span>
                    </div>
                    <div class="control w-2-3" style="position: relative"></div>
                </div>
                {{/if}}
                <div class="control-group">
                    <div class="control w-1-3">
                        <label>
                            Estimation Unit
                            <input type="text" data-bind="value: estimationUnit">
                        </label>
                        <span class="help-block">Estimation Unit is optional.</span>
                    </div>
                </div>
                <div class="footer">
                    <!-- <button type="button" class="btn-action" data-bind="click: function() {app.modal.closeCurrentOpened();}">Close</button>-->
                </div>
            </form>

            <div class="button_container">
                <button type="submit" class="btn-action-primary" data-bind="btnClick: save">Save</button>
                {{#if countOfTrashedItems() > 0}}
                <button type="submit" class="btn-action" data-bind="btnClick: emptyTrashbin">Empty trash bin ({{countOfTrashedItems}})</button>
                {{/if}}
            </div>
</script>
<script type="text/html" id="storymap.settingsdialog"> 
<div class="header">
    Settings
    <a class="btn-icon" data-bind="closeModal:true">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    {{#if parentModel.isTemplate}}
    <!-- ko template: {name: 'storymap.settingsdialog:settings-dialog-general-tab'} --><!-- /ko -->
    {{/if}}

    {{#ifnot parentModel.isTemplate}}
    <div class="metro-pivot" data-bind="metroPivot: { startIndex: startTabIndex }">
        <div class="pivot-item">
            <h3>General</h3>
            <div>
                <!-- ko template: {name: 'storymap.settingsdialog:settings-dialog-general-tab'} --><!-- /ko -->
            </div>
        </div>

        {{#if false}}
        <div class="pivot-item integration-settings">
            <h3>Issue tracker integration</h3>
            <track-page params="page: track.StorymapIssueTrackerSettings"></track-page>
            {{#if showIntegrationFeatureNotAvaliable}}
            <div class="subscription-info-hint-in-dialog">
                Hint: Issue tracker integration not avaliable in the current Basic subscription plan. Please upgrade to the Standard subscription plan to use this feature.
            </div>
            <br /><br />
            {{/if}}
            {{#ifnot showIntegrationFeatureNotAvaliable}}
            <div data-bind="template: {name: toolSettingsTemplate()}"></div>
            <div class="button_container">
                <button type="submit" class="btn-action-primary" data-bind="visible: isSaveButtonVisible, btnClick: saveToolSettings">Save</button>
                <button type="submit" class="btn-action" data-bind="visible: isImportButtonVisible, btnClick: importCards">Import new cards</button>

            </div>
            {{/ifnot}}
        </div>
        <div class="pivot-item chat-integration-settings">
            <h3>Team chat integration</h3>
            <track-page params="page: track.StorymapTeamChatSettings"></track-page>
            {{#if showTeamChatIntegrationFeatureNotAvaliable}}
            <div class="subscription-info-hint-in-dialog">
                Hint: Team chat integration not avaliable in the current subscription plan. Please upgrade your subscription plan to use this feature.
            </div>
            <br /><br />
            {{/if}}
            {{#ifnot showTeamChatIntegrationFeatureNotAvaliable}}
            <form>
                <fieldset>
                    <legend>Event notifications</legend>
                    <span class="legend-description">Send event notifications when...</span>
                    <div class="control-group" data-bind="foreach: visibleNotificationEvents">
                        <div class="control w-1-2">
                            <label>
                                <input type="checkbox" data-bind="checkbox: {checked: selected}" />
                                {{caption}}
                            </label>
                        </div>
                    </div>

                    <div class="event-notification-buttons">
                        <a data-bind="click: function() {selectAllNotificationEvents(true)}">select all</a>
                        <a data-bind="click: function() {selectAllNotificationEvents(false)}">select none</a>
                    </div>
                </fieldset>
                <div class="button_container">
                    <button data-bind="btnClick: saveEventNotifications" class="btn-action-primary">Save</button>
                </div>

                <fieldset>
                    <legend>Integration</legend>

                    <div class="chat-integration-details" data-bind="ifnot: chatToolSettings.showSettings">
                        Integration is configured with <strong data-bind="text: selectedChatTool().name"></strong><span class="disabled_warning" data-bind="if: !chatToolSettings.isEnabled()"> (Integration is disabled)</span>.
                        <div>
                            <a data-bind="click: toggleChatToolIntegrationEnabled, text: chatToolSettings.isEnabled() ? 'disable integration' : 'enable integration'"></a>
                            <a data-bind="click: function() { chatToolSettings.showSettings(true); }">edit integration settings</a>
                            <a data-bind="click: deleteChatToolIntegration">delete integration</a>
                        </div>
                    </div>

                    <div class="chat-integration-details" data-bind="if: chatToolSettings.showSettings">
                        <div class="control-group">
                            <div class="control">
                                {{#ifnot chatToolSettings.isConnected}}
                                <label>
                                    Select a tool to integrate with
                                    <select data-bind="disable: chatToolSettings.isConnected, options: chatTools, optionsText: 'name', value: selectedChatTool, select: true"></select>
                                </label>
                                {{/ifnot}}
                                {{#if chatToolSettings.isConnected}}
                                Integration is configured with <strong data-bind="text: selectedChatTool().name"></strong>
                                <br /><br />
                                {{/if}}
                            </div>
                        </div>

                        <div data-bind="template: {name: selectedChatTool().settingsTemplateName}"></div>
                    </div>
                </fieldset>
                {{#ifnot chatToolSettings.isConnected}}
                <div class="button_container" data-bind="if: chatToolSettings.showSettings() && selectedChatTool().id != 0">
                    <button data-bind="btnClick: saveChatToolSettings" class="btn-action-primary">Connect</button>
                </div>
                {{/ifnot}}
            </form>
            {{/ifnot}}
        </div>
        {{/if}}
    </div>
    {{/ifnot}}
</div>


</script>
<script type="text/html" id="storymap.shortcutshelpdialog"> <track-page params="page: track.StorymapKeyboardShortcuts"></track-page>

<div class="header">
    Keyboard shortcuts
    <a class="btn-icon" data-bind="closeModal:true">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content" style="padding-bottom: 0">

    <table>
        <tr>
            <td style="width: 33.33%">
                <table class="table">
                    <tr>
                        <th colspan="2">
                            <h5 class="shhead">Board related shortcuts</h5> 
                        </th>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            ?
                        </td>
                        <td>
                            Show available shortcuts
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Home
                        </td>
                        <td>
                            Select first card on board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            n
                        </td>
                        <td>
                            Insert first card, if there is no one on the board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            c
                        </td>
                        <td>
                            Collapse/Expand all activities and releases
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            + / -
                        </td>
                        <td>
                            Zoom in/Zoom out board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + Mouse wheel
                        </td>
                        <td>
                            Zoom in/Zoom out board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            r
                        </td>
                        <td>
                            Show related cards for expanded releases
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            0
                        </td>
                        <td>
                            Toggle unscheduled items
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            1-9
                        </td>
                        <td>
                            Toggle 1-9 releases
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            F11
                        </td>
                        <td>
                            Increase/decrease work area
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Alt + Click on subtask card
                        </td>
                        <td>
                            Send card to connected issue tracker or open linked issue if already sent
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + Mouse wheel
                        </td>
                        <td>
                            Scroll horizontally
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Space + drag board
                        </td>
                        <td>
                            Change view area on board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + f
                        </td>
                        <td>
                            Search & filter cards
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            F3
                        </td>
                        <td>
                            Find next card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + F3
                        </td>
                        <td>
                            Find previous card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + q
                        </td>
                        <td>
                            Reset card filter
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Alt + p
                        </td>
                        <td>
                            Show persona panel
                        </td>
                    </tr>
                </table>            

            </td>
            <td style="width: 33.33%">
                <table class="table">
                    <tr>
                        <th colspan="2">
                            <h5 class="shhead">Selected card related shortcuts</h5>
                        </th>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            t, F2
                        </td>
                        <td>
                            Edit selected card's title
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Enter
                        </td>
                        <td>
                            Show card details / Close opened card details
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Up, Down, Left, Right
                        </td>
                        <td>
                            Move selection on the board
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            n, Tab
                        </td>
                        <td>
                            Add new card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + n
                        </td>
                        <td>
                            Add new card at the selection position
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            d
                        </td>
                        <td>
                            Show card & edit details field
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            e
                        </td>
                        <td>
                            Show card & edit estimate field
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + p
                        </td>
                        <td>
                            Show card & edit personas (activity level cards only)
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + a
                        </td>
                        <td>
                            Show card & edit annotations
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            u
                        </td>
                        <td>
                            Unschedule card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            p
                        </td>
                        <td>
                            Push card to integrated issue tracker
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Del
                        </td>
                        <td>
                            Delete card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + Del
                        </td>
                        <td>
                            Delete card immediately (without confirmation)
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + Space
                        </td>
                        <td>
                            Collapse/Expand activity and show related releases
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + c / Ctrl + v
                        </td>
                        <td>
                            Copy and paste selected card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + x / Ctrl + v
                        </td>
                        <td>
                            Cut and paste selected card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            <span class="nowrap">Ctrl + Click,</span> s
                        </td>
                        <td>
                            Select multiple cards
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            x
                        </td>
                        <td>
                            Clear multiple card selection
                        </td>
                    </tr>
                </table>

            </td>
            <td style="width: 33%">
                <table class="table">
                    <tr>
                        <th colspan="2">
                            <h5 class="shhead">Card details shortcuts</h5>
                        </th>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            t
                        </td>
                        <td>
                            Add/edit title
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            d
                        </td>
                        <td>
                            Add/edit details
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            e
                        </td>
                        <td>
                            Add/edit estimation
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + p
                        </td>
                        <td>
                            Add/edit personas (activity level cards only)
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Shift + a
                        </td>
                        <td>
                            Add/edit annotations
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Esc, Enter
                        </td>
                        <td>
                            Close dialog
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            u
                        </td>
                        <td>
                            Unschedule card
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            p
                        </td>
                        <td>
                            Push card to integrated issue tracker
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            c
                        </td>
                        <td>
                            Add comment
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            m
                        </td>
                        <td>
                            Show more/less comments
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            a
                        </td>
                        <td>
                            Add attachment
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Ctrl + v
                        </td>
                        <td>
                            Paste image from clipboard as attachment
                        </td>
                    </tr>
                    <tr>
                        <td class="shortcut-column">
                            Del
                        </td>
                        <td>
                            Delete card
                        </td>
                    </tr>
                </table>            
            </td>
        </tr>
    </table>
</div></script>
<script type="text/html" id="storymap.tfs-expiredauthentication:tfs-token">
    <div class="header">
        TFS authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    {{#if parentModel.isReauthenticationSupported }}

    <div class="content">
        {{#if parentModel.isUsernamePasswordAuthentication}}
        <p>Your Team Foundation Server user name and password has expired.</p>
        <br />
        <p>To make changes on this story map you need to re-authenticate with your Team Foundation Server credentials first. <br />{{#if: parentModel.currentUserIsOriginallyAdmin}} Please note that the collaborators of this storymap also cannot make any changes until you re-authenticate in TFS.{{/if}}</p>
        <br />
        <br />
        <div class="control-group">
            <div class="control">
                <label>
                    TFS user name
                    <input type="text" data-bind="value: username">
                </label>
            </div>
            <div class="control" style="position: relative">
                <span class="validation-message" data-bind="validationMessage: username"></span>
            </div>
        </div>
        <div class="control-group">
            <div class="control">
                <label>
                    TFS password
                    <input type="password" data-bind="value: password">
                </label>
            </div>
            <div class="control" style="position: relative">
                <span class="validation-message" data-bind="validationMessage: password"></span>
            </div>
        </div>
        {{/if}}

        {{#ifnot parentModel.isUsernamePasswordAuthentication}}
        <!--Adminoknak szl, tokent kr ablak-->
        <p>Your Team Foundation Server personal access token has expired.</p>
        <br />
        <p>To make changes on this story map you need to provide a new personal access token from Team Foundation Server first. <br />{{#if: parentModel.currentUserIsOriginallyAdmin}} Please note that the collaborators of this storymap also cannot make any changes until the successful renewal of personal access token.{{/if}}</p>
        <br />
        <br />
        <div class="control-group">
            <div class="control">
                <label>
                    Personal access token
                    <input tabindex="2" type="text" data-bind="value: personalAccessToken, hasFocus: true">
                </label>
                <span class="validation-message" data-bind="validationMessage: personalAccessToken"></span>
            </div>
        </div>
        {{/ifnot}}
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateInTfs">Authenticate</button>
        <button class="btn-action" data-bind="click: continueInViewOnlyMode">Continue in read-only mode</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable TFS integration</a>
    </div>
    {{/if}}

    {{#ifnot parentModel.isReauthenticationSupported }}
    <!--Editornak szl, tokent nem kr ablak-->
    <div class="content">
        <p>This storymap is integrated with Team Foundation Server, but the authentication has expired.</p>
        <br />
        <p>
            To make changes on this storymap, the authentication has to be renewed.<br />
            Please ask a storymap administrator to re-authenticate.
        </p>
        <br />
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: continueInViewOnlyMode">Continue in read-only mode</button>
    </div>
    {{/ifnot}}


</script>
<script type="text/html" id="storymap.tfs-expiredauthentication:jiraoauth"></script>
<script type="text/html" id="storymap.tfs2015impersonation:tfs2015-auth">
    <div class="header">
        {{#if isOpenedManually}}Authenticate in Team Foundation Server {{/if}}
        {{#ifnot isOpenedManually}}Team Foundation Server authentication required{{/ifnot}}
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    <div class="content">
        <p>
            {{#if: isTriggeredByAnotherUser}}
            <span class="warning-text">{{triggererUser}} has just enabled impersonation in Team Foundation Server.</span>
            {{/if}}
            {{#ifnot: isTriggeredByAnotherUser}}
            This story map is integrated with Team Foundation Server and impersonation is also enabled.
            {{/ifnot}}
            This means that all changes you make on the story map will be synchronized to Team Foundation Server on behalf of your account.
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Team Foundation Server first. Unauthenticated collaborators can't make changes on this story map.</p>
        <br />

        <div class="control-group">
            <div class="control">
                <label>
                    Username
                    <input tabindex="2" type="text" data-bind="value: username, hasFocus: true">
                </label>
                <span class="validation-message" data-bind="validationMessage: username"></span>
            </div>
            <div class="control">
                <label>
                    Password
                    <input tabindex="3" type="password" data-bind="value: password">
                </label>
                <span class="validation-message" data-bind="validationMessage: password"></span>
            </div>
        </div>
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: auth">Authenticate in Team Foundation Server</button>
        {{#ifnot isOpenedManually}}
        <button class="btn-action" data-bind="click: authenticateLater">Later</button>
        <a data-bind="click: dontRemindMe">Don't remind me</a>
        {{/ifnot}}
    </div>
</script>
<script type="text/html" id="storymap.tfs2017impersonation:tfs2017-auth">
    <div class="header">
        {{#if isOpenedManually}}Authenticate in Team Foundation Server{{/if}}
        {{#ifnot isOpenedManually}}Team Foundation Server authentication required{{/ifnot}}
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    <div class="content">
        <p>
            {{#if: isTriggeredByAnotherUser}}
            <span class="warning-text">{{triggererUser}} has just enabled impersonation in Team Foundation Server.</span>
            {{/if}}
            {{#ifnot: isTriggeredByAnotherUser}}
            This story map is integrated with Team Foundation Server and impersonation is also enabled.
            {{/ifnot}}
            This means that all changes you make on the story map will be synchronized to Team Foundation Server on behalf of your account.
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Team Foundation Server first. Unauthenticated collaborators can't make changes on this story map.</p>
        <br />

        <div class="control-group">
            <div class="control">
                <label>
                    Personal access token
                    <input tabindex="2" type="text" data-bind="value: personalAccessToken, hasFocus: true">
                </label>
                <span class="validation-message" data-bind="validationMessage: personalAccessToken"></span>
            </div>
        </div>
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateWithPersonalAccessToken">Authenticate in Team Foundation Server</button>
        {{#ifnot isOpenedManually}}
        <button class="btn-action" data-bind="click: authenticateLater">Later</button>
        <a data-bind="click: dontRemindMe">Don't remind me</a>
        {{/ifnot}}
    </div>
</script>
<script type="text/html" id="storymap.trello-expiredauthentication:trello-token">
    <div class="header">
        Trello authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    {{#if parentModel.currentUserIsOriginallyAdmin }}
    <div class="content">
        <p>
            Your Trello authentication token has expired.
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Trello first. Unauthenticated collaborators can't make changes on this story map.</p>
        <br />
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticate">Authenticate in Trello</button>
        <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened, visible: showContinueInReadOnlyModeButton">Continue in read-only mode</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable Trello integration</a>
    </div>
    {{/if}}

    {{#ifnot parentModel.currentUserIsOriginallyAdmin }}
    <!--Editornak szl, tokent nem kr ablak-->
    <div class="content">
        <p>This storymap is integrated with Trello, but the authentication token has expired.</p>
        <br />
        <p>
            To make changes on this storymap, the authentication token needs to be renewed.<br />
            Please ask a storymap administrator to re-authenticate.
        </p>
        <br />
    </div>
    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: continueInViewOnlyMode">Continue in read-only mode</button>
    </div>
    {{/ifnot}}
</script>
<script type="text/html" id="storymap.trello-onboarding-dialog"> <div class="header">
    Welcome to your story map
    <a class="btn-icon" data-bind="closeModal: function() {}">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <p style="line-height: 1.5">
        We've added the first Epics and Releases to your story map. You can add new cards and organize them with drag-and-drop.
    </p>
    <p>
        Discover our additional features like Personas, Annotations, Colors, Filters and many more.
    </p>
    <br />
    <div class="d-flex justify-content-between">
        <div class="d-flex flex-column w-40">
            <img class="img-responsive w-80 m-auto" src="../../../content/img/push_cards_to_trello.png" alt="Push Cards to Trello" />
            <p class="mt-20" style="line-height: 1.5">Push your cards to Trello only when they're ready to be implemented. Follow the progress.</p>
        </div>
        <div class="d-flex flex-column w-40">
            <img class="img-responsive w-80 m-auto" src="../../../content/img/get_notified_from_trello.png" alt="Get notified from Trello" />
            <p class="mt-20" style="line-height: 1.5">Get notified when new cards are added to Trello. Import them manually, then we'll keep them synced automatically.</p>
        </div>
    </div> 
</div>
<div class="footer left">
    <button class="btn-view btn-action-primary p" data-bind="click: app.modal.closeCurrentOpened">View</button>
</div></script>
<script type="text/html" id="storymap.vsts-expiredauthentication:vsts-auth">
    <div class="header">
        Azure DevOps authentication required
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>


    {{#if: canAuthenticate}}
    <div class="content">
        <p>
            Your Azure DevOps authentication token is expired!
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Azure DevOps first.{{#if: parentModel.currentUserIsOriginallyAdmin}} Please note that the collaborators of this storymap also cannot make any changes until the successful renewal of personal access token.{{/if}}</p>
        <br />
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: initiateOauth">Authenticate</button>
        <button class="btn-action" data-bind="click: authenticateLater">Continue in read-only mode</button>
        <a href="#" data-bind="click: disableIntegration, visible: showDisableIntegrationButton">Disable Azure DevOps integration</a>
    </div>
    {{/if}}


    {{#ifnot: canAuthenticate}}
    <div class="content">
        <p>
            This storymap is integrated with Azure DevOps, but unfortunately the autentication token is expired.
        </p>
        <br />
        <p>To make changes on this storymap the authentication token need to be renewed. <br/>Please ask a storymap admin to reauthenticate.</p>
        <br />
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: authenticateLater">Continue in view only mode</button>
    </div>
    {{/ifnot}}

</script>
<script type="text/html" id="storymap.vsts-expiredauthentication:vstsoauth"></script>
<script type="text/html" id="storymap.vstsimpersonation:vsts-auth">
    <div class="header">
        {{#if isOpenedManually}}Authenticate in Azure DevOps Services{{/if}}
        {{#ifnot isOpenedManually}}Azure DevOps Services authentication required{{/ifnot}}
        <a class="btn-icon" data-bind="closeModal:true">
            <i class="icon-close-dialog"></i>
        </a>
    </div>

    <div class="content">
        <p>
            {{#if: isTriggeredByAnotherUser}}
            <span class="warning-text">{{triggererUser}} has just enabled impersonation in Azure DevOps Services.</span>
            {{/if}}
            {{#ifnot: isTriggeredByAnotherUser}}
            This story map is integrated with Azure DevOps Services and impersonation is also enabled.
            {{/ifnot}}
            This means that all changes you make on the story map will be synchronized to Azure DevOps Services on behalf of your account.
        </p>
        <br />
        <p>To make changes on this story map you need to authenticate in Azure DevOps Services first. Unauthenticated collaborators can't make changes on this story map.</p>
        <br />  
    </div>

    <div class="footer left">
        <button class="btn-action-primary" data-bind="click: initiateOauth">Authenticate in Azure DevOps Services</button>
        {{#ifnot isOpenedManually}}
            <button class="btn-action" data-bind="click: authenticateLater">Later</button>
            <a data-bind="click: dontRemindMe">Don't remind me</a>
        {{/ifnot}}
    </div>
</script>
<script type="text/html" id="storymap.vstsimpersonation:vstsaoauth"></script>
<script type="text/html" id="storymap.board.board2level"> 
{{#template 'storymap.board.boardisempty'/}}

{{#if $root.board.hasCard()}}

<div id="board-boundaries">
    <div id="board" data-bind="css: $root.board.zoomCssClass(), css: { 'has-activity-persona-images': $root.hasActivityPersonaImages, 'has-activity-personas': $root.hasActivityPersonaNames }, style: { width : $root.board.widthOf2LevelBoard() }">

        <!-- Activities & tasks, pinnable section -->

        <div id="board-head">

            <!-- Activities -->

            <ul id="board-activities" class="connect" data-activities="true" data-bind="sortable: viewmodels.storymap.bindings.activity.getSortable($root), sortableOptions: viewmodels.storymap.bindings.activity.getSortableOptions(), css: {'search-filter-active': $root.isSearchAndFilterActive()}">

                <!-- Activity -->

                <li class="board-activity" data-activity="true" data-bind="sortableItem: viewmodels.storymap.bindings.activity.getSortableItem($root,$data), clickCloseTemplatedContextmenu: { onClose: function() { $root.isColorEditorInEditMode(false) } } ">
                    <div class="board-line"></div>

                    {{#if $root.personasAreVisibleAboveActivities}}
                    <!-- ko template: { name: 'storymap.board.personas:personas', data: $data } --><!-- /ko -->
                    {{/if}}

                    {{#template 'storymap.board.board2levelcards:activity'/}}

                    <!-- Activity tasks -->
                    {{#if $data.expanded}}
                    <div class="board-tasks-outer" data-bind="clickIf: {
                                    do: function() {
                                        $root.board.tryCommitTitleChangesOfCurrentlyEditedCard();
                                        $root.board.showPlaceholderThanAddFirstChildFor($data);
                                    },
                                    ifnot:  $data.hasTasks.bind($data),
                                    and: function() { return !$root.currentUserIsViewer() }
                                },
                                hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if:  ($data.hasTasks() === false && $data.isChildPlaceholderShown() === false && $root.currentUserIsViewer() === false)  }">
                        <div class="board-add-to-empty">
                            <i class="icon-board-add-to-empty" data-bind="click: function() { $root.board.addNewTaskForAt($data,0); }"></i>
                        </div>

                        {{#if $data.isChildPlaceholderShown}}
                        <div class="board-selected-to-add-first-element"> </div>
                        {{/if}}

                        <ul class="board-tasks connect cf board-tasks-2level" data-tasks="true" data-bind="style: { width: $root.board.getTasksWidthForActivityOn2LevelBoard($data) }, hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if:  $data.hasTasks() === false  }, attr: { 'data-parent-activity-id': $data.id }, sortable: viewmodels.storymap.bindings.task.getSortable($root, $data), sortableOptions: viewmodels.storymap.bindings.task.getSortableOptions(), clickCloseTemplatedContextmenu: { onClose: function() { $root.isColorEditorInEditMode(false) } }, click: $root.board.tryCommitTitleChangesOfCurrentlyEditedCard">
                            <li class="board-task" data-bind="sortableItem: viewmodels.storymap.bindings.task.getSortableItem($parent, $data)">

                                {{#template 'storymap.board.board2levelcards:task'/}}

                            </li>
                        </ul>
                    </div>
                    {{/if}}

                    {{#ifnot $data.expanded}}
                    <div class="board-tasks-outer">
                        <div class="board-collapsed-activity-details-card" data-bind="click: expand">
                            {{$data.tasks().length}} collapsed children
                            <br>
                            click to expand
                        </div>
                    </div>
                    {{/ifnot}}
                </li>
            </ul>
        </div>
    </div>
</div>
{{/if}}</script>
<script type="text/html" id="storymap.board.board2levelcards:activity">
    <div class="board-activity-card card"
         data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                    click: function(data, event) { $root.handleCardClick(data,event) },
                    classes: classes,
                    attr: { id : id },
                    templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                    showTemplateOnHover: {
                        placeholder: '.board-card-buttons-placeholder',
                        templateName: 'storymap.board.board2levelcards:activity-buttons',
                        selector: '.board-card-buttons',
                        delay: 100,
                        hideDelay: $root.cardsButtonBarHideDelay,
                        hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                        disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                        orDisabled: $data.inlineEditing,
                        orDisabled2: false },
                  clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } }  ">
        
        {{#ifnot isTransparentAnnotation}}  
        <div class="board-card-indicators">
            {{#if $data.isWatched() }}
            <i class="board-card-indicator icon-board-card-indicator-watched"></i>
            {{/if}}
            {{#if $data.hasDescription() }}
            <i class="board-card-indicator icon-board-card-indicator-description"></i>
            {{/if}}
            {{#if $data.hasAttachment() }}
            <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
            {{/if}}
            {{#if $data.hasComment() }}
            <i class="board-card-indicator icon-board-card-indicator-comment"></i>
            {{/if}}
            {{#if isProjectLinked }}
            <i class="board-card-indicator icon-board-card-indicator-sync"></i>
            {{/if}}
        </div>
        {{/ifnot}}

    <div class="board-card-title-wrapper">
        {{#ifnot inlineEditing}}
        <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
        {{/ifnot}}
        <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
            value: name,
            displayPrefix: linkedItemKey,
            showDisplayPrefix: $root.showLinkedItemKeysOnCards,
            editmode: $data.inlineEditing,
            emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
            emptyClass: 'board-card-empty-title',
            selectTextOnFocus: true,
            inputClass: 'board-card-title-editor',
            endEditOnEnterKey: true,
            autoellipsis:true,
            trigger: 'none',
            onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
            }">
        </span>
    </div>
        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                <div class="board-card-buttons-placeholder"></div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="storymap.board.board2levelcards:activity-buttons">
    <div class="board-card-buttons for-two-level-activity">

        <!-- 2nd level cards column number -->
        {{#if color() !== 99 }}
        <div class="board-activity-columns-dropdownchoose" data-bind="dropdownchoose: { prop: $data.currentTaskColumnNumberOn2LevelBoard, callback: $data.updateCurrentTaskColumnNumberOn2LevelBoard.bind($data) }">
            <span class="board-activity-columns-selected-option"></span>
            <i class="icon-board-card-2level-col-selector-carot"></i>
            <ul class="board-activity-columns-dropdownchoose-items">
                <li class="board-activity-columns-dropdownchoose-item" data-value="1">1 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="2">2 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="3">3 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="4">4 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="5">5 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="6">6 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="7">7 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="8">8 cols</li>
                <li class="board-activity-columns-dropdownchoose-item" data-value="9">9 cols</li>
            </ul>
        </div>
        {{/if}}

        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer }}
        <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
        {{/ifnot}}

        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer()}}
        <a class="board-card-icon-button-without-padding" data-tip="Add next card" data-bind="debouncedClick: function() { $root.board.addNewActivityAt($index() + 1); }">
            <i class="icon-storymap-bc-next-card"></i>
        </a>
        {{/ifnot}}

        <!-- Editor or Viewer -->
        {{#if !$root.currentUserIsViewer() || $data.isProjectLinked() }}
        <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">
            <a class="board-card-icon-button-without-tooltip">
                <i class="icon-storymap-bc-options"></i>
            </a>
            <div class="menu-content board-subtask-more-dropdown-menu-content">
                <ul>
                    <!-- Integration -->
                    {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                    <!-- Integration / Go to card -->
                    {{#if isGoToConnectedCardEnabled }}
                    <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                    {{/if}}
                    <!-- Integration / Push card -->
                    {{#if $data.color() !== 99 && !$root.currentUserIsViewer() && !$data.isProjectLinked() && $root.isTopLevelCardSyncSupported() }}
                    <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                    {{/if}}
                    {{#if isGoToConnectedCardEnabled() || (!$root.currentUserIsViewer() && !$data.isPushedToIssueTracker() && $root.isTopLevelCardSyncSupported()) }}
                    <li class="dropdown-menu-line"><hr></li>
                    {{/if}}
                    {{/if}}

                    <!-- Collapse / expand -->
                    {{#if color() !== 99}}
                    {{#if: $data.expanded() && $data.tasks().length > 0}}
                    <li><a data-bind="click: function () { $data.collapse(); }">Collapse children</a></li>
                    {{/if}}
                    {{#ifnot: $data.expanded}}
                    <li><a data-bind="click: function () { $data.expand(); }">Expand children</a></li>
                    {{/ifnot}}
                    <li><a data-bind="click: function () { $root.board.collapseActivitiesExcept($data); }">Collapse others</a></li>
                    {{/if}}

                    <!-- Delete -->
                    {{#ifnot $root.currentUserIsViewer()}}
                    <li class="dropdown-menu-line"><hr></li>
                    <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                    <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                    {{#if $root.board.hasCardToPaste }}
                    <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                    {{/if}}
                    <li class="dropdown-menu-line"><hr></li>
                    <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                    {{/ifnot}}
                </ul>
            </div>
        </div>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
        <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
            <i class="icon-storymap-add-card-annotation"></i>
        </a>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
        <a class="board-card-icon-button" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
            <i class="icon-storymap-bc-edit-title"></i>
        </a>
        {{/if}}
    </div>
</script>
<script type="text/html" id="storymap.board.board2levelcards:task">
    <div class="board-task-card card"
         data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                    click: function(data, event) { $root.handleCardClick(data,event) },
                    classes: classes,
                    attr: { id : id },
                    templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                    showTemplateOnHover: {
                        placeholder: '.board-card-buttons-placeholder',
                        templateName: 'storymap.board.board2levelcards:task-buttons',
                        selector: '.board-card-buttons',
                        delay: 100,
                        hideDelay: $root.cardsButtonBarHideDelay,
                        hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                        disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                        orDisabled: $data.inlineEditing,
                        orDisabled2: false },
                   clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">
        <div class="board-card-title-wrapper">
            {{#ifnot inlineEditing}}
            <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
            {{/ifnot}}
            <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
                value: name,
                displayPrefix: linkedItemKey,
                showDisplayPrefix: $root.showLinkedItemKeysOnCards,
                editmode: $data.inlineEditing,
                emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
                emptyClass: 'board-card-empty-title',
                selectTextOnFocus: true,
                inputClass: 'board-card-title-editor',
                endEditOnEnterKey: true,
                autoellipsis:true,
                trigger: 'none',
                onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
                }">
            </span>

            <span class="board-task-card-subtask-count" data-bind="if: $data.subtaskCount() > 0">
                {{subtaskCount}} stories
            </span>
        </div>
        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                
                {{#ifnot isTransparentAnnotation}}  
                <div class="board-card-indicators">
                    {{#if $data.isWatched() }}
                    <i class="board-card-indicator icon-board-card-indicator-watched"></i>
                    {{/if}}
                    {{#if $data.hasDescription() }}
                    <i class="board-card-indicator icon-board-card-indicator-description"></i>
                    {{/if}}
                    {{#if $data.hasAttachment() }}
                    <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
                    {{/if}}
                    {{#if $data.hasComment() }}
                    <i class="board-card-indicator icon-board-card-indicator-comment"></i>
                    {{/if}}
                    {{#if $data.hasPersonas() }}
                    <i class="board-card-indicator icon-board-card-indicator-persona"></i>
                    {{/if}}
                    {{#if isProjectLinked }}
                    <i class="board-card-indicator icon-board-card-indicator-sync"></i>
                    {{/if}}
                </div>
                {{/ifnot}}
                
                <div class="board-card-buttons-placeholder"></div>

                {{#if $parent.isLastTaskElement($data) === true && !$root.currentUserIsViewer()}}
                <div class="board-card-last-element-add">
                    <div class="board-card-last-element-add-inner" data-bind="debouncedClick: function() { $root.board.addNewTaskFor($parent); }">
                        <i class="icon-board-card-last-element-add-inner"></i>
                    </div>
                </div>
                {{/if}}
            </div>
        </div>
        
        

    </div>
</script>
<script type="text/html" id="storymap.board.board2levelcards:task-buttons">
    <div class="board-card-buttons">
        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer }}
        <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
        {{/ifnot}}

        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer()}}
        <a class="board-card-icon-button-without-padding" data-tip="Add next card" data-bind="debouncedClick: function() { $root.board.addNewTaskForAt($parent,$index() + 1); }">
            <i class="icon-storymap-bc-next-card"></i>
        </a>
        {{/ifnot}}

        <!-- Editor or Viewer -->
        {{#if !$root.currentUserIsViewer() || $data.isProjectLinked() }}
        <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">
            <a class="board-card-icon-button-without-tooltip">
                <i class="icon-storymap-bc-options"></i>
            </a>
            <div class="menu-content board-subtask-more-dropdown-menu-content">
                <ul>
                    <!-- Integration -->
                    {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                    <!-- Integration / Go to card -->
                    {{#if isGoToConnectedCardEnabled }}
                    <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                    {{/if}}
                    {{#if: $data.color() !== 99 && !$data.isProjectLinked() && $root.isSecondLevelCardSyncSupported() }}
                    <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                    {{/if}}
                    {{#if isGoToConnectedCardEnabled() || (!$root.currentUserIsViewer() && !$data.isPushedToIssueTracker() && $root.isSecondLevelCardSyncSupported()) }}
                    <li class="dropdown-menu-line"><hr></li>
                    {{/if}}
                    {{/if}}

                    <!-- Copy, Cut, Paste, Delete -->
                    {{#ifnot $root.currentUserIsViewer()}}
                    <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                    <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                    {{#if $root.board.hasCardToPaste }}
                    <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                    {{/if}}
                    <li class="dropdown-menu-line"><hr></li>
                    <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                    {{/ifnot}}
                </ul>
            </div>
        </div>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
        <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
            <i class="icon-storymap-add-card-annotation"></i>
        </a>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
        <a class="board-card-icon-button" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
            <i class="icon-storymap-bc-edit-title"></i>
        </a>
        {{/if}}
    </div>
</script>
<script type="text/html" id="storymap.board.board2levelcards"> <!-- Activity on 2 level board template -->





<!-- Task template -->




</script>
<script id="storymap.board.board3level:board-head-template" type="text/html">
    <!-- Activities & tasks, pinnable section -->
    <div id="board-head" data-bind="css: { 'board-head-pinned': $root.isTopLevelCardsArePinned() }">

        <!-- Activities -->
        <ul id="board-activities" class="connect" data-activities="true" data-bind="css: { 'board-head-fixed-border' : $root.board.isTopLevelCardsBorderShouldShown(), 'board-head-fixed-border-small' : $root.board.isTopLevelCardsBorderShouldShown() && $root.board.zoomFactor() < 10 }, sortable: viewmodels.storymap.bindings.activity.getSortable($root), sortableOptions: viewmodels.storymap.bindings.activity.getSortableOptions(), click: $root.board.tryCommitTitleChangesOfCurrentlyEditedCard">

            <!-- Activity -->

            <li class="board-activity" data-activity="true" data-bind="sortableItem: viewmodels.storymap.bindings.activity.getSortableItem($root,$data)">

                <div class="board-line"></div>

                {{#if $root.personasAreVisibleAboveActivities}}
                <!-- ko template: { name: 'storymap.board.personas:personas', data: $data } --><!-- /ko -->
                {{/if}}

                {{#template 'storymap.board.board3levelcards:activity'/}}
                <!-- Activity tasks -->
                {{#if $data.expanded}}
                <div class="board-tasks-outer" data-bind="clickIf: {
                     do: function() {
                            $root.board.tryCommitTitleChangesOfCurrentlyEditedCard();
                            $root.board.showPlaceholderThanAddFirstChildFor($data);
                         },
                         ifnot:  $data.hasTasks.bind($data),
                         and: function() { return !$root.currentUserIsViewer() }
                     },
                     hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if: ($data.hasTasks() === false && $data.isChildPlaceholderShown() === false && $root.currentUserIsViewer() === false)  }">
                    <div class="board-add-to-empty">
                        <i class="icon-board-add-to-empty" data-bind="click: function() { $root.board.addNewTaskForAt($data,0); }"></i>
                    </div>

                    {{#if $data.isChildPlaceholderShown}}
                    <div class="board-selected-to-add-first-element"></div>
                    {{/if}}

                    <ul class="board-tasks connect" data-tasks="true" data-bind="hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if:  $data.hasTasks() === false  }, attr: { 'data-parent-activity-id': $data.id }, sortable: viewmodels.storymap.bindings.task.getSortable($root, $data), sortableOptions: viewmodels.storymap.bindings.task.getSortableOptions()">
                        {{#template 'storymap.board.board3levelcards:task'/}}
                    </ul>
                </div>
                {{/if}}

                {{#ifnot $data.expanded}}
                <div class="board-tasks-outer">
                    <div class="board-collapsed-activity-details-card" data-bind="click: expand">
                        {{$data.tasks().length}} collapsed children
                        <br>
                        {{$data.numberOfStoryCards()}} story cards
                        <br>
                        click to expand
                    </div>
                </div>
                {{/ifnot}}
            </li>


        </ul>
    </div>
</script>
<script id="storymap.board.board3level:board-body-template" type="text/html">

    <!-- Subtasks -->
    <div id="board-body-container" data-bind="css: { 'board-body-container-pinned': $root.isTopLevelCardsArePinned() } ">

        <div id="board-body" data-board-body="true" data-bind="css: { 'board-body-pinned': $root.isTopLevelCardsArePinned() }, style: { width : $root.board.widthOfBodyHeaderAndBodyOnPinnedBoard() }">

            <!-- lines (szndkosan span, mert a div-ekre van first-child pseudo selector) -->
            <span class="board-lines cf">
                <ul class="data-release-content" data-bind="foreach: $root.board.activities">
                    <li class="board-invisible-placeholder"></li>
                    <li class="board-activity for-line" data-bind="visible:$data.expanded, attr: { 'data-parent-activity-id': $data.id }">
                        <div class="board-body-line"></div>
                        <ul class="board-tasks for-line" data-bind="foreach: $data.tasks, attr: { 'data-parent-activity-id-for-tasks': $data.id }">
                            <li class="task board-invisible-placeholder"></li>
                            <li class="board-task for-line" data-bind="attr: { 'data-parent-task-id': $data.id }">
                                <ul class="board-subtasks for-line" data-release="unscheduled-subtasks" data-subtask-sortable="true"></ul>
                            </li>
                        </ul>
                    </li>

                    <li class="board-activity for-line" data-bind="visible:$data.collapsed">
                        <div class="board-body-line"></div>
                        <ul class="board-tasks for-line">
                            <li class="task board-invisible-placeholder"></li>
                            <li class="board-task for-line">
                                <ul class="board-subtasks for-line"></ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </span>


            <div id="board-sortable-releases" data-bind="sortable: viewmodels.storymap.bindings.releases.getSortable($root), sortableOptions: viewmodels.storymap.bindings.releases.getSortableOptions()">
                <!-- Releases/subtasks -->
                <div class="release-with-subtasks" data-bind="sortableItem: viewmodels.storymap.bindings.releases.getSortableItem($parent, $data)">
                    <div class="board-release" id="board-relese-{{$data.id}}" data-bind="click: function() {$root.board.toggleReleaseCollapsed($data)}">
                        <div class="board-release-relative">
                            {{#ifnot inlineEditingOnBoard()}}
                            <a class="release-collapse-expand-btn">
                                <i data-bind="css: {'icon-storymap-b-expand-release': $data.expanded, 'icon-storymap-b-collapse-release': !$data.expanded()}"></i>
                            </a>
                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger board-release-name" tabindex="1">
                                    <span class="board-release-prefix" data-bind="text:displayPrefix"></span>
                                    <span class="board-release-name-text" data-bind="text:name"></span>
                                    <span class="caret for-release"></span>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul>
                                        <li><a data-bind="click: openDetailsDialog">Open release details</a></li>

                                        {{#ifnot $root.isReadOnlyAccessOfPublishedBoard}}
                                        <li>
                                            <a data-bind="click: function() { $root.toggleWatchRelease($data) }">
                                                {{#ifnot isWatched}}Watch this release{{/ifnot}}
                                                {{#if isWatched}}Stop watching this release{{/if}}
                                            </a>
                                        </li>
                                        {{/ifnot}}
                                        <li>
                                            <a data-bind="click: function() { $root.board.toggleReleaseCollapsed($data); }">
                                                {{#if expanded}}Collapse release{{/if}}
                                                {{#ifnot expanded}}Expand release{{/if}}
                                            </a>
                                        </li>
                                        <li><a data-bind="click: function() { $root.board.showRelatedActivitiesToRelease($data); }">Show related cards</a></li>
                                        {{#if !$root.currentUserIsViewer()}}
                                        <li class="dropdown-menu-line">
                                            <hr>
                                        </li>
                                        {{#if canBeMovedUp() || canBeMovedDown()}}
                                        {{#if canBeMovedUp}}
                                        <li><a data-bind="click: function() { $root.board.moveReleaseUp($data,true); }">Move up</a></li>
                                        {{/if}}
                                        {{#if canBeMovedDown}}
                                        <li><a data-bind="click: function() { $root.board.moveReleaseDown($data,true); }">Move down</a></li>
                                        {{/if}}
                                        <li class="dropdown-menu-line">
                                            <hr>
                                        </li>
                                        {{/if}}
                                        <li><a data-bind="click: function() { $data.startInlineEditingOnBoard(); }">Edit name</a></li>
                                        {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn()}}
                                        {{#if $root.isIntegrationEnabled()}}
                                        <li>
                                            <a data-bind="click: function() { pushCardsToIntegrationTool(); }">
                                                Push <span data-bind="if: $root.isReleaseSyncEnabled()">with </span>cards to <span data-bind="text: $root.integrationToolName"></span>
                                            </a>
                                        </li>
                                        {{/if}}
                                        {{/if}}
                                        {{/if}}
                                        {{#if !$root.currentUserIsViewer()}}
                                        <li><a data-bind="click: function() { $root.board.selectAllCardsInRelease(id); }">Select all cards</a></li>
                                        <li><a data-bind="click: function() { $root.board.addNewReleaseBefore($data); }">Add new release above</a></li>
                                        {{/if}}
                                        {{#if !$root.currentUserIsViewer()}}
                                        <li><a data-bind="click: function() { $root.board.addNewReleaseAfter($data); }">Add new release below</a></li>
                                        {{/if}}
                                        {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn()}}
                                        {{#if $root.isIntegrationEnabled()}}
                                        <li data-bind="visible: $data.isConnected">
                                            <a data-bind="text: $root.goToConnectedReleaseCaption, click: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a>
                                        </li>
                                        {{/if}}
                                        {{/if}}
                                        {{#if !$root.currentUserIsViewer()}}
                                        <li><a data-bind="click: function() { $root.board.archiveRelease($data.id); }">Archive release</a></li>
                                        <li><a data-bind="click: function() { $root.board.openDeleteReleaseConfirm($data.id); }">Delete release</a></li>
                                        {{/if}}
                                    </ul>
                                </div>
                            </div>
                            <div class="board-release-details" data-bind="clickStop: true">
                                {{#if $data.isConnected() && $root.isIntegrationEnabled()}}
                                <span class="board-release-is-released" data-tip="{{$root.goToConnectedReleaseCaption()}}" data-bind="click: function() { window.open($data.linkedItemUrl(), '_blank'); }">
                                    <i class="icon-board-card-indicator-sync" aria-hidden="true"></i>
                                </span>
                                {{/if}}
                                {{#if $data.isReleased}}
                                <span class="board-release-is-released" data-tip="Released">
                                    <i class="icon-storymap-b-relase-released" aria-hidden="true"></i>
                                </span>
                                {{/if}}
                                {{#if $data.isWatched}}
                                <span class="board-release-is-watched" data-tip="Watching release. You will receive notifications about the card changes in this release. Click to unwatch." data-bind="click: function() { $root.toggleWatchRelease($data) }">
                                    <i class="icon-storymap-b-relase-watched" aria-hidden="true"></i>
                                </span>
                                {{/if}}
                                {{#if hasReleaseDate}}
                                <span class="board-release-releasedate" data-tip="View release date and details" data-bind="click: openDetailsDialog, css: {release-date-passed: hasReleaseDateWarning}">
                                    <i class="icon-storymap-b-relase-date" aria-hidden="true"></i>
                                    <span class="release-attr-line-text">{{moment.utc(releaseDate()).format('YYYY.MM.DD.')}}</span>
                                </span>
                                {{/if}}
                                {{#if hasGoal}}
                                <span class="board-release-has-goal" data-tip="View release goal and details" data-bind="click: openDetailsDialog">
                                    <i class="icon-storymap-b-relase-goal"></i>
                                    <span class="release-attr-line-text">Goal</span>
                                </span>
                                {{/if}}
                                {{#ifnot isEmpty}}
                                {{#if !$root.isPrivateLinkSharedAccess() && !$root.isPublicMapViewer()}}
                                <span class="release-view" title="Jump to release view" data-bind="click: openReleaseView, qtip: { position: 'bottom', delay: 1 }">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="width: 11px; fill: white;"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M128 288C119.2 288 112 280.8 112 272V144C112 135.2 119.2 128 128 128C136.8 128 144 135.2 144 144V272C144 280.8 136.8 288 128 288zM304 144C304 135.2 311.2 128 320 128C328.8 128 336 135.2 336 144V336C336 344.8 328.8 352 320 352C311.2 352 304 344.8 304 336V144zM224 256C215.2 256 208 248.8 208 240V144C208 135.2 215.2 128 224 128C232.8 128 240 135.2 240 144V240C240 248.8 232.8 256 224 256zM0 96C0 60.65 28.65 32 64 32H384C419.3 32 448 60.65 448 96V416C448 451.3 419.3 480 384 480H64C28.65 480 0 451.3 0 416V96zM64 448H384C401.7 448 416 433.7 416 416V96C416 78.33 401.7 64 384 64H64C46.33 64 32 78.33 32 96V416C32 433.7 46.33 448 64 448z" /></svg>

                                    Release view
                                </span>
                                {{/if}}
                                <span class="board-release-estimated-effort" data-tip="View status report of this release" data-bind="click: showStatusReport">
                                    <i class="icon-storymap-b-status-report"></i>
                                    <span class="board-release-estimated-effort-text">
                                        {{#if hasEstimation}}
                                        {{$data.cardsCount}} cards, {{$data.remainingAggregatedEstimation}} left of {{$data.aggregatedEstimation}} {{$root.storymapEstimationUnit}}
                                        {{/if}}
                                        {{#ifnot hasEstimation}}
                                        {{$data.undoneCardsCount}} left of {{$data.cardsCount}} cards
                                        {{/ifnot}}
                                    </span>
                                </span>
                                {{#if hasEstimation() && unEstimatedCount() > 0}}
                                <span class="board-release-estimated-effort" data-tip="Click to highlight unestimated cards" data-bind="click: showCardsWithMissingEstimatesOnBoard">
                                    <i class="icon-storymap-b-release-has-unestimated"></i>
                                    <span class="board-release-estimated-effort-text">
                                        {{$data.unEstimatedCount}} of {{$data.cardsCount}} cards aren't estimated
                                    </span>
                                </span>
                                {{/if}}
                                {{/ifnot}}
                            </div>

                            {{/if}}
                            {{#if inlineEditingOnBoard()}}
                            <span data-bind="inlineTextArea: {
                                    value: name,
                                    type: 'text',
                                    editOnClick: false,
                                    editmode: $data.inlineEditingOnBoard,
                                    emptyText:'Unnamed',
                                    emptyClass: 'empty-title' ,
                                    inputClass: 'board-release-name-editor',
                                    selectTextOnFocus: true,
                                    endEditOnEnterKey: true,
                                    autoellipsis:false,
                                    trigger: 'none',
                                    width: '800px',
                                    height: 'auto',
                                    onEndEdit: function(isCanceled) { $data.endInlineEditingOnBoard(isCanceled); }
                                    }">
                            </span>
                            {{/if}}
                        </div>
                    </div>


                    {{#if $data.expandedDuringLoad}}
                    <div data-bind="visible:$data.expanded" class="release-body-for-fadein">
                        <ul class="board-subtasks-activities data-release-content" data-release-content="true" data-bind="foreach: $root.board.activities">


                            <li class="board-invisible-placeholder"></li>
                            <li class="board-activity" data-bind="visible:$data.expanded, attr: { 'data-parent-activity-id': $data.id }">

                                {{#ifnot $data.hasTasks() }}
                                <ul class="board-tasks">
                                    <li class="board-task">
                                        <div class="board-must-add-task-message">
                                            You must add a second level card before you can add story cards here.
                                        </div>
                                    </li>
                                </ul>
                                {{/ifnot}}

                                {{#if $data.hasTasks() }}
                                <ul class="board-tasks" data-bind="attr: { 'data-parent-activity-id-for-tasks': $data.id }">
                                    <!-- ko foreach: $data.tasks -->
                                    <li class="task board-invisible-placeholder"></li>
                                    <li class="board-task" data-bind="clickIf: { do: function() { $root.board.showPlaceholderThanAddFirstChildForTaskRelease($data,$parents[1]) }, ifnot:  $data.hasSubTaskFor.bind($data,$parents[1]), and: function() { return !$root.currentUserIsViewer() } }, hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if:  ($data.hasSubTaskFor($parents[1]) === false && $root.currentUserIsViewer() === false)  }, attr: { 'data-parent-task-id': $data.id }">

                                        {{#with: $data.getTaskReleaseOrNullFor($parents[1])}}
                                        <div class="board-add-to-empty">
                                            <i class="icon-board-add-to-empty" data-bind="clickAndStop: function() { $root.board.addNewSubTaskForAt($data,0); }"></i>
                                        </div>
                                        {{#if $data.isChildPlaceholderShown}}
                                        <div class="board-selected-to-add-first-element">
                                        </div>
                                        {{/if}}
                                        <ul class="board-subtasks connect" data-subtask-sortable="true" data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); }, class: { name: $parents[2].id }, attr: { 'data-release' : $parents[2].id }, sortable: viewmodels.storymap.bindings.subTasks.getSortable($root, $data), sortableOptions: viewmodels.storymap.bindings.subTasks.getSortableOptions(), clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">
                                            {{#template 'storymap.board.board3levelcards:subtask'/}}
                                        </ul>
                                        {{/with}}

                                    </li>
                                    <!-- /ko -->
                                    {{#if $data.tasks}}
                                    <li class="task board-invisible-placeholder"></li>
                                    {{/if}}
                                </ul>
                                {{/if}}
                            </li>
                            <li class="board-activity" data-bind="visible:$data.collapsed">
                                <ul class="board-tasks">
                                    <li class="task board-invisible-placeholder"></li>
                                    <li class="board-task">
                                        <ul class="board-subtasks connect"></ul>
                                    </li>
                                </ul>
                            </li>

                        </ul>
                    </div>
                    {{/if}}
                    <div data-bind="visible:$data.collapsed">
                        &nbsp;
                    </div>

                </div>
            </div>

            <!-- Unscheduled subtasks -->
            {{#if $root.board.shouldShownUnscheduledHeader() }}
            <div class="board-release" data-bind="css: {single-release: !$root.board.hasVisibleReleases()}, click: $root.board.toggleUnscheduledSubtasksCollapsed.bind($root.board)">
                <div class="board-release-relative">
                    <a class="release-collapse-expand-btn">
                        <i data-bind="css: {'icon-storymap-b-expand-release': $root.board.unscheduledSubTasksAreExpanded, 'icon-storymap-b-collapse-release': !$root.board.unscheduledSubTasksAreExpanded()}"></i>
                    </a>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger board-release-name" tabindex="1">
                            <span data-bind="ifnot: $root.board.hasVisibleReleases()">Cards</span>
                            <span class="board-release-name-text" data-bind="if: $root.board.hasVisibleReleases()">Unscheduled cards</span>
                            <span class="caret for-release"></span>
                        </a>
                        <div class="menu-content left-aligned">
                            <ul>
                                <li><a data-bind="click: function() { $root.board.showRelatedActivitiesToUnscheduledItems(); }">Show related cards</a></li>
                                {{#if !$root.currentUserIsViewer()}}
                                <li><a data-bind="click: function() { $root.board.selectAllCardsInRelease(null); }">Select all cards</a></li>
                                <li><a data-bind="click: function() { $root.board.addNewReleaseAsLastOnBoard(); }">Add new release above</a></li>
                                {{/if}}
                            </ul>
                        </div>
                    </div>
                    <div class="board-release-details">
                        <span class="board-release-estimated-effort" data-tip="Aggregated estimate of the unscheduled cards" data-bind="if:$root.board.unscheduledAggregatedEstimation() > 0">
                            <span class="board-release-estimated-effort-text">
                                {{$root.board.unscheduledCardsCount}} cards,
                                {{$root.board.unscheduledRemainingAggregatedEstimation}} left of {{$root.board.unscheduledAggregatedEstimation}} {{$root.storymapEstimationUnit}}
                            </span>
                        </span>
                        {{#if $root.board.unscheduledCardsCount() !==  $root.board.unestimatedUnscheduledCardsCount() && $root.board.unestimatedUnscheduledCardsCount() > 0}}
                        <span class="board-release-estimated-effort-for-unscheduled-cards">
                            <i class="icon-storymap-b-release-has-unestimated"></i>
                            <span class="board-release-estimated-effort-text">
                                {{$root.board.unestimatedUnscheduledCardsCount}} of {{$root.board.unscheduledCardsCount}} cards aren't estimated
                            </span>
                        </span>
                        {{/if}}
                    </div>
                </div>
            </div>
            <div data-bind="if:$root.board.unscheduledSubTasksAreExpanded">
                <ul class="board-subtasks-activities data-release-content" data-release-content="true" data-bind="foreach: $root.board.activities">
                    <li class="board-invisible-placeholder"></li>
                    <li class="board-activity" data-bind="visible:$data.expanded, attr: { 'data-parent-activity-id': $data.id }">
                        <ul class="board-tasks" data-bind="attr: { 'data-parent-activity-id-for-tasks': $data.id }">
                            <!-- ko foreach: $data.tasks -->
                            <li class="task board-invisible-placeholder"></li>
                            <li class="board-task" data-bind="clickIf: { do: function() { $root.board.showPlaceholderThanAddFirstChildFor($data) }, ifnot:  $data.hasUnScheduledSubTasks.bind($data), and: function() { return !$root.currentUserIsViewer() } }, hoverToggle: { css: 'visible', childElementSelector: '.board-add-to-empty', if:  ($data.hasUnScheduledSubTasks() === false && $data.isChildPlaceholderShown() === false && $root.currentUserIsViewer() === false)  }, attr: { 'data-parent-task-id': $data.id }">
                                <div class="board-add-to-empty">
                                    <i class="icon-board-add-to-empty" data-bind="clickAndStop: function() { $root.board.addNewUnscheduledSubTaskForAt($data,0) }"></i>
                                </div>
                                {{#if $data.isChildPlaceholderShown}}
                                <div class="board-selected-to-add-first-element">
                                </div>
                                {{/if}}
                                <ul class="board-subtasks connect unscheduled-subtasks" data-release="unscheduled-subtasks" data-subtask-sortable="true" data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); } , attr: { 'data-parent-task-id' : $data.id }, sortable: viewmodels.storymap.bindings.unscheduledSubTasks.getSortable($root, $data), sortableOptions: viewmodels.storymap.bindings.unscheduledSubTasks.getSortableOptions()">
                                    {{#template 'storymap.board.board3levelcards:unscheduled-subtask'/}}
                                </ul>
                            </li>
                            <!-- /ko -->
                            {{#if $data.tasks}}
                            <li class="task board-invisible-placeholder"></li>
                            {{/if}}
                        </ul>
                    </li>

                    <li class="board-activity" data-bind="visible:$data.collapsed">
                        <ul class="board-tasks">
                            <li class="task board-invisible-placeholder"></li>
                            <li class="board-task">
                                <ul class="board-subtasks connect unscheduled-subtasks"></ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div data-bind="ifnot:$root.board.unscheduledSubTasksAreExpanded">
                &nbsp;
            </div>
            {{/if}}




        </div>
    </div>
    <div data-bind="visible: !$root.board.releasesLoadDone()" id="release-load-indicator"><div class="spinner"></div><span>Loading</span></div>
</script>
<script type="text/html" id="storymap.board.board3level:remove-release-confirm">
    <div class="header">Confirmation</div>
    <div class="content">
        <div data-bind="if: isEmpty">
            Are you sure you want to delete this release?
        </div>
        <div id="confirm-not-empty-release-delete" data-bind="ifnot: isEmpty">
            There are subtasks associated with this release. <br>
            Do you want to
            <div>
                <label>
                    <input type="radio" name="opt" value="unscheduled" data-bind="checked: moveSubtasksTo, radio:true" />
                    leave them unscheduled, or
                </label>
            </div>
            <div class="move-to-release-wrapper">
                <label>
                    <input type="radio" name="opt" value="release" data-bind="checked: moveSubtasksTo, enable: hasOtherReleases, radio:true" />
                    move them to
                </label>
                <select data-bind="options: otherReleases, optionsText: 'name', value: selectedOtherRelease, select: true"></select> ?
            </div>
        </div>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="debouncedClick: removeRelease">OK</button>
        <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Cancel</button>
    </div>
</script>
<script type="text/html" id="storymap.board.board3level"> {{#if $root.board.boardIsReady}}
{{#template 'storymap.board.boardisempty'/}}
{{/if}}




<div id="board-boundaries" data-bind="visible: $root.board.hasCard, css: { 'board-boundaries-pinned': $root.isTopLevelCardsArePinned() }">

    <div id="board" data-bind="css: { 'board-pinned': $root.isTopLevelCardsArePinned(), 'search-filter-active': $root.isSearchAndFilterActive(), 'has-activity-persona-images': $root.hasActivityPersonaImages, 'has-activity-personas': $root.hasActivityPersonaNames }, style: { width : $root.board.widthOfBodyOnUnPinnedBoard() }">

        {{#template 'storymap.board.board3level:board-head-template' /}}
        {{#template 'storymap.board.board3level:board-body-template' /}}

    </div>
</div>









</script>
<script type="text/html" id="storymap.board.board3levelcards:activity">
    <div class="board-activity-card card"
         data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                    click: function(data, event) { $root.handleCardClick(data,event) },
                    classes: classes,
                    attr: { id : id },
                    templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                    showTemplateOnHover: {
                        placeholder: '.board-card-buttons-placeholder',
                        templateName: 'storymap.board.board3levelcards:activity-buttons',
                        selector: '.board-card-buttons, .card-collapse-container',
                        delay: 100,
                        hideDelay: $root.cardsButtonBarHideDelay,
                        hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                        disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                        orDisabled: $data.inlineEditing,
                        orDisabled2: false },
                    clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">

        {{#ifnot isTransparentAnnotation}}
        <div class="board-card-indicators">
            {{#if $data.isWatched() }}
            <i class="board-card-indicator icon-board-card-indicator-watched"></i>
            {{/if}}
            {{#if $data.hasDescription() }}
            <i class="board-card-indicator icon-board-card-indicator-description"></i>
            {{/if}}
            {{#if $data.hasAttachment() }}
            <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
            {{/if}}
            {{#if $data.hasComment() }}
            <i class="board-card-indicator icon-board-card-indicator-comment"></i>
            {{/if}}
            {{#if isProjectLinked }}
            <i class="board-card-indicator icon-board-card-indicator-sync"></i>
            {{/if}}
        </div>
        <span class="board-toplevel-card-estimation"
              data-bind='visible:$data.aggregatedEstimation() > 0,attr: {"data-tip":"Aggregated estimate in " + $root.storymapEstimationUnit() }'>
            {{aggregatedEstimation}}
        </span>
        {{/ifnot}}
        <div class="board-card-title-wrapper">
            {{#ifnot inlineEditing}}
            <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
            {{/ifnot}}
            <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
                value: name,
                displayPrefix: linkedItemKey,
                showDisplayPrefix: $root.showLinkedItemKeysOnCards,
                editmode: $data.inlineEditing,
                emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
                emptyClass: 'board-card-empty-title',
                selectTextOnFocus: false,
                inputClass: 'board-card-title-editor',
                endEditOnEnterKey: true,
                autoellipsis:true,
                trigger: 'none',
                onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
                }">
            </span>
        </div>
        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                <div class="board-card-buttons-placeholder"></div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="storymap.board.board3levelcards:activity-buttons">
    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer }}
    <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
    {{/ifnot}}

<div class="board-card-buttons">

    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer()}}
    <a class="board-card-icon-button-without-padding" data-tip="Add next card" data-bind="debouncedClick: function() { $root.board.addNewActivityAt($index() + 1); }">
        <i class="icon-storymap-bc-next-card"></i>
    </a>
    {{/ifnot}}

    <!-- Editor or Viewer -->

    <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">
        <a class="board-card-icon-button-without-tooltip">
            <i class="icon-storymap-bc-options"></i>
        </a>
        <div class="menu-content board-subtask-more-dropdown-menu-content">
            <ul>
                <!-- Integration -->
                {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                <!-- Integration / Go to card -->
                {{#if isGoToConnectedCardEnabled }}
                <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                <!-- Integration / Push card -->
                {{/if}}
                {{#if $data.color() !== 99 && !$root.currentUserIsViewer() && !$data.isPushedToIssueTracker() && $root.isTopLevelCardSyncSupported() }}
                <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                {{/if}}
                {{#if isGoToConnectedCardEnabled() || (!$root.currentUserIsViewer() && !$data.isPushedToIssueTracker() && $root.isTopLevelCardSyncSupported()) }}
                <li class="dropdown-menu-line"><hr></li>
                {{/if}}
                {{/if}}

                <!-- Collapse / Expand  -->
                {{#if $data.color() !== 99 }}
                {{#if $data.expanded() && $data.tasks().length > 0}}
                <li><a data-bind="click: function () { $data.collapse(); }">Collapse children</a></li>
                {{/if}}
                {{#ifnot $data.expanded}}
                <li><a data-bind="click: function () { $data.expand(); }">Expand children</a></li>
                {{/ifnot}}
                <li><a data-bind="click: function () { $root.board.collapseActivitiesExcept($data); }">Collapse others</a></li>
                <li><a data-bind="click: function () { $root.board.showRelatedReleasesTo($data); }">Show related releases</a></li>
                {{/if}}

                <!-- Copy, Cut, Paste, Delete -->
                {{#ifnot $root.currentUserIsViewer()}}
                <li class="dropdown-menu-line"><hr></li>
                <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                {{#if $root.board.hasCardToPaste }}
                <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                {{/if}}
                <li class="dropdown-menu-line"><hr></li>
                <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                {{/ifnot}}
            </ul>
        </div>
    </div>

    {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
    <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
        <i class="icon-storymap-add-card-annotation"></i>
    </a>
    {{/if}}

    {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
    <a class="board-card-icon-button-without-tooltip" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
        <i class="icon-storymap-bc-edit-title"></i>
    </a>
    {{/if}}
</div>
</script>
<script type="text/html" id="storymap.board.board3levelcards:task">
    <li class="board-task board-task-card card"
        data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                   click: function(data, event) { $root.handleCardClick(data,event) },
                   sortableItem: viewmodels.storymap.bindings.task.getSortableItem($parent, $data),
                   classes: classes,
                   attr: { id : id },
                   templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                   showTemplateOnHover: {
                        placeholder: '.board-card-buttons-placeholder',
                        templateName: 'storymap.board.board3levelcards:task-buttons',
                        selector: '.board-card-buttons, .card-collapse-container',
                        delay: 100,
                        hideDelay: $root.cardsButtonBarHideDelay,
                        hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                        disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                        orDisabled: $data.inlineEditing,
                        orDisabled2: false },
                clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">


        {{#ifnot isTransparentAnnotation}}
        <div class="board-card-indicators">
            {{#if $data.isWatched() }}
            <i class="board-card-indicator icon-board-card-indicator-watched"></i>
            {{/if}}
            {{#if $data.hasDescription() }}
            <i class="board-card-indicator icon-board-card-indicator-description"></i>
            {{/if}}
            {{#if $data.hasAttachment() }}
            <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
            {{/if}}
            {{#if $data.hasComment() }}
            <i class="board-card-indicator icon-board-card-indicator-comment"></i>
            {{/if}}
            {{#if $data.hasPersonas() }}
            <i class="board-card-indicator icon-board-card-indicator-persona"></i>
            {{/if}}
            {{#if: isProjectLinked }}
            <i class="board-card-indicator icon-board-card-indicator-sync"></i>
            {{/if}}
        </div>
        <span class="board-toplevel-card-estimation"
              data-bind='visible:$data.aggregatedEstimation() > 0,attr: {"data-tip":"Aggregated estimate in " + $root.storymapEstimationUnit() }'>
            {{aggregatedEstimation}}
        </span>
        {{/ifnot}}
        <div class="board-card-title-wrapper">
            {{#ifnot inlineEditing}}
            <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
            {{/ifnot}}
            <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
                value: name,
                displayPrefix: linkedItemKey,
                showDisplayPrefix: $root.showLinkedItemKeysOnCards,
                editmode: $data.inlineEditing,
                emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
                emptyClass: 'board-card-empty-title',
                selectTextOnFocus: true,
                inputClass: 'board-card-title-editor',
                endEditOnEnterKey: true,
                autoellipsis:true,
                trigger: 'none',
                onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
                }">
            </span>
        </div>
        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                <div class="board-card-buttons-placeholder"></div>
            </div>
        </div>
    </li>
</script>
<script type="text/html" id="storymap.board.board3levelcards:task-buttons">
    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer }}
    <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
    {{/ifnot}}

<div class="board-card-buttons">

    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer()}}
    <a class="board-card-icon-button-without-padding" data-tip="Add next card" data-bind="debouncedClick: function() { $root.board.addNewTaskForAt($parent,$index() + 1); }">
        <i class="icon-storymap-bc-next-card"></i>
    </a>
    {{/ifnot}}

    <!-- Editor or Viewer -->
    {{#if !$root.currentUserIsViewer() || $data.isProjectLinked() && $root.isIntegrationEnabled() }}
    <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">
        <a class="board-card-icon-button-without-tooltip">
            <i class="icon-storymap-bc-options"></i>
        </a>
        <div class="menu-content board-subtask-more-dropdown-menu-content">
            <ul>

                <!-- Add unscheduled child -->
                {{#ifnot $root.currentUserIsViewer()}}
                <li><a data-bind="click: function() { $root.board.addNewUnscheduledSubTaskFor($data); }">Add unscheduled child</a></li>
                {{/ifnot}}

                <!-- Integration -->
                {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                <!-- Integration / Go to card -->
                {{#if isGoToConnectedCardEnabled }}
                <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                {{/if}}
                <!-- Integration / Push card -->
                {{#if: $data.color() !== 99 && !$data.isProjectLinked() && $root.isSecondLevelCardSyncSupported() }}
                <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                {{/if}}
                {{/if}}

                <li class="dropdown-menu-line"><hr></li>

                <!-- Copy, Cut, Paste, Delete -->
                {{#ifnot $root.currentUserIsViewer()}}
                <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                {{#if $root.board.hasCardToPaste }}
                <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                {{/if}}
                <li class="dropdown-menu-line"><hr></li>
                <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                {{/ifnot}}
            </ul>
        </div>
    </div>
    {{/if}}

    {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
    <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
        <i class="icon-storymap-add-card-annotation"></i>
    </a>
    {{/if}}

    {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
    <a class="board-card-icon-button" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
        <i class="icon-storymap-bc-edit-title"></i>
    </a>
    {{/if}}

</div>
</script>
<script type="text/html" id="storymap.board.board3levelcards:subtask">

    <li class="board-subtask-card card"
        data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                   click: function(data, event) { $root.handleCardClick(data,event) },
                   sortableItem: viewmodels.storymap.bindings.subTasks.getSortableItem($parent, $data),
                   classes: classes,
                   attr: { id : id },
                   templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                   showTemplateOnHover: {
                        placeholder: '.board-card-buttons-placeholder',
                        templateName: 'storymap.board.board3levelcards:subtask-buttons',
                        selector: '.board-card-buttons, .card-collapse-container',
                        delay: 100,
                        hideDelay: $root.cardsButtonBarHideDelay,
                        hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                        disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                        orDisabled: $data.inlineEditing,
                        orDisabled2: false },
                    clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">

        {{#ifnot isTransparentAnnotation}}
        <div class="board-card-indicators">
            {{#if $data.isWatched() }}
            <i class="board-card-indicator icon-board-card-indicator-watched"></i>
            {{/if}}
            {{#if $data.hasEstimation() }}
            <span class="board-card-indicator board-card-indicator-estimation">
                {{estimation}}
            </span>
            {{/if}}
            {{#if $data.hasDescription() }}
            <i class="board-card-indicator icon-board-card-indicator-description"></i>
            {{/if}}
            {{#if $data.hasAttachment() }}
            <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
            {{/if}}
            {{#if $data.hasComment() }}
            <i class="board-card-indicator icon-board-card-indicator-comment"></i>
            {{/if}}
            {{#if $data.hasPersonas() }}
            <i class="board-card-indicator icon-board-card-indicator-persona"></i>
            {{/if}}
            {{#if: isProjectLinked }}
            <i class="board-card-indicator icon-board-card-indicator-sync"></i>
            {{/if}}
        </div>
        {{/ifnot}}

        <div class="board-card-title-wrapper">
            {{#ifnot inlineEditing}}
            <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
            {{/ifnot}}
            <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
                value: name,
                displayPrefix: linkedItemKey,
                showDisplayPrefix: $root.showLinkedItemKeysOnCards,
                editmode: $data.inlineEditing,
                emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
                emptyClass: 'board-card-empty-title',
                selectTextOnFocus: true,
                inputClass: 'board-card-title-editor',
                endEditOnEnterKey: true,
                autoellipsis:true,
                trigger: 'none',
                onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
                }">
            </span>
        </div>
        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                {{#ifnot isTransparentAnnotation}}

                {{#if $root.currentUserIsViewer() }}
                <span class="board-subtask-statuses-menu-selected-option" data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() }, text: $data.status().name(), style: { 'background-color': $data.status().color }">
                </span>
                {{/if}}

                {{#ifnot $root.currentUserIsViewer() }}
                {{#if $root.isIntegrationEnabled() && $data.isPushedToIssueTracker()}}
                <span class="board-subtask-statuses-menu-selected-option disabled" data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() + ' managed by (' + $root.integrationToolName() + ')' }, text: $data.status().name(), style: { 'background-color': $data.status().color }">
                </span>
                {{/if}}

                {{#if !$root.isIntegrationEnabled() || !$data.isPushedToIssueTracker() }}
                <div class="board-subtask-statuses-menu" data-bind="toggleTemplateOnHover: {
                            templateName: 'storymap.board.board3levelcards:subtask-status-display',
                            toggleTemplateName: 'storymap.board.board3levelcards:subtask-status-menu',
                            }">
                    <span class="board-subtask-statuses-menu-selected-option" data-bind="text: $data.status().name(), style: { 'background-color': $data.status().color }">
                    </span>
                </div>
                {{/if}}
                {{/ifnot}}

                {{/ifnot}}

                <div class="board-card-buttons-placeholder"></div>

                {{#if $parent.isLastElement($data) === true && !$root.currentUserIsViewer()}}
                <div class="board-card-last-element-add">
                    <div class="board-card-last-element-add-inner" data-bind="debouncedClick: function() { $root.board.addNewSubTaskFor($parent); }">
                        <i class="icon-board-card-last-element-add-inner"></i>
                    </div>
                </div>
                {{/if}}

            </div>
        </div>


    </li>
</script>
<script type="text/html" id="storymap.board.board3levelcards:subtask-status-display">
    <span class="board-subtask-statuses-menu-selected-option" data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() } ,text: $data.status().name(), style: { 'background-color': $data.status().color }">
    </span>
</script>
<script type="text/html" id="storymap.board.board3levelcards:subtask-status-menu">
    <!--<div class="board-subtask-statuses-menu" data-bind="dropdownchoose: { prop: $data.statusKey, callback: function(stateId) { $root.board.tryCommitTitleChangesOfCurrentlyEditedCard(); $data.updateStatus.bind($data)(stateId); }, disabled: $root.currentUserIsViewer() || ($root.isIntegrationEnabled() && $data.isPushedToIssueTracker()) }">-->
    <!--<span class="board-subtask-statuses-menu-selected-option" data-bind="css: { todo: $data.status().key == 1, doing: $data.status().key == 2, ready: $data.status().key == 3, done: $data.status().key == 4  }"></span>-->
    <!--<ul class="board-subtask-statuses-menu-items">
        <li class="board-subtask-statuses-menu-item" data-value="1">Todo</li>
        <li class="board-subtask-statuses-menu-item" data-value="2">Doing</li>
        <li class="board-subtask-statuses-menu-item" data-value="3">Ready</li>
        <li class="board-subtask-statuses-menu-item" data-value="4">Done</li>
    </ul>-->
    <!--</div>-->

    <div class="dropdown-menu" data-bind="dropdownmenu: true">
        <a href="#" data-bind="stopPropagation: true" class="trigger">
            <span class="small-font board-subtask-statuses-menu-selected-option"
                  style="color: white;"
                  data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() }, style: { 'background-color': $data.status().color } ,text: $data.status().name"></span>
        </a>
        <div class="menu-content left-aligned" style="top: -1px;">
            <ul data-bind="foreach: $root.subtaskStatuses">
                <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $root.board.tryCommitTitleChangesOfCurrentlyEditedCard(); $parent.updateStatus.bind($parent)($data.key); }">
                    <div class="status-menu-item__color-box"
                         data-bind="css: { 'bordered': color().toLowerCase() == '#ffffff'}, style: { 'background-color': color }"></div>
                    <a class="ml-5" data-bind="text: name"></a>
                </li>
            </ul>
            {{#if $root.currentUserIsAdmin }}
            <div class="mt-5 pl-10 pb-5 pointer subtask-status-menu__link" data-bind="clickStop: true">
                <span data-bind="click: $root.openWorkflowSettingsModal">manage workflow</span>
            </div>
            {{/if}}
        </div>
    </div>
</script>
<script type="text/html" id="storymap.board.board3levelcards:subtask-buttons">
    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer }}
    <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
    {{/ifnot}}

<div class="board-card-buttons">

    <!-- Editor only -->
    {{#ifnot $root.currentUserIsViewer() }}
    <a class="board-card-icon-button-without-padding" data-tip="Add card below" data-bind="debouncedClick: function(e) { $root.board.addNewSubTaskForAt($parent, $index() + 1); }">
        <i class="icon-storymap-bc-add-bellow"></i>
    </a>
    {{/ifnot}}

    <!-- Editor or Viewer -->
    {{#if !$root.currentUserIsViewer() || $data.isProjectLinked() }}
    <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">
        <a class="board-card-icon-button-without-tooltip" data-tip="More...">
            <i class="icon-storymap-bc-options"></i>
        </a>
        <div class="menu-content board-subtask-more-dropdown-menu-content">
            <ul>
                <!-- Integration -->
                {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                <!-- Integration / Go to card -->
                {{#if isGoToConnectedCardEnabled }}
                <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                {{/if}}
                <!-- Integration / Push card -->
                {{#if $data.color() !== 99 && !$root.currentUserIsViewer() && !$data.isPushedToIssueTracker()  }}
                <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                {{/if}}
                {{#if isGoToConnectedCardEnabled() || (!$root.currentUserIsViewer() && !$data.isPushedToIssueTracker()) }}
                <li class="dropdown-menu-line"><hr></li>
                {{/if}}
                {{/if}}

                <!-- Unschedule, Delete, Copy, Cut, Paste  -->
                {{#ifnot $root.currentUserIsViewer() }}
                <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                {{#if $root.board.hasCardToPaste }}
                <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                {{/if}}
                <li class="dropdown-menu-line"><hr></li>
                <li><a data-bind="click: function() { $data.unschedule(); }">Unschedule card</a></li>
                <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                {{/ifnot}}
            </ul>
        </div>
    </div>
    {{/if}}

    {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
    <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
        <i class="icon-storymap-add-card-annotation"></i>
    </a>
    {{/if}}

    {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
    <a class="board-card-icon-button" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
        <i class="icon-storymap-bc-edit-title"></i>
    </a>
    {{/if}}

</div>
</script>
<script type="text/html" id="storymap.board.board3levelcards:unscheduled-subtask">
    <li class="board-subtask-card card"
        data-bind="click: function() { $.fn.dropdownmenu.hide(); $.fn.dropdownChoose.hide(); },
                click: function(data, event) { $root.handleCardClick(data,event) },
                sortableItem: viewmodels.storymap.bindings.unscheduledSubTasks.getSortableItem($parent, $data),
                classes: classes,
                attr: { id : id },
                templatedContextmenu: { template: 'templates:coloreditor-for-board', useParentContext:true, afterRender: function() { $root.showCardColorEditor($data); }, afterRenderContext: $root, scrollContainer: '#main, #board-body-container', onClose: function() { $root.isColorEditorInEditMode(false) }, disabled: $root.currentUserIsViewer },
                showTemplateOnHover: {
                    placeholder: '.board-card-buttons-placeholder',
                    templateName: 'storymap.board.board3levelcards:unscheduled-subtask-buttons',
                    selector: '.board-card-buttons, .card-collapse-container',
                    delay: 100,
                    hideDelay: $root.cardsButtonBarHideDelay,
                    hideCallback: function() { $root.cardsButtonBarHideDelay(150); },
                    disabled: $root.board.zoomFactorIsNotEnoughToShowCardButtons,
                    orDisabled: $data.inlineEditing,
                    orDisabled2: false },
                clickCloseTemplatedContextmenu:  { onClose: function() { $root.isColorEditorInEditMode(false) } } ">

        {{#ifnot isTransparentAnnotation}}
        <div class="board-card-indicators">
            {{#if $data.isWatched() }}
            <i class="board-card-indicator icon-board-card-indicator-watched"></i>
            {{/if}}
            {{#if $data.hasEstimation() }}
            <span class="board-card-indicator board-card-indicator-estimation">
                {{estimation}}
            </span>
            {{/if}}
            {{#if $data.hasDescription() }}
            <i class="board-card-indicator icon-board-card-indicator-description"></i>
            {{/if}}
            {{#if $data.hasAttachment() }}
            <i class="board-card-indicator icon-board-card-indicator-attachment"></i>
            {{/if}}
            {{#if $data.hasComment() }}
            <i class="board-card-indicator icon-board-card-indicator-comment"></i>
            {{/if}}
            {{#if $data.hasPersonas() }}
            <i class="board-card-indicator icon-board-card-indicator-persona"></i>
            {{/if}}
            {{#if isProjectLinked }}
            <i class="board-card-indicator icon-board-card-indicator-sync"></i>
            {{/if}}
        </div>
        {{/ifnot}}
        <div class="board-card-title-wrapper">
            {{#ifnot inlineEditing}}
            <card-annotations params="cardAnnotations: cardAnnotations"></card-annotations>
            {{/ifnot}}
            <span class="board-card-title-text" data-bind="inlineRestrictedMarkdownEditor: {
                value: name,
                displayPrefix: linkedItemKey,
                showDisplayPrefix: $root.showLinkedItemKeysOnCards,
                editmode: $data.inlineEditing,
                emptyText: $data.color() == 99 ? 'Empty transparent card' : 'Empty card',
                emptyClass: 'board-card-empty-title',
                selectTextOnFocus: true,
                inputClass: 'board-card-title-editor',
                endEditOnEnterKey: true,
                autoellipsis:true,
                trigger: 'none',
                onEndEdit: function(isCanceled) { $root.board.endInlineEditing(isCanceled, $data); }
            }">
            </span>
        </div>

        <div class="board-card-buttons-container">
            <div class="board-card-buttons-wrapper">
                {{#ifnot isTransparentAnnotation}}

                {{#if $root.currentUserIsViewer() }}
                <span class="board-subtask-statuses-menu-selected-option" data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() }, text: $data.status().name(), style: { 'background-color': $data.status().color }">
                </span>
                {{/if}}

                {{#ifnot $root.currentUserIsViewer() }}
                {{#if $root.isIntegrationEnabled() && $data.isPushedToIssueTracker()}}
                <span class="board-subtask-statuses-menu-selected-option disabled" data-bind="qtip: { position: 'top', delay: 1, contentValue: $data.status().name() + ' managed by (' + $root.integrationToolName() + ')' }, text: $data.status().name(), style: { 'background-color': $data.status().color }">
                </span>
                {{/if}}

                {{#if !$root.isIntegrationEnabled() || !$data.isPushedToIssueTracker() }}
                <div class="board-subtask-statuses-menu" data-bind="toggleTemplateOnHover: {
                                templateName: 'storymap.board.board3levelcards:subtask-status-display',
                                toggleTemplateName: 'storymap.board.board3levelcards:subtask-status-menu',
                                }">
                    <span class="board-subtask-statuses-menu-selected-option" data-bind="text: $data.status().name(), style: { 'background-color': $data.status().color }">
                    </span>
                </div>
                {{/if}}
                {{/ifnot}}

                {{/ifnot}}

                <div class="board-card-buttons-placeholder"></div>

                {{#if $parent.isLastSubtaskElement($data) && !$root.currentUserIsViewer()}}
                <div class="board-card-last-element-add">
                    <div class="board-card-last-element-add-inner" data-bind="debouncedClick: function() { $root.board.addNewUnscheduledSubTaskFor($parent); }">
                        <i class="icon-board-card-last-element-add-inner"></i>
                    </div>
                </div>
                {{/if}}
            </div>
        </div>
    </li>
</script>
<script type="text/html" id="storymap.board.board3levelcards:unscheduled-subtask-buttons">

    <div class="board-card-buttons">
        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer }}
        <card-annotation-context-menu params="
                              card: $data,
                              cardAnnotations: cardAnnotations,
                              availableAnnotations: $root.annotations,
                              isEditEnabled: isCardAnnotationsVisible,
                              contextMenuOpener: isCardAnnotationsContextMenuOpen"></card-annotation-context-menu>
        {{/ifnot}}

        <!-- Editor only -->
        {{#ifnot $root.currentUserIsViewer() }}
        <a class="board-card-icon-button-without-padding" data-tip="Add card below" data-bind="debouncedClick: function() { $root.board.addNewUnscheduledSubTaskForAt($parent,$index() + 1); }">
            <i class="icon-storymap-bc-add-bellow"></i>
        </a>
        {{/ifnot}}

        <!-- Editor or Viewer -->
        {{#if !$root.currentUserIsViewer() || $data.isProjectLinked() }}
        <div class="dropdown-menu board-subtask-more-dropdown-menu" data-bind="dropdownmenu: true">

            <a class="board-card-icon-button-without-tooltip">
                <i class="icon-storymap-bc-options"></i>
            </a>
            <div class="menu-content board-subtask-more-dropdown-menu-content">
                <ul>
                    <!-- Integration -->
                    {{#if common.SubscriptionManager.hasIntegrationFeatureAddOn() && $root.isIntegrationEnabled()}}
                    <!-- Integration / Go to card -->
                    {{#if isGoToConnectedCardEnabled }}
                    <li><a data-bind="text: $root.goToConnectedCardCaption, debouncedClick: function() { window.open($data.linkedItemUrl(), '_blank'); }"></a></li>
                    {{/if}}
                    <!-- Integration / Push card -->
                    {{#if $data.color() !== 99 && !$root.currentUserIsViewer() && !$data.isPushedToIssueTracker()  }}
                    <li><a data-bind="debouncedClick: function() { pushCard(); }">Push card to {{$root.integrationToolName()}}</a></li>
                    {{/if}}
                    {{#if isGoToConnectedCardEnabled() || (!$root.currentUserIsViewer() && !$data.isPushedToIssueTracker()) }}
                    <li class="dropdown-menu-line"><hr></li>
                    {{/if}}
                    {{/if}}


                    <!--Delete, Copy, Cut, Paste -->
                    {{#ifnot $root.currentUserIsViewer() }}
                    <li><a data-bind="click: function() { $root.copyCardToClipboard($data); }">Copy card</a></li>
                    <li><a data-bind="click: function() { $root.cutCardToClipboard($data.id); }">Cut card</a></li>
                    {{#if $root.board.hasCardToPaste }}
                    <li><a data-bind="click: function() { $root.pasteCard($data.id); }">Paste card</a></li>
                    {{/if}}
                    <li class="dropdown-menu-line"><hr></li>
                    <li><a data-bind="debouncedClick: function() { $data.delete(); return false; }">Delete card</a></li>
                    {{/ifnot}}
                </ul>
            </div>
        </div>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && isCardAnnotationsVisible() && $root.annotations().length > 0 && $root.shouldShowAnnotationButton() }}
        <a class="add-card-anontation-icon board-card-icon-button" data-tip="Annotate card" data-bind="clickAndStop: toggleAnnotationContextMenu">
            <i class="icon-storymap-add-card-annotation"></i>
        </a>
        {{/if}}

        {{#if !$root.currentUserIsViewer() && !$data.inlineEditing() }}
        <a class="board-card-icon-button" data-tip="Edit title" data-bind="debouncedClick: function() { $root.board.startInlineEditingFor($data); }">
            <i class="icon-storymap-bc-edit-title"></i>
        </a>
        {{/if}}

    </div>
</script>
<script type="text/html" id="storymap.board.board3levelcards"> <!-- Activity template -->



<!-- Activity buttons  template -->



<!-- Task template -->



<!-- Task buttons template -->



<!-- Subtask template -->



<!-- Subtask status menu template -->






<!-- Subtask buttons template -->




<!-- Unscheduled subtask template -->



<!-- Unscheduled subtask buttons template -->

</script>
<script type="text/html" id="storymap.board.boardisempty"> <!-- ko ifnot: $root.board.hasCard() -->
<!-- ko if: !$root.currentUserIsViewer() -->
<div class="alert-outer">
    <div class="alert">
        {{#ifnot $root.isTemplate }}
        <div class="alert-title">
            Are you ready to visualize your product vision?
        </div>
        <div class="alert-description">
            <a class="button btn-action-primary" data-bind="clickAndStop: $root.board.addFirstCardToBoard.bind($root.board)">Let's add</a> your first card to this board. You can also use the 'n' <a data-bind="click: showKeyboardShortcutsHelp">keyboard shortcut</a> to create cards.
            <br /><br />
            {{#if currentUserIsAdmin}}
            <strong>ProTip</strong> Use the <a data-bind="click: editAboutBoardText.bind($root)">About this board</a> panel to introduce your product vision and help your <a data-bind="click: openCollaboratorsModal.bind($root)">collaborators</a> to understand and get familiar with the concept.
            <br /><br />
            {{/if}}
            Don't know how to get started? Click <a data-bind="redirect: {url: globalConfig.helpLinkAboutThisToolForEditors, openInNewTab: true}">here</a> for a short introduction.
        </div>
        {{/ifnot}}
        {{#if $root.isTemplate }}
        <div class="storymap-template-intro">
            <div class="alert-title">
                Boost your discovery process with story map templates
            </div>
            <div class="alert-description">
                <div class="mb-5">Create a template story map with settings that fit your workflow</div>
                <ul>
                    <li>Create user persona templates</li>
                    <li>Set up custom workflows</li>
                    <li>Set up card colors and annotations</li>
                    <li>Assign a group of collaborators <a data-bind="click: openCollaboratorsModal.bind($root)">here</a></li>
                </ul>

                <br />
                <div>Do you keep re-using the same epics, steps, or even user stories? Create a basic story map for a template. <a class="button btn-action-primary" data-bind="clickAndStop: $root.board.addFirstCardToBoard.bind($root.board)">Let's add the first card</a></div>
                <br />
                <div class="mb-5">Useful links:</div>
                <ul>
                    <li><a data-bind="click: $root.showKeyboardShortcutsHelp">Keyboard shortcuts</a></li>
                    <li><a data-bind="redirect: {url: 'https://storiesonboard.com/user-story-mapping-intro.html', openInNewTab: true}">User story mapping basics</a></li>
                </ul>
            </div>
        </div>
        {{/if }}
    </div>
</div>
<!-- /ko -->
<!-- ko if: $root.currentUserIsViewer() -->
<div class="alert-outer">
    <div class="alert">
        <div class="alert-title">
            This board has no cards yet!
        </div>
        <div class="alert-description">
            Please check back later.
            <br /><br />
        </div>
    </div>
</div>
<!-- /ko -->
<!-- /ko -->
</script>
<script type="text/html" id="storymap.board.cards:helper">
    {{#if $data}}
    <div class='board-sortable-helper' data-bind="class: { name: $data.colorClass }">
        <!-- $data megltt mindig ellenrizni kell, mert a helper template hamarabb generldik, mint a start-ban a movingItem bellts -->
        <div data-bind="if: $data && $data.name">
            <span class="board-sortable-helper-text" data-bind="text: $data.name"></span>
        </div>
    </div>
    {{/if}}
</script>
<script type="text/html" id="storymap.board.cards:activity-placeholder">
    <div class="board-placeholder-card"></div>
    <div class="line"></div>
</script>
<script type="text/html" id="storymap.board.cards:placeholder">
    <div class="board-placeholder-card"></div>
</script>
<script type="text/html" id="storymap.board.cards:release-placeholder">
    <div class="release-placeholder-line"></div>
</script>
<script type="text/html" id="storymap.board.cards:release-helper">
    <div class='board-sortable-release-helper'>
        <!-- $data megltt mindig ellenrizni kell, mert a helper template hamarabb generldik, mint a start-ban a movingItem bellts -->
        <div data-bind="if: $data && $data.name">
            <span data-bind="text: $data.name"></span>
        </div>
    </div>
</script>
<script type="text/html" id="storymap.board.cards"> 
<!-- Helper template -->




<!-- Activity placeholder template -->



<!-- Task, subtask placeholder template -->



<!-- Release placeholder template -->


<!-- Release helper template -->


</script>
<script type="text/html" id="storymap.board.command-failed-no-network:command-failed-no-network-modal">
    <div class="header">You are offline</div>
    <div class="content">
        <p>
            The last operation you attempted has failed due to a possible network outage.
        </p>
        <p class="mt-20">
            Please check your network connection and reload the page.
        </p>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="click: function() { location.reload(true); }">Reload now</button>
    </div>
</script>
<script type="text/html" id="storymap.board.header"> <div id="header" data-bind="css: {publicMap: $root.isReadOnlyAccessOfPublishedBoard()}">
    <div id="header-title">
        {{#if $root.hasLoggedInUser() && !IsInIframe()}}
        <a href="{{backUrl()}}" class="navigate-back btn-icon light">
            <i class="icon-header-nav-back"></i>
        </a>
        <a href="{{dashboardUrl()}}" class="navigate-dashboard btn-icon light">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-hidden="true"><path d="M4.0258,23.9994 C2.90048904,23.9994 1.9993,23.0518665 1.9993,21.8959 L1.9993,21.8959 L1.9993,8.6349 C1.9993,7.97060311 2.30167149,7.3439756 2.81715338,6.94682346 L2.81715338,6.94682346 L11.2838806,0.415034039 C12.006167,-0.142908013 12.9985851,-0.137686874 13.7165065,0.426985969 L13.7165065,0.426985969 L22.1992418,7.09877788 C22.7060136,7.49685872 23.0013,8.11765187 23.0013,8.7749 L23.0013,8.7749 L23.0013,21.8959 C23.0013,23.0519587 22.1010412,23.9994 20.9758,23.9994 L20.9758,23.9994 Z M13.037087,1.29080894 C12.7147031,1.03724161 12.2791198,1.03494999 11.9554466,1.28497654 L11.9554466,1.28497654 L3.48844662,7.81697654 C3.24494176,8.00458465 3.0983,8.30848157 3.0983,8.6349 L3.0983,8.6349 L3.0983,21.8959 C3.0983,22.4568896 3.52011807,22.9004 4.0258,22.9004 L4.0258,22.9004 L8.5798,22.9009 L8.5798,14.6509 C8.5798,14.0441103 9.07212877,13.5524 9.6793,13.5524 L9.6793,13.5524 L15.1083,13.5524 C15.7147805,13.5524 16.2068,14.0444195 16.2068,14.6509 L16.2068,14.6509 L16.2068,22.9009 L16.2068,22.9009 L20.9758,22.9004 C21.4811698,22.9004 21.9023,22.4571984 21.9023,21.8959 L21.9023,21.8959 L21.9023,8.7749 C21.9023,8.4515612 21.7591406,8.15059116 21.5200935,7.96281403 L21.5200935,7.96281403 Z M15.1078698,14.6513302 L9.67885525,14.6513302 L9.6788,22.9009 L15.1078698,22.9004698 L15.1078698,14.6513302 Z"></path></svg>
        </a>
        {{/if}}
        {{#ifnot $root.hasLoggedInUser()}}
        <a class="stob-logo-container" href="https://storiesonboard.com/">
            <img class="stob-logo" alt="logo" src="../../../content/img/storiesonboard-logo-new.png">
        </a>
        {{/ifnot}}

        <storymap-name></storymap-name>




        {{#if $root.isReadOnlyAccessOfPublishedBoard() === false }}
        <span class="storymap-header-buttons">

            <header-board-actions></header-board-actions>

            {{#if $root.isTemplate}}
            <span class="template-indicator pa-4 ml-4 mr-4" style="border-radius: 4px; color: white; font-size: 13px;">template</span>
            {{/if}}

            {{#ifnot $root.isTemplate}}
            <toggle-favorite-storymap></toggle-favorite-storymap>
            <toggle-mute-board></toggle-mute-board>
            {{/ifnot}}
        </span>
        {{/if}}

        {{#if $root.isReadOnlyAccessOfPublishedBoard() === false }}
            <roadmap-dropdown></roadmap-dropdown>
        
            <div style="position: relative;
                    display: inline-block;
                    margin-top: 5px;
                    float: left;
                    margin-left: 5px;">
                <a class="btn-action-primary button" href="/storymap/{{originalSlug}}?viewType=discovery">
                    NextGen Story map
                </a>
            </div>
        {{/if}}

        <span class="brand-subtext"><board-save-indicator></board-save-indicator></span>

        {{#if !$root.hasLoggedInUser()}}
        <div class="login-dropdown" data-bind="dropdownmenu: { dontCloseOnClick: true, afterOpened: function() { $('#public-login-dropdown-email-field').focus(); }}">
            <a>login</a>
            <div class="menu-content">
                <div class="login-dropdown-menu-content">
                    <div class="login-dropdown-menu-title">
                        Login to StoriesOnBoard
                        <div class="login-dropdown-menu-title-sob"><a data-bind="redirect: 'http://storiesonboard.com'">What is this tool for?</a></div>
                    </div>
                    <ul>
                        <li>
                            <form>
                                {{#if login.showPasswordChangeNeeded}}
                                <div class="control-group">
                                    <div class="password-format-error for-public">
                                        Your password has expired.
                                        Please go to login page, try login and select a new password.
                                        <br /> <br />
                                        <a class="button btn-action btn-action-primary2" data-bind="redirect: globalConfig.workspacesUrl">Go to login</a>
                                    </div>
                                </div>
                                {{/if}}

                                <div class="control-group">
                                    <div class="control w-3-3">
                                        <label>
                                            Email
                                            <input id="public-login-dropdown-email-field" type="text" data-bind="value: login.email" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: login.email"></span>
                                    </div>
                                    {{#ifnot login.isSsoRequired}}
                                    <div class="control">
                                        <label>
                                            Password
                                            <input type="password" data-bind="value: login.password" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: login.password"></span>
                                    </div>
                                    <div class="control">
                                        <span class="styled-check-label">
                                            <input type="checkbox" id="pSignInRememberMe" data-bind="checkbox: {checked: login.rememberMe}">
                                            Remember me
                                        </span>
                                    </div>
                                    {{/ifnot}}
                                </div>
                                <br />
                                {{#ifnot login.isSsoRequired}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="btnClick: login.login.bind($root.login, $data)">Login</button>
                                </div>
                                {{/ifnot}}
                                {{#if login.isSsoRequired}}
                                {{#if !IsInIframe()}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="click: login.loginWithCorporateAccount, hasFocus:login.isSsoLoginButtonFocused">Login with corporate account</button>
                                </div>
                                {{/if}}
                                {{#if IsInIframe() }}
                                <span style="font-size: 13px;">Single sign-on is disabled in iframes.</span>
                                <a target="_blank" onclick="window.open(globalConfig.loginUrl)" style="font-size: 13px;" class="btn-action mt-5" href="{{globalConfig.loginUrl}}">Click here to login</a><span style="font-size: 13px;"> then refresh this page</span>
                                {{/if}}
                                {{/if}}
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="signup-dropdown" data-bind="dropdownmenu: {dontCloseOnClick: true, afterOpened: function() { $('#public-signup-dropdown-name-field').focus(); }}">
            <a>sign up</a>
            <div class="menu-content">
                <div class="signup-dropdown-menu-content">
                    <div class="signup-dropdown-menu-title">
                        Sign up to StoriesOnBoard
                        <div class="signup-dropdown-menu-title-sob"><a data-bind="redirect: 'http://storiesonboard.com'">What is this tool for?</a></div>
                    </div>
                    <ul>
                        <li>
                            <form>

                                <div class="control-group" data-bind="if: signUp.passwordFormatIsInvalid">
                                    <div class="password-format-error for-public">
                                        Your password does not satisfy the current password policy requirements.
                                        <ul>
                                            {{#if signUp.isMinCharCountInvalid}}
                                            <li>{{signUp.minCharCount}} characters</li>
                                            {{/if}}
                                            {{#if signUp.isMinUpperCharCountInvalid}}
                                            <li>{{signUp.minUpperCharCount}} uppercase letters</li>
                                            {{/if}}
                                            {{#if signUp.isMinLowerCharCountInvalid}}
                                            <li>{{signUp.minLowerCharCount}} lowercase letters</li>
                                            {{/if}}
                                            {{#if signUp.isMinNumberCountInvalid}}
                                            <li>{{signUp.minNumberCount}} digits</li>
                                            {{/if}}
                                            {{#if signUp.isMinSpecialCharsCountInvalid}}
                                            <li>{{signUp.minSpecialCharsCount}} special characters</li>
                                            {{/if}}
                                            {{#if signUp.differentPasswordRequired}}
                                            <li>must be different than a previous {{signUp.differentPasswordCount}}</li>
                                            {{/if}}
                                        </ul>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <div class="control">
                                        <label>
                                            Name
                                            <input id="public-signup-dropdown-name-field" type="text" data-bind="value: signUp.name" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.name"></span>
                                    </div>
                                    <div class="control">
                                        <label>
                                            Email
                                            <input type="text" data-bind="value: signUp.email, event: { blur: signUp.checkLoginType, focus: function() { signUp.isSsoRequired(false); } }" />
                                            <!--<input type="text" data-bind="value: signUp.emailConfirmation" tabindex="1000" class="email-confirmation"/> - BNGSZ AUTOCOMPLETE ELRONTOTTA -->
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.email"></span>
                                    </div>
                                    {{#ifnot signUp.isSsoContentVisible}}
                                    <div class="control password">
                                        <label>
                                            Password
                                            <input type="password" data-bind="value: signUp.password, hideShowPassword: {wrapper: {enforceWidth: false}, toggle: {styles: {height: '24px', width: '55px'}}}" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.password"></span>
                                    </div>
                                    {{/ifnot}}
                                    {{#if signUp.isSsoContentVisible() && !IsInIframe() }}
                                    <div class="signup-dropdown-menu-sso-text">
                                        Your company uses their login credentials to access StoriesOnBoard, so you don't need to create a separate password in our system.
                                        To register in StoriesOnBoard you should simply login with your corporate credentials if your company allows access to StoriesOnBoard for you.
                                        To create a personal account instead, please sign up with a personal email address.
                                    </div>
                                    {{/if}}
                                </div>
                                {{#ifnot signUp.isSsoContentVisible}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="btnClick: signUp.signUp.bind($root.signUp, $data)">Sign up</button>
                                </div>
                                {{/ifnot}}
                                {{#if signUp.isSsoContentVisible}}
                                {{#if !IsInIframe()}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="click: signUp.loginWithCorporateAccount, hasFocus:signUp.isSsoContentVisible">Login with corporate account</button>
                                </div>
                                {{/if}}
                                {{#if IsInIframe() }}
                                <span style="font-size: 13px;">Single sign-on is disabled in iframes.</span>
                                <a target="_blank" onclick="window.open(globalConfig.loginUrl)" style="font-size: 13px;" class="btn-action mt-5" href="{{globalConfig.loginUrl}}">Click here to login</a><span style="font-size: 13px;"> then refresh this page</span>
                                {{/if}}
                                {{/if}}
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        {{/if}}
    </div>

    <div id="storymap-header-menu">
        <div class="storymap-header-menu-content">
            <div class="storymap-header-menu-content-inner">
                <!--<span class="sm-header-divider"></span>-->
                {{#if: $root.currentUserIsAdmin() }}
                <span>
                    <a class="btn-action-primary button share-storymap-btn" data-bind="btnClick: openCollaboratorsModal.bind($root)">
                        {{$root.isTemplate ? 'Collaborators' : 'Share'}}
                    </a>
                </span>
                {{/if}}

                <!-- Collapse/expand buttons -->

                <span class="pull-child-left">
                    <div class="expandcollapse-dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="btn-icon header-menu-btn" title="Collapse / Expand" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }">
                            <i class="icon-storymap-h-collapse-expand"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <div class="expandcollapse-dropdown-menu-content" data-bind="css: {twoLevel: $root.board.boardLevel() == 2}">
                                <ul>
                                    <li><a data-bind="dropdownmenuClick: $root.board.collapseAll.bind($root.board)">Collapse all</a></li>
                                    <li><a data-bind="dropdownmenuClick: $root.board.expandAll.bind($root.board)">Expand all</a></li>
                                </ul>
                                {{#if $root.board.boardLevel() == 3}}
                                <ul>
                                    <li><a data-bind="dropdownmenuClick: $root.board.collapseTopCards.bind($root.board)">Collapse top cards</a></li>
                                    <li><a data-bind="dropdownmenuClick: $root.board.expandTopCards.bind($root.board)">Expand top cards</a></li>
                                </ul>
                                <ul>
                                    <li><a data-bind="dropdownmenuClick: $root.board.collapseReleases.bind($root.board)">Collapse releases</a></li>
                                    <li><a data-bind="dropdownmenuClick: $root.board.expandReleases.bind($root.board)">Expand releases</a></li>
                                </ul>
                                {{/if}}
                            </div>
                        </div>
                    </div>

                    <!-- Two/treelevel board -->
                    {{#if $root.board.boardLevel() == 2}}
                    <a class="btn-icon light" title="Switch to three level board view" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, debouncedClick: function() { changeBoardLevelTo(3); }">
                        <i class="icon-storymap-h-two-level-view"></i>
                    </a>
                    {{/if}}
                    {{#if $root.board.boardLevel() == 3}}
                    <a class="btn-icon light" title="Switch to two level board view" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, debouncedClick: function() { changeBoardLevelTo(2); }">
                        <i class="icon-storymap-h-three-level-view"></i>
                    </a>
                    {{/if}}
                    <!--</span>-->
                    <!-- Zoom buttons -->
                    <!--<span class="pull-child-left">-->
                    <!-- Chrom-on fullscreen vlts oda-vissza utn a jobboldali button valamirt elugrik ha nincs itt width -->
                    <!--<a class="btn-icon light" title="Zoom out" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, debouncedClick: $root.board.decreaseZoomFactor.bind($root.board)">
                        <i class="icon-storymap-h-zoom-out"></i>
                    </a>-->
                    <input type="text" data-bind="zoomslider: { width:'80px', min:$root.board.minZoomFactor, max:$root.board.maxZoomFactor, directChange:  function(){ $root.board.setZoomFactorTo() }, value: $root.board.scaleZoomFactor }" />
                    <!--
                    <input type="text" data-bind="slider: { width:'80px', min:$root.board.minZoomFactor, max:$root.board.maxZoomFactor, value: $root.board.zoomFactor, onStartCallback: function() { pubsub.publish(new viewmodels.storymap.BoardZoomLevelChangeStart())  }, onChangeCallback: function(newValue) { if ($root.board.boardIsReady() && newValue !== $root.board.zoomFactor) { pubsub.publish(new viewmodels.storymap.BoardZoomLevelChanging(newValue)) } }, onEndCallback: function(newValue) { pubsub.publish(new viewmodels.storymap.BoardZoomLevelChanged(newValue)) } }" />
                    <a class="btn-icon light" title="Zoom in" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, debouncedClick: $root.board.increaseZoomFactor.bind($root.board)">
                        <i class="icon-storymap-h-zoom-in"></i>
                    </a>-->
                    <!--</span>-->
                    <!--<span>-->
                    <!-- Personas -->
                    <a class="btn-icon light" href="#persona-panel" title="Personas" id="btn-open-persona" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, panelslider: { isPanelOpened: $root.board.isPersonaPanelOpened,  onBefore: function(df){ $root.closeAllPanelComponents.bind($root)(); df.resolve(); }, onComplete: function() { $('#wrapper').css('right','410px'); }, onClose: function() { $('#wrapper').css('right','0'); }}">
                        <i class="icon-storymap-h-persona"></i>
                    </a>
                    <!-- Idea panel -->
                    {{#ifnot $root.isReadOnlyAccessOfPublishedBoard() || $root.isTemplate }}
                    <a class="light storymap-header-ideas-button" title="Ideas" id="btn-open-idea-panel" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, click: $root.toggleIdeaPanel.bind($root)">
                        <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" data-prefix="far" data-icon="lightbulb" class="svg-inline--fa fa-lightbulb fa-w-11" role="img" viewBox="0 0 352 512"><path fill="currentColor" d="M176 80c-52.94 0-96 43.06-96 96 0 8.84 7.16 16 16 16s16-7.16 16-16c0-35.3 28.72-64 64-64 8.84 0 16-7.16 16-16s-7.16-16-16-16zM96.06 459.17c0 3.15.93 6.22 2.68 8.84l24.51 36.84c2.97 4.46 7.97 7.14 13.32 7.14h78.85c5.36 0 10.36-2.68 13.32-7.14l24.51-36.84c1.74-2.62 2.67-5.7 2.68-8.84l.05-43.18H96.02l.04 43.18zM176 0C73.72 0 0 82.97 0 176c0 44.37 16.45 84.85 43.56 115.78 16.64 18.99 42.74 58.8 52.42 92.16v.06h48v-.12c-.01-4.77-.72-9.51-2.15-14.07-5.59-17.81-22.82-64.77-62.17-109.67-20.54-23.43-31.52-53.15-31.61-84.14-.2-73.64 59.67-128 127.95-128 70.58 0 128 57.42 128 128 0 30.97-11.24 60.85-31.65 84.14-39.11 44.61-56.42 91.47-62.1 109.46a47.507 47.507 0 0 0-2.22 14.3v.1h48v-.05c9.68-33.37 35.78-73.18 52.42-92.16C335.55 260.85 352 220.37 352 176 352 78.8 273.2 0 176 0z" /></svg>
                    </a>
                    <!-- Discussion panel -->

                    <a class="btn-icon light" title="Board discussion" id="btn-open-discussion" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, click: $root.toggleDiscussionPanel.bind($root)">
                        {{#ifnot $root.hasNewBoardComment}}
                        <i class="icon-storymap-h-discussion"></i>
                        {{/ifnot}}
                        {{#if $root.hasNewBoardComment}}
                        <i class="icon-storymap-h-discussion has-unread"></i>
                        {{/if}}
                    </a>
                    {{/ifnot}}

                    <!-- Search & filter -->
                    {{#ifnot $root.isTemplate}}
                    <a class="btn-icon light" id="btn-open-search-and-filter" title="Search & filter" href="#search-and-filter-panel"
                       data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1, contentValue: searchIconTooltip },
                              panelslider: { isPanelOpened: $root.isSearchAndFilterPanelOpened, onBefore: function(df){ $root.closeAllPanelComponents.bind($root)(); df.resolve(); },  onComplete: function() { $('#wrapper').css('right','410px'); $root.searchAndFilterPanel.searchTextHasFocus(true); }, onClose: function() { $('#wrapper').css('right','0'); $root.isSearchAndFilterPanelOpened(false); $root.setFocusOnBoard();}},
                              css: { 'not-displayed' : !$root.isDefaultSearchAndFilterButtonVisible() } ">
                        <i data-bind="css: searchIconClass"></i>
                    </a>
                    {{/ifnot}}

                    {{#if !$root.isDefaultSearchAndFilterButtonVisible() }}
                    <div class="search-and-filter-dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="btn-icon light" title="Search & filter"
                           data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1, contentValue: searchIconTooltip }">
                            <i data-bind="css: searchIconClass"></i>
                        </a>

                        <div class="menu-content right-aligned">
                            <div class="search-and-filter-dropdown-menu-content">
                                <ul>
                                    <li>
                                        <a data-bind="click: $root.searchAndFilterPanel.resetFilters">Reset board filter</a>
                                    </li>
                                    <li>
                                        <a data-bind="triggerClickOnElement: { selector: '#btn-open-search-and-filter' }">
                                            {{#if $root.isSearchAndFilterPanelOpened() }}
                                            Close
                                            {{/if}}
                                            {{#ifnot $root.isSearchAndFilterPanelOpened() }}
                                            Open
                                            {{/ifnot}}
                                            search & filter panel
                                        </a>
                                    </li>
                                    <li>
                                        <hr />
                                    </li>
                                    <li class="hint">
                                        Hint: The board is in filtered state.
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    {{/if}}


                    <!-- Tool integration -->
                    {{#if: $root.isIntegrationEnabled() && $root.currentUserIsCollaborator() && common.SubscriptionManager.hasIntegrationFeatureAddOn()}}
                    <div class="integration-dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="btn-icon" title="Tool integration" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }">
                            <i data-bind="attr: { 'class' :( $root.hasImportableCards() && $root.isImportEnabled() ? 'icon-storymap-h-integrated has-importable' : 'icon-storymap-h-integrated') }"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <div class="integration-dropdown-menu-content">
                                <ul>
                                    <li><a data-bind="debouncedClick: function() { window.open($root.linkedProjectUrl(), '_blank'); }">Go to project in {{$root.integrationToolName()}}</a></li>
                                    {{#if !$root.currentUserIsViewer() && $root.isStructureSyncEnabled()}}
                                    <li><a data-bind="debouncedClick: pushTopLevelCards">Push top level cards to {{$root.integrationToolName()}}</a></li>
                                    {{/if}}
                                    <!-- ko if: !$root.currentUserIsViewer() && $root.isImportEnabled() -->
                                    <li><a data-bind="debouncedClick: function() { importNewCards(); }">Import and sync changes from {{$root.integrationToolName()}}</a></li>
                                    <!-- /ko -->
                                    {{#if $root.isLinkedItemKeyHumanReadable}}
                                    {{#if $root.isLinkedItemKeyVisibleOnCards}}
                                    <li><a data-bind="debouncedClick: function() { setLinkedItemKeyVisibilityOnCards(false); }">Hide linked {{$root.integrationToolName()}} keys on cards</a></li>
                                    {{/if}}
                                    {{#ifnot $root.isLinkedItemKeyVisibleOnCards}}
                                    <li><a data-bind="debouncedClick: function() { setLinkedItemKeyVisibilityOnCards(true); }">Show linked {{$root.integrationToolName()}} keys on cards</a></li>
                                    {{/ifnot}}
                                    {{/if}}
                                    {{#if $root.isImpersonationEnabled}}
                                    {{#ifnot $root.isCollaboratorAuthenticated}}
                                    <li><a data-bind="debouncedClick: function() { openImpersonationAuthenticationModal(null, true); }">Authenticate in {{$root.integrationToolName()}}</a></li>
                                    {{/ifnot}}
                                    {{#if  $root.isCollaboratorAuthenticated}}
                                    <li><a data-bind="debouncedClick: function() { removeImpersonationToken(); }">Log me out from {{$root.integrationToolName()}} on this story map</a></li>
                                    {{/if}}
                                    {{/if}}
                                </ul>
                            </div>
                        </div>
                    </div>
                    {{/if}}

                    <!-- View board activities -->
                    {{#if $root.isReadOnlyAccessOfPublishedBoard() === false && !$root.isTemplate }}
                    <a class="btn-icon light" id="btn-open-board-activities" title="View your activity feed" href="#board-activities-panel" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, click: $root.toggleBoardActivities">

                        {{#if $root.hasNewBoardActivity}}
                        <i class="icon-storymap-h-history has-new-activity"></i>
                        {{/if}}
                        {{#ifnot $root.hasNewBoardActivity}}
                        <i class="icon-storymap-h-history"></i>
                        {{/ifnot}}
                    </a>
                    {{/if}}

                    <!-- Notifications -->
                    {{#if $root.isReadOnlyAccessOfPublishedBoard() === false }}
                    <a><storymap-notification-icon params="onClick: $root.toggleNotificationPanel.bind($root)"></storymap-notification-icon></a>
                    {{/if}}

                    <!-- Share, ... buttons -->
                    {{#if: $root.currentUserIsAdmin() }}

                    <!--<a class="btn-icon light" title="Share"
                       data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, btnClick: openCollaboratorsModal.bind($root)">
                        <i class="icon-storymap-h-share"></i>
                    </a>-->
                    {{/if}}

                    <div class="more-dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="btn-icon">
                            <i class="icon-storymap-h-more"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <div class="more-dropdown-menu-content">
                                <ul>
                                    <li><a data-bind="click: $root.toggleAboutBoard.bind($root)">About this board</a></li>
                                    <li><a data-bind="click: $root.toggleAnnotationPanel.bind($root)">Card annotations</a></li>
                                    {{#if $root.currentUserIsAdmin()}}
                                    <li><a data-bind="click: $root.openWorkflowSettingsModal.bind($root)">Workflow settings</a></li>
                                    {{/if}}
                                    {{#if $root.currentUserIsAdmin()}}
                                    <li><a data-bind="click: $root.openStoryTemplatesPanel.bind($root)">User story templates</a></li>
                                    {{/if}}
                                    <li>
                                        <hr />
                                    </li>
                                    {{#if !$root.isReadOnlyAccessOfPublishedBoard()}}
                                    <li><a data-bind="click: $root.openExportModal.bind($root)">Export & print</a></li>
                                    {{/if}}
                                    {{#if !$root.currentUserIsViewer()}}
                                    <li><a data-bind="click: $root.showRecoverableCardDeleteEvents.bind($root)">Recover deleted cards</a></li>
                                    {{/if}}
                                    {{#if !$root.currentUserIsViewer()}}
                                    <li><a data-bind="click: openReleasesModal.bind($root)">Archived releases</a></li>
                                    {{/if}}

                                    {{#if !$root.isReadOnlyAccessOfPublishedBoard() || !$root.currentUserIsViewer() ||  $root.currentUserIsAdmin()}}
                                    <li>
                                        <hr />
                                    </li>
                                    {{/if}}
                                    {{#if $root.board.zoomIsAdaptive}}
                                    <li><a data-bind="click: function() { $root.board.setZoomIsAdaptive(false); app.flash.showSuccess('Normal zoom enabled.'); }">Normal zoom</a></li>
                                    {{/if}}
                                    {{#ifnot $root.board.zoomIsAdaptive}}
                                    <li>
                                        <a class="with-info-icon" data-bind="click: function() { $root.board.setZoomIsAdaptive(true); app.flash.showSuccess('Adaptive zoom enabled.'); }">Adaptive zoom</a>
                                        <div class="adaptive-zoom-info" title="View more text on cards by zooming in." data-bind="qtip: { position: 'top', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }">
                                            <i class="icon-info-circle" aria-hidden="true"></i>
                                        </div>
                                    </li>
                                    {{/ifnot}}
                                    {{#if $root.board.isTopLevelCardsPinnable}}
                                    {{#if $root.board.isTopLevelCardsArePinned}}
                                    <li><a data-bind="click: function() { $root.board.unPinTopLevelCards(); app.flash.showSuccess('Top level cards are unpinned.'); }">Unpin top cards</a></li>
                                    {{/if}}
                                    {{#ifnot $root.board.isTopLevelCardsArePinned}}
                                    <li><a data-bind="click: function() { $root.board.pinTopLevelCards(); app.flash.showSuccess('Top level cards are pinned.'); }">Pin top cards</a></li>
                                    {{/ifnot}}
                                    {{/if}}
                                    <li>
                                        <a data-bind="toggleFullscreen: true">
                                            Fullscreen
                                            <!--<span class="keyboard-shortcut-in-menu">F11</span>-->
                                        </a>
                                    </li>


                                </ul>
                            </div>
                        </div>
                    </div>

                    {{#if $root.hasLoggedInUser()}}
                    <a class="btn-icon account-on-board" data-bind="component: { name: 'account-on-board', params: {
                                                                                                    storymapId: $root.storymapId(),
                                                                                                    shouldHideSlack: $root.isPublicMapViewer || $root.isPrivateLinkSharedAccess} }"></a>
                    {{/if}}

                </span>

                <!-- Increase... button -->
                <!--<span>
                    <a class="btn-icon light" title="Increase work area" data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, toggleFullscreen: true">
                        <i class="icon-storymap-h-fullscreen"></i>
                    </a>
                </span>-->
            </div>
        </div>
    </div>
</div></script>
<script type="text/html" id="storymap.board.headercompact"> <div id="header-compact">
    <div class="left-side">
        <span data-bind="text: storymapName, toggleFullscreen: true" class="storymap-name"></span>

        {{#if !$root.hasLoggedInUser()}}
        <div class="login-dropdown" data-bind="dropdownmenu: { dontCloseOnClick: true, afterOpened: function() { $('#public-login-dropdown-email-field').focus(); }}">
            <a>login</a>
            <div class="menu-content">
                <div class="login-dropdown-menu-content">
                    <div class="login-dropdown-menu-title">
                        Login to StoriesOnBoard
                        <div class="login-dropdown-menu-title-sob"><a data-bind="redirect: 'http://storiesonboard.com'">What is this tool for?</a></div>
                    </div>
                    <ul>
                        <li>
                            <form>
                                {{#if login.showPasswordChangeNeeded}}
                                <div class="control-group">
                                    <div class="password-format-error for-public">
                                        Your password has expired.
                                        Please go to login page, try login and select a new password.
                                        <br /> <br />
                                        <a class="button btn-action btn-action-primary2" data-bind="redirect: globalConfig.workspacesUrl">Go to login</a>
                                    </div>
                                </div>
                                {{/if}}

                                <div class="control-group">
                                    <div class="control w-3-3">
                                        <label>
                                            Email
                                            <input id="public-login-dropdown-email-field" type="text" data-bind="value: login.email" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: login.email"></span>
                                    </div>
                                    {{#ifnot login.isSsoRequired}}
                                    <div class="control">
                                        <label>
                                            Password
                                            <input type="password" data-bind="value: login.password" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: login.password"></span>
                                    </div>
                                    <div class="control">
                                        <span class="styled-check-label">
                                            <input type="checkbox" id="pSignInRememberMe" data-bind="checkbox: {checked: login.rememberMe}">
                                            Remember me
                                        </span>
                                    </div>
                                    {{/ifnot}}
                                </div>
                                <br />
                                {{#ifnot login.isSsoRequired}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="btnClick: login.login.bind($root.login, $data)">Login</button>
                                </div>
                                {{/ifnot}}
                                {{#if login.isSsoRequired}}
                                {{#if !IsInIframe()}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="click: login.loginWithCorporateAccount, hasFocus:login.isSsoLoginButtonFocused">Login with corporate account</button>
                                </div>
                                {{/if}}
                                {{#if IsInIframe() }}
                                <span style="font-size: 13px;">Single sign-on is disabled in iframes.</span>
                                <a target="_blank" onclick="window.open(globalConfig.loginUrl)" style="font-size: 13px;" class="btn-action mt-5" href="{{globalConfig.loginUrl}}">Click here to login</a><span style="font-size: 13px;"> then refresh this page</span>
                                {{/if}}
                                {{/if}}
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="signup-dropdown" data-bind="dropdownmenu: {dontCloseOnClick: true, afterOpened: function() { $('#public-signup-dropdown-name-field').focus(); }}">
            <a>sign up</a>
            <div class="menu-content">
                <div class="signup-dropdown-menu-content">
                    <div class="signup-dropdown-menu-title">
                        Sign up to StoriesOnBoard
                        <div class="signup-dropdown-menu-title-sob"><a data-bind="redirect: 'http://storiesonboard.com'">What is this tool for?</a></div>
                    </div>
                    <ul>
                        <li>
                            <form>

                                <div class="control-group" data-bind="if: signUp.passwordFormatIsInvalid">
                                    <div class="password-format-error for-public">
                                        Your password does not satisfy the current password policy requirements.
                                        <ul>
                                            {{#if signUp.isMinCharCountInvalid}}
                                            <li>{{signUp.minCharCount}} characters</li>
                                            {{/if}}
                                            {{#if signUp.isMinUpperCharCountInvalid}}
                                            <li>{{signUp.minUpperCharCount}} uppercase letters</li>
                                            {{/if}}
                                            {{#if signUp.isMinLowerCharCountInvalid}}
                                            <li>{{signUp.minLowerCharCount}} lowercase letters</li>
                                            {{/if}}
                                            {{#if signUp.isMinNumberCountInvalid}}
                                            <li>{{signUp.minNumberCount}} digits</li>
                                            {{/if}}
                                            {{#if signUp.isMinSpecialCharsCountInvalid}}
                                            <li>{{signUp.minSpecialCharsCount}} special characters</li>
                                            {{/if}}
                                            {{#if signUp.differentPasswordRequired}}
                                            <li>must be different than a previous {{signUp.differentPasswordCount}}</li>
                                            {{/if}}
                                        </ul>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <div class="control">
                                        <label>
                                            Name
                                            <input id="public-signup-dropdown-name-field" type="text" data-bind="value: signUp.name" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.name"></span>
                                    </div>
                                    <div class="control">
                                        <label>
                                            Email
                                            <input type="text" data-bind="value: signUp.email, event: { blur: signUp.checkLoginType, focus: function() { signUp.isSsoRequired(false); } }" />
                                            <!--<input type="text" data-bind="value: signUp.emailConfirmation" tabindex="1000" class="email-confirmation"/> - BNGSZ AUTOCOMPLETE ELRONTOTTA -->
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.email"></span>
                                    </div>
                                    {{#ifnot signUp.isSsoContentVisible}}
                                    <div class="control password">
                                        <label>
                                            Password
                                            <input type="password" data-bind="value: signUp.password, hideShowPassword: {wrapper: {enforceWidth: false}, toggle: {styles: {height: '24px', width: '55px'}}}" />
                                        </label>
                                    </div>
                                    <div class="control">
                                        <span class="validation-message" data-bind="validationMessage: signUp.password"></span>
                                    </div>
                                    {{/ifnot}}
                                    {{#if signUp.isSsoContentVisible}}
                                    <div class="signup-dropdown-menu-sso-text">
                                        Your company uses their login credentials to access StoriesOnBoard, so you don't need to create a separate password in our system.
                                        To register in StoriesOnBoard you should simply login with your corporate credentials if your company allows access to StoriesOnBoard for you.
                                        To create a personal account instead, please sign up with a personal email address.
                                    </div>
                                    {{/if}}
                                </div>
                                {{#ifnot signUp.isSsoContentVisible}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="btnClick: signUp.signUp.bind($root.signUp, $data)">Sign up</button>
                                </div>
                                {{/ifnot}}
                                {{#if signUp.isSsoContentVisible}}
                                {{#if !IsInIframe()}}
                                <div class="form-action-buttons">
                                    <button type="submit" class="btn-action" data-bind="click: signUp.loginWithCorporateAccount, hasFocus:signUp.isSsoContentVisible">Login with corporate account</button>
                                </div>
                                {{/if}}
                                {{#if IsInIframe() }}
                                <span style="font-size: 13px;">Single sign-on is disabled in iframes.</span>
                                <a target="_blank" onclick="window.open(globalConfig.loginUrl)" style="font-size: 13px;" class="btn-action mt-5" href="{{globalConfig.loginUrl}}">Click here to login</a><span style="font-size: 13px;"> then refresh this page</span>
                                {{/if}}
                                {{/if}}
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        {{/if}}
        &nbsp;
        <board-save-indicator></board-save-indicator>
    </div>
    <div class="right-side">

        <!-- Collapse/expand buttons -->
        <span>
            <a class="btn-icon" data-bind="click: $root.board.collapseAll.bind($root.board)">
                Collapse
            </a>
            &nbsp;
            <a class="btn-icon" data-bind="click: $root.board.expandAll.bind($root.board)">
                Expand
            </a>
        </span>
        <!-- Zoom buttons -->
        <span data-bind="mousescroll: {propertyToChange: $root.board.zoomFactor, minValue: $root.board.minZoomFactor, maxValue: $root.board.maxZoomFactor}">
            <a class="btn-icon" data-bind="click: $root.board.decreaseZoomFactor.bind($root.board)">
                Zoom Out
            </a>
            &nbsp;
            <a class="btn-icon" data-bind="click: $root.board.increaseZoomFactor.bind($root.board)">
                Zoom In
            </a>
        </span>
        <!-- Manage... buttons -->
        {{#if: $root.currentUserIsAdmin() }}
        <span>
            <a class="btn-icon" data-bind="btnClick: openCollaboratorsModal.bind($root)">
                Share
            </a>
        </span>
        {{/if}}
        
        
        {{#if: $root.isIntegrationEnabled() && $root.currentUserIsCollaborator() && common.SubscriptionManager.hasIntegrationFeatureAddOn() }}
        <span>
            <div class="integration-dropdown-menu" data-bind="dropdownmenu: true">
                <a class="btn-icon" title="Tool integration">
                    Tool integration
                </a>
                <div class="menu-content right-aligned">
                    <div class="integration-dropdown-menu-content">
                        <ul>
                            <li><a data-bind="debouncedClick: function() { window.open($root.linkedProjectUrl(), '_blank'); }">Go to project in {{$root.integrationToolName()}}</a></li>
                            {{#if !$root.currentUserIsViewer() && $root.isStructureSyncEnabled()}}
                            <li><a data-bind="debouncedClick: pushTopLevelCards">Push top level cards to {{$root.integrationToolName()}}</a></li>
                            {{/if}}
                            <!-- ko if: !$root.currentUserIsViewer() && $root.isImportEnabled() -->
                            <li><a data-bind="debouncedClick: function() { importNewCards(); }">Import and sync changes from {{$root.integrationToolName()}}</a></li>
                            <!-- /ko -->
                            {{#if $root.isLinkedItemKeyHumanReadable}}
                            {{#if $root.isLinkedItemKeyVisibleOnCards}}
                            <li><a data-bind="debouncedClick: function() { setLinkedItemKeyVisibilityOnCards(false); }">Hide linked {{$root.integrationToolName()}} keys on cards</a></li>
                            {{/if}}
                            {{#ifnot $root.isLinkedItemKeyVisibleOnCards}}
                            <li><a data-bind="debouncedClick: function() { setLinkedItemKeyVisibilityOnCards(true); }">Show linked {{$root.integrationToolName()}} keys on cards</a></li>
                            {{/ifnot}}
                            {{/if}}
                            {{#if $root.isImpersonationEnabled}}
                            {{#ifnot $root.isCollaboratorAuthenticated}}
                            <li><a data-bind="debouncedClick: function() { openImpersonationAuthenticationModal(null, true); }">Authenticate in {{$root.integrationToolName()}}</a></li>
                            {{/ifnot}}
                            {{#if  $root.isCollaboratorAuthenticated}}
                            <li><a data-bind="debouncedClick: function() { removeImpersonationToken(); }">Log me out from {{$root.integrationToolName()}} on this story map</a></li>
                            {{/if}}
                            {{/if}}
                        </ul>
                    </div>
                </div>
            </div>
        </span>
        {{/if}}


        <span>
            <div class="more-dropdown-menu" data-bind="dropdownmenu: true">
                <a class="btn-icon" title="More...">
                    More
                </a>
                <div class="menu-content right-aligned">
                    <div class="more-dropdown-menu-content">
                        <ul>
                            {{#if $root.board.boardLevel() == 2}}
                            <li><a data-bind="debouncedClick: function() { changeBoardLevelTo(3); }">Three level board view</a></li>
                            <li>
                                <hr />
                            </li>
                            {{/if}}
                            {{#if $root.board.boardLevel() == 3}}
                            <li><a data-bind="qtip: { position: 'bottom', adjustY: 10, delay: 1 }, debouncedClick: function() { changeBoardLevelTo(2); }">Two level board view</a></li>
                            <li>
                                <hr />
                            </li>
                            {{/if}}
                            <li><a data-bind="click: $root.toggleAboutBoard.bind($root)">About this board</a></li>
                            {{#ifnot $root.isReadOnlyAccessOfPublishedBoard}}
                            <li><a data-bind="click: $root.toggleIdeaPanel.bind($root)">Ideas</a></li>
                            {{/ifnot}}
                            {{#ifnot $root.isPublicMapViewer}}
                            <li><a data-bind="click: $root.toggleDiscussionPanel.bind($root)">Board discussion</a></li>
                            {{/ifnot}}
                            <li><a data-bind="click: $root.toggleAnnotationPanel.bind($root)">Card annotations</a></li>
                            {{#if $root.currentUserIsAdmin()}}
                            <li><a data-bind="click: $root.openWorkflowSettingsModal.bind($root)">Workflow settings</a></li>
                            {{/if}}
                            {{#if $root.currentUserIsAdmin()}}
                            <li><a data-bind="click: $root.openStoryTemplatesPanel.bind($root)">User story templates</a></li>
                            {{/if}}
                            <li><a href="#persona-panel" id="btn-open-persona" data-bind="panelslider: { isPanelOpened: $root.board.isPersonaPanelOpened,  onBefore: function(df){ $root.closeAllPanelComponents.bind($root)(); df.resolve(); }, onComplete: function() { $('#wrapper').css('right','410px'); }, onClose: function() { $('#wrapper').css('right','0'); }}">Personas</a></li>
                            <li>
                                <hr />
                            </li>
                            <li><a href="#search-and-filter-panel" id="btn-open-search-and-filter" data-bind="panelslider: { isPanelOpened: $root.isSearchAndFilterPanelOpened,  onBefore: function(df){ $root.closeAllPanelComponents.bind($root)(); df.resolve(); }, onComplete: function() { $('#wrapper').css('right','410px'); $root.searchAndFilterPanel.searchTextHasFocus(true); }, onClose: function() { $('#wrapper').css('right','0'); $root.isSearchAndFilterPanelOpened(false); $root.setFocusOnBoard();}}">Search & filter</a></li>

                            {{#if $root.isReadOnlyAccessOfPublishedBoard() === false }}
                            <li><a id="btn-open-board-activities" href="#board-activities-panel" data-bind="click: $root.toggleBoardActivities">Board activities</a></li>
                            {{/if}}
                            {{#if $root.isReadOnlyAccessOfPublishedBoard() === false }}
                            <li><a id="btn-open-notifications" data-bind="click: $root.toggleNotificationPanel.bind($root)">Notifications</a></li>
                            {{/if}}

                            {{#if !$root.isReadOnlyAccessOfPublishedBoard()}}
                            <li><a data-bind="click: $root.openExportModal.bind($root)">Export & print</a></li>
                            {{/if}}
                            {{#if !$root.currentUserIsViewer()}}
                            <li><a data-bind="click: $root.showRecoverableCardDeleteEvents.bind($root)">Recover deleted cards</a></li>
                            {{/if}}
                            {{#if !$root.currentUserIsViewer()}}
                            <li><a data-bind="click: openReleasesModal.bind($root)">Archived releases</a></li>
                            {{/if}}
                            {{#if $root.currentUserIsAdmin()}}
                            <li><a data-bind="click: openSettingsModal.bind($root)">Board settings</a></li>
                            {{/if}}
                            <li>
                                <hr />
                            </li>
                            {{#if $root.board.zoomIsAdaptive}}
                            <li><a data-bind="click: function() { $root.board.setZoomIsAdaptive(false); app.flash.showSuccess('Normal zoom enabled.'); }">Normal zoom</a></li>
                            {{/if}}
                            {{#ifnot $root.board.zoomIsAdaptive}}
                            <li>
                                <a class="with-info-icon" data-bind="click: function() { $root.board.setZoomIsAdaptive(true); app.flash.showSuccess('Adaptive zoom enabled.'); }">Adaptive zoom</a>
                                <div class="adaptive-zoom-info" title="View more text on cards by zooming in." data-bind="qtip: { position: 'top', qtipTip: { width:'8', height: '6' }, classes:'qtip-tipsy qtip-sob qtip-favorite-storymap' }">
                                    <i class="icon-info-circle" aria-hidden="true"></i>
                                </div>
                            </li>
                            {{/ifnot}}
                            {{#if $root.board.isTopLevelCardsPinnable}}
                            {{#if $root.board.isTopLevelCardsArePinned}}
                            <li><a data-bind="click: function() { $root.board.unPinTopLevelCards(); app.flash.showSuccess('Top level cards are unpinned.'); }">Unpin top cards</a></li>
                            {{/if}}
                            {{#ifnot $root.board.isTopLevelCardsArePinned}}
                            <li><a data-bind="click: function() { $root.board.pinTopLevelCards(); app.flash.showSuccess('Top level cards are pinned.'); }">Pin top cards</a></li>
                            {{/ifnot}}
                            {{/if}}
                            <li>
                                <hr />
                            </li>
                            <li><a data-bind="click: $root.showKeyboardShortcutsHelp">Keyboard shortcuts</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </span>
        

        <a class="full-header btn-icon" data-bind="toggleFullscreen: true">
            <i class="icon-storymap-h-compact-expand"></i>
        </a>
    </div>
</div></script>
<script type="text/html" id="storymap.board.personas:personas">
    <div class="personas-wrapper">
        {{#if $data.color() !== 99}}
        <div class="action dropdown-menu" data-bind="dropdownmenu: { dontCloseOnClick: true, closeOnClickSelector: '.board-subtasks, .board-tasks' }">
            <a class="trigger" data-bind="stopPropagation: true" tabindex="1">

                <div class="personas-container" id="personas-container-{{$data.id}}">

                    {{#if $root.hasActivityPersonaNames()}}
                    <i class="icon-on-board-persona"></i>
                    <span>({{$data.cardPersonas().length}})</span>
                    {{#foreach $data.visiblePersonasOnBoard}}
                    {{#if $index() > 0}}<span>,</span> {{/if}}<span>{{$data.persona.name}}</span>
                    {{/foreach}}
                    {{/if}}

                    {{#if $root.hasActivityPersonaImages()}}
                    {{#if $data.hasPersonas()}}
                    {{#foreach $data.visiblePersonasOnBoard}}
                    <div class="persona-item">
                        {{#if $data.persona.picture().isBuiltInAvatar}}
                        <img class="built-in-avatar" data-bind="attr: { src: $data.persona.picture().path }">
                        {{/if}}
                        {{#ifnot $data.persona.picture().isBuiltInAvatar}}
                        <img data-bind="attr: { src: $data.persona.picture().path }">
                        {{/ifnot}}

                    </div>
                    {{/foreach}}
                    {{#if hiddenPersonasCountOnBoard() > 0}}
                    <div class="persona-item">
                        <span>+{{hiddenPersonasCountOnBoard}}</span>
                    </div>
                    {{/if}}
                    {{/if}}
                    {{#ifnot $data.hasPersonas()}}
                    <div class="persona-item persona-item-add-persona" data-tip="{{$root.currentUserIsViewer() ? 'Personas' : 'Assign persona'}}" data-bind="qtip: { position: 'right' }">
                        <img class="no-persona-image" data-bind="hoverImage: { originalImage: $root.noPersonaPicturePath, hoverImage: $root.noPersonaHoverPicturePath }" />
                    </div>
                    {{/ifnot}}

                    {{/if}}

                </div>
            </a>

            <div class="menu-content left-aligned">
                <ul>
                    <li class="dropdown-menu-item">
                        <a data-bind="clickAndStop: function() { $root.openPersonaPanelFor($data); }">View on persona panel</a>
                    </li>
                    {{#ifnot $root.currentUserIsViewer()}}
                    <li class="dropdown-menu-item">
                        <a data-bind="clickAndStop: function() { $root.openPersonaPanelForCreatingAndAssign($data); }">Create & assign new persona</a>
                    </li>
                    {{/ifnot}}

                    <li class="dropdown-menu-item">
                        {{#if $root.showPersonaNamesInsteadOfImages()}}
                        <a data-bind="clickAndStop: function() { $root.showPersonaNames(false); }">Show persona images</a>
                        {{/if}}
                        {{#ifnot $root.showPersonaNamesInsteadOfImages()}}
                        <a data-bind="clickAndStop: function() { $root.showPersonaNames(true); }">Show persona names</a>
                        {{/ifnot}}
                    </li>

                    {{#ifnot $root.currentUserIsViewer()}}
                    <li class="dropdown-menu-line">
                        <hr />
                    </li>
                    <li class="dropdown-items-heading">
                        Assign personas to card
                    </li>
                    <li class="dropdown-items-heading pt-5" style="text-transform: none;">
                        Global personas
                    </li>
                    {{#foreach $root.personas().filter(x => x.isGlobal) }}
                    <li class="dropdown-menu-item">
                        <a class="assign-persona-row" data-bind="clickAndStop: function() { $root.addOrRemovePersonaToActivity($parent, $data); }">
                            {{#if $parent.hasPersona($data)}}
                            <span class="assign-persona-icon-container">
                                <i class="icon-on-board-persona-assign-checked"></i>
                            </span>
                            {{/if}}
                            {{#ifnot $parent.hasPersona($data)}}
                            <span class="assign-persona-icon-container">
                                <i class="icon-on-board-persona-assign-unchecked"></i>
                            </span>
                            {{/ifnot}}
                            <!--{{#ifnot $parent.hasPersona($data)}}
                            <span class="assign-persona-icon-container"></span>
                            {{/ifnot}}-->
                            <img data-bind="attr: { src: $data.picture().path }" />
                            <span class="assign-persona-item">{{$data.name|fit:20}}</span>
                        </a>
                    </li>
                    {{/foreach}}
                    <li class="dropdown-items-heading pt-5" style="text-transform: none;">
                        Local personas
                    </li>
                    {{#foreach $root.personas().filter(x => !x.isGlobal) }}
                    <li class="dropdown-menu-item">
                        <a class="assign-persona-row" data-bind="clickAndStop: function() { $root.addOrRemovePersonaToActivity($parent, $data); }">
                            {{#if $parent.hasPersona($data)}}
                            <span class="assign-persona-icon-container">
                                <i class="icon-on-board-persona-assign-checked"></i>
                            </span>
                            {{/if}}
                            {{#ifnot $parent.hasPersona($data)}}
                            <span class="assign-persona-icon-container">
                                <i class="icon-on-board-persona-assign-unchecked"></i>
                            </span>
                            {{/ifnot}}
                            <!--{{#ifnot $parent.hasPersona($data)}}
            <span class="assign-persona-icon-container"></span>
            {{/ifnot}}-->
                            <img data-bind="attr: { src: $data.picture().path }" />
                            <span class="assign-persona-item">{{$data.name|fit:20}}</span>
                        </a>
                    </li>
                    {{/foreach}}
                    {{/ifnot}}
                </ul>
            </div>
        </div>
        {{/if}}
    </div>
</script>
<script type="text/html" id="storymap.settingsdialog.delete-storymap-confirm"> <div class="header">Delete storymap</div>
<div class="content">
    <p>
        If you delete this story map, all data contained therein will be immediately and irrecoverably destroyed.
    </p>
    <p>
        <br />
        <span class="warning-text">THIS OPERATION CANNOT BE UNDONE!</span>
        <br /> <br />
    </p>
    <div class="control-group">
        <div class="control w-1-2">
            <label>
                <input type="checkbox" data-bind="checkbox: {checked: deleteStorymapConfirmed}">
                I understand, please delete my story map.
            </label>
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn-action-primary" data-bind="inlineConfirm: ['Delete story map', 'Click again to confirm deletion', 'Deleting story map'], submitFunction: deleteStorymap, showTimer: 'true', visible: deleteStorymapConfirmed"></button>
    <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Cancel</button>
</div></script>
<script type="text/html" id="storymap.settingsdialog.flowdockchatsettings"> <div data-bind="if: chatToolSettings.showSettings">
    <div class="control-group">
        <div class="control" data-bind="css: {'w-1-1': !chatToolSettings.isConnected(), 'w-3-4': chatToolSettings.isConnected}">
            <label>
                Flow API token
                <input type="text" data-bind="value: chatToolSettings.flowApiToken">
                <span class="help-block"><a href="https://www.flowdock.com/account/tokens" target="_blank">Where can I find my API Token?</a></span>
            </label>
        </div>
        {{#if chatToolSettings.isConnected }}
        <div class="control w-1-4 cancel-button">
            <button data-bind="btnClick: saveChatToolSettings" class="btn-action-primary">Connect</button>
            &nbsp;
            <button data-bind="btnClick: function() { chatToolSettings.showSettings(false); }" class="btn-action">Cancel</button>
        </div>
        {{/if}}
        <div class="control w-1-1" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: chatToolSettings.flowApiToken"></span>
        </div>
    </div>
</div></script>
<script type="text/html" id="storymap.settingsdialog.github.preferences"> <div class="connection-status description">
   
    <div>
        {{#if toolSettingsModel.isGitHubEnterprise}}
        Connected to <strong>GitHub Enterprise</strong> (@ <span data-bind="text: toolSettingsModel.selfHostedUrl"></span>)
        {{/if}}
        {{#ifnot toolSettingsModel.isGitHubEnterprise}}
        Connected to <strong>GitHub</strong>
        {{/ifnot}}
        and linked to <strong data-bind="text: toolSettingsModel.linkedProjectName"></strong> repository. <span class="disabled_warning" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled())">(Integration is disabled)</span>
    </div>

    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromGitHub();}">Disconnect GitHub</a>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.unlinkGitHubRepo();}">Unlink repository</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && toolSettingsModel.isIntegrationEnabled(), click: function() {toggleIntegrationEnabled();}">Disable integration</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled()), click: function() {toggleIntegrationEnabled();}">Enable integration</a>
</div>

<div id="github-preferences">
    <fieldset>
        <legend>Label for exported issues</legend>
        <span class="legend-description">Optional label can be added to every pushed issue.</span>
        <br />
        <input id="github-export-label" data-bind="value: toolSettingsModel.exportLabel" />
    </fieldset>

    <fieldset>
        <legend>Status mapping</legend>
        <span class="legend-description">Map StoriesOnBoard statuses to GitHub statuses and labels. When integration is enabled, statuses always come from GitHub Issues, and can't be modified manually.</span>

        <table id="github-status-mapping">
            <thead>
                <tr>
                    <td>GitHub status</td>
                    <td>GitHub label</td>
                    <td>StoriesOnBoard status</td>
                </tr>
            </thead>
            <tbody data-bind="foreach: toolSettingsModel.statusMappings">
                <tr>
                    <td>
                        <div class="dropdown-menu" data-bind="dropdownmenu: true">
                            <a href="#" data-bind="stopPropagation: true" class="trigger">
                                <span class="small-font" data-bind="text: gitHubStatus().Name"></span>
                                <span class="caret"></span>
                            </a>
                            <div class="menu-content left-aligned">
                                <ul data-bind="foreach: $parent.toolSettingsModel.statuses">
                                    <li><a data-bind="text: Name, dropdownmenuClick: function () { $parent.gitHubStatus($data); }"></a></li>
                                </ul>
                            </div>
                        </div>
                    </td>
                    <td>
                        <input class="github-label" data-bind="value: gitHubLabel" />
                    </td>
                    <td>
                        <div class="dropdown-menu" data-bind="dropdownmenu: true">
                            <a href="#" data-bind="stopPropagation: true" class="trigger">
                                <div class="d-flex align-items-center">
                                    <span class="small-font board-subtask-statuses-menu-selected-option"
                                          style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                                          data-bind="style: { 'background-color': storiesOnBoardSatus().color } ,text: storiesOnBoardSatus().name"></span>
                                    <i class="ml-5 delete-dropdown-icon"></i>
                                </div>
                            </a>
                            <div class="menu-content left-aligned">
                                <ul data-bind="foreach: StoriesOnBoardStatuses">
                                    <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $parent.storiesOnBoardSatus($data); }">
                                        <div class="status-menu-item__color-box"
                                             data-bind="style: { 'background-color': color }"></div>
                                        <a class="ml-5" data-bind="text: name"></a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <a class="remove-status-mapping" data-bind="click: function() {$parent.toolSettingsModel.removeStatusMapping($data);}">remove</a>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="control-group">
            <div class="control">
                <a id="add-status-mapping" data-bind="click: function() { toolSettingsModel.addStatusMapping(); }">add new</a>
            </div>
        </div>

        <div id="status-mapping-presets">
            <div>Using some of the tools below? Click on a name to load default mapping configuration</div>
            <div>
                <a class="preset" data-bind="click: function() { toolSettingsModel.loadPreset('waffle.io'); }">Waffle.io</a>
                <a class="preset" data-bind="click: function() { toolSettingsModel.loadPreset('zenhub.com'); }">ZenHub.com</a>
                <a class="preset" data-bind="click: function() { toolSettingsModel.loadPreset('huboard.com'); }">Huboard.com</a>
                <a class="preset" data-bind="click: function() { toolSettingsModel.loadPreset('overv.io'); }">Overv.io</a>
            </div>
        </div>
    </fieldset>

    <div class="status-helper-info-box">
        Need more states? You can customize your workflow by creating custom states.
        <span data-bind="click: toolSettingsModel.onOpenWorkflowSettings" style="text-decoration: underline">Go to workflow settings.</span>
    </div>

    <fieldset>
        <legend>Card synchronization</legend>
        <span class="legend-description">Enable two way synchronization of card properties</span>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeNameChanges }" />
                Synchronize name changes
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeDescriptionChanges }" />
                Synchronize description changes
            </label>
        </div>
    </fieldset>

    <fieldset>
        <legend>Release synchronization</legend>
        <span class="legend-description">Enable two way synchronization of releases</span>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeReleases }" />
                Synchronize releases as GitHub Milestones
            </label>
        </div>
    </fieldset>

    <fieldset>
        <legend>Import options</legend>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.enableImportOptionOnBoard }" />
                Allow editors to import new cards from GitHub (only non closed issues will be imported)
            </label>
            <!--
            {{#if  toolSettingsModel.enableImportOptionOnBoard() === true }}
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importNewReleases }"/>
                Import GitHub milestones as releases (only non closed milestones will be imported)
            </label>
            {{/if}}
            -->
        </div>
    </fieldset>
</div></script>
<script type="text/html" id="storymap.settingsdialog.github.repos"> <div class="connection-status description">
    {{#if toolSettingsModel.isGitHubEnterprise }}
        <div>Connected to <strong>GitHub Enterprise </strong> @ <span data-bind="text: toolSettingsModel.selfHostedUrl"></span></div>
    {{/if}}
    {{#ifnot toolSettingsModel.isGitHubEnterprise }}
    <div>Connected to <strong>GitHub</strong></div>
    {{/ifnot}}
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromGitHub();}">Disconnect GitHub</a>
</div>

{{#ifnot isFailedToConnectToTool}}
<div class="control-group">
    <div class="control">
        <label>
            Select a GitHub repository
            <select data-bind="options: toolSettingsModel.repos, optionsText: 'Name', value: toolSettingsModel.selectedGitHubRepo, select: true"></select>
        </label>
    </div>
</div>

<!-- ko if: toolSettingsModel.selectedGitHubRepo() != null -->
<button class="btn-action" data-bind="click: function() {toolSettingsModel.linkGitHubRepo();}">Link repository</button>
<!-- /ko -->
<a data-bind="click: toolSettingsModel.refreshProjects">Refresh GitHub repository list</a>
{{/ifnot}}

{{#if isFailedToConnectToTool}}
<p>Your GitHub personal access token has expired.</p>
<br />
<p>To make changes on this story map you need to provide a new personal access token from GitHub first. <br />Collaborators can't make changes on this story map until that.</p>
<br />
<br />
<button class="btn-action-primary" data-bind="click: $data.parentModel.switchToExpiredToolItegrationAuthModal.bind($data.parentModel)">Authenticate in GitHub</button>
{{/if}}
</script>
<script type="text/html" id="storymap.settingsdialog.githubsettings"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>

<div>

</div>

<div class="control-group info-text">
    You can find detailed information on how to set up GitHub Issues integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureGitHubIssues }" href="">here</a>.
</div>

{{#ifnot toolSettingsModel.showGitHubEnterprise }}
<div class="control-group info-text">
    Using GitHub Enterprise? Click <a target="_blank" data-bind="clickAndStop: function() {toolSettingsModel.toggleGitHubEnterpriseSettings();}" href="">here</a> to setup your server instance.
</div>
{{/ifnot}}

{{#if toolSettingsModel.showGitHubEnterprise }}
<div class="control-group info-text">
    Click <a target="_blank" data-bind="clickAndStop: function() {toolSettingsModel.toggleGitHubEnterpriseSettings();}" href="">here</a> to connect to GitHub instead of GitHub Enterprise
</div>
<div class="control-group">
    <div class="control">
        <label>
            GitHub Enterprise server instance URL
            <input type="text" data-bind="value: toolSettingsModel.selfHostedUrl">
        </label>
        <span class="help-block">If you are integrating with an on-premise GitHub Enterprise system you might need to whitelist StoriesOnBoard in your firewall so that it can 
            connect to your server. StoriesOnBoard uses the following IP addresses for connections: <small data-bind="text: outboundIpAddresses"></small></span>
    </div>
    <div class="control">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.selfHostedUrl"></span>
    </div>
</div>
{{/if}}

<div class="control-group">
    <div class="control">
        <label>
            Personal access token
            <input type="text" data-bind="value: toolSettingsModel.personalAccessToken">
        </label>
        <span class="help-block">Your token must have [repo] scope enabled. <a href="" data-bind="attr: {href: toolSettingsModel.gitHubPersonalAccessTokenUrl}" target="_blank">Create a Personal access token</a></span>
    </div>
    <div class="control" style="position: relative">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.personalAccessToken"></span>
    </div>
</div>

  


<button class="btn-action" data-bind="click: function() {toolSettingsModel.connectToGitHub();}">Connect</button>
</script>
<script type="text/html" id="storymap.settingsdialog.hipchatsettings"> <div data-bind="if: chatToolSettings.showSettings">
    <div class="control-group">
        <div class="control" data-bind="css: {'w-1-1': !chatToolSettings.isConnected(), 'w-3-4': chatToolSettings.isConnected}">
            <label>
                Integration URL
                <input type="text" data-bind="value: chatToolSettings.hipChatUrl">
                <span class="help-block"><a href="https://hipchat.com/admin/byo" target="_blank">How to get an integration URL?</a></span>
            </label>
        </div>
        {{#if chatToolSettings.isConnected }}
        <div class="control w-1-4 cancel-button">
            <button data-bind="btnClick: saveChatToolSettings" class="btn-action-primary">Connect</button>
            &nbsp;
            <button data-bind="btnClick: function() { chatToolSettings.showSettings(false); }" class="btn-action">Cancel</button>
        </div>
        {{/if}}
        <div class="control w-1-1" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: chatToolSettings.hipChatUrl"></span>
        </div>
    </div>
</div></script>
<script type="text/html" id="storymap.settingsdialog.jira-synclevelchangedconfirm:jira-stucture-sync-confirm">
    <div class="header">
        Confirmation
    </div>


    <div class="content">



        {{#if: toolSettingsModel.isStructureSyncEnabled}}


        {{#if: toolSettingsModel.upgradedFromSecondToTopLevelSync}}
        <p>You are about to change to top-level hierarchical synchronization.</p>
        <br />
        <p>
            We will unlink your second level (task/step) cards from their linked Jira Epics.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from StoriesOnBoard to Jira</p>
        <br />
        <p>
            This will create the same hierarchy in Jira which you have on your story map.
            We're going to push every top level (activity/goal) card to Jira as an Epic, which has linked story level children.
        </p>

        <br />
        <p class="strong">Synchronizing structure and data from Jira to StoriesOnBoard</p>
        <br />
        <p>
            This will create the same hierarchy on the story map which you have in Jira by importing the Epics as top level (activity/goal) cards and rearrange the linked story level children under their parents.
        </p>
        {{/if}}


        {{#if: toolSettingsModel.downgradedFromTopToSecondLevelSync}}
        <p>You are about to change to second level hierarchical synchronization.</p>
        <br />
        <p>
            This will unlink your top level (activity/goal) cards from  their linked Jira Epics.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from StoriesOnBoard to Jira</p>
        <br />
        <p>
            This will create the same hierarchy in Jira which you have on your story map.
            We're going to push every second level (task/step) card  to Jira as an Epic, which has linked story level children.
        </p>

        <br />
        <p class="strong">Synchronizing structure and data from Jira to StoriesOnBoard</p>
        <br />
        <p>
            This will create the same hierarchy on the story map which you have in Jira by importing the Epics as
            second level (task/step) cards and rearrange the linked story level children under their parents.
        </p>
        {{/if}}

        {{#if: toolSettingsModel.upgradedFromStoryLevelToTopLevelSync}}
        <p>
            You are about to enable the hierarchical synchronization feature with Jira. This is a major change, if you are not sure about the outcome
            learn more about it <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraIntegrationModeChange }" href="" target="_blank">here</a>.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from StoriesOnBoard to Jira</p>
        <br />
        <p>
            This will create the same hierarchy in Jira which you have on your story map.
            We're going to push every top level (activity/goal) card  to Jira as an Epic, which has linked story level children.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from Jira to StoriesOnBoard</p>
        <br />
        <p>
            This will create the same hierarchy on the story map which you have in Jira by importing the Epics as top level (activity/goal) cards
            and rearrange the linked story level children under their parents.
        </p>

        {{/if}}




        {{#if: toolSettingsModel.upgradedFromStoryLevelToSecondLevelSync}}
        <p>
            You are about to enable the hierarchical synchronization feature with Jira. This is a major change, if you are not sure about the outcome
            learn more about it <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraIntegrationModeChange }" href="" target="_blank">here</a>.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from StoriesOnBoard to Jira</p>
        <br />
        <p>
            This will create the same hierarchy in Jira which you have on your story map.
            We're going to push every second level (task/step) card to Jira as an Epic, which has linked story level children.
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from Jira to StoriesOnBoard</p>
        <br />
        <p>
            This will create the same hierarchy on the story map which you have in Jira by importing the Epics as second level (task/step) cards
            and rearrange the linked story level children under their parents.
        </p>
        {{/if}}

        <div class="footer left buttons">
            <button class="btn-action-primary" data-bind="click: toolSettingsModel.syncToIntegrationTool">Sync from StoriesOnBoard to Jira</button>
            <button class="btn-action-primary" data-bind="click: toolSettingsModel.syncFromIntegrationTool">Sync from Jira to StoriesOnBoard</button>
            <a href="#" data-bind="closeModal:true">Cancel</a>
        </div>


        {{/if}}





        {{#ifnot: toolSettingsModel.isStructureSyncEnabled}}
        <p>You chose to disable the hiearchical synchronization with Jira.</p>
        <br />
        <p>We will unlink the cards you have in the upper levels from the Jira issues and keep synchronizing the third level cards on the story map according to your integration settings.</p>
        <br />
        <p>
            Are you sure you want to continue?
        </p>
        <div class="footer left buttons">
            <button class="btn-action-primary" data-bind="click: toolSettingsModel.disableStructureSync">Yes</button>
            <button class="btn-action" data-bind="closeModal:true">No</button>
        </div>
        {{/ifnot}}

    </div>


</script>
<script type="text/html" id="storymap.settingsdialog.jira.auth.cloud"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>


<jira-oauth2-connector params="successCallback: toolSettingsModel.connectToJiraWithStoredToken, isAlreadyAuthenticated: userHasJiraCredentials"></jira-oauth2-connector>
<br />
<br />
<span>*You must have the proper project permissions in JIRA to create and modify issues and versions.</span>

<div class="issue-tracker-help-link">
    You can find detailed information on how to set up JIRA integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureJira }" href="">here</a>.
</div>

</script>
<script type="text/html" id="storymap.settingsdialog.jira.auth.server:jiraoauth"></script>
<script type="text/html" id="storymap.settingsdialog.jira.auth.server"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>


{{#if isJiraAppLinkIntegrationEnabled()}}
<button class="btn-action" data-bind="click: $root.toolSettingsModel.connectToJiraInitateOauth">Connect to Jira</button>
    <br/>
    <br />
    <span>*You must have the proper project permissions in Jira to create and modify issues and versions.</span>
{{/if}}

{{#ifnot isJiraAppLinkIntegrationEnabled()}}

Global Jira integation settings must be configured before you can setup a project level tool integration. 
<br/>
Please contact with a workspace administrator.

{{/ifnot}}

<div class="issue-tracker-help-link">
    You can find detailed information on how to set up Jira integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureJira }" href="">here</a>.
</div>



</script>
<script type="text/html" id="storymap.settingsdialog.jira.autosettings"> <p class="font-weight-bold">We successfully configured your Jira integration</p>

<p class="mt-20">Your integration settings are based on the selected projects structure. You can import cards from Jira now, or you can change the integration settings.</p>

<p class="mt-10">
    Keep in mind that in order to have two-way synchronization enabled between Jira and StoriesOnBoard
    {{#if $root.isWorkspaceAdmin}}
    you have to <a target="_blank" href="/integrationsettings">configure a webhook</a>
    {{/if}}
    {{#ifnot $root.isWorkspaceAdmin}}
    a workspace admin have to configure a webhook.
    {{/ifnot}}
</p>

<p class="mt-10">
    Please go to 'Advanced settings' to synchronize Jira states to the story map.
</p>

<div class="button_container">
    <button type="submit" class="btn-action-primary" data-bind="btnClick: importCards">Import new cards from Jira</button>
    <button type="submit" class="btn-action" data-bind="closeModal:true">Close</button>
    <button type="submit" class="btn-action" data-bind="btnClick: closeAndOpenAdvancedIntegrationSettings">Advanced settings</button>

</div></script>
<script type="text/html" id="storymap.settingsdialog.jira.customfields"> 
<!-- TEXTBOX -->
{{#if field().Type == 1}}
<input type="text" data-bind="value: Value" />
<span class="validation-message" data-bind="validationMessage: Value"></span>
{{/if}}

<!-- SELECT -->
{{#if field().Type == 2}}
<select data-bind="options: field().PossibleValues, optionsText: 'Value', value: Value, select: true"></select>
<span class="validation-message" data-bind="validationMessage: Value"></span>
{{/if}}

<!-- MULTISELECT -->
{{#if field().Type == 3}}
<select data-bind="options: field().PossibleValues, optionsText: 'Value', selectedOptions: Value, multiselect: { includeSelectAllOption: false }" multiple="multiple"></select>
<span class="validation-message" data-bind="validationMessage: Value"></span>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.jira.preferences.estimationmessages"> {{#if toolSettingsModel.hasNoStoryPointFieldInExportingIssueType}}
<div class="story-point-sync-setting-jira-alert">
	<span class="highlighted-important">The selected exporting issue type ({{toolSettingsModel.exportingIssueType().Name}}) does not support estimation values.</span>
	<br /><br />
	Update the field configuration of the appropriate Jira screens to include the Story Points field then revalidate your settings.
	Need help? Click <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraStoryPoints }" href="" target="_blank">here</a>.
	<br />
	<button class="storypoint-validator-btn btn-action-primary" data-bind="click: toolSettingsModel.validateStoryPointFieldConfiguration">Validate configuration</button>
</div>
{{/if}}

{{#if !toolSettingsModel.hasNoStoryPointFieldInExportingIssueType() && toolSettingsModel.hasImportingIssueTypeWithNoStoryPointField()}}
<div class="story-point-sync-setting-jira-alert">
	Please note that some of the issue types you have selected to import ({{toolSettingsModel.importingIssueTypeNamesWithNoStoryPointField}}) currently do not support estimation values.
	<br /><br />
	Update the field configuration of the appropriate Jira screens to include the Story Points field then revalidate your settings.
	Need help? Click <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraStoryPoints }" href="" target="_blank">here</a>.
	<br />
	<button class="storypoint-validator-btn btn-action-primary" data-bind="click: toolSettingsModel.validateStoryPointFieldConfiguration">Validate configuration</button>
</div>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.jira.preferences"> <div class="info-text">
    To make the most out of our issue tracker integration, please click <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraRecommendedWorkflows }" href="" target="_blank">here</a> to read more about our recommended workflows.
</div>

<div class="connection-status description">
    <div>Connected to <strong>Jira</strong> at <span data-bind="text: toolSettingsModel.instanceUrl()"></span> and linked to <strong data-bind="text: toolSettingsModel.linkedProjectName"></strong> project. <span class="disabled_warning" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled())">(Integration is disabled)</span></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromJira();}">Disconnect Jira</a>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.unlinkProject();}">Unlink project</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && toolSettingsModel.isIntegrationEnabled(), click: function() {toggleIntegrationEnabled();}">Disable integration</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled()), click: function() {toggleIntegrationEnabled();}">Enable integration</a>
</div>

<div>
    <fieldset id="jira-export-options">
        <legend>Integration mode and general settings</legend>
        
        
            {{#ifnot: toolSettingsModel.isStructureSyncAvailable }}
        <div class="grey-alert-box structure-sync-alert">
            {{#if toolSettingsModel.hasEpicIssueType}}
            None of your Jira Issue types have an Epic link field which is required for the hierarchical synchronization to work. Please adjust your Jira Issue field configuration and include the Epic link field to enable these options.
            {{/if}}

            {{#ifnot toolSettingsModel.hasEpicIssueType}}
            A valid epic issue type is required for the hierarchical synchronization to work. Please make sure your Jira project has both the Epic issue type and the Epic name field enabled.
            {{/ifnot}}
        </div>
            {{/ifnot}}

        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.structureSyncOption, checkedValue: 1, radio: { enabled: toolSettingsModel.isStructureSyncAvailable }">
                Link Jira Epics with the top level cards and a selected issue type with the third level cards
            </label>
        </div>
        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.structureSyncOption, checkedValue: 2, radio: { enabled: toolSettingsModel.isStructureSyncAvailable }">
                Link Jira Epics with the second level cards and a selected issue type with the third level cards
            </label>
        </div>
        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.structureSyncOption, checkedValue: 0, radio:true">
                Link only story level cards
            </label>
            <div class="legend-description" data-bind="if: toolSettingsModel.isActivityAsEpicHintVisible">
                Hint: The selected synchronization mode will link the top level cards with Epics and third level cards with a selection of yours.
            </div>
            <div class="legend-description" data-bind="if: toolSettingsModel.isTaskAsEpicHintVisible">
                Hint: The selected synchronization mode will link the second level cards with Epics and third level cards with a selection of yours.
            </div>
        </div>

        {{#if: toolSettingsModel.isSyncOptionChanged }}

        <div class="grey-alert-box structure-sync-alert">
            <span class="warning-text">Pay attention, major change ahead.</span>
            <br />
            <br />
            Please note that changing the integration mode is a major change in how the synchronization works and may have unwanted side effects.
            It can reorganize your hierarchy in StoriesOnBoard or in Jira depending on your choice when saving this form.
            Please be careful with this operation. Learn more about it <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraIntegrationModeChange }" href="" target="_blank">here</a>.
        </div>
        {{/if}}

        <div class="control">
            <label>
                Exporting issue type
                <select data-bind="options: toolSettingsModel.availableIssueTypesForExport, optionsText: 'nameWithEpicLinkMsg', value: toolSettingsModel.exportingIssueType, select: true, optionsAfterRender: toolSettingsModel.disableUnavailableIssueType"></select>
            </label>
            <span class="help-block">Select the appropriate Jira issue type to synchronize with the bottom level cards in StoriesOnBoard</span>
        </div>

        <div class="control">
            <label class="backlink-checkbox">
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.addStoriesOnBoardLink }" />
                Add StoriesOnBoard card link to Jira as an Issue link
            </label>
        </div>
    </fieldset>

    <fieldset>
        <legend></legend>
        <span class="legend-description">
            You can set additional Jira fields with predefined values when pushing cards into Jira.
            {{#if toolSettingsModel.hasSupportedRequiredExportField}}
            The required fields have been preloaded below.
            {{/if}}
            <br />
            Hint: you can use <a data-bind="qtip: {contentId: '#labels-tooltip-content', classes: 'labels-tooltip qtip-tipsy qtip-sob'}">variables</a> in labels.
            Labels are separated by spaces, commas, or semicolons.
        </span>

        <div id="labels-tooltip-content" style="display: none">
            <div><span class="variable-name">{activity}</span> <span class="variable-description">The name of the activity the pushed subtask belongs to</span></div>
            <div><span class="variable-name">{task}</span> <span class="variable-description">The name of the task the pushed subtask belongs to</span></div>
            <div><span class="variable-name">{release}</span> <span class="variable-description">The name of the release the pushed subtask belongs to</span></div>
            <div><span class="variable-name">{colorLabel}</span> <span class="variable-description">The label of the subtask's color</span></div>
            <div><span class="variable-name">{activityColorLabel}</span> <span class="variable-description">The label of the activity's color which the pushed subtask belongs to</span></div>
            <div><span class="variable-name">{taskColorLabel}</span> <span class="variable-description">The label of the task's color which the pushed subtask belongs to</span></div>
            <div><span class="variable-name">{storymap}</span> <span class="variable-description">The name of this story map</span></div>
        </div>

        <div class="unsupported-field-jira-alert" data-bind="visible: toolSettingsModel.hasUnsupportedRequiredExportField">
            <span class="highlighted-important">The selected export issue type contains required fields which are not supported by StoriesOnBoard.</span><br />
            The following fields are required in Jira but StoriesOnBoard doesn't support them yet: <strong>{{toolSettingsModel.getUnsupportedRequiredExportFieldNames()}}</strong>.<br />
            You can set up integration without them but pushing issues as <strong>{{toolSettingsModel.exportingIssueType().Name}}</strong> may not be possible.
            To resolve this issue make these fields optional in Jira, or chose another export issue type.
        </div>

        <div class="control" data-bind="visible: toolSettingsModel.customExportValues().length > 0">
            <table id="export-field-grid">
                <thead>
                    <tr>
                        <td>Jira field</td>
                        <td>value</td>
                        <td>&nbsp;</td>
                    </tr>
                </thead>
                <tbody data-bind="foreach: toolSettingsModel.customExportValues()">
                    <tr>
                        <td>
                            {{#ifnot field().Required}}
                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger">
                                    <span class="small-font" data-bind="text: field().Name"></span>
                                    <span class="caret"></span>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul data-bind="foreach: $root.toolSettingsModel.getAvailableCustomFields()">
                                        <li><a data-bind="text: Name, dropdownmenuClick: function () { $parent.field($data); }"></a></li>
                                    </ul>
                                </div>
                            </div>
                            {{/ifnot}}
                            {{#if field().Required}}
                            <div class="dropdown-menu">
                                <a href="#" class="disabled" title="Required">
                                    <span class="small-font" data-bind="text: field().Name"></span>
                                    <span class="caret disabled"></span>
                                </a>
                            </div>
                            {{/if}}
                        </td>
                        <td>
                            <div data-bind="template: {name: 'storymap.settingsdialog.jira.customfields'}"></div>
                        </td>
                        <td>
                            {{#ifnot field().Required}}
                            <a class="btn-action" data-bind="click: function() { $root.toolSettingsModel.removeCustomExportValue($data); }">remove</a>
                            {{/ifnot}}
                            {{#if field().Required}}
                            <a class="btn-action disabled" title="Required">remove</a>
                            {{/if}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="subtext">
            <a class="btn-action" data-bind="css: { disabled: !toolSettingsModel.canAddCustomExportValue() }, clickIf: { if: toolSettingsModel.canAddCustomExportValue, do: function() { toolSettingsModel.addCustomExportValue(); } }">
                {{#if toolSettingsModel.customExportValues().length == 0}}
                add your first field with predefined value(s)
                {{/if}}
                {{#if toolSettingsModel.customExportValues().length > 0}}
                add new
                {{/if}}
            </a>
        </div>
    </fieldset>

    <fieldset>
        <legend>Import filter with status mapping</legend>
        <span class="legend-description">Select the issue types you wish to  import and synchronize. Make sure to map their statuses to the appropriate ones in StoriesOnBoard. The <strong>{{toolSettingsModel.exportingIssueType().Name}}</strong> issue type is selected by default because it is your exporting type as well.</span>
        <div class="issue-type" data-bind="foreach: toolSettingsModel.visibleStatusMappings">
            <label class="board-settings-jira-issue-type-label">
                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled, enabled: CanBeModified }" />
                <strong class="issue-type-name" data-bind="text: IssueTypeName"></strong>
            </label>
            <table data-bind="visible: IsSyncEnabled">
                <tbody data-bind="foreach: Statuses">
                    <tr>
                        <td>
                            <label>
                                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled, enabled: $parent.CanBeModified }" />
                                <span data-bind="text: JiraStatus.Name"></span>
                            </label>
                        </td>
                        <td data-bind="visible: IsSyncEnabled">
                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger">
                                    <div class="d-flex align-items-center">
                                        <span class="small-font board-subtask-statuses-menu-selected-option"
                                              style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                                              data-bind="style: { 'background-color': Status().color } ,text: Status().name()"></span>
                                        <i class="ml-5 delete-dropdown-icon"></i>
                                    </div>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul data-bind="foreach: $parent.availableStates">
                                        <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $parent.Status($data); }">
                                            <div class="status-menu-item__color-box"
                                                 data-bind="style: { 'background-color': color }"></div>
                                            <a class="ml-5" data-bind="text: name"></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="status-helper-info-box">
            Need more states? You can customize your workflow by creating custom states.
            <span data-bind="click: toolSettingsModel.onOpenWorkflowSettings" style="text-decoration: underline">Go to workflow settings.</span>
        </div>
    </fieldset>

    <fieldset>
        <legend>Additional import settings</legend>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.enableImportOptionOnBoard }" />
                Allow editors to import new cards from Jira
            </label>
        </div>
        {{#ifnot toolSettingsModel.hasAdvancedImportFilter }}
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.ignoreClosedIssues }" />
                Ignore closed or done issues on import
            </label>
        </div>
        <div class="subtext">
            <a class="btn-action" data-bind="click: function() { toolSettingsModel.hasAdvancedImportFilter(true) }">Advanced import filter configuration with JQL</a>
        </div>
        {{/ifnot}}
        {{#if toolSettingsModel.hasAdvancedImportFilter }}
        <div class="control">
            <label>
                Type or paste your JQL expression for import filter
            </label>
            <div class="advanced-filter-status-jira-alert">
                Advanced import filter allows you to customize your import settings and also  to import such issues which are not included in the status mapping section. 
                <span class="strong">
                    Please note that we will not be able to synchronize the statuses of these issues and also this operation will unlink all your existing cards on your board which do not match the JQL result.
                </span> 
                <span data-bind="visible: toolSettingsModel.isStructureSyncEnabled">
                    The selected hierarchical synchronization mode will only import issue types which have Epic link fields. Make sure the query result includes all the linked Epic issues as well.
                </span>
            </div>
            <textarea id="advanced-import-filter" data-bind="value: toolSettingsModel.advancedImportFilter"></textarea>
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.advancedImportFilter"></span>
        </div>
        <div class="subtext">
            <div class="left">
                Click <a class="btn-action" href="{{toolSettingsModel.instanceUrl}}/issues/?jql={{encodeURIComponent(toolSettingsModel.advancedImportFilter()) || ''}}" target="_blank">here</a> to test your JQL expression in Jira.
            </div>
            <div class="right">
                <a class="btn-action" data-bind="click: function() { toolSettingsModel.hasAdvancedImportFilter(false) }">cancel filter</a>
            </div>
        </div>
        {{/if}}
    </fieldset>


    <div class="sync-options">
        <fieldset>
            <legend>Card synchronization</legend>
            <div class="legend-description">
                Keep in mind that in order to have two-way synchronization enabled between Jira and StoriesOnBoard
                {{#if $root.isWorkspaceAdmin}}
                you have to <a target="_blank" href="/integrationsettings">configure a webhook</a>
                {{/if}}
                {{#ifnot $root.isWorkspaceAdmin}}
                a workspace admin have to configure a webhook.
                {{/ifnot}}
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeNameChanges }" />
                    Synchronize name changes
                </label>
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeDescriptionChanges }" />
                    Synchronize description changes
                </label>
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeEstimationChanges }" />
                    Synchronize estimation changes as Story points
                </label>
                <div data-bind="template: { name: 'storymap.settingsdialog.jira.preferences.estimationmessages' }"></div>
            </div>
            {{#if toolSettingsModel.isNextGenProject }}
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.autoSyncReleases }" />
                    Synchronize releases
                </label>
                <div data-bind="template: { name: 'storymap.settingsdialog.jira.preferences.releasesmessages' }"></div>
            </div>
            {{/if}}
        </fieldset>
        {{#ifnot toolSettingsModel.isNextGenProject }}
        <fieldset>
            <legend>Release synchronization</legend>
            <span class="legend-description">Enable two way synchronization of releases</span>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.autoSyncReleases}" />
                    Synchronize releases as Jira versions
                </label>
            </div>
        </fieldset>
        {{/ifnot}}

        <fieldset>
            <legend>Impersonation</legend>
            <span class="legend-description">By enabling impersonation the changes on the story map will be synced with Jira on behalf of the current collaborator. Collaborators need to authenticate in Jira to make changes on the story map. Unauthenticated collaborators can only view the map.</span>

            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.isImpersonationEnabled }" />
                    Enable impersonation
                </label>
                {{#if toolSettingsModel.showUpgradeToProPlanMessage}}
                <br />
                <div class="subscription-info-hint-in-dialog">
                    Hint: This feature is not avaliable in the current Standard subscription plan. Please upgrade to the Pro subscription plan to use this feature.
                </div>
                {{/if}}
            </div>
        </fieldset>
    </div>

</div></script>
<script type="text/html" id="storymap.settingsdialog.jira.preferences.releasesmessages"> {{#ifnot toolSettingsModel.canSaveAutoSyncReleases}}
<div class="story-point-sync-setting-jira-alert">
    <span class="highlighted-important">Release feature is disabled in your linked Jira project</span>
    <br /><br />Please enable releases on Jira side.
    To access features configuration in Jira please click <a data-bind="attr: { href: globalConfig.helpLinkConfigureJiraNextgenRelease }" href="" target="_blank">here</a>.
    <br />
    <button class="storypoint-validator-btn btn-action-primary" data-bind="click: toolSettingsModel.validateNextgenReleaseConfiguration">Validate configuration</button>
</div>
{{/ifnot}}
</script>
<script type="text/html" id="storymap.settingsdialog.jira.projects"> <div class="connection-status description">
    <div>Connected to <strong>Jira</strong> at <span data-bind="text: jiraInstanceUrl"></span></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromJira();}">Disconnect Jira</a>
</div>

{{#if (isFailedToConnectToTool() == false && isConnectedButGloballyDisabled() == false)}}
<div class="control-group">
    <div class="control">
        <label>
            Select a Jira project
            <select data-bind="options: toolSettingsModel.projects, optionsText: 'displayNameInSelectList', value: toolSettingsModel.selectedProject, select: true"></select>
        </label>
    </div>
</div>
<button class="btn-action" data-bind="click: function() {toolSettingsModel.linkProject();}">Link project</button>
<a data-bind="click: toolSettingsModel.refreshProjects">Refresh Jira project list</a>
{{/if}}


{{#if isFailedToConnectToTool()}}
    Error while connecting to Jira project '<strong data-bind="text: toolSettingsModel.linkedProjectName"></strong>'. Please contact with a workspace administrator.
<br />
<br />
    Error message:
<span data-bind="text: failedConnectionMessage"></span>
<br />
<br />
<button class="btn-action-primary" data-bind="click: toolSettingsModel.reauthToJira">Authenticate in Jira</button>
{{/if}}


{{#ifnot isFailedToConnectToTool()}}
{{#if toolSettingsModel != null && toolSettingsModel.isProjectLinked() && isConnectedButGloballyDisabled()}}
        This story map linked to '<span data-bind="text: toolSettingsModel.linkedProjectName"></span>' Jira project, but the Jira integration is globally disabled in this workspace.
{{/if}}

{{#if toolSettingsModel != null && toolSettingsModel.isProjectLinked() == false && isConnectedButGloballyDisabled()}}
        This story map is connected to Jira, but the Jira integration is globally disabled in this workspace.
{{/if}}
{{/ifnot}}</script>
<script type="text/html" id="storymap.settingsdialog.move-storymap-confirm"> 
<div class="header">Transfer story map</div>

{{#if canMoveStorymapToOtherWorkspace() }}
<div class="content">
    <div>
        <div class="confirm-messages">
            You can transfer your story map to any <strong>non-trial</strong> workspace, where you have the necessary permissions to create one.<br>
            <span class="warning-text">The story map won't be accessible on it's current URL, so please notify all collaborators of the change!</span><br />
            <span class="warning-text">The global persona assignments, collaborators and the integration settings will be permanently deleted, you must set them up again!</span><br />
            <span class="warning-text">Transferring a story map to a BASIC plan workspace will remove the workflow settings and restore default states (Todo/Doing/Ready/Done).</span><br />
            After the operation you will be redirected to the dashboard.
        </div>

        <div class="control-group move-to-workspace">
            <div class="control">
                <label>
                    To which workspace would you like to transfer your story map?
                </label>
                <select data-bind="options: otherManagedWorkspaces, optionsText: 'workspaceName', value: workspaceToMoveStorymap, select: true, optionsAfterRender: setTrialWorkspacesDisabled, optionsCaption: 'Please choose a workspace'"></select>
            </div>
            <div class="control">
                <span class="validation-message" data-bind="validationMessage: workspaceToMoveStorymap"></span>
            </div>
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn-action-primary" data-bind="inlineConfirm: ['Transfer story map', 'Are you really sure?', 'Transferring story map'], submitFunction: moveStorymap, showTimer: 'true'"></button>
    <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Cancel</button>
</div>
{{/if}}
{{#ifnot canMoveStorymapToOtherWorkspace() }}
<div class="content">
    <div>
        <div class="confirm-messages">
            Sorry, but you can't tranfer this story map into an another workspace. There are no other workspaces where you have story map creation permission.
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Close</button>
</div>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.nulltoolsettings"> 

<div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>
<div class="issue-tracker-help-link">
    You can find a description on how to use the integration <a data-bind="attr: { href: globalConfig.helpLinkToolIntegrationCommon }" href="" target="_blank">here</a>.
</div>
</script>
<script type="text/html" id="storymap.settingsdialog.pivotaltracker.preferences"> <div class="connection-status description">
    <div>Connected to <strong>Pivotal Tracker</strong> and linked to <strong data-bind="text: toolSettingsModel.linkedProjectName"></strong> project. <span class="disabled_warning" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled())">(Integration is disabled)</span></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromPivotalTracker();}">Disconnect Pivotal Tracker</a>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.unlinkPivotalTrackerProject();}">Unlink project</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && toolSettingsModel.isIntegrationEnabled(), click: function() {toggleIntegrationEnabled();}">Disable integration</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled()), click: function() {toggleIntegrationEnabled();}">Enable integration</a>
</div>

<div>

    <!--<fieldset>
        <legend>Export & Import</legend>
        <span class="legend-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</span>
        <p>
            Donec in pellentesque mauris. Proin finibus elementum tortor quis congue. In sit amet pretium mi. Donec a ligula non orci tempor vestibulum vulputate sit amet lacus. Proin sit amet vulputate nisi. Vivamus eget risus malesuada, euismod velit eget, tempus ipsum.
        </p>
    </fieldset>-->

    <fieldset>
        <legend>Card synchronization</legend>
        <span class="legend-description">Enable two way synchronization of card properties</span>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeNameChanges }" />
                Synchronize name changes
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeDescriptionChanges }" />
                Synchronize description changes
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeEstimationChanges }" />
                Synchronize estimation changes
            </label>
        </div>
    </fieldset>

    <fieldset>
        <legend>Import options</legend>
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.enableImportOptionOnBoard }"/>
                Allow editors to import new cards from Pivotal Tracker
            </label>
        </div>
    </fieldset>
    {{#if toolSettingsModel.enableImportOptionOnBoard }}
    <span class="legend-description">Restrict which stories will be imported by state</span>
    <br/><br />
    <fieldset>
        <div class="control-group">
            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importUnscheduledStories }"/>
                    unscheduled
                </label>
            </div>
            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importUnstartedStories }"/>
                    unstarted
                </label>
            </div>

            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importPlannedStories }"/>
                    planned
                </label>
            </div>
            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importRejectedStories }"/>
                    rejected
                </label>
            </div>

            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importStartedStories }"/>
                    started
                </label>
            </div>
            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importFinishedStories }"/>
                    finished
                </label>
            </div>

            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importDeliveredStories  }"/>
                    delivered
                </label>
            </div>
            <div class="control w-1-4">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.importAcceptedStories }"/>
                    accepted
                </label>
            </div>
        </div>
    </fieldset>
    {{/if}}
</div></script>
<script type="text/html" id="storymap.settingsdialog.pivotaltracker.projects"> <div class="connection-status description">
    <div>Connected to <strong>Pivotal Tracker</strong></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromPivotalTracker();}">Disconnect Pivotal Tracker</a>
</div>
{{#ifnot isFailedToConnectToTool}}
<div class="control-group">
    <div class="control">
        <label>
            Select a Pivotal Tracker project
            <select data-bind="options: toolSettingsModel.projects, optionsText: 'Name', value: toolSettingsModel.selectedPivotalTrackerProject, select: true"></select>
        </label>
    </div>
</div>

<!-- ko if: toolSettingsModel.selectedPivotalTrackerProject() != null -->
<button class="btn-action" data-bind="click: function() {toolSettingsModel.linkPivotalTrackerProject();}">Link project</button>
<!-- /ko -->
<a data-bind="click: toolSettingsModel.refreshProjects">Refresh Pivotal Tracker project list</a>
{{/ifnot}}

{{#if isFailedToConnectToTool}}
<p>Your Pivotal Tracker personal access token has expired.</p>
<br />
<p>To make changes on this story map you need to provide a new personal access token from Pivotal Tracker first. <br />Collaborators can't make changes on this story map until that.</p>
<br />
<br />
<button class="btn-action-primary" data-bind="click: $data.parentModel.switchToExpiredToolItegrationAuthModal.bind($data.parentModel)">Authenticate in Pivotal Tracker</button>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.ptsettings"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>

<div>

</div>

<div class="control-group info-text">
    You can connect with your Pivotal Tracker API Token or if you wish with your Pivotal Tracker credentials. We never store your Pivotal Tracker username and password, it's used only for requesting an api token from Pivotal Tracker.
    <br /><br />
    You can find detailed information on how to set up Pivotal Tracker integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigurePivotalTracker }" href="">here</a>.
</div>

<div class="control-group">
    <div class="control">
        <label>
            Pivotal Tracker API token
            <input type="text" data-bind="value: toolSettingsModel.apiToken">
        </label>
        <span class="help-block"><a href="" data-bind="attr: { href: globalConfig.helpLinkPivotalTrackerApiToken }" target="_blank">Where can I find my API Token?</a></span>
    </div>
    <div class="control" style="position: relative">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.apiToken"></span>
    </div>
</div>

<div id="credentials_separator"><span>OR</span></div>

<div class="control-group">
    <div class="control w-1-2">
        <label>
            Pivotal Tracker email
            <input type="text" data-bind="value: toolSettingsModel.email">
        </label>
    </div>
    <div class="control w-1-2">
        <label>
            Pivotal Tracker password
            <input type="password" data-bind="value: toolSettingsModel.password">
        </label>
    </div>
    <div class="control w-1-2" style="position: relative">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.email"></span>
    </div>
    <div class="control w-1-2" style="position: relative">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.password"></span>
    </div>
</div>

<button class="btn-action" data-bind="click: function() {toolSettingsModel.connectToPivotalTracker();}">Connect</button>
</script>
<script type="text/html" id="storymap.settingsdialog.slackchatsettings"> 
<div data-bind="if: chatToolSettings.showSettings">
    <div class="control-group">
        <div class="control" data-bind="css: {'w-1-1': !chatToolSettings.isConnected(), 'w-3-4': chatToolSettings.isConnected}">
            <label>
                Webhook URL
                <input type="text" data-bind="value: chatToolSettings.slackWebhookUrl">
                <span class="help-block"><a href="https://my.slack.com/services/new/incoming-webhook/" target="_blank">How to create a webhook?</a></span>
            </label>
        </div>

        {{#if chatToolSettings.isConnected }}
        <div class="control w-1-4 cancel-button">
            <button data-bind="btnClick: saveChatToolSettings" class="btn-action-primary">Connect</button>
            &nbsp;
            <button data-bind="btnClick: function() { chatToolSettings.showSettings(false); }" class="btn-action">Cancel</button>
        </div>
        {{/if}}
        <div class="control w-1-1" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: chatToolSettings.slackWebhookUrl"></span>
        </div>
    </div>
</div></script>
<script type="text/html" id="storymap.settingsdialog.tfs-synclevelchangedconfirm:tfs-stucture-sync-confirm">
    <div class="header">
        Confirmation
    </div>

    {{#if: toolSettingsModel.upgradedToHigherLevelStructureSync}}

    <div class="content">

        <p>You are about to enable the <span data-bind="visible: toolSettingsModel.isTwoLevelStructureSyncEnabled">two-level</span> hierarchical synchronization feature with {{toolSettingsModel.getToolName()}}. This is a major change, if you are not sure about the outcome learn more about it <a data-bind="attr: { href: globalConfig.helpLinkConfigureTfsIntegrationModeChange }" href="" target="_blank">here</a>.</p>
        <br />
        <p class="strong">Synchronizing structure and data from StoriesOnBoard to {{toolSettingsModel.getToolShortName()}}</p>
        <br />
        <p>
            This will create the same hierarchy in {{toolSettingsModel.getToolName()}} which you have on your story map.
            {{#if: toolSettingsModel.isStructureSyncEnabled}}
            We're going to push the parents of your linked story level cards to {{toolSettingsModel.getToolName()}} as {{toolSettingsModel.projectStructure.topLevelWorkItemType}}s and {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s.
            {{/if}}
            {{#if: toolSettingsModel.isTwoLevelStructureSyncEnabled}}
            We're going to push every second level (task/step) card to {{toolSettingsModel.getToolName()}} as {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s, which has linked story level children.
            {{/if}}
        </p>
        <br />
        <p class="strong">Synchronizing structure and data from {{toolSettingsModel.getToolShortName()}} to StoriesOnBoard</p>
        <br />
        <p>
            {{#if: toolSettingsModel.isStructureSyncEnabled}}
            This will create the same hierarchy on the story map which you have in {{toolSettingsModel.getToolName()}} by importing the {{toolSettingsModel.projectStructure.topLevelWorkItemType}}s, {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s and the rest of the {{toolSettingsModel.getToolShortName()}} Work Items that match your import settings.
            {{/if}}
            {{#if: toolSettingsModel.isTwoLevelStructureSyncEnabled}}
            This will create the same hierarchy on the story map which you have in {{toolSettingsModel.getToolName()}} by importing the {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s as second level (task/step) cards and rearrange the linked story level children under their parents.
            {{/if}}
        </p>
    </div>
    
    <div class="footer left buttons">
        <button class="btn-action-primary" data-bind="click: toolSettingsModel.syncToIntegrationTool">Sync from StoriesOnBoard to {{toolSettingsModel.getToolShortName()}}</button>
        <button class="btn-action-primary" data-bind="click: toolSettingsModel.syncFromIntegrationTool">Sync from {{toolSettingsModel.getToolShortName()}} to StoriesOnBoard</button>
        <a href="#" class="cancel-button" data-bind="closeModal:true">Cancel</a>
    </div>
    
    {{/if}}

        
    {{#if: toolSettingsModel.downgradedToLowerLevelStructureSync}}
    <div class="content">

        {{#if: toolSettingsModel.isTwoLevelStructureSyncEnabled}}
        <p>You are about to change to two-level hierarchical synchronization.</p>
        <br />
        <p>
            We will unlink your top level (activity/goal) cards from their linked {{toolSettingsModel.getToolShortName()}} Work Items and keep the second (task/step) and story levels synchronized.
        </p>
        {{/if}}

        {{#if: toolSettingsModel.isStoryLevelSyncEnabled}}
        <p>You are about to change to story level hierarchical synchronization.</p>
        <br />
        <p>
            We will unlink your top level cards from the {{toolSettingsModel.getToolShortName()}} Work Items and keep the story level cards synchronized.
        </p>
        {{/if}}

        <br />
        <p>
            Are you sure you want to continue?
        </p>
        <div class="footer left buttons">
            <button class="btn-action-primary" data-bind="click: toolSettingsModel.disableStructureSync">Yes</button>
            <button class="btn-action" data-bind="closeModal:true">No</button>
        </div>
    </div>
    {{/if}}



</script>
<script type="text/html" id="storymap.settingsdialog.tfs.preferences.estimationmessages"> {{#if toolSettingsModel.hasNoStoryPointFieldInExportingWorkItemType}}
<div class="story-point-sync-setting-tfs-alert">
    <span class="highlighted-important">The selected exporting work item type ({{toolSettingsModel.exportingWorkItemType().name}}) does not support estimation values</span>
    <br /><br />
    {{#if toolSettingsModel.isVsts()}}
    Update the layout configuration of your work item types to include the Story Point or the Effort field then revalidate your settings.
    Need help? Click <a data-bind="attr: { href: globalConfig.helpLinkConfigureTfsStoryPoints }" href="" target="_blank">here</a>.
    <br />
    <button class="storypoint-validator-btn btn-action-primary" data-bind="click: toolSettingsModel.validateStoryPointFieldConfiguration">Validate configuration</button>
    {{/if}}
    {{#ifnot toolSettingsModel.isVsts()}}
    Please ask your TFS administrator to include the Story Point or the Effort field in the desired work item types.
    {{/ifnot}}
</div>
{{/if}}

{{#if !toolSettingsModel.hasNoStoryPointFieldInExportingWorkItemType() && toolSettingsModel.hasImportingWorkItemTypeWithNoStoryPointField}}
<div class="story-point-sync-setting-tfs-alert">
    Please note that some of the work item types you have selected to import ({{toolSettingsModel.importingWorkItemTypeNamesWithNoStoryPointField}}) currently do not support estimation values.
    <br /><br />
    {{#if toolSettingsModel.isVsts()}}
    Update the layout configuration of your work item types to include the Story Point or the Effort field then revalidate your settings.
    Need help? Click <a data-bind="attr: { href: globalConfig.helpLinkConfigureTfsStoryPoints }" href="" target="_blank">here</a>.
    <br />
    <button class="storypoint-validator-btn btn-action-primary" data-bind="click: toolSettingsModel.validateStoryPointFieldConfiguration">Validate configuration</button>
    {{/if}}
    {{#ifnot toolSettingsModel.isVsts()}}
    Please ask your TFS administrator to include the Story Point or Effort field in the desired work item types. After a successful configuration please reopen this dialog and save your settings again.
    {{/ifnot}}
</div>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.tfs.preferences"> <div class="info-text">
    To make the most out of our issue tracker integration, please click <a data-bind="attr: { href: globalConfig.helpLinkConfigureTfsRecommendedWorkflows }" href="" target="_blank">here</a> to read more about our recommended workflows.
</div>

<div class="connection-status description">
    <div>
        Connected to <strong>{{toolSettingsModel.getToolName()}}</strong> @ <span data-bind="text: toolSettingsModel.connectedUrl"></span> and linked to <strong data-bind="text: toolSettingsModel.linkedProjectName"></strong> project. <span class="disabled_warning" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled())">(Integration is disabled)</span>
    </div>
    <a class="btn-action" data-bind="click: toolSettingsModel.disconnect">Disconnect {{toolSettingsModel.getToolName()}}</a>
    <a class="btn-action" data-bind="click: toolSettingsModel.unlinkProject">Unlink project</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && toolSettingsModel.isIntegrationEnabled(), click: function() {toggleIntegrationEnabled();}">Disable integration</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled()), click: function() {toggleIntegrationEnabled();}">Enable integration</a>
</div>

<div>
    <fieldset id="tfs-export-options">
        <legend>Integration mode and general settings</legend>
        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.selectedStructureSyncMode, checkedValue: viewmodels.storymap.settingsdialog.TfsStructureSyncType.AllLevels, radio: { enabled: toolSettingsModel.isThreeLevelStructureSyncAvailable }">
                Link all levels of the board hierarchy
            </label>
        </div>
        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.selectedStructureSyncMode, checkedValue: viewmodels.storymap.settingsdialog.TfsStructureSyncType.TwoLevels, radio: { enabled: toolSettingsModel.isTwoLevelStructureSyncAvailable }">
                Link the second and the story level of the board hierarchy
            </label>
        </div>
        <div class="control">
            <label class="export-option">
                <input type="radio" data-bind="checked: toolSettingsModel.selectedStructureSyncMode, checkedValue: viewmodels.storymap.settingsdialog.TfsStructureSyncType.NoStructure, radio:true">
                Link only story level cards
            </label>
            

            <div class="legend-description" data-bind="if: toolSettingsModel.isTwoLevelStructureSyncEnabled">
                Hint: The selected synchronization mode will send
                second level cards as {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s
                and third level cards as {{toolSettingsModel.projectStructure.thirdLevelWorkItemType}}s.
            </div>
            <div class="legend-description" data-bind="if: toolSettingsModel.isStructureSyncEnabled">
                Hint: The selected synchronization mode will send 
                top level cards as {{toolSettingsModel.projectStructure.topLevelWorkItemType}}s,
                second level cards as {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s
                and third level cards as {{toolSettingsModel.projectStructure.thirdLevelWorkItemType}}s.
            </div>
        </div>
        
        {{#if: toolSettingsModel.isSyncOptionChanged }}

        <div class="grey-alert-box structure-sync-alert">
            <span class="warning-text">Pay attention, major change ahead.</span>
            <br />
            <br />
            Please note that changing the integration mode is a major change in how the synchronization works and may have unwanted side effects.
            It can reorganize your hierarchy in StoriesOnBoard or in {{toolSettingsModel.getToolName()}} depending on your choice when saving this form. 
            Please be careful with this operation. Learn more about it <a data-bind="attr: { href: globalConfig.helpLinkConfigureTfsIntegrationModeChange }" href="" target="_blank">here</a>.
        </div>
        {{/if}}

        <div class="control" data-bind="if: toolSettingsModel.selectedStructureSyncMode() == viewmodels.storymap.settingsdialog.TfsStructureSyncType.NoStructure">
            <label>
                Exporting work item type
                <select data-bind="options: toolSettingsModel.availableWorkItemTypesForExport, optionsText: 'name', value: toolSettingsModel.exportingWorkItemType, select: true"></select>
            </label>
            <span class="help-block">Select the appropriate {{toolSettingsModel.getToolName()}} work item type to use when exporting bottom level cards from StoriesOnBoard</span>
        </div>
        <div class="control">
            <label class="backlink-checkbox">
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.addStoriesOnBoardLink }" />
                Add StoriesOnBoard card link to the {{toolSettingsModel.getToolName()}} work item's link tab as a hyperlink
            </label>
        </div>
    </fieldset>


    <fieldset>
        {{#ifnot: toolSettingsModel.isStructureSyncEnabled}}
        <legend>Import filter with status mapping</legend>
        <span class="legend-description">Select the work item types you wish to import and synchronize. Make sure to map their statuses to the appropriate ones in StoriesOnBoard. The {{toolSettingsModel.exportingWorkItemType().name}} work item type is selected by default because it is your exporting type as well.</span>
        {{/ifnot}}
        {{#if: toolSettingsModel.isStructureSyncEnabled}}
        <legend>Status mapping</legend>
        <span class="legend-description">Map the statuses of the {{toolSettingsModel.exportingWorkItemType().name}} work item type to the appropriate ones in StoriesOnBoard.</span>
        {{/if}}

        <div class="work-item-type" data-bind="foreach: toolSettingsModel.visibleStatusMappings">
            <label class="board-settings-tfs-work-item-type-label">
                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled, enabled: CanBeModified }" />
                <strong class="work-item-type-name" data-bind="text: WorkItemTypeName"></strong>
            </label>
            <table data-bind="visible: IsSyncEnabled">
                <tbody data-bind="foreach: Statuses">
                    <tr>
                        <td>
                            <label>
                                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled, enabled: $parent.CanBeModified }" />
                                <span data-bind="text: TfsStatus.Name"></span>
                            </label>
                        </td>
                        <td data-bind="visible: IsSyncEnabled">
                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger">
                                    <div class="d-flex align-items-center">
                                        <span class="small-font board-subtask-statuses-menu-selected-option"
                                              style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                                              data-bind="style: { 'background-color': Status().color } ,text: Status().name()"></span>
                                        <i class="ml-5 delete-dropdown-icon"></i>
                                    </div>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul data-bind="foreach: $parent.availableStates">
                                        <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $parent.Status($data); }">
                                            <div class="status-menu-item__color-box"
                                                 data-bind="style: { 'background-color': color }"></div>
                                            <a class="ml-5" data-bind="text: name"></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        {{#if (toolSettingsModel.isStructureSyncEnabled() || toolSettingsModel.isTwoLevelStructureSyncEnabled())}}

        <a class="mt-10" data-bind="if: !toolSettingsModel.showExtraStatusMappings(), click: () => toolSettingsModel.showExtraStatusMappings(true)">Show additional work item types</a>

        {{#if toolSettingsModel.showExtraStatusMappings()}}
        <legend>Additional work item types</legend>
        <span class="legend-description">Cards created in StoriesOnBoard will be snychronized as {{toolSettingsModel.exportingWorkItemType().name}} in Azure DevOps.</span>
        <div class="work-item-type" data-bind="foreach: toolSettingsModel.extraStatusMappings">
            <label class="board-settings-tfs-work-item-type-label">
                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled }" />
                <strong class="work-item-type-name" data-bind="text: WorkItemTypeName"></strong>
            </label>
            <table data-bind="visible: IsSyncEnabled">
                <tbody data-bind="foreach: Statuses">
                    <tr>
                        <td>
                            <label>
                                <input type="checkbox" data-bind="checkbox: { checked: IsSyncEnabled }" />
                                <span data-bind="text: TfsStatus.Name"></span>
                            </label>
                        </td>
                        <td data-bind="visible: IsSyncEnabled">
                            <div class="dropdown-menu" data-bind="dropdownmenu: true">
                                <a href="#" data-bind="stopPropagation: true" class="trigger">
                                    <div class="d-flex align-items-center">
                                        <span class="small-font board-subtask-statuses-menu-selected-option"
                                              style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                                              data-bind="style: { 'background-color': Status().color } ,text: Status().name()"></span>
                                        <i class="ml-5 delete-dropdown-icon"></i>
                                    </div>
                                </a>
                                <div class="menu-content left-aligned">
                                    <ul data-bind="foreach: $parent.availableStates">
                                        <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $parent.Status($data); }">
                                            <div class="status-menu-item__color-box"
                                                 data-bind="style: { 'background-color': color }"></div>
                                            <a class="ml-5" data-bind="text: name"></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        {{/if}}
        {{/if}}


        <div class="status-helper-info-box">
            Need more states? You can customize your workflow by creating custom states.
            <span data-bind="click: toolSettingsModel.onOpenWorkflowSettings" style="text-decoration: underline">Go to workflow settings.</span>
        </div>
    </fieldset>
        
    <fieldset>
        {{#ifnot: toolSettingsModel.isStructureSyncEnabled}}
        <legend>Additional import settings</legend>
        {{/ifnot}}
        {{#if: toolSettingsModel.isStructureSyncEnabled}}
        <legend>Import settings</legend>
        {{/if}}
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.enableImportOptionOnBoard }" />
                Allow editors to import new cards from {{toolSettingsModel.getToolName()}}
            </label>
        </div>

        {{#ifnot toolSettingsModel.isAdvancedFilterEnabled }}
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.ignoreClosedIssues }" />
                Ignore closed work items on import
            </label>
        </div>
        <div class="subtext">
            <a class="btn-action" data-bind="click: function() { toolSettingsModel.isAdvancedFilterEnabled(true) }">Advanced import filter</a>
        </div>
        {{/ifnot}}

        {{#if toolSettingsModel.isAdvancedFilterEnabled }}
        <div class="control">
            <label>
                Select a stored query from {{toolSettingsModel.getToolName()}}
                <select data-bind="options: toolSettingsModel.queries, optionsText: 'Name', value: toolSettingsModel.advancedFilterQuery, select: true, optionsCaption: 'Choose...'"></select>
                <div class="subtext">
                    <div class="left" data-bind="if: toolSettingsModel.advancedFilterQuery() != null">
                        Click <a class="btn-action" href="{{toolSettingsModel.connectedUrl}}/{{toolSettingsModel.linkedProjectName}}/_workitems?path={{toolSettingsModel.advancedFilterQuery().Name}}&_a=query" target="_blank">here</a> to test your query.
                    </div>
                    <div class="right">
                        <a class="btn-action" data-bind="click: function() { toolSettingsModel.isAdvancedFilterEnabled(false) }">cancel filter</a>
                    </div>
                </div>
            </label>
        </div>
        <div class="control" id="advanced-import-filter-validation-message">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.advancedFilterQuery"></span>
        </div>
        <div class="legend-description">
            Hint:
            Advanced import filter allows you to further customize the Work Items you wish to import and synchronize. With Queries you can import Work Item types that are not listed among the
            status mapping options but we can only keep the statuses of these items synchronized if they are part of the configured project.
            <span class="strong">
                Please note, the selected synchronization mode only supports queries with the following type: "Flat list of work items".
                {{#if toolSettingsModel.isSaved}}
                Changing the query will unlink all your existing cards on your board which are not in the query result.
                {{/if}}
            </span>
            {{#if: toolSettingsModel.isStructureSyncEnabled}}
            Please make sure that the selected query returns the whole structure not just the bottom level. Parent cards will not be imported if they are missing from the query's result.
            {{/if}}

            {{#if: toolSettingsModel.isTwoLevelStructureSyncEnabled}}
            Please make sure that the selected query returns the {{toolSettingsModel.projectStructure.secondLevelWorkItemType}}s and {{toolSettingsModel.projectStructure.thirdLevelWorkItemType}}s. Parent cards will not be imported if they are missing from the query's result.
            {{/if}}
        </div>
        {{/if}}
    </fieldset>
    

    <div class="sync-options">
        <fieldset>
            <legend>Card synchronization</legend>
            <span class="legend-description">Enable two way synchronization of card properties</span>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeNameChanges }" />
                    Synchronize name changes
                </label>
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeDescriptionChanges }" />
                    Synchronize description changes
                </label>
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeEstimationChanges }" />
                    Synchronize estimation changes as Story points or Effort
                </label>
                <div data-bind="template: { name: 'storymap.settingsdialog.tfs.preferences.estimationmessages' }"></div>

            </div>
        </fieldset>

        <fieldset>
            <legend>Release synchronization</legend>
            <span class="legend-description">Enable two way synchronization of releases</span>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.autoSyncReleases }" />
                    Synchronize releases as {{toolSettingsModel.getToolName()}} iterations
                </label>
            </div>
            {{#if toolSettingsModel.autoSyncReleases }}
            <div class="control">
                <label>
                    Parent iteration for exported releases
                    <select data-bind="options: toolSettingsModel.iterations, optionsText: 'PathWithProjectName', value: toolSettingsModel.exportingIteration, select: true, optionsCaption: 'Choose...'""></select>
                </label>
            </div>
            <div class="control" style="position: relative; clear: both;">
                <span class="validation-message" data-bind="validationMessage: toolSettingsModel.exportingIteration"></span>
            </div>
            <div class="tfs-release-sync-info-in-dialog">
                Release synchronization may require additional permissions in {{toolSettingsModel.getToolName()}} to work. Click <a class="btn-action" href="{{ globalConfig.helpLinkConfigureTfsReleaseSync }}" target="_blank">here</a> for more information.
            </div>
            {{/if}}
        </fieldset>

        <fieldset>
            <legend>Impersonation</legend>
            <span class="legend-description">By enabling impersonation the changes on the story map will be synced with {{toolSettingsModel.getToolName()}} on behalf of the current collaborator. Collaborators need to authenticate in {{toolSettingsModel.getToolName()}} to make changes on the story map. Unauthenticated collaborators can only view the map.</span>

            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.isImpersonationEnabled }" />
                    Enable impersonation
                </label>
                {{#if toolSettingsModel.showUpgradeToProPlanMessage}}
                <br />
                <div class="subscription-info-hint-in-dialog">
                    Hint: This feature is not avaliable in the current Standard subscription plan. Please upgrade to the Pro subscription plan to use this feature.
                </div>
                {{/if}}
            </div>
        </fieldset>
    </div>
</div></script>
<script type="text/html" id="storymap.settingsdialog.tfs.projects"> <div class="connection-status description">
    <div>Connected to <strong>{{toolSettingsModel.getToolName()}}</strong> @ <span data-bind="text: toolSettingsModel.connectedUrl"></span></div>

    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnect();}">Disconnect {{toolSettingsModel.getToolName()}}</a>
</div>

{{#ifnot isFailedToConnectToTool}}
<div class="control-group">
    <div class="control">
        <label>
            Select a(n) {{toolSettingsModel.getToolName()}} project
            <select data-bind="options: toolSettingsModel.projects, optionsText: 'Name', value: toolSettingsModel.selectedProject, select: true"></select>
        </label>
    </div>
</div>

{{#if toolSettingsModel.selectedProject() != null}}
<button class="btn-action" data-bind="click: toolSettingsModel.linkProject">Link project</button>
{{/if}}
<a data-bind="click: toolSettingsModel.refreshProjects">Refresh project list</a>
{{/ifnot}}

{{#if isFailedToConnectToTool}}
        Error while connecting to {{toolSettingsModel.getToolName()}}.
<br />
<br />
        Error message:
<span data-bind="text: failedConnectionMessage"></span>
<br />
<br />

{{#if toolSettingsModel.isVsts()}}
<button class="btn-action-primary" data-bind="click: toolSettingsModel.reauthToVsts.bind(toolSettingsModel)">Authenticate in Azure DevOps</button>
{{/if}}

{{#if !toolSettingsModel.isVsts() && toolSettingsModel.parentModel.parentModel.isReauthenticationSupported()}}

    {{#if toolSettingsModel.parentModel.parentModel.isUsernamePasswordAuthentication}}
    <div class="control-group">
        <div class="control">
            <label>
                TFS user name
                <input type="text" data-bind="value: toolSettingsModel.username">
            </label>
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.username"></span>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                TFS password
                <input type="password" data-bind="value: toolSettingsModel.password">
            </label>
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.password"></span>
        </div>
    </div>
    {{/if}}

    {{#ifnot toolSettingsModel.parentModel.parentModel.isUsernamePasswordAuthentication}}
    <div class="control-group">
        <div class="control">
            <label>
                Personal access token
                <input type="text" data-bind="value: toolSettingsModel.personalAccessToken">
            </label>
            {{#if toolSettingsModel.isValudUrl}}
            <span class="help-block">
                Click <a href="" data-bind="attr: {href: toolSettingsModel.tfsPersonalAccessTokenUrl}" target="_blank">here</a> to create a personal access token.
                <br />
                <br />
                Please note that your Personal Access Token must have <strong>Work items (read and write)</strong> authorized scope to be able to integrate with TFS.
            </span>
            {{/if}}
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.personalAccessToken"></span>
        </div>
    </div>
    {{/ifnot}}

    <button class="btn-action-primary" data-bind="click: toolSettingsModel.reAuthenticate.bind(toolSettingsModel)">Authenticate in TFS</button>
{{/if}}

{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.tfssettings"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>

<div>

</div>

<div class="control-group info-text">
    You can find detailed information on how to set up TFS integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureTfs}" href="">here</a>.
</div>

<div class="control-group info-text">
    {{#ifnot toolSettingsModel.showTfs2015 }}
    Using TFS2015? Click <a data-bind="click: toolSettingsModel.toggleTfs2015Settings">here</a> to authenticate with username/password.
    {{/ifnot}}
    {{#if toolSettingsModel.showTfs2015 }}
    Click <a target="_blank" data-bind="click: toolSettingsModel.toggleTfs2015Settings" href="">here</a> to connect to TFS with personal access token.
    {{/if}}
</div>

<div class="control-group">
    <div class="control">
        <label>
            TFS server collection URL
            <input type="text" data-bind="value: toolSettingsModel.tfsCollectionUrl">
        </label>
        <span class="help-block">Your url looks similar to these: https://tfs.yourcompany.com/yourcollection or https://yourcompany.com/tfs/yourcollection </span>
    </div>
    <div class="control" style="position: relative">
        <span class="validation-message" data-bind="validationMessage: toolSettingsModel.tfsCollectionUrl"></span>
    </div>
</div>

{{#ifnot toolSettingsModel.showTfs2015 }}
    <div class="control-group">
        <div class="control">
            <label>
                Personal access token
                <input type="text" data-bind="value: toolSettingsModel.personalAccessToken">
            </label>
            {{#if toolSettingsModel.isValudUrl}}
                <span class="help-block">
                    Click <a href="" data-bind="attr: {href: toolSettingsModel.tfsPersonalAccessTokenUrl}" target="_blank">here</a> to create a personal access token.
                </span>
            {{/if}}
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.personalAccessToken"></span>
        </div>
    </div>
{{/ifnot}}

{{#if toolSettingsModel.showTfs2015 }}
    <div class="control-group">
        <div class="control">
            <label>
                TFS user name
                <input type="text" data-bind="value: toolSettingsModel.username">
            </label>
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.username"></span>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                TFS password
                <input type="password" data-bind="value: toolSettingsModel.password">
            </label>
        </div>
        <div class="control" style="position: relative">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.password"></span>
        </div>
    </div>
{{/if}}

<div class="control-group">
    <div class="control">
        <span class="help-block">
            You might need to whitelist StoriesOnBoard in your firewall so that it can
            connect to your server. StoriesOnBoard uses the following IP addresses for connections: <small data-bind="text: outboundIpAddresses"></small>
        </span>
        <span class="help-block pat-scope-info-block">
            Please note that your Personal Access Token must have <strong>Work items (read and write)</strong> authorized scope to be able to integrate with TFS.
        </span>
    </div>
</div>


<button class="btn-action tfs-connect-btn" data-bind="click: toolSettingsModel.connect">Connect</button>
</script>
<script type="text/html" id="storymap.settingsdialog.trello.boards"> <div class="connection-status description">
    <div>Connected to <strong>Trello</strong></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromTrello();}">Disconnect Trello</a>
</div>

{{#ifnot isFailedToConnectToTool()}}
    <div class="control-group">
        <div class="control">
            <label>
                Select a Trello board
                <select data-bind="options: toolSettingsModel.boards, optionsText: 'Name', value: toolSettingsModel.selectedBoard, select: true"></select>
            </label>
        </div>
    </div>

    <button class="btn-action" data-bind="click: function() {toolSettingsModel.linkBoard();}">Link board</button>
    <a data-bind="click: toolSettingsModel.refreshBoards">Refresh Trello board list</a>
{{/ifnot}}

{{#if isFailedToConnectToTool()}}
    <p>Your Trello authentication token has expired.</p>
    <br />
    <p>We weren't able to connect to the Trello board '<strong data-bind="text: toolSettingsModel.LinkedProjectName"></strong>'. The server responded: <span data-bind="text: failedConnectionMessage"></span> </p>
    <br />
    <p>To resolve the issue and to make changes on this storymap you need to authenticate in Trello first. <br />Collaborators can't make changes on this story map until that.</p>
    <br />
    <br />
    <button class="btn-action-primary" data-bind="click: toolSettingsModel.openTrelloAuthWindowToRenewToken.bind(toolSettingsModel)">Authenticate in Trello</button>
{{/if}}</script>
<script type="text/html" id="storymap.settingsdialog.trello.preferences"> <div class="connection-status description">
    <div>Connected to <strong>Trello</strong> and linked to <strong data-bind="text: toolSettingsModel.linkedProjectName"></strong> board. <span class="disabled_warning" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled())">(Integration is disabled)</span></div>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnectFromTrello();}">Disconnect Trello</a>
    <a class="btn-action" data-bind="click: function() {toolSettingsModel.unlinkBoard();}">Unlink board</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && toolSettingsModel.isIntegrationEnabled(), click: function() {toggleIntegrationEnabled();}">Disable integration</a>
    <a class="btn-action" data-bind="if: toolSettingsModel.isSaved() && !(toolSettingsModel.isIntegrationEnabled()), click: function() {toggleIntegrationEnabled();}">Enable integration</a>
</div>

<div>
    <fieldset>
        <legend>Export options</legend>
        <span class="legend-description">Select the appropriate Trello list to use when exporting cards from StoriesOnBoard</span>
        <div class="control">
            <label>
                Trello list
                <select data-bind="options: toolSettingsModel.lists, optionsText: 'Name', value: toolSettingsModel.exportingList, select: true"></select>
            </label>
        </div>
        <div class="control">
            <label class="backlink-checkbox">
                <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.addStoriesOnBoardLink }" />
                Add StoriesOnBoard card link to the Trello card as an attachment
            </label>
        </div>
    </fieldset>
    
    <fieldset>
        <legend>Status mappings</legend>
        <span class="legend-description">Map Trello lists to StoriesOnBoard card statuses. When integration is enabled, statuses always come from Trello, and can't be modified manually</span>
        <table>
            <tbody data-bind="foreach: toolSettingsModel.statusMappings">
            <tr>
                <td>
                    <span data-bind="text: TrelloList.Name"></span>
                </td>
                <td>
                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a href="#" data-bind="stopPropagation: true" class="trigger">
                            <div class="d-flex align-items-center">
                                <span class="small-font board-subtask-statuses-menu-selected-option"
                                      style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                                      data-bind="style: { 'background-color': Status().color } ,text: Status().name()"></span>
                                <i class="ml-5 delete-dropdown-icon"></i>
                            </div>
                        </a>
                        <div class="menu-content left-aligned">
                            <ul data-bind="foreach: availableStates">
                                <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: function () { $parent.Status($data); }">
                                    <div class="status-menu-item__color-box"
                                         data-bind="style: { 'background-color': color }"></div>
                                    <a class="ml-5" data-bind="text: name"></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
        
        <div class="status-helper-info-box">
            Need more states? You can customize your workflow by creating custom states. 
            <span data-bind="click: toolSettingsModel.onOpenWorkflowSettings" style="text-decoration: underline">Go to workflow settings.</span>
        </div>
    </fieldset>

    <div class="sync-options">
        <fieldset>
            <legend>Card synchronization</legend>
            <span class="legend-description">Enable two way synchronization of card properties</span>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeNameChanges }" />
                    Synchronize name changes
                </label>
            </div>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeDescriptionChanges }" />
                    Synchronize description changes
                </label>
            </div>
        </fieldset>
        
        <fieldset>
            <legend>Import options</legend>
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.enableImportOptionOnBoard }" />
                    Allow editors to import new cards from Trello (only non archived cards will be imported)
                </label>
            </div>
            {{#if toolSettingsModel.enableImportOptionOnBoard }}
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.ignoreArchivedCards }"/>
                    Ignore importing cards from archive lists
                </label>
            </div>
            {{/if}}
        </fieldset>
        
        <fieldset>
            <legend>Trello Power-Up</legend>
            
            <div class="info-block">
                <p class="info-text">  
                    Want a radically more powerful integration? Try out our Trello Power-Up. <a href="{{ globalConfig.trelloPowerUpLearnMore }}" target="_blank">Learn more</a>
                </p>            
                <p class="info-text">
                    Add our <a href="{{ globalConfig.trelloPowerUpUrl }}" target="_blank">Power-Up</a> to your Trello board and use the following Power-Up integration identifier to set it up.
                </p>
            </div>

            <div class="control">
                <label>
                    Integration identifier
                    <div class="styled-to-input">{{ toolSettingsModel.integrationIdentifier }}</div>
                </label>
            </div>
            
            <div class="control">
                <label class="mt-10">
                    <input type="checkbox" data-bind="checkbox: { checked: toolSettingsModel.synchronizeEstimationChanges  }" />
                    Allow updating estimations from Trello (for all Trello board members )
                </label>
            </div>

          
        </fieldset>
    </div>
</div></script>
<script type="text/html" id="storymap.settingsdialog.trellosettings"> <div class="control-group">
    <div class="control">
        <label>
            Select a tool to integrate with
            <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
        </label>
    </div>
</div>
<div class="issue-tracker-help-link">
    You can find detailed information on how to set up Trello integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureTrello }" href="">here</a>.
</div>
<button class="btn-action" data-bind="click: toolSettingsModel.openTrelloAuthWindowToConnect.bind(toolSettingsModel)">Connect to Trello</button></script>
<script type="text/html" id="storymap.settingsdialog.vstssettings"> <div class="vsts-settings">
    {{#if toolSettingsModel.isAuthenticated}}
    <div class="connection-status description">
        <div>Connected to <strong>{{toolSettingsModel.getToolName()}}</strong></div>
        <a class="btn-action" data-bind="click: function() {toolSettingsModel.disconnect();}">Disconnect {{toolSettingsModel.getToolName()}}</a>
    </div>
    {{/if}}
    {{#ifnot toolSettingsModel.isAuthenticated}}
    <div class="control-group">
        <div class="control">
            <label>
                Select a tool to integrate with
                <select data-bind="options: tools, optionsText: 'name', value: selectedTool, select: true"></select>
            </label>
        </div>
    </div>
    {{/ifnot}}
    <div class="issue-tracker-help-link">
        You can find detailed information on how to set up Azure DevOps integration <a target="_blank" data-bind="attr: { href: globalConfig.helpLinkConfigureVsts }" href="">here</a>.
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                Azure DevOps account URL
                <input type="text" data-bind="value: toolSettingsModel.vstsAccountUrl">
            </label>
            <span class="help-block">Your URL looks similar to these: https://dev.azure.com/yourcompany or https://yourcompany.visualstudio.com</span>
        </div>
        <div class="control validation-message-container">
            <span class="validation-message" data-bind="validationMessage: toolSettingsModel.vstsAccountUrl"></span>
        </div>
    </div>
    {{#if toolSettingsModel.shouldShowWrongAccountMessage}}
    <div class="grey-alert-box mb-15">
        <div class="highlighted-important" style="line-height: 1.3; padding: 5px;">
            We could not find any project linked to your current Azure DevOps account. Please make sure you are logged in with the correct user. To try a different user, <span class="font-weight-bold" style="font-size: 13px;">please disconnect first and it might be necessary to configure the integration in an incognito window</span> to successfully re-authenticate in Azure DevOps.
        </div>
    </div>
    {{/if}}
    <button class="btn-action" data-bind="click: toolSettingsModel.connectToVsts">Connect</button>
</div></script>
<script type="text/html" id="storymap.slidingpanels.board-activities"> <div class="x-board-activities-panel-content">
    <div id="hide-my-activities">
        <div class="control-group">
            <div class="control w-2-3">
                <label class="styled-check-label" onclick="">
                    <input type="checkbox" data-bind="checkbox: {checked: hideOwnActivities}" />
                    <span class="label">Hide my own activities</span>
                </label>
            </div>
        </div>
    </div>
    
    {{#if showRecoverableDeletesOnly }}
        <track-page params="page: track.StorymapTrashedItems"></track-page>

        <div class="trash-bin-filter">Filtered by <strong>Recoverable card delete events ({{numberOfVisibleBoardActivities}})</strong> <a class="unfilter-link" data-bind="click: resetRecoverableCardsFilter">unfilter</a></div>
    {{/if}}
    
    {{#ifnot showRecoverableDeletesOnly}}
        <track-page params="page: track.StorymapActivityFeed"></track-page>

        <div id="card-filter-panel" data-bind="visible: $root.board.showCardFilter, css: { filtered: $root.board.cardFilterApplied }">
            <span data-bind="if: $root.board.cardFilterApplied">Filtered </span>
            {{#ifnot $root.board.cardFilterApplied}}
            <button class="btn-action-primary" data-bind="click: $root.filterBySelectedCard">Filter</button>
            {{/ifnot}}
            <span>by</span>
            <span id="selected-card-name" data-bind="text: $root.board.selectedCardName"></span>
            <span>card</span>
            <a id="cancel-card-filter-link" data-bind="click: $root.setAllBoardActivitiesVisible, visible: $root.board.cardFilterApplied">unfilter</a>
        </div>
    {{/ifnot}}

    <div class="board-activities-feed-panel-conatiner-spacer"></div>

    <div class="board-activities-feed-panel-conatiner" data-bind="heightResizer: { selector: '#board-activities-panel', relative: $root.boardActivitiesPanelHeight }, visible: hasBoardActivitiesToShow()">
        <div class="board-activities-feed-panel-content">
            <board-activities-list params="boardActivities: $root.visibleBoardActivities"></board-activities-list>
            


            
        </div>
        <div class="show-archived-button">
            {{#if $root.hasUnloadedBoardActivities() && !$root.board.cardFilterApplied() }}
            <a data-bind="click: loadMoreBoardActivity">load more activities</a>
            {{/if}}
        </div>
    </div>

    <div class="no-filter-result" data-bind="visible: !hasBoardActivitiesToShow()">
        <span>No activities found.</span>
    </div>
</div></script>
<script type="text/html" id="storymap.slidingpanels.persona:globalPersonaOnboarding">
    <div>
        You can create <span class="font-weight-bold">product personas</span> that <span class="font-weight-bold">can be reused on each story map.</span>
        <br />
        <br />
        <br />
        Moreover, a product persona allows you to customize persona details by adding custom fields or personality attributes.
        <br />
        <br />
        <br />
        Click <a tabindex="1" target="_blank" data-bind="click: goToGlobalPersona">here</a> to create a product persona.
    </div>
    <div>
        <img class="mt-20 img-responsive" src="{{globalConfig.appUrl}}/content/img/persona-example.png" alt="persona example" />
    </div>
</script>
<script type="text/html" id="storymap.slidingpanels.persona:personaItem">

    <li class="persona-item" data-bind="css: {active: $data.hasActiveClass}, scrollTo: {container: '.persona-data-wrapper', doScroll: isScrolledIntoView}">
        <div class="inline-container">      
                                          
            <div class="persona-avatar" data-bind="css: {custom: !$data.picture().isBuiltInAvatar}">
                <a data-bind="click: function() { $data.isExpanded(!$data.isExpanded()); }">
                    <img class="selected-image" data-bind="attr: { src: $data.picture().path }, css: { 'built-in-avatar' : $data.picture().isBuiltInAvatar }">           
                </a>
                            
                <!-- Picture dropdown menu -->
                {{#if $data.isPictureEditing}}
                <div class="picture-menu" data-bind="template: {name: 'storymap.slidingpanels.persona.avatarchooser', data: $parent.avatarChooser}"></div>
                {{/if}}
            </div>

            <!-- Persona name & group inline editor -->

            <div class="row-wrapper" data-bind="css: {has-optional-data: $data.hasOptionalData}">
                            
                <div class="name-container" data-bind="inlineTextArea: { value: $data.name,
                                                    editmode: $data.isNameEdited,
                                                    emptyText: 'Unnamed Persona',
                                                    selectTextOnFocus: false,
                                                    editOnClick: false,
                                                    onStartEdit: function() {$parent.setActivePersona($data); $data.isNameEdited(true);},
                                                    onEndEdit: function(contentUnchanged) {if (!contentUnchanged) {$parent.updatePersonaName($data)}; $data.inactivate();},
                                                    inputClass: 'inline-textfield persona-name',
                                                    emptyClass: 'name-container',
                                                    type: 'text',
                                                    endEditOnEnterKey: true,
                                                    width: '90%',
                                                    customTriggerHandler: function() {$data.isExpanded(!$data.isExpanded())},
                                                    maxlength: $parent.personaNameMaxLength
                                                }">
                </div>

                {{#if ($data.group() != null && $data.group().length > 0) || $data.isGroupEdited()}}
                <div class="group-container" data-bind="inlineTextArea: {
                                            value: $data.group,
                                            editmode: $data.isGroupEdited,
                                            emptyText: 'Type group name and press enter',
                                            emptyTextIsPlaceholder: true,
                                            selectTextOnFocus: false,
                                            editOnClick: false,
                                            onStartEdit: function() {$parent.setActivePersona($data); $data.isGroupEdited(true);},
                                            onEndEdit: function(contentUnchanged) {if (!contentUnchanged) {$parent.updatePersonaGroup($data)}; $data.inactivate();},
                                            inputClass: 'inline-textfield persona-group-name',
                                            emptyClass: 'group-container',
                                            endEditOnEnterKey: true,
                                            type: 'text',
                                            width: '50%',
                                            customTriggerHandler: function() {$data.isExpanded(!$data.isExpanded())},
                                            maxlength: $parent.personaGroupMaxLength
                                         }">
                </div>
                {{/if}}
                        
                <!-- Actions dropdown -->

                {{#ifnot $root.currentUserIsViewer()}}
                <div class="actions-container">

                    <div class="dropdown-menu" data-bind="dropdownmenu: true">
                        <a class="trigger" tabindex="1">
                            <!--actions
                            <span class="caret blue"></span>-->
                            <i class="icon-panel-v-options"></i>
                        </a>
                        <div class="menu-content right-aligned">
                            <ul>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$data.isExpanded(!$data.isExpanded())}">
                                        {{#ifnot isExpanded}}
                                        Show persona details
                                        {{/ifnot}}
                                        {{#if isExpanded}}
                                        Hide persona details
                                        {{/if}}
                                    </a>
                                </li>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$parent.filterBoard($data); }">Show related cards</a>
                                </li>
                                
                                {{#if !isGlobal}}
                                <li class="dropdown-menu-line">
                                    <hr>
                                </li>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$parent.setActivePersona($data); $data.isNameEdited(true); }">Edit persona name</a>
                                </li>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$parent.setActivePersona($data); $data.isGroupEdited(true); }">
                                        {{#if $data.group() == null || $data.group().length < 1}}
                                        Add persona group
                                        {{/if}}
                                        {{#if $data.group() != null && $data.group().length > 0}}
                                        Edit persona group
                                        {{/if}}
                                    </a>
                                </li>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$parent.setActivePersona($data); $parent.showEditPictureMenuFor($data); }">Change persona image</a>
                                </li>
                                {{#ifnot $parent.isPersonaListFiltered}}
                                <li class="dropdown-menu-line">
                                    <hr>
                                </li>
                                <li class="dropdown-menu-item">
                                    <a data-bind="click: function() {$parent.deletePersona($data); }">Delete persona</a>
                                </li>
                                {{/ifnot}}
                                {{/if}}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            {{/ifnot}}

                        </div>
                        
                        <!-- Persona details & goals -->

                        <div class="data-wrapper" data-bind="slideVisible: $data.isExpanded">
                            <div class="data-container">                                                                 
                                <div class="data-container-inner">
                                    <div class="data description-container">
                                        <inline-extra-markdown params="
                                                               value: $data.description,
                                                               emptyText: function() { return !$root.currentUserIsViewer() ? 'Click to add persona details. <a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot; onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;&quot; class=&quot;inline-text-empty-link&quot;>Markdown</a> is supported!' : '' },
                                                               isEditEnabled: !isGlobal && !$root.currentUserIsViewer(),
                                                               onEndEdit: function(contentUnchanged) {if (!contentUnchanged) {$parent.updatePersonaDescription($data)};},
                                                               isInEditMode: $data.isDescEditing,
                                                               helperPoz: 'left' ">
                                        </inline-extra-markdown>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                {{#if $index() < $root.personas().length-1}}
                <li class="divider-item">&nbsp;</li>
                {{/if}}

</script>
<script type="text/html" id="storymap.slidingpanels.persona"> <track-page params="page: track.StorymapPersonas"></track-page>

<div class="cf persona-title">
    <div class="storymap-panel-close-button">
        <a href="/" data-bind="click: function() { $root.board.isPersonaPanelOpened(false); }, panelsliderClose ">
            <i class="icon-panel-close"></i>
        </a>
    </div>
    <div class="storymap-panel-title"><span>Personas</span></div>
    <div class="persona-show-hide">
        {{#if $root.hasPersonas}}
            {{#if $root.isShowPersonasEnabled}}	
                <a class="secondary-link" data-bind="click: $root.toggleShowPersonasEnabled">hide personas on board</a>	
            {{/if}}	
            {{#ifnot $root.isShowPersonasEnabled}}	
                <a class="secondary-link" data-bind="click: $root.toggleShowPersonasEnabled">show personas on board</a>	
            {{/ifnot}}     
         {{/if}}      
    </div>
</div>

<div class="persona-panel-content" data-bind="click: hideEditPictureMenu">
    <div class="persona-onboard-messages">

        {{#ifnot isNewPersonaVisible}}

        <!-- Onboard message if there is no personas yet. -->
        {{#ifnot hasPersona}}
        {{#if $root.currentUserIsViewer()}}
        <br />
        This story map doesn't have any personas defined yet.
        {{/ifnot}}

        {{#ifnot $root.currentUserIsViewer()}}
        <div>
            Understand your target audience by creating user personas. Personas can be assigned both to top-level and story cards.
            <br />
            <br />
            <br />
            You can create <span class="font-weight-bold">local personas</span>, which are <span class="font-weight-bold">only available on this story map.</span>
            <br />
            <br />
            <br />
            Click <a tabindex="1" data-bind="click: addNewPersona">here</a> to add a local persona.
        </div>

        <hr class="mt-20 mb-20" />

        {{#template 'storymap.slidingpanels.persona:globalPersonaOnboarding'/}}

        {{/ifnot}}
        {{/ifnot}}

        <!-- Filter section, if there is at least one persona  -->
        {{#if hasPersona}}

        <!-- Filter section, if filter is not enabled -->
        {{#ifnot isPersonaListFiltered}}

        {{#ifnot shouldShowFilterButton}}
        <!--<p>You have {{personas().length}} persona{{#if personas().length > 1}}s{{/if}}.</p>-->
        {{/ifnot}}



        {{#if shouldShowFilterButton}}
        <div class="card-filter-button-section">
            <button class="btn-action-primary" data-bind="click: filterPersonaListBySelectedActivity">Filter</button>
            <span>by</span>
            <span class="persona-filtered-by-card-name" id="selected-card-name" data-bind="text: filteringActivityName"></span>
            <span>card.</span>
        </div>
        {{/if}}
        {{/ifnot}}

        <!-- Filter section, if filter is enabled -->
        {{#if isPersonaListFiltered() && hasFilteringActivity()}}
        <p class="active-filter-conatiner">
            <span>Filtered by&nbsp;</span><span class="persona-filtered-by-card-name">{{filteringActivityName}}</span> <span>card</span>
            &nbsp;<a data-bind="click: unfilterPersonaList">unfilter</a>
        </p>
        {{/if}}


        {{/if}}

        <!-- Persona list actions -->

        <div class="persona-list-actions">

            <!-- Add persona -->
            {{#if !$root.currentUserIsViewer() && hasPersona() && !isPersonaListFiltered() && !isNewPersonaVisible()}}
            <a class="action" href="#" tabindex="4" data-bind="click: addNewPersona">
                add new persona
            </a>
            {{/if}}

            <!-- Expand/collapse -->
            {{#if hasVisiblePersona}}

            {{#if !$root.currentUserIsViewer() && hasPersona() && !isPersonaListFiltered() && !isNewPersonaVisible()}}
            <span class="link-btn-separator">|</span>&nbsp;
            {{/ifnot}}

            <a class="action" href="#" tabindex="2" data-bind="click: expandPersonas" data-tip="View details for all persona" class="first">expand all</a>
            &nbsp;<span class="link-btn-separator">|</span>&nbsp;
            <a class="action" href="#" tabindex="3" data-bind="click: collapsePersonas" data-tip="Hide persona details">collapse all</a>
            {{/if}}

            <div class="cf"></div>
        </div>

        {{/ifnot}}
    </div>

    <!-- New persona form -->
    {{#if isNewPersonaVisible}}
    <div class="new-persona-container" data-bind="heightResizer: { selector: '#persona-panel', relative: -155 }">
        <div class="control-group overflow-allowed">
            <div class="control">
                <label>
                    Name of the new persona
                    <input tabindex="9900" type="text" id="new-persona-name" data-bind="value: newPersonaName, hasFocus: newPersonaNameHasFocus, stopTab: { withShift: true }">
                </label>
                <span class="validation-message" data-bind="validationMessage: newPersonaName"></span>
            </div>
            <div class="control overflow-allowed">
                <label>
                    Image of the new persona
                </label>
                <div class="persona-avatars-dropdown" data-bind="clickStop: true">
                    <a tabindex="1" data-bind="click: showEditPictureMenuForNewPersona">
                        <img class="selected-image" data-bind="attr: { src: newPersonaPicture().path }, css: { 'built-in-avatar' : newPersonaPicture().isBuiltInAvatar }" />
                    </a>
                    {{#if $data.isNewPersonaPictureEditing}}
                    <div class="picture-menu" data-bind="template: {name: 'storymap.slidingpanels.persona.avatarchooser', data: avatarChooser}"></div>
                    {{/if}}
                </div>
            </div>
            <div class="control">
                <label>
                    Persona group
                    <input tabindex="9901" type="text" data-bind="value: newPersonaGroup, hasFocus: newPersonaGroupHasFocus, keys: [{ keyCode: 9, action: function() { isNewPersonaDetailsEditing(true)} }]">
                    <span class="help-block">Optional. E.g. role, job title, archetype, etc.</span>
                </label>
                <span class="validation-message" data-bind="validationMessage: newPersonaGroup"></span>
            </div>
            <div class="control">
                <label>
                    Details
                </label>

                <div class="data description-container" data-bind="oldInlineExtraMarkdown: {
                        value: newPersonaDescription,
                        emptyText: '',
                        selectTextOnFocus: false,
                        onEndEdit: function(contentUnchanged) {if (!contentUnchanged) {};},
                        inputClass: 'inline-textarea persona-details',
                        emptyClass: 'data-placeholder description-container',
                        width: '100%',
                        endEditOnEnterKey: false,
                        autoresize:true,
                        editmode: isNewPersonaDetailsEditing,
                        onTabKeyDownEvent: function(shift) { if (!shift) { $data.addPersonaButtonHasFocus(true); } else { newPersonaGroupHasFocus(true); } }
                        }">
                </div>
                <span class="markdown-editor-formatting-help"><a title="<div class=&quot;markdown-help-tip-content&quot;> <br/># Heading1<br/><br/>## Heading2<br/><br/>*Italics* or _Italics_<br/><br/>**Bold** or __Bold__<br/><br/>> This is a block-quote <br/><br/>* Unordered list item 1<br/><br/>1. Ordered list item 1<br/><br/>[Link with custom text](http://www.storiesonboard.com)<br/><br/>![alt text](http://url-to-public-image.com/public-image.jpg &quot;title&quot;) <br/><br /><a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble =true;&quot; class=&quot;inline-text-empty-link&quot;  target=&quot;_blank&quot; onmousedown=&quot;return false;&quot;>More formatting options</a><br /><br/></div>" target="_blank" onmousedown=" return false; " onclick=" return false; " data-bind="qtip: { withEncode: false, position: 'left', classes: 'qtip-tipsy qtip-sob qtip-sob-markdownhelp', useWindowViewport : true }" href="https://storiesonboard.uservoice.com/knowledgebase/articles/488687-story-details-formating-options">formatting help</a></span>
            </div>
            <div class="buttons">
                <a tabindex="9920" class="btn btn-action-primary button" data-bind="clickOrKey: storeNewPersona, hasFocus: addPersonaButtonHasFocus, keys: [{ keyCode: 9, action: function() { cancelButtonHasFocus(true)} },{ keyCode: 9, keyModifier: 'shiftKey', action: function() { isNewPersonaDetailsEditing(true)} }]"><span>Add persona</span></a>
                &nbsp;
                <a tabindex="9930" class="btn btn-action-primary2 button" data-bind="clickOrKey: cancelAddingNewPersona, hasFocus:cancelButtonHasFocus, keys: [{ keyCode: 9, keyModifier: 'shiftKey', action: function() { addPersonaButtonHasFocus(true)} }], stopTab: true"><span>Cancel</span></a>
            </div>
        </div>
    </div>
    {{/if}}

    <!-- No persona assigned message - if activity filter is enabled -->
    {{#if hasPersona() && isPersonaListFiltered() && hasFilteringActivity() && !filteringActivity().hasPersonas() && !isNewPersonaVisible()}}
    <div class="no-persona-assigned-wrapper">
        There aren't any personas assigned to '<span data-bind="text: filteringActivityName"></span>' card.
        {{#ifnot $root.currentUserIsViewer}}
        Click on the icon above the card to assign personas.
        {{/ifnot}}
    </div>
    {{/if}}

    <!-- Persona list -->
    {{#ifnot isNewPersonaVisible}}
    <div class="persona-data-wrapper" data-bind="heightResizer: { selector: '#persona-panel', relative: -204 }">
        {{#if hasPersona}}
        <div class="persona-list-container">

            {{#if visibleLocalPersonas().length > 0}}
            <ul style="margin-bottom: 0;">
                {{#foreach visibleLocalPersonas}}

                {{#template 'storymap.slidingpanels.persona:personaItem'/}}

                {{/foreach}}
            </ul>
            {{/if}}

            {{#if visibleGlobalPersonas().length > 0}}
            <div class="mt-10 mb-10" style="font-weight: bold; color: #667eaa;">Product personas</div>

            <ul>
                {{#foreach visibleGlobalPersonas}}

                {{#template 'storymap.slidingpanels.persona:personaItem'/}}

                {{/foreach}}
            </ul>
            {{/if}}

            {{#if hasPersona() && !hasGlobalPersona() && !$root.currentUserIsViewer()}}
            <hr class="mt-20 mb-20" />

            <div class="font-weight-bold mb-25">Did you know?</div>

            {{#template 'storymap.slidingpanels.persona:globalPersonaOnboarding'/}}
            {{/if}}
        </div>
        {{/if}}
    </div>
    {{/ifnot}}
</div>



</script>
<script type="text/html" id="storymap.slidingpanels.search-and-filter"> <track-page params="page: track.StroymapSearchAndFilter"></track-page>

<div class="cf search-title">
    <div class="storymap-panel-close-button">
        <a href="/"  data-bind="click: function() { $root.closeSearchAndFilter.bind($root)(); }">
            <i class="icon-panel-close"></i>
        </a>
    </div>
    <div class="storymap-panel-title"><span>Search & filter</span></div>
</div>

<div class="search-and-filter-panel-content" data-bind="click: deselectActiveCardOnBoard, heightResizer: { selector: '#search-and-filter-panel', relative: -150 }">
    <div class="filters-container">
        <div class="control-groups basic-filters-container">
            <div class="control-group">
                <div class="control">
                    <label>
                        <input type="text" data-bind="value:searchText, valueUpdate:'afterkeydown', hasFocus: searchTextHasFocus, enterKey: highlightNextCard, stopTab: { withShift : true }, attr: {'placeholder': searchFieldPlaceholder}, keys: [{ keyCode: 114, action: goToBoard }, { keyCode: 70, keyModifier: 'ctrlKey', action: close }, { keyCode: 81, keyModifier: 'ctrlKey', action: resetFilters }]" tabindex="30001" />
                    </label>
                </div>
            </div>
            <div class="control-group">
                <div class="control">
                    <a class="iconized-link-button filter-link-btn" data-bind="click: toggleAdvancedFilterVisibility, triggerClickOnEnter: true, hasFocus: showAdvancedFilterHasFocus" tabindex="30010">
                        <i class="icon-panel-search-and-filter-filter"></i>                        
                        <span class="filter-link-text" data-bind="text: advancedFilterVisibilityText() + ' filters'"></span>
                        <!--<span class="filter-link-text"> filters</span>-->
                    </a>
                <!--</div>
                <div class="control">-->
                    <label class="search-in-desc">
                        <input type="checkbox" data-bind="checked: searchInDescription, hasFocus: searchInDescriptionHasFocus, enterKey: highlightNextCard, checkbox:true, keys: [{ keyCode: 114, action: goToBoard }, { keyCode: 70, keyModifier: 'ctrlKey', action: close }]" tabindex="30020" />
                        <span>Search in description</span>
                    </label>
                </div>
            </div>
        </div>
        <div class="advanced-filters-container" data-bind="slideVisible: {observable: isAdvancedFiltersOrInfoVisible, onCompleteEventName: 'readyForSearchResultsResize'}">
            <div class="control-groups advanced-filters-settings-container"
                 data-bind="template: 'storymap.slidingpanels.search-and-filter.advanced-filters', slideVisible: {observable: isAdvancedFiltersSettingsVisible, onCompleteEventName: 'readyForSearchResultsResize'}">
            </div>
            <div class="advanced-filters-info-container"
                    data-bind="template: 'storymap.slidingpanels.search-and-filter.advanced-filters-info', slideVisible: {observable: isAdvancedFiltersInfoVisible, onCompleteEventName: 'readyForSearchResultsResize'}">
            </div>
        </div>
    </div>
    <div class="search-results">        
        {{#if hasSearchFilter() || hasSearchResult()}}
            <div class="cards-found">
                {{#if isNewSearchSession}}
                    <span class="cards-found-card-number">{{searchResults().length}} cards found.</span>
                {{/if}} 
                {{#if isNewSearchSession() && searchTextHasFocus()}}
                Press <span class="keyboard-shortcut">ENTER</span> to apply filter.
                {{/if}}
                {{#ifnot isNewSearchSession}}
                    {{#if hasSearchResult}}
                        <span class="cards-found-card-number">{{searchResults().length}}/{{selectedSearchResultIndex() + 1}} card selected.</span>
                        {{#ifnot isSearchPanelFocused}}
                        &nbsp; hint: <span class="keyboard-shortcut">F3</span> - next card &nbsp;<span class="keyboard-shortcut">Shift+F3</span> - previous card
                        {{/ifnot}}
                    {{/if}}
                    {{#if hasSearchFilter}}
                        {{#ifnot hasSearchResult}}
                            <span class="cards-found-card-number">No cards found.</span>
                        {{/ifnot}}
                    {{/if}}
                    {{#if hasSearchResult() && searchTextHasFocus()}}
                    &nbsp; hint: <span class="keyboard-shortcut">ENTER</span> - next card &nbsp;<span class="keyboard-shortcut">F3</span> - select card
                    {{/if}}
                    {{#if hasSearchResult()  && !searchTextHasFocus() && isSearchPanelFocused()}}
                     &nbsp; hint: <span class="keyboard-shortcut">F3</span> - select card
                    {{/if}}
                {{/ifnot}}
            </div>
        {{/if}}

        <div class="search-panel-buttons">
            <a tabindex="31000" class="button btn-action-primary" data-bind="clickAndStop: highlightNextCard, hasFocus:findNextButtonHasFocus, triggerClickOnEnter: true">
                {{#if isNewSearchSession()}}
                 Find First
                {{/if}}
                {{#ifnot isNewSearchSession()}}
                Next
                {{/ifnot}}
            </a>
            {{#ifnot isNewSearchSession()}}
            {{#if hasSearchResult}}
            <a tabindex="31010" class="button btn-action-primary" data-bind="clickAndStop: highlightPreviousCard, hasFocus:findPreviousButtonHasFocus, triggerClickOnEnter: true">Previous</a>
            <a tabindex="31011" class="button btn-action-primary" data-bind="visible: shouldShowSelectCardsButton,clickAndStop: selectCards, hasFocus:selectCardsButtonHasFocus, triggerClickOnEnter: true">Select cards</a>
            {{/if}}
            {{/ifnot}}
            <a tabindex="31020" class="button btn-action-primary2" data-bind="clickAndStop: resetFilters, hasFocus:resetButtonHasFocus, triggerClickOnEnter: true, stopTab: { if: isResetButtonTabStopped }">Reset</a>
        </div>
        <div class="search-panel-links">
            {{#ifnot isNewSearchSession}} 
            {{#if hasSearchResult}}
                <a tabindex="31030" data-bind="click: collapseUnrelatedCards, triggerClickOnEnter: true, hasFocus:collapseUnrelatedLinkHasFocus, stopTab: true">collapse unrelated cards & releases</a>   
            {{/if}} 
            {{/ifnot}}          
         </div>
    </div>
</div></script>
<script type="text/html" id="storymap.slidingpanels.board-activities.restore-or-delete-confirm"> <div class="header">Restore card</div>
<div class="content">
    <p>
        Do you want to restore the deleted <strong>{{originalDeleteActivity.cardName}}</strong> card
        {{#if originalDeleteActivity.cardNumberOfChildren > 0}}
            and its {{originalDeleteActivity.cardNumberOfChildren == 1 ? "child" : originalDeleteActivity.cardNumberOfChildren + " children"}}
        {{/if}}?
    </p>
    <p>You can also delete it permanently, but be careful you will not be able to restore it again.</p>
</div>
<div class="footer">
    <button class="btn-action-primary" data-bind="debouncedClick: restoreCardFromTrash, focus: true">Restore</button>
    <button class="btn-action inline-confirm" data-bind="inlineConfirm: ['Delete permanently', 'Are you sure?', 'Deleting card'], submitFunction: deleteTrashedCardPermanently, showTimer: 'true'"></button>
    <button class="btn-action" data-bind="click: app.modal.closeCurrentOpened">Cancel</button>
</div></script>
<script type="text/html" id="storymap.slidingpanels.persona.avatarchooser"> <div class="picture-menu-content" data-bind="clickStop: true">
    <div class="picture-menu-inner-menu">
        <a data-bind="clickAndStop: showAvatarsInPictureEdit, css: {active: isAvatarsVisibleInPictureEdit}">drawn avatars</a>
        &nbsp;
        <a data-bind="clickAndStop: showUserImagesInPictureEdit, css: {active: isUserImagesVisibleInPictureEdit}">uploaded images</a>&nbsp;
    </div>
    {{#if isAvatarsVisibleInPictureEdit}}
    <ul>
        <li>
            <div data-bind="foreach: builtInAvatarOptions">
                {{#if ($index() > 0) && (($index() % 6) == 0)}}
                <div class="cf"></div>
                {{/if}}
                <span class="avatar-item">
                    <img class="built-in-avatar" data-bind="attr: { src: $data.path }, click: $parent.selectAvatar.bind($root.personaPanel.avatarChooser) " />
                </span>
            </div>
        </li>
    </ul>
    {{/if}}
    {{#if isUserImagesVisibleInPictureEdit}}
    <ul>
        <li>
            {{#if isImageCropInProgress}}
            <div class="image-crop-container" data-bind="imageCrop: {data: originalimageDataToCrop, doneCallback: saveCroppedImage.bind($data), cancelCallback: cancelImageCrop.bind($data)}"></div>
            {{/if}}

            <div class="user-images-container" data-bind="visible: !isImageCropInProgress()">
                {{#if userImageOptions().length == 0}}
                   <div class="image-upload-onboard">
                       <span class="image-upload-onboard-msg">
                           Images let you build empathy with your user personas.

                           Drop an image file into this area or <a data-bind="imagePicker: {dropZone: '.image-upload-onboard:visible', callback: startImageCrop.bind($data), errorCallback: app.flash.showError}">click</a> here to upload one.
                           <br/>
                           <br/>
                           <strong>ProTip</strong> You can also search for persona avatars on the site <a href="https://uifaces.co" target="_blank" >uifaces.co</a>  
                       </span>
                   </div>
                {{/if}}
                {{#if userImageOptions().length > 0}}
                    {{#foreach: userImageOptions}}
                        {{#if ($index() > 0) && (($index() % 6) == 0)}}
                            <div class="cf"></div>
                        {{/if}}
                        <span class="avatar-item">
                            <img data-bind="attr: { src: $data.path }, click: $parent.selectAvatar.bind($root.personaPanel.avatarChooser) " />
                            <a class="delete-button" data-bind="click: $parent.deleteUserImage.bind($parent)">x</a>
                        </span>
                    {{/foreach}}
                    {{#if (userImageOptions().length > 0) && ((userImageOptions().length % 6) == 0)}}
                        <div class="cf"></div>
                    {{/if}}
                    {{#if canUploadUserImages}}
                    <span class="avatar-item">
                    <div class="upload-user-image" data-bind="imagePicker: {dropZone: '.picture-menu-content:visible', callback: startImageCrop.bind($data), errorCallback: app.flash.showError}">
                        <i class="icon-add-persona-image"></i>
                    </div>
                    </span>
                    {{/if}}
                {{/if}}
            </div>
        </li>
    </ul>
    {{/if}}
</div></script>
<script type="text/html" id="storymap.slidingpanels.search-and-filter.advanced-filters-info"> <div class="advanced-filters-info">
    <h3>Filters</h3>
    <ul class="filters-info-list">
        {{#foreach activeFilters().multipleFilters}}
        <li class="filter-info">
            {{$data.name}}
            {{#foreach $data.filterValues}}
            {{#if $index() > 0}} <span class="filter-data-and">or</span> {{/if}}<span class="filter-data">{{$data}}</span>
            {{/foreach}}
            {{/if}}
        </li>
        {{/foreach}}
        {{#if activeFilters().singleFilters.length > 0}}
        <li class="filter-info">
            Card
            {{#if activeFilters().singleFilters.length == 1}}
            <span class="filter-name"><span class="filter-data">{{activeFilters().singleFilters[0].name}}</span> {{#if activeFilters().singleFilters[0].extraMessage}}{{activeFilters().singleFilters[0].extraMessage}}{{/if}}</span>
            {{/if}}
            {{#if activeFilters().singleFilters.length > 1}}
            <ul class="boolean-filter-list-item">
                {{#foreach activeFilters().singleFilters}}
                <li>- <span class="filter-name"><span class="filter-data">{{$data.name}}</span> {{#if $data.extraMessage}}{{$data.extraMessage}}{{/if}}</span></li>
                {{/foreach}}
            </ul>
            {{/if}}
        </li>
        {{/if}}
    </ul>
    <div class="cf"></div>
</div></script>
<script type="text/html" id="storymap.slidingpanels.search-and-filter.advanced-filters"> <div class="control-group update-filters one-column">
    <select tabindex="30110" class="time-select-component" data-bind="optionsCaption: 'Created or updated',
                                options: filterLastUpdatedOptions,
                                optionsText: 'text',
                                optionsValue: 'id',
                                value: filterLastUpdatedAt,
                                select: true,
                                hasFocus: filterLastUpdatedAtHasFocus,
                                key: { keyCode: 114, action: goToBoard }"></select>

</div>
<div class="control-group multi-filters one-column">
    <div class="control">
        <select multiple="multiple" tabindex="30120" data-bind="options: releases,
                        selectedOptions: filterReleases,
                        optionsText: 'name',
                        multiselect: {
                            nonSelectedText: 'Filter by releases',
                            includeSelectAllOption: true,
                            disableIfEmpty: true,
                            hasFocus: filterReleasesHasFocus
                        }"></select>
    </div>
    <div class="control">
        <select multiple="multiple" tabindex="30130" data-bind="options: colorLabels,
                       selectedOptions: filterColorLabels,
                       optionsText: 'colorLabel',
                       multiselect: {
                            nonSelectedText: 'Filter by colors',
                            includeSelectAllOption: true,
                            hasFocus: filterColorLabelsHasFocus
                       }"></select>
    </div>     
    <div class="control">
        <select multiple="multiple" tabindex="30135" data-bind="options: annotations,
                       selectedOptions: filterAnnotations,
                       optionsText: 'name',
                       multiselect: {
                            nonSelectedText: 'Filter by annotations',
                            includeSelectAllOption: true,
                            hasFocus: filterAnnotationsHasFocus
                       }"></select>
    </div>
    <div class="control">
        <select multiple="multiple" tabindex="30136" data-bind="options: personas,
                       selectedOptions: filterPersonas,
                       optionsText: 'name',
                       multiselect: {
                            nonSelectedText: 'Filter by personas',
                            includeSelectAllOption: true,
                            disableIfEmpty: true,
                            hasFocus: filterPersonasHasFocus
                       }"></select>
    </div>
    <div class="control">
        <select multiple="multiple" tabindex="30140" data-bind="options: subtaskStatuses,
                        selectedOptions: filterSubtaskStatuses,
                        optionsText: 'name',
                        multiselect: {
                            nonSelectedText: 'Filter by states',
                            includeSelectAllOption: true,
                            hasFocus: filterSubtaskStatesHasFocus
                        }"></select>
    </div>
</div>
<div class="control-group single-filters two-column">
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30150" data-bind="checkbox: {checked: filterTopLevelCards}, hasFocus: filterTopLevelCardsHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Is among top level cards</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30160" data-bind="checkbox: {checked: filterStoryCards}, hasFocus: filterStoryCardsHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Is among story cards</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30170" data-bind="checkbox: {checked: filterCreatedByOthers}, hasFocus: filterCreatedByOthersHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Created by others</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30180" data-bind="checkbox: {checked: filterCreatedByMe}, hasFocus: filterCreatedByMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Created by me</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30190" data-bind="checkbox: {checked: filterUpdatedByOthers}, hasFocus: filterUpdatedByOthersHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Last updated by others</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30200" data-bind="checkbox: {checked: filterUpdatedByMe}, hasFocus: filterUpdatedByMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Last updated by me</span>
            </label>
        </div>
    </div>

    <div class="control">
        <label>
            <input type="checkbox" tabindex="30210" data-bind="checkbox: {checked: filterCommentedByOthers}, hasFocus: filterCommentedByOthersHasFocus, key: { keyCode: 114, action: goToBoard }" />
            <span>Commented by others</span>
        </label>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30220" data-bind="checkbox: {checked: filterCommentedByMe}, hasFocus: filterCommentedByMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Commented by me</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30230" data-bind="checkbox: {checked: filterHasDetails}, hasFocus: filterHasDetailsHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has details</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30240" data-bind="checkbox: {checked: filterHasNoDetails}, hasFocus: filterHasNoDetailsHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has no details</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30250" data-bind="checkbox: {checked: filterHasEstimation}, hasFocus: filterHasEstimationHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has estimation</span>
            </label>
        </div>
        <div class="control" data-bind="visible: !filterHasEstimation()">
            <label>
                <input type="checkbox" tabindex="30260" data-bind="checkbox: {checked: filterHasNoEstimation}, hasFocus: filterHasNoEstimationHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has no estimation</span>
            </label>
        </div>
        <div class="control estimation-range" data-bind="visible: filterHasEstimation">
            <label>
                <input type="text" tabindex="30270" data-bind="value: filterEstimationFrom,numericInput: true, hasFocus: filterEstimationFromHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>-</span>
                <input type="text" tabindex="30280" data-bind="value: filterEstimationTo,numericInput: true, hasFocus: filterEstimationToHasFocus, key: { keyCode: 114, action: goToBoard }" />
            </label>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30290" data-bind="checkbox: {checked: filterHasAttachment}, hasFocus: filterHasAttachmentHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has attachment</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30300" data-bind="checkbox: {checked: filterHasNoAttachment}, hasFocus: filterHasNoAttachmentHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Has no attachment</span>
            </label>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30310" data-bind="checkbox: {checked: filterPushedToIssueTracker}, hasFocus: filterPushedToIssueTrackerHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Linked to issue tracker</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30320" data-bind="checkbox: {checked: filterNotPushedToIssueTracker}, hasFocus: filterNotPushedToIssueTrackerHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Not linked to issue tracker</span>
            </label>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30330" data-bind="checkbox: {checked: filterCardsWatchedByMe }, hasFocus: filterCardsWatchedByMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Is watched by me</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30340" data-bind="checkbox: {checked: filterCardsNotWatchedByMe }, hasFocus: filterCardsNotWatchedByMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Not watched by me</span>
            </label>
        </div>
    </div>
    <div class="control-group">
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30350" data-bind="checkbox: {checked: filterAssignedToMe }, hasFocus: filterAssignedToMeHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Assigned to me</span>
            </label>
        </div>
        <div class="control">
            <label>
                <input type="checkbox" tabindex="30360" data-bind="checkbox: {checked: filterUnassigned }, hasFocus: filterUnassignedHasFocus, key: { keyCode: 114, action: goToBoard }" />
                <span>Unassigned</span>
            </label>
        </div>
    </div>
</div>
<div class="cf"></div>
</script>
<script type="text/html" id="storymap.slidingpanels.search-and-filter.___search-results"> <div class="search-results-info">
    <h2>Search results</h2>
    <div class="cards-found">
        {{searchResults().length}} card{{#if searchResults().length > 1 || searchResults().length < 1}}s{{/if}} found
    </div>
    <div class="apply-filter-on-board">
        {{#if searchResults().length > 0}}
            <a data-bind="click: applyFilterOnBoard, triggerClickOnEnter: true" tabindex="100022">apply filter on board</a>
        {{/if}}
        {{#if $root.isSearchAndFilterActive()}}
        | <a data-bind="click: unfilterBoard, triggerClickOnEnter: true" tabindex="100023">unfilter board</a>
        {{/if}}
    </div>
    <div class="cf"></div>
    <hr>
    {{#if searchResults().length < 1}}
        <span class="no-cards-found-message">
            There are no cards found with the given expression.
        </span>
    {{/if}}
</div>
<div class="search-results-wrapper">
    <ul class="search-results">
        {{#foreach searchResults}}
        <li class="matching-card-container" data-bind="attr: {'tabindex' : 100024 + $index()}, enterKey: function() { $parent.goToCard($index(), $data.id) }">
            <div class="matching-card">
                <div class="card-name">{{name}}</div>
                <div class="go-to-card">
                    <a data-bind="click: function() {$parent.goToCard($index(), $data.id)}, triggerClickOnEnter: true">go to card</a>
                </div>
                <div class="view-details">
                    <a data-bind="click: function() {$root.openCardDetailsModalFor($data.id, false)}, triggerClickOnEnter: true">view details</a>
                </div>
                <div class="cf"></div>
            </div>
            <hr>
        </li>
        {{/foreach}}
    </ul>
</div></script>
<script type="text/html" id="workspacesettings.accesshistory:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Workspace access history',
        description: 'Review all successful and blocked workspace access attempts.',
        url: '/workspacesettings?p=security'
        } }"></div>
</script>
<script type="text/html" id="workspacesettings.accesshistory:main-section">
    
    <div id="main" class="access-history cf">
        <div class="control-group access-history-filter">
            <div class="control w-1-4">
                <label>
                    <input type="text" data-bind="value: filter" />
                    <span class="help-block">User name or email address</span>
                </label>
            </div>
            <div class="control w-1-4 filter-buttons">
                <button class="btn-action-primary" data-bind="click: applyFilter">Filter</button>
                <a data-bind="click: removeFilter">Unfilter</a>
            </div>
        </div>        
        
        <div id="history-contents">
            <table id="history-grid" class="list-view">
                <tbody data-bind="foreach: items">
                    <tr data-bind="css: { isBlocked: isBlocked }">
                        <td class="accessed-at nowrap">{{moment(accessedAt).format("YYYY.MM.DD HH:mm:ss")}}</td>
                        <td class="user-name">{{userName}}</td>
                        <td class="user-email">{{userEmail}}</td>
                        <td class="ip-address">{{userIp}}</td>
                        <td class="block-reason">{{blockReason}}</td>
                    </tr>
                </tbody>
            </table>

            <div id="history-loading" class="bounce-spinner" data-bind="scroll: {
             scrollingElement: '#history-contents',
             enabled: hasMoreItems,
             loadFunc: loadNextPage,
             offset: 10}">
                <div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="workspacesettings.accesshistory"> <!-- Sub header -->


<!-- Main -->
</script>
<script type="text/html" id="workspacesettings.auditlog:sub-header-section">
    <div data-bind="template: { name: 'templates:sub-header', data: {
        title: 'Workspace audit log',
        description: 'Review all user activites in this workspace.',
        url: '/workspacesettings?p=security'
        } }"></div>
</script>
<script type="text/html" id="workspacesettings.auditlog:main-section">
    
    <div id="main" class="audit-log cf">

        <div id="log-contents">

            <div id="audit-log-filter" class="control-group">
                <div class="control" id="user-filter-container">
                    <label>
                        Operation performed by
                        <select multiple="multiple" data-bind="options: members, optionsText: 'name', selectedOptions: userFilter, multiselect: { includeSelectAllOption: false, numberDisplayed: 10 }"></select>
                    </label>
                </div>
                <div class="control w-1-4">
                    <label>
                        Date range
                        <input type="text" data-bind="daterangepicker: dateRangeFilter"/>
                    </label>
                </div>
                <div class="control w-1-6">
                    <label>
                        Order
                        <select data-bind="options: sortDirections, optionsText: 'name', value: sortDirection, select: true"></select>
                    </label>
                </div>
                <div class="control w-1-1">
                    <label>
                        Event(s)
                        <select multiple="multiple" data-bind="foreach: activityGroups, selectedOptions: activityTypeFilter, multiselect: { includeSelectAllOption: false, enableClickableOptGroups: true, numberDisplayed: 10 }">
                            <optgroup data-bind="attr: {label: Name}, foreach: Activities">
                                <option data-bind="attr: {value: Id}, text: Name"></option>
                            </optgroup>
                        </select>
                    </label>
                </div>

                <div class="control w-1-4 filter-buttons">
                    <button class="btn-action-primary" data-bind="click: applyFilter">Filter</button>
                    <a data-bind="click: removeFilter">Unfilter</a>
                </div>
            </div>
            <div id="log-contents-inner">
            <table id="log-grid" class="list-view">
                <tbody data-bind="foreach: entries">
                    <tr>
                        <td class="nowrap">{{moment(ActivityAt).format("YYYY.MM.DD HH:mm:ss")}}</td>
                        <td>{{UserEmail}}</td>
                        <td>{{ActivityType}}</td>
                        <td>
                            {{Contents}}.
                            {{#if HasStorymapLink}}
                                Click <a data-bind="click: function() {$root.showBoardActivitiesFor($data);}">here</a> to view board activities
                            {{/if}}
                        </td>
                        <td>{{UserIp}}</td>
                    </tr>
                </tbody>
            </table>
            </div>
            <div id="log-loading" class="bounce-spinner" data-bind="scroll: {
             scrollingElement: '#log-contents',
             enabled: hasMoreItems,
             loadFunc: loadNextPage,
             offset: 10}">
                <div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="workspacesettings.auditlog"> <!-- Sub header -->


<!-- Main -->
</script>
<script type="text/html" id="workspacesettings.boardactivitiesmodal"> <div class="header">
    Board activities
    <div class="title-description">of {{userName}} on {{storymapName}} from {{moment(startDate).format("YYYY.MM.DD HH:mm:ss")}}</div>
    <a class="btn-icon" data-bind="click: close">
        <i class="icon-close-dialog"></i>
    </a>
</div>
<div class="content">
    <div id="board-activity-contents">
        {{#if hasNoActivity}}
            <div class="empty-result">No board activities found for user {{userName}}</div>
        {{/if}}
        {{#ifnot hasNoActivity}}
            <table id="board-activity-grid" class="list-view">
                <tbody data-bind="foreach: entries">
                    <tr>
                        <td class="nowrap">{{moment(datetime).format("YYYY.MM.DD HH:mm:ss")}}</td>
                        <td>{{getDescription()}}</td>
                    </tr>
                    <tr class="spacer1"><td colspan="4"><div class="tr-line"></div></td></tr>
                </tbody>
            </table>

            <div id="board-activity-loading" class="bounce-spinner" data-bind="scroll: {
                     scrollingElement: '#board-activity-contents',
                     enabled: hasMoreItems,
                     loadFunc: loadNextPage,
                     offset: 10}">
                <div class="bounce1"></div>
                <div class="bounce2"></div>
                <div class="bounce3"></div>
            </div>
        {{/ifnot}}
    </div>
</div></script>
<script type="text/html" id="workspacesettings.domain-access-settings"> <h3 class="page-section-heading">Email domain based access control</h3>
<p>Use these settings to restrict workspace access to specified domains or email addresses. Invitations may only be sent to these addresses as well.</p>
<p>Hint: Subscription admins will always be able to access the workspace.</p>
<p class="toggle-access-control" data-bind="visible: isAccessControlToggleVisible">
    {{#if IsEnabled}}
        Email domain based access control is enabled. Click <a data-bind="click: disable">here</a> to disable email domain based access control
    {{/if}}
    {{#ifnot IsEnabled}}
        <span class="warning-text">Email domain based access control is disabled.</span> Click <a data-bind="click: enable">here</a> to enable email domain based access control
    {{/ifnot}}
</p>    

<div id="add-domain-form">
    <a class="iconized-link-button btn-add-domain-or-email" data-bind="click: toggleAddDomainOrEmail">
        <i class="icon-add-domain-or-email"></i>
        <span>Add domain or email address</span>
    </a>

    <div data-bind="visible: isAddDomainOrEmailFormVisible">
        <div class="control-group">
            <div class="control w-1-2">
                <label>
                    Add domain (including the @) or email address
                    <input type="text" data-bind="value: domainOrEmailAddressToAdd, hasFocus: domainOrEmailAddressToAddFocused">
                    <span class="help-block">e.g.: @{{userDomain}} or some.other.user@{{userDomain}}</span>
                </label>
                <span class="validation-message" data-bind="validationMessage: domainOrEmailAddressToAdd" style="display: none;"></span>
            </div>
        </div>

        <div class="buttons">
            <a class="btn-action-primary button" data-bind="debouncedAjaxBtnClick: addDomainOrEmail"><span>Add</span></a>
            &nbsp;
            <a class="btn-action-primary2 button" data-bind="debouncedClick: toggleAddDomainOrEmail"><span>Close</span></a>
        </div>
    </div>
</div>
    
<div class="tile-group-row">
    <div class="tile-group three-column">
        <!--Header -->
        <div class="tile-group-header">
            <div class="tile-group-header-right">
                <div data-bind="visible: RestrictedDomains.pageCount() == 1">
                    <br />
                </div>
                <div data-bind="visible: RestrictedDomains.pageCount() > 1">
                    <div class="tile-pager">
                        <div class="tile-paging-info">
                            <span data-bind="text: RestrictedDomains.pagingInfo()"></span>
                        </div>
                        <a class="btn-icon opacitied">
                            <i class="pager-left" data-bind="click: RestrictedDomains.movePrevious"></i>
                        </a>
                        <a class="btn-icon opacitied">
                            <i class="pager-right" data-bind="click: RestrictedDomains.moveNext"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Content -->
        <div class="tile-group-content" data-bind="foreach: RestrictedDomains.currentPageData">
            <div class="tile-cell">
                <div class="tile-domain">
                    <span class="caption" data-bind="text: name, attr: { title: name }"></span>
                    <div class="center_content">
                        {{#if IsSsoOnlyAccess}}
                        <div>SSO only access</div>
                        {{/if}}
                        {{#ifnot IsSsoOnlyAccess}}
                        <div>SSO and username/password access</div>
                        {{/ifnot}}
                        {{#if SsoInfo() != null}}
                        <div>This domain is controlled by {{SsoInfo().OwnerName}} and configured for {{SsoInfo().IsSsoOptional ? "optional" : "mandatory"}} SSO</div>
                        {{/if}}
                        {{#if showSsoWarningText}}
                        <div class="warning">WARNING: This domain has no SSO enabled. With the current settings nobody (except subscription admins) can access the workspace </div>
                        {{/if}}
                        {{#if showPasswordWarningText}}
                        <div class="warning">WARNING: Username/password access is disabled by domain control settings.</div>
                        {{/if}}
                    </div>
                    <div class="bottom_right">
                        <div class="dropdown-menu" data-bind="dropdownmenu: true">
                            <a href="#" data-bind="stopPropagation: true" class="trigger" tabindex="1">
                                <i class="icon-tile-options"></i>
                                <!--<span class="small-font">options</span>
                                <span class="caret"></span>-->
                            </a>
                            <div class="menu-content right-aligned">
                                <ul>
                                    <li><a data-bind="clickAndStop: toggleSsoOnlyAccess, text: ssoOnlyAccessToggleCaption"></a></li>
                                    <li><a data-bind="clickAndStop: function () { $parent.removeDomainOrEmail($data) }">Remove</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="separator"></div>

{{#if LockedOutMembers().length > 0}}
    <div id="locked-out-members-hint">
        Hint: With the current settings <a data-bind="qtip: { position: 'right', contentValue: lockedOutMembersTooltipText }">{{LockedOutMembers().length}} existing workspace members</a> will be locked out from this workspace.
    </div>
{{/if}}

{{#if hasDomainWithSso}}
    <div class="control" id="redirect-to-idp-block">
        <label>
            <input type="checkbox" data-bind="checkbox: {checked: RedirectToIdpWhenUnauthenticated, enabled: isWorkspaceAccessRestrictedToSingleSsoDomain}, click: toggleRedirectToIdpWhenUnauthenticated" />
            Automatically redirect unauthenticated users to the identity provider's login page when they access the workspace URL directly (e.g. with bookmarked workspace dashboard or story map)
        </label>
        {{#ifnot isWorkspaceAccessRestrictedToSingleSsoDomain}}
        <div class="note" data-bind="css: {warning: RedirectToIdpWhenUnauthenticated}">
            {{#if RedirectToIdpWhenUnauthenticated}}Warning: {{/if}}
            {{#ifnot RedirectToIdpWhenUnauthenticated}}Hint: {{/ifnot}}
            This feature is unavailable now beacause multiple authentication sources are allowed by the current settings
        </div>
        {{/ifnot}}
    </div>
{{/if}}</script>
<script type="text/html" id="workspacesettings.ip-access-settings"> <h3 class="page-section-heading">Approved IP ranges</h3>
<p>Use these settings to restrict access to certain whitelisted IP addresses or ranges. Users with non-listed IP addresses will not be able to access this workspace.</p>
<p>Hint: Subscription admins will always be able to access the workspace. This computer is using IP address <button class="btn-link" data-bind="enable: isUserIpLinkEnabled, debouncedClick: addUserIp">{{userIp}}</button></p>
<p class="toggle-access-control" data-bind="visible: isAccessControlToggleVisible">
    {{#if IsEnabled}}
    IP based access control is enabled. Click <a data-bind="click: disable">here</a> to disable IP based access control
    {{/if}}
    {{#ifnot IsEnabled}}
    <span class="warning-text">IP based access control is disabled.</span> Click <a data-bind="click: enable">here</a> to enable IP based access control
    {{/ifnot}}
</p>


<div id="add-ip-form">
    <a class="iconized-link-button btn-add-ip" data-bind="click: toggleAddIp">
        <i class="icon-add-ip"></i>
        <span>Add IP address</span>
    </a>

    <div data-bind="visible: isAddIpFormVisible">
        <div class="control-group">
            <div class="control w-1-2">
                <label>
                    Add IP range or address
                    <input type="text" data-bind="value: ipAddressToAdd, hasFocus: ipAddressToAddFocused">
                    <span class="help-block">You can add a single IPv4 or IPv6 address or a subnet using CIDR notation (e.g. {{userIp}}/24)</span>
                </label>
                <span class="validation-message" data-bind="validationMessage: ipAddressToAdd" style="display: none;"></span>
            </div>
        </div>

        <div class="buttons">
            <a class="btn-action-primary button" data-bind="debouncedAjaxBtnClick: addIpAddress">
                <span>Add</span>
            </a>
            &nbsp;
            <a class="btn-action-primary2 button" data-bind="debouncedClick: toggleAddIp">
                <span>Close</span>
            </a>
        </div>
    </div>
</div>

<div class="tile-group-row">
    <div class="tile-group three-column">
        <!--Header -->
        <div class="tile-group-header">
            <div class="tile-group-header-right">
                <div data-bind="visible: RestrictedIpAddresses.pageCount() == 1">
                    <br/>
                </div>
                <div data-bind="visible: RestrictedIpAddresses.pageCount() > 1">
                    <div class="tile-pager">
                        <div class="tile-paging-info">
                            <span data-bind="text: RestrictedIpAddresses.pagingInfo()"></span>
                        </div>
                        <a class="btn-icon opacitied">
                            <i class="pager-left" data-bind="click: RestrictedIpAddresses.movePrevious"></i>
                        </a>
                        <a class="btn-icon opacitied">
                            <i class="pager-right" data-bind="click: RestrictedIpAddresses.moveNext"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Content -->
        <div class="tile-group-content" data-bind="foreach: RestrictedIpAddresses.currentPageData">
            <div class="tile-cell">
                <div class="tile-ip">
                    <span class="caption" data-bind="text: $data, attr: { title: $data }"></span>
                    <div class="bottom_right">
                        <a data-bind="clickAndStop: function () { $parent.removeIpAddress($data) }">remove</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="separator"></div></script>
<script type="text/html" id="workspacesettings.static-content"> <h3 class="page-section-heading">Workspace access history</h3>
<p>Review all successful and blocked workspace access attempts.</p>

<div class="control-group">
    <div class="control w-1-3">
        <a class="btn-action-primary button" data-bind="go: 'workspacesettings/accesshistory'"><span>View access history</span></a>
    </div>
</div>

<h3 class="page-section-heading">Workspace audit log</h3>
<p>Review all user activites in this workspace.</p>

<div class="control-group">
    <div class="control w-1-3">
        <a class="btn-action-primary button" data-bind="go: 'workspacesettings/auditlog'"><span>View audit log</span></a>
    </div>
</div>

<hr class="pro-tip-line" />
<div class="pro-tip">
    <strong>ProTip</strong> With the help of Domain Control you can manage and supervise user accounts that belong to your corporate domain. You may require users to log in to StoriesOnBoard through your Corporate Identity Provider's interface using SAML SSO protocol, create password policy rules and monitor their activities. This configuration is workspace independent, belongs to your company and managed by dedicated domain admins.
    <br />
    <br />
    Click <a data-bind="redirect: globalConfig.workspacesUrl + '/domaincontrol'"><span>here</span></a> to setup domain control.
</div></script>

    <script type="text/html" id="aboutboard"> <sliding-panel params="
        title: 'About this board',
        elementId: 'about-board',
        isFullSize: params.isFullSize,
        isOpened: params.isOpened,
        onClose: params.onClose
">
    {{#if isReady}}
    {{#if params.isOpenedAutomatically}}
    <span class="secondary-link" data-bind="click: dismissAutoOpen, qtip:{ position: 'bottom' }" title="Click here if you dont want this panel to open automatically.  You can open it from the '...' menu later.">don't show this next time </span>
    {{/if}}

    <expandable-container params="
        containerHeight: '150',
        openStateOnInit: openStateOnInit
        ">

        <rich-markdown-editor params="
            value: aboutBoardText,
            id: 'about-board-text',
            isInEditMode: isMessageInEditMode,
            isEditEnabled: canEditAboutBoardText,
            toolbarSet: 'minimal',
            hasMentions: false,
            isBoardCard: false,
            emptyTextWithTemplate:{
                textTemplate: 'Use this panel to introduce your product vision to your collaborators. Give context, share important assets and links. If you add some text here, this panel will be automatically shown to your collaborators.  Click to start typing. $0 is supported!',
                links: [{ text: 'Markdown', href: 'http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown' }],
                isVisible: canEditAboutBoardText
            },
            onSave: aboutBoardTextChanged"></rich-markdown-editor>
    </expandable-container>

    <used-annotations params="annotationsInUse: annotationsInUse"></used-annotations>

    <card-color-legend params="colorMappings: params.colorMappings, colorsInUse: colorsInUse"></card-color-legend>
    
    <panel-section params="title: 'Workflow'">
            <ul data-bind="foreach: storeProps.statuses">
                <li class="status-menu-item d-flex align-items-center pl-15 pr-5 py-5 nowrap">
                    <div class="status-menu-item__color-box"
                         data-bind="css: { 'bordered': color().toLowerCase() == '#ffffff'}, style: { 'background-color': color, 'width': '24px', 'height': '24px' }"></div>
                    <span class="ml-15" data-bind="text: name"></span>
                </li>
            </ul>
    </panel-section>

    {{#if storeProps.userRights.isWorkspaceMember()}}
    <collaborator-initials params="collaborators: collaborators"></collaborator-initials>

    <panel-section params="title: 'Your user rights'">
        <user-rights></user-rights>
    </panel-section>
    {{/if}}

    <panel-section params="title: 'About StoriesOnBoard'">
        See what you can do in StoriesOnBoard! Check out the <a target="_blank" href="{{introductionLink}}">Quick Guide</a> to learn how to use the platform.
    </panel-section>
    {{/if}}
</sliding-panel>

</script>
<script type="text/html" id="cardcolorlegend"> <panel-section params="title: 'Card color legend'">
    {{#ifnot hasCustomColors}}
        There aren't any card colors in use. 
        {{#if userHasEditorRights}} Right-click on any of the cards to start using colors. {{/if}}
    {{/ifnot}}
    {{#if hasCustomColors}}
    <div id="color-list" data-bind="foreach: customColors">
        <div class="color-row">
            <div data-bind="css: colorClass" class="color-box"></div>
            <span data-bind="text: name" class="color-name"></span>
        </div>
    </div>
    {{/if}}
</panel-section></script>
<script type="text/html" id="collaboratorinitials"> {{#if isVisible}}
<panel-section params="title: 'Collaborators'">
    <div class="cf" id="collaborator-list" data-bind="foreach: params.collaborators">
        
        <div class="initial-user-details" data-bind="clickStop: true, attr: { 'id': 'user_details_'+$index() }">
            <div class="name">{{$data.displayName}}</div>
            <div class="email">{{$data.email}}</div>
            <div class="role" data-bind="visible: $data.isAdmin">admin</div>
        </div>
        
        <div class="initial-icon" data-bind="text: $data.userInitials, qtip: { contentId: '#user_details_'+$index(), position: 'top' }, css: { 'admin': $data.isAdmin }"></div> 

    </div>
</panel-section>
{{/if}}</script>
<script type="text/html" id="usedannotations"> <panel-section params="title: 'Card annotations'">
    {{#ifnot hasUsedAnnotations}}
        There aren't any <a data-bind="click: openAnnotationPanel">annotations</a> in use.
    {{/ifnot}}
    {{#if hasUsedAnnotations}}
        The following <a data-bind="click: openAnnotationPanel">annotations</a> are currently being assigned to cards.
    {{/if}}
    {{#if hasUsedAnnotations}}
    <div id="annotation-list" data-bind="foreach: params.annotationsInUse">
        <div class="annotation-row">
            {{#if: isEmoji }}
            <span class="annotation-emoji" data-bind="text: emoji"></span>
            {{/if}}

            {{#ifnot: isEmoji }}
            <span data-bind="class: { name: iconClass }"></span>
            {{/ifnot}}
            <span data-bind="text: name" class="annotation-name"></span>
        </div>
    </div>
    {{/if}}
</panel-section></script>
<script type="text/html" id="userrights"> <div class="user-rights">
    {{#if isViewer }}
        <div>
            As a viewer you are able to ...
        </div>
        <div class="viewer-rights">
            
            <span class="user-right-enabled"></span>
            <span class="viewer-right-text">View card, release and persona details</span>
            <br/>
            <span class="user-right-enabled"></span>
            <span class="viewer-right-text">View release status report</span>
            <br/>
            <span class="user-right-enabled"></span>
            <span class="viewer-right-text">Search or filter cards on the board</span>
            <br/>
            <span class="user-right-enabled"></span>
            <span class="viewer-right-text">Export the story map</span>

            <br/>
            <span data-bind="css: { 
                  'user-right-enabled': storeProps.userRights.canCommentOnStorymap, 
                  'user-right-disabled': !storeProps.userRights.canCommentOnStorymap 
            }"></span>
            <span class="viewer-right-text">Comment on Cards</span>
        </div>
    
        <div class="learn-more">
            Want to do more on this map? Ask an admin for appropriate rights. You can also learn more about user roles by clicking
            <a href="{{rolesLink}}" target="_blank">here</a>.
        </div>
    {{/if}}
        
    {{#ifnot isViewer }}
        <div>
            You are
            {{#if isEditor }}
                an editor
            {{/if}}
            {{#if isAdmin }}
                an admin
            {{/if}}
            on this board
        </div>
        <div class="learn-more">
            Learn more about user roles by clicking
            <a href="{{rolesLink}}" target="_blank">here</a>.
        </div>
    {{/ifnot}}
</div>
</script>
<script type="text/html" id="annotationpanel"> <sliding-panel params="
        title: 'Card annotations',
        elementId: 'annotation-panel',
        isFullSize: params.isFullSize,
        isOpened: params.isOpened,
        onClose: params.onClose">    
    
    <div class="annotation-info-section">
        Annotations are like labels. They radiate even more information on cards. <a href="{{annotationHelpLink}}" target="_blank">Learn more.</a>
    </div>

    {{#if params.isEditEnabled}}
        {{#ifnot isEditorVisible}}
        <div class="annotation-button-section">
            <a data-bind="click: addAnnotation.bind($data), if: params.isEditEnabled">add new annotation</a>
        </div>
        {{/ifnot}}
        {{#if isEditorVisible}}
        <add-annotation-editor params="onSave: saveNewAnnotation.bind($data), onCancel: hideAnnotationEditor.bind($data)"></add-annotation-editor>
        {{/if}}
    {{/if}}

    {{#ifnot isEditorVisible}}
        <ul data-bind="foreach: annotations">
            <annotation-item params="
                annotation: $data,
                isEditEnabled: $parent.params.isEditEnabled,
                onDelete: $parent.deleteAnnotation.bind($parent),
                onArchive: $parent.archiveAnnotation.bind($parent),
                onSaveName: $parent.saveAnnotationName.bind($parent),
                onSaveEmoji: $parent.saveAnnotationEmoji.bind($parent),
                onSaveIcon: $parent.saveIcon.bind($parent)">
            </annotation-item>
        </ul>

        {{#if archivedAnnotations().length > 0 }}
    
        <div class="annotation-info-section mt-20">
            Archived annotations
        </div>
        <ul data-bind="foreach: archivedAnnotations">
            <annotation-item params="
                annotation: $data,
                isEditEnabled: $parent.params.isEditEnabled,
                onDelete: $parent.deleteAnnotation.bind($parent),
                onRestore: $parent.restoreAnnotation.bind($parent),
                onSaveName: $parent.saveAnnotationName.bind($parent),
                onSaveEmoji: $parent.saveAnnotationEmoji.bind($parent),
                onSaveIcon: $parent.saveIcon.bind($parent)">
            </annotation-item>
        </ul>
        {{/if}}
    {{/if}}
    <track-page params="page: track.StorymapAnnotations"></track-page>
</sliding-panel>
</script>
<script type="text/html" id="addannotationeditor"> <div class="control-group">
    {{#ifnot: $data.isEmoji }}
    <custom-control class="icon-editor" params="label: 'Icon'">
        <a class="editor-icon" data-bind="click: showIconSelector.bind($data)">
            <span data-bind="attr: { class: iconClass }"></span>
        </a>
        <span class="validation-message" data-bind="validationMessage: icon"></span>
        <annotation-icon-selector params="
            isOpen: isIconSelectorOpen,
            onIconSelect: selectIcon.bind($data),
            onColorSelect: selectColor.bind($data),
            onEndEdit: hideIconSelector.bind($data)"></annotation-icon-selector>
    </custom-control>
    {{/ifnot}}

    {{#if: $data.isEmoji }}
    <div class="control emoji-editor">
        <label>Emoji</label>
        <input type="text" name="Emoji" data-bind="value: emoji, hasFocus:isEmojiFocused" maxlength="50" />
        <span class="validation-message" data-bind="validationMessage: emoji"></span>
    </div>
    {{/if}}

    <textbox-control class="name-editor" params="label: 'Name', value: name, isRequired: true"></textbox-control>
</div>

<div class="buttons">
    <a class="btn btn-action-primary button" data-bind="btnClick: save.bind($data)"><span>Add</span></a>
    <a class="btn btn-action-primary2 button" data-bind="click: cancel.bind($data)"><span>Cancel</span></a>
</div>

{{#ifnot: $data.isEmoji }}
<p class="info">Can't find the right icon? Click <a data-bind="click: toggleEmojis.bind($data)">here</a> to use use emojis instead.</p>
{{/ifnot}}

{{#if: $data.isEmoji }}
<p class="info"><strong>ProTip</strong> You can search for emojis on <a href="https://emojipedia.org" target="_blank">https://emojipedia.org</a> or use the shortcut Cmd+Ctrl+Space on a Mac or Win+period(.) on Windows to open the emoji keyboard.</p>
{{/if}}</script>
<script type="text/html" id="annotationiconselector"> {{#if params.isOpen}}
    <div data-bind="clickOut: endEdit.bind($data)">
        <icon-selector params="items: iconNames, selectedItem: selectedIconName, isOpen: params.isOpen, widthInPixels: 338, onSelect: selectIcon.bind($data)">
            <span data-bind="attr: { class: 'annotation-icon ' + $data+' '+$parents[2].selectedColor().colorClass }"></span>
        </icon-selector>

        <div class="annotation-icon-selector-bottom">
            <color-picker params="availableColors: colors, selectedColor: selectedColor, onSelect: selectColor.bind($data)"></color-picker>
        </div>
    </div>
{{/if}}</script>
<script type="text/html" id="annotationitem"> <list-item params="contextMenuItems: [
     {caption: 'Highlight related cards...', callback: filter.bind($data)},
     {caption: 'Edit name', callback: editName.bind($data), isVisible: params.isEditEnabled},
     {caption: 'Change icon', callback: changeIcon.bind($data), isVisible: params.isEditEnabled},
     {caption: 'Archive', callback: archiveItem.bind($data), isVisible: isArchiveButtonVisible },
     {caption: 'Restore', callback: restoreItem.bind($data), isVisible: isRestoreButtonVisible },
     {caption: 'Delete', callback: deleteItem.bind($data), isVisible: params.isEditEnabled}]">

    <div class="annotation-item">

        {{#if: params.annotation.isEmoji }}
            {{#ifnot: isIconInEditMode}}
                <span class="annotation-emoji" data-bind="text: emoji, click: filter.bind($data), qtip:{ position: 'left' }" title="Highlight related cards..."></span>
            {{/ifnot}}
            {{#if: isIconInEditMode}}
                <div class="emoji-editor">
                    <input type="text" data-bind="value: emoji, hasFocus: isEmojiEditorFocused, event: {'blur': hideIconEditor.bind($data)}" maxlength="50" />
                    <span class="validation-message" data-bind="validationMessage: emoji"></span>
                </div>
            {{/if}}
        {{/if}}

        {{#ifnot: params.annotation.isEmoji }}
        <span class="annotation-icon" data-bind="attr: { class: params.annotation.iconClass }, click: filter.bind($data), qtip:{ position: 'left' }" title="Highlight related cards..."></span>
        <annotation-icon-selector params="
            isOpen: isIconInEditMode,
            selectedIcon: params.annotation.icon,
            selectedColor: params.annotation.color,
            onIconSelect: selectIcon.bind($data),
            onColorSelect: selectColor.bind($data),
            onEndEdit: hideIconSelector.bind($data)"></annotation-icon-selector>
        {{/ifnot}}


        <span class="annotation-name">
            <inline-textarea params="
                             value: name,
                             editOnClick: false,
                             endEditOnEnterKey: true,
                             isInEditMode: isNameInEditMode,
                             onEndEdit: saveName.bind($data),
                             width: '250px',
                             height: '20px'"></inline-textarea>
            <span class="validation-message" data-bind="validationMessage: name"></span>
        </span>
    </div>
</list-item></script>
<script type="text/html" id="boardquicktip"> <div class="board-quick-tip d-flex align-items-center" data-bind="css: { 'visible':shouldShowMessage}, click: close">
    <span class="board-quick-tip__bulb mr-5"></span>
    <span>{{message}}
        {{#if buttonLabel().length > 0}}
        <span style="text-decoration: underline" data-bind="text: buttonLabel, click: handleButtonClick"></span>
        {{/if}}
    </span>
</div></script>
<script type="text/html" id="boardsaveindicator"> <span class="board-save-indicator" data-bind="text: requestStatus, css:{ visible: isVisible, fadeOut: !isVisible() }"></span></script>
<script type="text/html" id="cardannotationcontextmenu"> {{#if params.isEditEnabled() && hasAvailableAnnotations() && isOpen}}
    <context-menu params="isOpen: isOpen">
        <p class="title">Assign annotations to card</p>
        {{#foreach items}}
        <div class="item" data-bind="click: $parent.toggleAnnotationSelection.bind($parent, $data)">
            <span class="annotation-checkbox">
                <i data-bind="class: {name: checkboxClass}"></i>
            </span>

            {{#if: isEmoji }}
            <span class="annotation-icon" data-bind="text: emoji"></span>
            {{/if}}

            {{#ifnot: isEmoji }}
            <span data-bind="class: {name: iconClass}"></span>
            {{/ifnot}}

            <span class="annotation-name">{{name}}</span>
        </div>
        {{/foreach}}
    </context-menu>
{{/if}}</script>
<script type="text/html" id="cardannotations"> <div class="card-annotations">
    {{#if hasCardAnnotations}}
    {{#foreach: params.cardAnnotations}}
    {{#if: annotation.isEmoji }}
    <span class="emoji" data-bind="text: annotation.emoji"></span>
    {{/if}}

    {{#ifnot: annotation.isEmoji }}
    <span data-bind="attr: { class: 'small ' + annotation.iconClass() }"></span>
    {{/ifnot}}
    {{/foreach}}
    {{/if}}
</div></script>
<script type="text/html" id="cardcomments"> {{#if isEditorVisible}}
    <custom-control params="label: 'Comments'">
        <comment-editor params="
            correlationId: correlationId,
            id: params.cardId,
            onEdit: saveExistingComment.bind($data),
            onAdd: saveNewComment.bind($data),
            onCancel: cancelEdit.bind($data),
            emptyText: 'Type your comment here. Use @ to mention.',
            fileUploadConfig: fileUploadConfig,
            addAttachmentConfig: addAttachmentConfig"></comment-editor>
    </custom-control>
{{/if}}

<comment-list params="
  correlationId: correlationId,
  comments: commentsToShow,
  isCommentingEnabledForCurrentUser: params.isCommentingEnabledForCurrentUser,
  isCurrentUserAdmin: params.isCurrentUserAdmin,
  onEdit: editComment.bind($data),
  onReply: replyToComment.bind($data),
  onDelete: deleteComment.bind($data)"></comment-list>
{{#if canShowMoreComments}}
    <a class="show-more-link" data-bind="click: showMoreComments.bind($data)">show more comments ({{numberOfHiddenComments}})</a>
{{/if}}
</script>
<script type="text/html" id="commenteditor"> <div class="mention-input-container">
    <new-editor-core params="
                         value: value,
                         id: id,
                         editorMode: 'comment',
                         placeHolder: 'Type your comment here. Use @ to mention.',
                         onSave: onSave,
                         onCancel: cancel,
                         triggerSetEditorValueFn: setEditorValue,
                         fileUploadConfig: fileUploadConfig,
                         addAttachmentConfig: addAttachmentConfig"></new-editor-core>
</div></script>
<script type="text/html" id="deletestorymap"> <modal params="{
       title: 'Delete storymap',
       isOpen: isOpen,
       type: 'confirmation',
       class: 'delete-storymap-confirm',
    }">
    <div class="header">Delete story map{{#if storeProps.isTemplateStorymap }} template{{/if}}</div>
    <div class="content">
        <p>
            If you delete this story map{{#if storeProps.isTemplateStorymap }} template{{/if}}, all data contained therein will be immediately and irrecoverably destroyed.
        </p>
        <p>
            <br/>
            <span class="warning-text">THIS OPERATION CANNOT BE UNDONE!</span>
            <br/> <br/>
        </p>
        <div class="control-group">
            <div class="control">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: deleteStorymapConfirmed}">
                    I understand, please delete my story map{{#if storeProps.isTemplateStorymap }} template{{/if}}.
                </label>
            </div>
        </div>
    </div>
    <div class="footer">
        {{#if storeProps.isTemplateStorymap }}
        <button class="btn-action-primary" data-bind="inlineConfirm: ['Delete story map template', 'Click again to confirm deletion', 'Deleting story map template...'], submitFunction: deleteStorymap, showTimer: 'true', visible: deleteStorymapConfirmed"></button>
        {{/if}}
        {{#ifnot storeProps.isTemplateStorymap }}
        <button class="btn-action-primary" data-bind="inlineConfirm: ['Delete story map', 'Click again to confirm deletion', 'Deleting story map...'], submitFunction: deleteStorymap, showTimer: 'true', visible: deleteStorymapConfirmed"></button>
        {{/ifnot}}
        <button class="btn-action" data-bind="click: close">Cancel</button>
    </div>
</modal></script>
<script type="text/html" id="discussionpanel"> <sliding-panel params="
        title: 'Board discussion',
        elementId: 'discussion-panel',
        isFullSize: params.isFullSize,
        isOpened: params.isOpened,
        onClose: params.onClose">

    <div class="info-section">
        Discuss product, share ideas, files and assets. Notify others by using @mention.
    </div>

{{#if params.isOpened}}
    <div class="metro-pivot" data-bind="metroPivot: true">
        <div class="pivot-item comments-tab">
            <track-page params="page: track.StorymapBoardDiscussion"></track-page>

            <h3>Discussion</h3>
            <board-comments params="
                correlationId: boardcommentsCorrelationId,
                addAttachmentConfig: {
                     onOpenFileUpload: openFileUpload,
                     onWebLinkSave: addWebLink,
                     position: 'top'
                },
                fileUploadConfig: {
                   url: '/UploadAttachment',
                   extraFormData: { storymapId: storeProps.storymapId },
                   onSuccessUpload: onFileUploadedByEditor 
                }"></board-comments>
        </div>
        <div class="pivot-item attachments-tab">
            <track-page params="page: track.StorymapBoardAttachments"></track-page>

            <h3>
                Attachments
                {{#if numberOfAttachments() > 0}}
                ({{numberOfAttachments}})
                {{/if}}
            </h3>

            <attachment-list params="
                         isEditEnabled: isEditEnabled,
                         attachments: attachments,
                         onDeleteAttachment: onDeleteAttachment,
                         onNameChanged: onAttachmentNameChanged"></attachment-list>

            <weblink-list params="
                     isEditEnabled: isEditEnabled,
                     webLinks: weblinks,

                     onNameChange: changeWeblinkName,
                     onDelete: deleteWeblink"></weblink-list>

        </div>
    </div>

    {{#if isEditEnabled}}
    <file-uploader params="
        correlationId: fileuploaderCorrelationId,
        disablePicturePaste: true,
        sendConfig: {
            url: '/UploadAttachment',
            extraFormData: { storymapId: storeProps.storymapId }
        },
        dropZoneSelector: 'board-comments',
        onSuccessUpload: onFileUploaded
        "></file-uploader>
    {{/if}}
{{/if}}

</sliding-panel></script>
<script type="text/html" id="boardcomments"> {{#if isReady}}
<div id="board-comments">
    <comment-list params="
              correlationId: correlationId,
              comments: comments,
              isCommentingEnabledForCurrentUser: storeProps.userRights.canCommentOnStorymap,
              isCurrentUserAdmin: storeProps.userRights.hasAdminRights(),
              direction: 'bottom-up',
              onEdit: editComment.bind($data),
              onReply: replyToComment.bind($data),
              onDelete: deleteComment.bind($data),
              infiniteScroll: fetchNextBatch.bind($data)"></comment-list>

    {{#if currentUserCanComment}}
    <comment-editor params="
            correlationId: correlationId,
            id: 'board-comments',
            onEdit: saveExistingComment.bind($data),
            onAdd: saveNewComment.bind($data),
            onCancel: cancelEdit.bind($data),
            emptyText: 'Type your message here. Use @ to mention.',
            fileUploadConfig: fileUploadConfig,
            addAttachmentConfig: addAttachmentConfig"></comment-editor>
    {{/if}}
</div>
{{/if}}

</script>
<script type="text/html" id="fileuploader"> <div class="file-upload-container">
    <div class="drop-zone-indicator">Drop files here</div>

    <input class="hidden-fileupload" id="{{ id }}" type="file" name="file" />

    <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
</div>  </script>
<script type="text/html" id="headerboardactions"> {{#if storeProps.shoudShow}}
<header-dropdown params="iconClass: 'icon-storymap-h-more'">
    <ul>
        <li data-bind="click: editStorymapName"><a>Edit name</a></li>
        {{#ifnot isStorymapTemplate}}
        <li data-bind="click: openChangeCollection"><a>Change collection</a></li>
        <li data-bind="click: openCopyStorymap"><a>Copy story map</a></li>
        <li data-bind="click: openCopyStorymapToTemplate"><a>Copy as a template</a></li>
        <li data-bind="click: archiveStorymap"><a>Archive story map</a></li>

        <li><hr /></li>

        <li data-bind="click: $root.openSettingsModalWithTab.bind($root, 1)"><a>Integration settings</a></li>
        {{/ifnot}}
        <li data-bind="click: $root.openSettingsModal.bind($root)"><a>All board settings</a></li>
        <li><hr /></li>

        {{#if isStorymapTemplate}}
        <li data-bind="click: openDeleteStorymap"><a>Delete template</a></li>
        {{/if}}
        {{#ifnot isStorymapTemplate}}
        <li data-bind="click: openDeleteStorymap"><a>Delete story map</a></li>
        {{/ifnot}}
    </ul>
</header-dropdown>

<change-collection params="openFn: changeCollectionOpener"></change-collection>
<copy-storymap  params="openFn: copyStorymapOpener"></copy-storymap>
<copy-storymap-to-template params="openFn: copyStorymapToTemplateOpener"></copy-storymap-to-template>
{{/if}}</script>
<script type="text/html" id="changecollection"> {{#if isOpen}}
    <context-menu params="isOpen: isOpen, direction: 'bottom'">
        <div class="header">
            <h5>Change story map Collection</h5>
            <a class="btn-icon" data-bind="click: onClose">
                <i class="icon-close-dialog"></i>
            </a>
        </div>

        <div class="control-group change-collection-form">
            <div class="control">
                <label>
                    Collection
                    <select class="collection-select-component" data-bind="
                            options: collections,
                            optionsText: 'truncatedName',
                            value: selectedCollection,
                            optionsCaption: 'Choose collection...',
                            select: true"></select>
                </label>
                <span class="help-block">Collections help you organize your story maps</span>
            </div>
        </div>

        <div class="buttons">
            <a class="btn btn-action-primary button" data-bind="click: save"><span>Save</span></a>
        </div>
    </context-menu>
{{/if}}</script>
<script type="text/html" id="copystorymap"> {{#if isOpen}}
<context-menu params="isOpen: isOpen, direction: 'bottom'">
        
    <div class="header">
        <h5>Copy story map</h5>
        <a class="btn-icon" data-bind="click: onClose">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
        

    <div class="control-group copy-storymap-form">
        <div class="control link">
            <label>Name</label>
            <input type="text" name="name" data-bind="value: name, valueUpdate: 'keyup', hasFocus: true, enterKey: save, escKey: onClose" placeholder="Name" />
            <span class="validation-message" data-bind="validationMessage: name"></span>
        </div>
        
        <div class="control pb-0">
            <label>
                <input type="checkbox" data-bind="checkbox: {checked: isKeepMembers}">
               Keep collaborators & sharing settings
            </label>
        </div>
    </div>

    <div class="buttons">
        <a class="btn btn-action-primary button" data-bind="btnClick: save"><span>Copy</span></a>
    </div>
</context-menu>
{{/if}}</script>
<script type="text/html" id="copystorymaptotemplate"> {{#if isOpen}}
<context-menu params="isOpen: isOpen, direction: 'bottom'">
        
    <div class="header">
        <h5>Copy story map as a template</h5>
        <a class="btn-icon" data-bind="click: onClose">
            <i class="icon-close-dialog"></i>
        </a>
    </div>
        

    <div class="control-group copy-storymap-form">
        <div class="control link">
            <label>Template name</label>
            <input type="text" name="name" data-bind="value: name, valueUpdate: 'keyup', hasFocus: true, enterKey: save, escKey: onClose" placeholder="Template name" />
            <span class="validation-message" data-bind="validationMessage: name"></span>
        </div>
    </div>

    <div class="buttons">
        <a class="btn btn-action-primary button" data-bind="btnClick: save"><span>Copy</span></a>
    </div>
</context-menu>
{{/if}}</script>
<script type="text/html" id="headerdropdown"> <div class="more-dropdown-menu" data-bind="dropdownmenu: true">
    <a class="btn-icon">
        <i data-bind="class: { name: params.iconClass }"></i>
    </a>
    <div class="menu-content right-aligned">
        <div class="more-dropdown-menu-content">
            <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --><!-- /ko -->
        </div>
    </div>
</div></script>
<script type="text/html" id="ideapanel"> <sliding-panel params="
        title: 'Ideas',
        elementId: 'idea-panel',
        isFullSize: params.isFullSize,
        isOpened: params.isOpened,
        onClose: params.onClose">

    {{#if shouldShowOnboarding}}
    <idea-onboarding params="
                            isNotCollaborator: isNotCollaborator,
                            isViewer: isViewer,
                            hasNoFeedbackPortal: hasNoFeedbackPortal,
                            hasNotCompletedFeedbackPortalOnboarding: hasNotCompletedFeedbackPortalOnboarding,
                            hasNoFeedbackPortalAccess: hasNoFeedbackPortalAccess
                           "></idea-onboarding>
    {{/if}}

    {{#ifnot shouldShowOnboarding}}
        <div>
            {{#if selectedIdea() == null}}
                <idea-search-and-filter params="
                                        searchText: searchText,
                                        statuses: statuses,
                                        labels: labels,
                                        filterLabelIds: filterLabelIds,
                                        filterStatusIds: filterStatusIds
                                        ">
                </idea-search-and-filter>

                {{#if visibleIdeas().length === 0 && isFiltered()}}
                    <div class="no-ideas-found mt-5">No ideas found.</div>
                {{/if}}

                {{#foreach visibleNonProcessedIdeas}}
                    <idea-list-item params="
                                idea: $data,
                                allLabels: $parent.labels,
                                statuses: $parent.statuses" data-bind="click: () => $parent.openIdea($data)"></idea-list-item>
                {{/foreach}}
                
                {{#if visibleProcessedIdeas().length > 0 }}
                    <div class="mt-30" style="font-weight: bold;">Processed ideas</div>
                {{/if}}

                {{#foreach visibleProcessedIdeas}}
                    <idea-list-item params="
                                idea: $data,
                                allLabels: $parent.labels,
                                statuses: $parent.statuses" data-bind="click: () => $parent.openIdea($data)"></idea-list-item>
                {{/foreach}}
            {{/if}}

            {{#if selectedIdea() != null}}
                <idea-list-item params="
                            idea: selectedIdea,
                            allLabels: labels,
                            statuses: statuses,
                            showFull: true,
                            onClose: closeIdea"></idea-list-item>
            {{/if}}
        </div>
    {{/ifnot}}
</sliding-panel></script>
<script type="text/html" id="attachmentsandweblinks"> {{#if params.attachments.length > 0}}
    <div class="mt-15">
        <div style="font-weight: 700; font-size: 14px;" class="mb-10">Attachments</div>
        {{#foreach params.attachments }}
            <div class="d-flex align-items-center mt-5">
            <span class="d-flex align-items-center" style="font-size: 12px; height: 12px; width: 12px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                    <path fill="var(--blueGrey90Light)" d="M21,15.3333333 L21,3.33333333 C21,2.22876383 20.1045695,1.33333333 19,1.33333333 L4.33333333,1.33333333 C3.22876383,1.33333333 2.33333333,2.22876383 2.33333333,3.33333333 L2.33333333,20.6666667 C2.33333333,21.7712362 3.22876383,22.6666667 4.33333333,22.6666667 L13.6666667,22.6666667 C14.7712362,22.6666667 15.6666667,21.7712362 15.6666667,20.6666667 C15.6666667,18.8257175 17.1590508,17.3333333 19,17.3333333 C20.1045695,17.3333333 21,16.4379028 21,15.3333333 L21,15.3333333 Z M20.3352544,18.3884641 C19.9264398,18.5673909 19.4748134,18.6666667 19,18.6666667 C17.8954305,18.6666667 17,19.5620972 17,20.6666667 C17,21.1414801 16.9007243,21.5931065 16.7217975,22.0019211 C18.3164913,21.2701351 19.6034684,19.983158 20.3352544,18.3884641 L20.3352544,18.3884641 Z M1,3.33333333 C1,1.49238417 2.49238417,0 4.33333333,0 L19,0 C20.8409492,0 22.3333333,1.49238417 22.3333333,3.33333333 L22.3333333,15.3333333 C22.3333333,20.1198012 18.4531345,24 13.6666667,24 L4.33333333,24 C2.49238417,24 1,22.5076158 1,20.6666667 L1,3.33333333 Z M7,8 C6.63181017,8 6.33333333,7.70152317 6.33333333,7.33333333 C6.33333333,6.9651435 6.63181017,6.66666667 7,6.66666667 L16.3333333,6.66666667 C16.7015232,6.66666667 17,6.9651435 17,7.33333333 C17,7.70152317 16.7015232,8 16.3333333,8 L7,8 Z M7,12 C6.63181017,12 6.33333333,11.7015232 6.33333333,11.3333333 C6.33333333,10.9651435 6.63181017,10.6666667 7,10.6666667 L16.3333333,10.6666667 C16.7015232,10.6666667 17,10.9651435 17,11.3333333 C17,11.7015232 16.7015232,12 16.3333333,12 L7,12 Z M7,16 C6.63181017,16 6.33333333,15.7015232 6.33333333,15.3333333 C6.33333333,14.9651435 6.63181017,14.6666667 7,14.6666667 L13.6666667,14.6666667 C14.0348565,14.6666667 14.3333333,14.9651435 14.3333333,15.3333333 C14.3333333,15.7015232 14.0348565,16 13.6666667,16 L7,16 Z"></path>
                </svg>
            </span>
            {{#if IsImage}}
                <a class="ellipsis" style="line-height: 1.4; color: #44577a; display: block; margin-left: 5px;" data-bind="attr: { href: Url, 'data-title': Name, 'data-lightbox': 'lightboxGroup' }">{{Name}}</a>
            {{/if}}
            {{#ifnot IsImage}}
                <a class="ellipsis" style="line-height: 1.4; color: #44577a; display: block; margin-left: 5px;" data-bind="attr: {target: '_blank', href: Url }">{{Name}}</a>
            {{/ifnot}}
            </div>
        {{/foreach}}
    </div>
{{/if}}

{{#if params.weblinks.length > 0}}
    <div class="mt-15">
        <div style="font-weight: 700; font-size: 14px;" class="mb-10">Weblinks</div>
        {{#foreach params.weblinks }}
            <div class="d-flex align-items-center mt-5">
                <div style="width: 40px; height: 40px; flex: 0 0 40px;" class="d-flex align-items-center justify-content-center">
                    <img src="{{FaviconUrl}}" width="16px" height="16px"/>
                </div>
                {{#if Name}}
                    <div class="d-flex flex-column ml-5">
                        <a href="{{Url}}" target="_blank" style="font-size: 13px; line-height: 1.3; font-weight: 700; color: #283660; display: block;">{{Name}}</a>
                        <a class="line-clamp" href="{{Url}}" target="_blank" style="font-size: 11px; line-height: 1.2; font-weight: 400; color: #283660;  word-break: break-all;">{{Url}}</a>
                    </div>
                {{/if}}
                {{#ifnot Name}}
                    <a class="ml-5 line-clamp" href="{{Url}}" target="_blank" style="font-size: 13px;line-height: 1.3; font-weight: 700; color: #283660; word-break: break-all;">{{Url}}</a>
                {{/ifnot}}
            </div>
        {{/foreach}}
    </div>
{{/if}}
        
</script>
<script type="text/html" id="feedbackcard"> <div 
    data-bind="clickIf: { ifnot: isExpanded, do: toggleExpanded }, style: { 'cursor': isExpanded() ? 'auto' : 'pointer'}" 
     class="idea-list-item__card pa-10 d-flex mt-10" style="padding-right: 2px; background-color: #eff1f5">
    
    <div style="min-width: 0;">
        {{#if params.feedback.Tags.length > 0}}
            <div class="d-flex flex-wrap mb-10" style="min-width: 0;">
                {{#foreach params.feedback.Tags}}
                    <div class="feedback-tag pa-5 ellipsis">{{$data}}</div>
                {{/foreach}}
            </div>
        {{/if}}

        <div data-bind="css: { 'line-clamp': !isExpanded() }, megamark: {value: params.feedback.Content}" style="line-height: 1.2;"></div>
        
        {{#if isExpanded}}
            <attachments-and-weblinks params="attachments: params.feedback.Attachments, weblinks: params.feedback.Weblinks"></attachments-and-weblinks>
        {{/if}}
        
        {{#if params.feedback.ContactEmail}}
            <div class="d-flex align-items-center mt-10">
                <span class="d-flex align-items-center" style="font-size: 12px; height: 12px; width: 12px;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                        <path fill="var(--blueGrey90Light)" d="M19.842,17.4144 L15.6936,15.5292 C17.0976,14.4312 18,12.7212 18,10.8 C18,7.4868 15.3144,4.8 12,4.8 C8.6868,4.8 6,7.4868 6,10.8 C6,12.7212 6.9024,14.4312 8.3076,15.5292 L4.1592,17.4144 C3.7644,17.5944 3.4176,17.8548 3.1392,18.1752 C1.9164,16.4244 1.2,14.2956 1.2,12 C1.2,6.036 6.036,1.2 12,1.2 C17.9652,1.2 22.8,6.036 22.8,12 C22.8,14.2956 22.0836,16.4244 20.862,18.1752 C20.5836,17.8548 20.2368,17.5944 19.842,17.4144 M7.2,10.8 C7.2,8.1492 9.3492,6 12,6 C14.6508,6 16.8,8.1492 16.8,10.8 C16.8,13.4508 14.6508,15.6 12,15.6 C9.3492,15.6 7.2,13.4508 7.2,10.8 M12,22.8 C8.7756,22.8 5.8824,21.3876 3.9024,19.1472 C4.0872,18.87 4.3464,18.6468 4.656,18.5076 L9.5544,16.2804 C10.3008,16.614 11.1288,16.8 12,16.8 C12.8712,16.8 13.6992,16.614 14.4468,16.2804 L19.3452,18.5076 C19.6536,18.6468 19.9128,18.87 20.0976,19.1472 C18.1188,21.3876 15.2244,22.8 12,22.8 M12,0 C5.3724,0 0,5.3724 0,12 C0,18.6276 5.3724,24 12,24 C18.6276,24 24,18.6276 24,12 C24,5.3724 18.6276,0 12,0"></path>
                    </svg>
                </span>
                
                <div class="ml-5 ellipsis" data-bind="attr: { 'title': params.feedback.ContactEmail }, qtip: {position: 'top-right'}">
                    {{params.feedback.ContactEmail}}
                </div>
            </div>
        {{/if}}
    </div>
    
    <div class="spacer"></div>

    {{#if params.feedback.IsProcessed}}
        <span data-bind="btnClick: toggleIsProcessed, qtip: {position: 'top-right'}" title="Mark as not processed" class="d-flex align-items-center mt-5" style="font-size: 12px; height: 12px; width: 12px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                <path fill="var(--blueGrey90Light)" d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zm0 32c8.823 0 16 7.178 16 16v352c0 8.822-7.177 16-16 16H48c-8.822 0-16-7.178-16-16V80c0-8.822 7.178-16 16-16h352m-34.301 98.293l-8.451-8.52c-4.667-4.705-12.265-4.736-16.97-.068l-163.441 162.13-68.976-69.533c-4.667-4.705-12.265-4.736-16.97-.068l-8.52 8.451c-4.705 4.667-4.736 12.265-.068 16.97l85.878 86.572c4.667 4.705 12.265 4.736 16.97.068l180.48-179.032c4.704-4.667 4.735-12.265.068-16.97z"></path>
            </svg>
        </span>
    {{/if}}
    {{#ifnot params.feedback.IsProcessed}}
        <span data-bind="btnClick: toggleIsProcessed, qtip: {position: 'top-right'}" title="Mark as processed" class="d-flex align-items-center mt-5" style="font-size: 12px; height: 12px; width: 12px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                <path fill="var(--blueGrey90Light)" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm16 400c0 8.8-7.2 16-16 16H48c-8.8 0-16-7.2-16-16V80c0-8.8 7.2-16 16-16h352c8.8 0 16 7.2 16 16v352z"></path>
            </svg>
        </span>
    {{/ifnot}}

    <span data-bind="clickAndStop: toggleExpanded, style: { 'transform': isExpanded() ? 'rotate(180deg) translateX(-1px) translateY(-3px)' : 'none'}" style="cursor: pointer; font-size: 20px; height: 20px; width: 13px; margin-left: 2px;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" aria-hidden="true" style="pointer-events: none; font-size: 20px; height: 20px; width: 20px; margin-left: -5px;">
            <path fill="var(--blueGrey90Light)" d="M11.5773679,13.9732087 L8.1763051,10.5838006 C7.94123163,10.3495327 7.94123163,9.97071651 8.1763051,9.73894081 L8.74148171,9.17570093 C8.97655517,8.94143302 9.35667396,8.94143302 9.58924664,9.17570093 L12,11.5781931 L14.4107534,9.17570093 C14.6458268,8.94143302 15.0259456,8.94143302 15.2585183,9.17570093 L15.8236949,9.73894081 C16.0587684,9.97320872 16.0587684,10.3520249 15.8236949,10.5838006 L12.4226321,13.9732087 C12.1925602,14.2074766 11.8124414,14.2074766 11.5773679,13.9732087 L11.5773679,13.9732087 Z"></path>
        </svg>
    </span>
</div></script>
<script type="text/html" id="idealistitem"> <div class="idea-list-item__card pa-10" style="position: relative;" data-bind="style: { 'cursor': showFull ? 'default' : 'pointer'}">
    {{#if showFull}}
    <a class="btn-icon" data-bind="click: close" style="position: absolute; top: 0; right: 0;">
        <i class="icon-close-dialog"></i>
    </a>
    <!--<span data-bind="click: close" style="position: absolute; top: 10px; right: 10px;">X</span>-->
    {{/if}}

    <div class="d-flex flex-wrap" style="padding-right: 25px;">
        {{#foreach labels}}
        <div class="idea-label ellipsis"
             data-bind="style: { 'background-color': $parent.getLabelClass(Color).bgColor, 'color': $parent.getLabelClass(Color).fontColor }">
            {{Name}}
        </div>
        {{/foreach}}

    </div>
    <div class="mt-15">
        {{idea.Title ? idea.Title : "Untitled idea"}}
    </div>
    <div class="d-flex align-items-center mt-10">
        <div class="idea-status ellipsis">{{status.Name}}</div>
        <div class="d-flex align-items-center ml-10">
            <span class="d-flex align-items-center" style="font-size: 12px; height: 12px; width: 12px;">
                <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-thumbs-up fa-w-16 v-icon__component theme--light" style="font-size: 12px; height: 12px; width: 12px;"><path fill="var(--blueGrey90Light)" d="M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"></path></svg>
            </span>
            <span style="font-size: 11px; margin-left: 2px;">{{idea.Upvotes}}</span>
        </div>
        {{#if idea.Feedbacks.length }}
        <div class="d-flex align-items-center ml-10">
            <span class="d-flex align-items-center" style="font-size: 12px; height: 12px; width: 12px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                    <path fill="var(--blueGrey90Light)" d="M21,15.3333333 L21,3.33333333 C21,2.22876383 20.1045695,1.33333333 19,1.33333333 L4.33333333,1.33333333 C3.22876383,1.33333333 2.33333333,2.22876383 2.33333333,3.33333333 L2.33333333,20.6666667 C2.33333333,21.7712362 3.22876383,22.6666667 4.33333333,22.6666667 L13.6666667,22.6666667 C14.7712362,22.6666667 15.6666667,21.7712362 15.6666667,20.6666667 C15.6666667,18.8257175 17.1590508,17.3333333 19,17.3333333 C20.1045695,17.3333333 21,16.4379028 21,15.3333333 L21,15.3333333 Z M20.3352544,18.3884641 C19.9264398,18.5673909 19.4748134,18.6666667 19,18.6666667 C17.8954305,18.6666667 17,19.5620972 17,20.6666667 C17,21.1414801 16.9007243,21.5931065 16.7217975,22.0019211 C18.3164913,21.2701351 19.6034684,19.983158 20.3352544,18.3884641 L20.3352544,18.3884641 Z M1,3.33333333 C1,1.49238417 2.49238417,0 4.33333333,0 L19,0 C20.8409492,0 22.3333333,1.49238417 22.3333333,3.33333333 L22.3333333,15.3333333 C22.3333333,20.1198012 18.4531345,24 13.6666667,24 L4.33333333,24 C2.49238417,24 1,22.5076158 1,20.6666667 L1,3.33333333 Z M7,8 C6.63181017,8 6.33333333,7.70152317 6.33333333,7.33333333 C6.33333333,6.9651435 6.63181017,6.66666667 7,6.66666667 L16.3333333,6.66666667 C16.7015232,6.66666667 17,6.9651435 17,7.33333333 C17,7.70152317 16.7015232,8 16.3333333,8 L7,8 Z M7,12 C6.63181017,12 6.33333333,11.7015232 6.33333333,11.3333333 C6.33333333,10.9651435 6.63181017,10.6666667 7,10.6666667 L16.3333333,10.6666667 C16.7015232,10.6666667 17,10.9651435 17,11.3333333 C17,11.7015232 16.7015232,12 16.3333333,12 L7,12 Z M7,16 C6.63181017,16 6.33333333,15.7015232 6.33333333,15.3333333 C6.33333333,14.9651435 6.63181017,14.6666667 7,14.6666667 L13.6666667,14.6666667 C14.0348565,14.6666667 14.3333333,14.9651435 14.3333333,15.3333333 C14.3333333,15.7015232 14.0348565,16 13.6666667,16 L7,16 Z"></path>
                </svg>
            </span>
            <span style="font-size: 11px; margin-left: 2px;">{{idea.Feedbacks.length}}</span>
        </div>
        {{/if}}
        <div class="spacer"></div>
        {{#if idea.Attachments.length || idea.Weblinks.length}}
            <span class="d-flex align-items-center ml-10" style="font-size: 12px; height: 12px; width: 12px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                    <path fill="var(--blueGrey90Light)" d="M21.8332664,10.5243973 C22.1675861,10.1890573 22.7104525,10.1882302 23.0457924,10.5225499 C23.3811324,10.8568696 23.3819595,11.399736 23.0476398,11.7350759 L12.8542169,21.959607 C10.1477265,24.6743571 5.75294262,24.6810529 3.03773012,21.9741011 C0.322958781,19.2593401 0.322958781,14.8692094 3.03153831,12.160631 L13.7629987,1.48764948 C15.7612724,-0.499728845 18.9909298,-0.495314487 20.9837632,1.49751896 C22.9759838,3.48973954 22.9764086,6.71963625 20.9847122,8.71238083 L10.0854398,19.617389 C8.79654831,20.9069588 6.70629244,20.9075087 5.41664289,19.6185375 C4.12648175,18.3283765 4.12291767,16.2385802 5.4081381,14.9445621 L13.2307497,7.06840299 C13.5644359,6.73243266 14.1072997,6.73058098 14.4432701,7.06426716 C14.7792404,7.39795334 14.7810921,7.94081721 14.4474059,8.27678755 L6.62479433,16.1529467 C6.0053372,16.7766441 6.00705503,17.7838949 6.62855619,18.405396 C7.24866432,19.0251781 8.25318618,19.0249139 8.87259344,18.4051806 L19.7718658,7.5001724 C21.0942026,6.17713978 21.0939205,4.03273113 19.7712358,2.7100464 C18.4467687,1.3855793 16.3002898,1.38264545 14.972207,2.703487 L4.25416857,13.3630855 C2.20514664,15.4120764 2.20514664,18.716473 4.24277452,20.7541013 C6.29294137,22.7980401 9.60199242,22.7929985 11.6398435,20.7489283 L21.8332664,10.5243973 Z"></path>
                </svg>
            </span>
        {{/if}}
        
        <div class="idea-processed-btn ml-10 d-flex align-items-center" data-bind="btnClick: toggleIsProcessed">
            <div style="font-size: inherit;">Processed</div>
            {{#if idea.IsProcessed}}
                <span class="d-flex align-items-center ml-10" style="font-size: 12px; height: 12px; width: 12px;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                        <path fill="var(--blueGrey90Light)" d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zm0 32c8.823 0 16 7.178 16 16v352c0 8.822-7.177 16-16 16H48c-8.822 0-16-7.178-16-16V80c0-8.822 7.178-16 16-16h352m-34.301 98.293l-8.451-8.52c-4.667-4.705-12.265-4.736-16.97-.068l-163.441 162.13-68.976-69.533c-4.667-4.705-12.265-4.736-16.97-.068l-8.52 8.451c-4.705 4.667-4.736 12.265-.068 16.97l85.878 86.572c4.667 4.705 12.265 4.736 16.97.068l180.48-179.032c4.704-4.667 4.735-12.265.068-16.97z"></path>
                    </svg>
                </span>
            {{/if}}
            {{#ifnot idea.IsProcessed}}
                <span class="d-flex align-items-center ml-10" style="font-size: 12px; height: 12px; width: 12px;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" role="img" aria-hidden="true" style="font-size: 12px; height: 12px; width: 12px;">
                        <path fill="var(--blueGrey90Light)" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm16 400c0 8.8-7.2 16-16 16H48c-8.8 0-16-7.2-16-16V80c0-8.8 7.2-16 16-16h352c8.8 0 16 7.2 16 16v352z"></path>
                    </svg>
                </span>
            {{/ifnot}}
        </div>
    </div>

    {{#if showFull}}

        {{#if idea.Content}}
        <div class="mt-15">
            <div style="font-weight: 700; font-size: 14px;" class="mb-10">Description</div>
            <div data-bind="megamark:{ value: idea.Content }"></div>
        </div>
        {{/if}}

        <attachments-and-weblinks params="attachments: idea.Attachments, weblinks: idea.Weblinks"></attachments-and-weblinks>
    
        {{#if nonProcessedFeedbacks().length > 0}}
            <div class="mt-15">
                <div style="font-weight: 700; font-size: 14px;" class="mb-10">Insights</div>
                {{#foreach nonProcessedFeedbacks}}
                    <feedback-card params="feedback: $data"></feedback-card>
                {{/foreach}}
            </div>
        {{/if}}

        {{#if processedFeedbacks().length > 0}}
            <div class="mt-15">
                <div style="font-weight: 700; font-size: 14px;" class="mb-10">Processed Insights</div>
                {{#foreach processedFeedbacks}}
                    <feedback-card params="feedback: $data"></feedback-card>
                {{/foreach}}
            </div>
        {{/if}}

    {{/if}}

</div></script>
<script type="text/html" id="ideaonboarding"> <div>
    {{#if reason() === "isViewerOrWsVisibleMap"}}
    <div class="mt-10 font-weight-bold font-size-18">
        You don't have permission to access the idea panel.
    </div>
    <p class="mt-20 font-size-16">
        To be able to access this panel, ask an administrator to change your role to editor on this story map.
    </p>
    {{/if}}

    {{#if reason() === "hasNoFeedbackPortalButHasAccess"}}
    <div class="mt-10 font-weight-bold font-size-18">
        The idea board is still unexplored on your workspace.
    </div>
    <div class="mt-20 font-weight-bold font-size-16">
        Be the first one on your team to try it out!
    </div>
    <a href="{{globalConfig.appUrl}}/{{productSlug}}/feedbackportal/ideas" target="_blank" class="mt-20 button btn-action-primary">Go to idea board</a>
    {{/if}}

    {{#if reason() === "hasNoFeedbackPortalAndNoAccess"}}
    <div class="mt-10 font-weight-bold font-size-18">
        The idea board is still unexplored on your workspace.
    </div>
    <p class="mt-20 font-size-16">
        To try it out, ask an administrator of your workspace to grant you access to Feedback Management.
    </p>
    {{/if}}

    {{#if reason() === "hasNoFeedbackPortalAccessAndAdmin"}}
    <div class="mt-10 font-weight-bold font-size-18">
        You don't have access to Feedback Management.
    </div>
    <p class="mt-20 font-size-16">
        Since you are an administrator on your workspace, you can grant yourself access by ticking Feedback Management for your user under Manage users.

    </p>
    <a href="{{globalConfig.appUrl}}/managepeople" target="_blank" class="mt-20 button btn-action-primary">
        Manage permissions
    </a>
    {{/if}}

    {{#if reason() === "hasNoFeedbackPortalAccessAndNotAdmin"}}
    <div class="mt-10 font-weight-bold font-size-18">
        You don't have access to Feedback Management.
    </div>
    <p class="mt-20 font-size-16">
        To view and edit insights and ideas, ask an administrator to grant you access.
    </p>
    {{/if}}

    {{#if reason() === "hasNotCompletedFeedbackPortalOnboarding"}}
    <div class="mt-10 font-weight-bold font-size-18">
        To access the idea panel, simply start using Feedback Management
    </div>

    <a href="{{globalConfig.appUrl}}/{{productSlug}}/feedbackportal/ideas" target="_blank" class="mt-20 button btn-action-primary">Go to idea board</a>

    {{/if}}

    <div class="mt-40 font-weight-bold font-size-18">Watch quick intro</div>
    <div class="mt-15">
        <a href="https://youtu.be/OhSj4cfwco8" target="_blank">
            <img class="idea-panel-onboarding-img" style="max-width: 100%;" src="{{globalConfig.appUrl}}/content/img/feedback-video.png" alt="Feedback Management Video" />
        </a>
    </div>
    <div class="mt-40 font-weight-bold font-size-18">What are ideas</div>
    <p class="mt-15 font-size-16">Ideas refer to actionable bits of product feedback such as features or partial features. Ideas are born by grouping smaller bits of product feedback called Insights. You can reach the idea board directly from the dashboard.</p>
    <div class="mt-20 font-weight-bold font-size-18">How to use ideas on the story map?</div>
    <div class="mt-15">
        <ul class="pl-15" style="list-style: disc;">
            <li class="font-size-16">Keep the story map organized by managing feature requests and ideas on the idea board.</li>
            <li class="mt-5 font-size-16">Use ideas as inputs for product discovery.</li>
            <li class="mt-5 font-size-16">Open ideas to process all relevant information (description, insights, attachments).</li>
        </ul>
    </div>
    <div class="mt-20">
        <a style="text-decoration: underline" target="_blank" href="https://storiesonboard.com/blog/introducing-storiesonboard-feedback-management">learn more</a>
    </div>
</div>
</script>
<script type="text/html" id="ideasearchandfilter"> <div class="control-groups basic-filters-container">
    <input class="searchInput"
           type="text"
           data-bind="value:params.searchText, valueUpdate:'afterkeydown'"
           placeholder="Search in titles and contents"
           tabindex="30001" />

    {{#if params.labels().length > 0 || params.statuses().length > 0}}
        <a class="iconized-link-button filter-link-btn mt-5" data-bind="click: toggleExpanded">
            <i class="icon-panel-search-and-filter-filter"></i>
            {{#if isExpanded}}
            <span class="filter-link-text">Hide filters</span>
            {{/if}}
            {{#ifnot isExpanded}}
            <span class="filter-link-text">Show filters</span>
            {{/ifnot}}
        </a>
        
        {{#if filterCount() > 0}}
            <span>{{filterCount}} filters applied</span>
        {{/if}}
    {{/if}}
    
    {{#if isExpanded}}
        <div class="d-flex mt-5">
            {{#if params.labels().length > 0}}
            <div style="width: 50%">
                <div class="filter-section-header">Labels</div>
                {{#foreach params.labels}}
                <label class="styled-check-label ellipsis" style="display: block;">
                    <input type="checkbox" value="{{Id}}" data-bind="checked: $parent.params.filterLabelIds, checkbox:true" />
                    <span>{{Name}}</span>
                </label>
                {{/foreach}}
            </div>
            {{/if}}

            {{#if params.statuses().length > 0}}
            <div style="width: 50%">
                <div class="filter-section-header">Statuses</div>
                {{#foreach params.statuses}}
                <label class="styled-check-label ellipsis" style="display: block;">
                    <input type="checkbox" value="{{Id}}" data-bind="checked: $parent.params.filterStatusIds, checkbox:true" />
                    <span>{{Name}}</span>
                </label>
                {{/foreach}}
            </div>
            {{/if}}
        </div>
        <div>
            <a class="button btn-action-primary" data-bind="clickAndStop: saveFilters">Save filter</a>
            &nbsp;
            <a class="button btn-action-primary2" data-bind="clickAndStop: resetFilters">Reset</a>
        </div>
    {{/if}}

</div></script>
<script type="text/html" id="jiraoauth2connector"> <button class="btn-action" data-bind="click: connect">Connect to Jira</button></script>
<script type="text/html" id="mainnotificationpanel"> {{#if params.isOpened}}
<user-notifications-panel params="
        isOpened: params.isOpened,
        isFullSize: true,
        elementId: 'storymap-user-notification-panel',
        onClose: params.onClose,
        notifications: notifications,
        isCommentingEnabledCallback: canCommentOnStorymap,
        onDismissAll: onDismissAll,
        trackNotificationPanel: 'track.UserDashboardNotifications',
        trackDirectMessagePanel: 'track.UserDashboardDirectMessageNotifications',
        
        actions: {
            onDismiss: onDismiss,
            onOpenCard: onOpenCard,
            onOpenStorymap: onOpenStorymap,
            onReply: onReply
        }">
</user-notifications-panel>
{{/if}}</script>
<script type="text/html" id="movestorymap"> <modal params="{
       title: 'Transfer storymap',
       isOpen: isOpen,
       type: 'confirmation',
       class: 'move-storymap-confirm'
    }">

    <div class="header">Transfer story map</div>
    {{#if canMoveStorymapToOtherWorkspace }}
    <div class="content">
        <div>
            <div class="confirm-messages">
                You can transfer your story map to any <strong>non-trial</strong> workspace, where you have the necessary permissions to create one.<br>
                <span class="warning-text">The story map won't be accessible on it's current URL, so please notify all collaborators of the change!</span><br />
                <span class="warning-text">The global persona assignments, collaborators and the integration settings will be permanently deleted, you must set them up again!</span><br />
                <span class="warning-text">Transferring a story map to a BASIC plan workspace will remove the workflow settings and restore default states (Todo/Doing/Ready/Done).</span><br />
                After the operation you will be redirected to the dashboard.
            </div>

            <div class="control-group move-to-workspace">
                <div class="control">
                    <label>
                        To which workspace would you like to transfer your story map?
                    </label>
                    <select data-bind="
                            options: otherManagedWorkspaces, 
                            optionsText: 'workspaceName', 
                            value: workspaceToMoveStorymap, 
                            select: true, 
                            optionsAfterRender: setTrialWorkspacesDisabled, 
                            optionsCaption: 'Please choose a workspace'"></select>
                </div>
                <div class="control">
                    <span class="validation-message" data-bind="validationMessage: workspaceToMoveStorymap"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <button class="btn-action-primary" data-bind="inlineConfirm: ['Transfer story map', 'Are you really sure?', 'Transferring story map...'], submitFunction: moveStorymap, showTimer: 'true'"></button>
        <button class="btn-action" data-bind="click: close">Cancel</button>
    </div>
    {{/if}}

    {{#ifnot canMoveStorymapToOtherWorkspace() }}
    <div class="content">
        <div>
            <div class="confirm-messages">
                Sorry, but you can't transfer this story map into an another workspace. There are no other workspaces where you have story map creation permission.
            </div>
        </div>
    </div>
    <div class="footer">
        <button class="btn-action" data-bind="click: close">Close</button>
    </div>
    {{/if}}
</modal></script>
<script type="text/html" id="multiselectionpanel"> <sliding-panel params="
        title: 'Edit multiple cards',
        elementId: 'multi-selection-panel',
        isFullSize: params.isFullSize,
        isOpened: storeProps.hasMultiselectedCards,
        onClose: onClose">

    <div>
        {{ selectedCards().length }} card(s) selected

        {{#if sumEstimation() > 0}}
        <div class="mt-5">
            Aggregated estimation: 
            {{sumEstimation}} {{parentModel.storymapEstimationUnit}}
            {{#if numberOfUnestimatedCards() > 0}}
            ({{numberOfUnestimatedCards}} not estimated)
            {{/endif}}
        </div>
        {{/if}}
    </div>
    <div class="mt-10">What would you like to change on them?</div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('MOVE')}">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sort" class="svg-inline--fa fa-sort fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.9 17-41z"></path></svg>
            <span>
                Move cards to
                <span class="font-weight-bold"> a release</span>
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'MOVE'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        <select data-bind="options: releases,
                       optionsText: getTrimmedReleaseName,
                       value: selectedRelease,
                       optionsCaption: 'Choose...',
                        select: true"></select>

                        <button class="button btn-action-primary mt-10"
                                data-bind="
                            enable: selectedRelease() != null,
                            clickAndStop: moveSelectedCards,
                            triggerClickOnEnter: true">
                            Move selected card(s)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('COLOR')}">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="palette" class="svg-inline--fa fa-palette fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"></path></svg>
            <span>
                Change card(s) colors
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'COLOR'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">

                        <ul class="multiselect-container dropdown-menu" style="display: block;">
                            {{#foreach: colorMappings}}
                            <li class="mt-5 pointer" data-bind="visible: isEnabled(), click: function() { $parent.setSelectedColor(color()); }">
                                <div data-bind="css: colorClass">
                                    <div class="color-box-checkmark" data-bind="visible: $parent.selectedColor() == color()"></div>
                                </div>
                                <span>
                                    {{colorLabel}}
                                </span>
                            </li>
                            {{/foreach}}
                        </ul>

                        <div>
                            <button class="button btn-action-primary mt-10"
                                    data-bind="
                            enable: selectedColor() != null,
                            clickAndStop: changeColors,
                            triggerClickOnEnter: true">
                                Change color
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('ADD_ANNOTATION')}">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tag" class="svg-inline--fa fa-tag fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg>
            <span>
                Add annotation
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'ADD_ANNOTATION'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        {{#foreach availableAnnotations}}
                        <div class="item pointer" data-bind="click: () => $parent.toggleAnnotation($data.id)">
                            <span class="annotation-checkbox">
                                <i class="mr-5" data-bind="classes: $parent.getAnnotationCheckboxClass($data.id)"></i>
                            </span>
                            {{#if: isEmoji }}
                            <span class="annotation-icon" data-bind="text: emoji"></span>
                            {{/if}}

                            {{#ifnot: isEmoji }}
                            <span data-bind="class: {name: iconClass}"></span>
                            {{/ifnot}}

                            <span class="annotation-name">{{name}}</span>
                        </div>
                        {{/foreach}}

                        <div>
                            <button class="button btn-action-primary mt-10"
                                    data-bind="
                                    enable: selectedAnnotations().length,
                            clickAndStop: addAnnotations,
                            triggerClickOnEnter: true">
                                Add annotation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('REMOVE_ANNOTATION')}">
            <svg style="transform: scale(1.4) translateX(-4px);" width="719" height="646" viewBox="0 0 719 646" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_506_26)"><mask id="mask0_506_26" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="-87" y="-144" width="941" height="1006"><path d="M-87 145.143L284.152 -144L539.617 183.922L168.465 473.065L-87 145.143Z" fill="#FF0B0B" /><path d="M226.519 533.339L597.671 244.196L853.136 572.118L481.984 861.261L226.519 533.339Z" fill="#FF0B0B" /></mask><g mask="url(#mask0_506_26)"><path d="M136.519 330.314V126.196C136.519 99.6858 158.009 78.1958 184.519 78.1958H388.637C401.367 78.1959 413.576 83.253 422.578 92.2548L634.46 304.137C653.205 322.882 653.205 353.274 634.46 372.019L430.342 576.137C411.597 594.882 381.205 594.882 362.46 576.137L150.578 364.255C141.576 355.253 136.519 343.044 136.519 330.314V330.314ZM248.519 142.196C222.009 142.196 200.519 163.686 200.519 190.196C200.519 216.706 222.009 238.196 248.519 238.196C275.029 238.196 296.519 216.706 296.519 190.196C296.519 163.686 275.029 142.196 248.519 142.196Z" fill="currentColor" /></g><path d="M63.0513 562.397C68.1243 568.946 77.5461 570.143 84.0954 565.07L673.706 108.366C680.255 103.293 681.452 93.8717 676.379 87.3224L656.032 61.0545C650.959 54.5051 641.537 53.3083 634.988 58.3814L45.3777 515.085C38.8283 520.158 37.6316 529.58 42.7046 536.129L63.0513 562.397Z" fill="currentColor" /></g><defs><clipPath id="clip0_506_26"><rect width="719" height="646" fill="white" /></clipPath></defs></svg>

            <span>
                Remove annotation
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'REMOVE_ANNOTATION'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        {{#foreach removableAnnotations}}
                        <div class="item pointer" data-bind="click: () => $parent.toggleAnnotationToRemove($data.id)">
                            <span class="annotation-checkbox">
                                <i class="mr-5" data-bind="classes: $parent.getAnnotationToRemoveCheckboxClass($data.id)"></i>
                            </span>
                            {{#if: isEmoji }}
                            <span class="annotation-icon" data-bind="text: emoji"></span>
                            {{/if}}

                            {{#ifnot: isEmoji }}
                            <span data-bind="class: {name: iconClass}"></span>
                            {{/ifnot}}

                            <span class="annotation-name">{{name}}</span>
                        </div>
                        {{/foreach}}

                        {{#if removableAnnotations().length == 0}}
                        No annotations on the selected cards
                        {{/if }}

                        <div>
                            <button class="button btn-action-primary mt-10"
                                    data-bind="
                                    enable: selectedAnnotationsToRemove().length,
                            clickAndStop: removeAnnotations,
                            triggerClickOnEnter: true">
                                Remove annotation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('ADD_PERSONA')}">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user" class="svg-inline--fa fa-user fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"></path></svg>
            <span>
                Add persona
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'ADD_PERSONA'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        {{#foreach availablePersonas}}
                        <div class="item pointer persona-row" data-bind="click: () => $parent.togglePersona($data.id)">
                            <span class="annotation-checkbox">
                                <i class="mr-5" data-bind="classes: $parent.getPersonaCheckboxClass($data.id)"></i>
                            </span>
                            <img class="persona-icon" data-bind="attr: { src: $data.picture().path }" />
                            <span class="annotation-name">{{$data.name|fit:40}}</span>
                        </div>
                        {{/foreach}}

                        <div>
                            <button class="button btn-action-primary mt-10"
                                    data-bind="
                                    enable: selectedPersonas().length,
                            clickAndStop: addPersonas,
                            triggerClickOnEnter: true">
                                Add personas
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('REMOVE_PERSONA')}">
            <svg style="transform: scale(1.2) translateX(-4px);" xmlns="http://www.w3.org/2000/svg" width="640" height="512" viewBox="0 0 640 512" fill="currentColor"><path fill="currentColor" d="M6.23268 458.1L277.731 248.3C227.932 230.7 192.032 183.8 192.032 128C192.032 57.3 249.331 0 320.031 0C387.131 0 441.53 51.8 446.93 117.4L594.53 3.4C601.53 -2 611.53 -0.8 617.03 6.2L636.629 31.4C642.029 38.4 640.829 48.4 633.829 53.8L45.4325 508.5C38.4325 513.9 28.4326 512.7 22.9326 505.7L3.33267 480.4C-2.0673 473.6 -0.767284 463.5 6.23268 458.1V458.1ZM544.03 422.4V464C544.03 490.5 522.53 512 496.03 512H145.832L432.631 290.3C495.83 301.3 544.03 356 544.03 422.4Z" /></svg>
            <span>
                Remove persona
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'REMOVE_PERSONA'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        {{#foreach removablePersonas}}
                        <div class="item pointer persona-row" data-bind="click: () => $parent.togglePersonaToRemove($data.id)">
                            <span class="annotation-checkbox">
                                <i class="mr-5" data-bind="classes: $parent.getPersonaToRemoveCheckboxClass($data.id)"></i>
                            </span>

                            <img class="persona-icon" data-bind="attr: { src: $data.picture().path }" />
                            <span class="annotation-name">{{$data.name|fit:40}}</span>
                        </div>
                        {{/foreach}}

                        {{#if removablePersonas().length == 0}}
                        No personas on the selected cards
                        {{/if }}

                        <div>
                            <button class="button btn-action-primary mt-10"
                                    data-bind="
                                    enable: selectedPersonasToRemove().length,
                            clickAndStop: removePersonas,
                            triggerClickOnEnter: true">
                                Remove personas
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {{#if parentModel.isIntegrationEnabled}}
<div data-bind="click: pushSelectedCards, css: { 'inProgress' : isPushingInProgress }" class="d-flex align-items-center multiselect-item-wrapper mt-20 pa-10 pointer push-cards">
    {{#if parentModel.integrationToolName() == "Trello"}}
    <svg fill="#3485D2" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="trello" class="svg-inline--fa fa-trello fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M392.3 32H56.1C25.1 32 0 57.1 0 88c-.1 0 0-4 0 336 0 30.9 25.1 56 56 56h336.2c30.8-.2 55.7-25.2 55.7-56V88c.1-30.8-24.8-55.8-55.6-56zM197 371.3c-.2 14.7-12.1 26.6-26.9 26.6H87.4c-14.8.1-26.9-11.8-27-26.6V117.1c0-14.8 12-26.9 26.9-26.9h82.9c14.8 0 26.9 12 26.9 26.9v254.2zm193.1-112c0 14.8-12 26.9-26.9 26.9h-81c-14.8 0-26.9-12-26.9-26.9V117.2c0-14.8 12-26.9 26.8-26.9h81.1c14.8 0 26.9 12 26.9 26.9v142.1z"></path></svg>
    {{/if}}
    {{#if parentModel.integrationToolName() == "Jira"}}
    <svg fill="#3485D2" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="jira" class="svg-inline--fa fa-jira fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M490 241.7C417.1 169 320.6 71.8 248.5 0 83 164.9 6 241.7 6 241.7c-7.9 7.9-7.9 20.7 0 28.7C138.8 402.7 67.8 331.9 248.5 512c379.4-378 15.7-16.7 241.5-241.7 8-7.9 8-20.7 0-28.6zm-241.5 90l-76-75.7 76-75.7 76 75.7-76 75.7z"></path></svg>
    {{/if}}
    {{#if parentModel.integrationToolName() == "Pivotal Tracker"}}

    <svg fill="#3485D2" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve">
    <title>pivotaltracker</title>
    <path d="M16,0C7.2,0,0,7.2,0,16c0,8.8,7.2,16,16,16c8.8,0,16-7.2,16-16C32,7.2,24.8,0,16,0z M16,3.2C23,3.2,28.8,9,28.8,16
	C28.8,23,23,28.8,16,28.8C9,28.8,3.2,23,3.2,16C3.2,9,9,3.2,16,3.2z M15.8,5l-4.1,2.3v0l3.6,6.2c0.6-0.2,1.2-0.1,1.7,0.2l1.9-3.3
	L15.8,5z M21.4,8l-3.6,6.2c0.4,0.4,0.7,1,0.7,1.6h3.8l3.1-5.4L21.4,8z M6.4,10.6v4.7h7.2c0.2-0.6,0.5-1.1,1-1.4l-1.9-3.3H6.4z
	 M9.7,16.2l-3.1,5.4l4.1,2.4l3.6-6.2c-0.4-0.4-0.7-1-0.7-1.6L9.7,16.2z M18.5,16.7c-0.2,0.6-0.5,1.1-1,1.4l1.9,3.3h6.3v-4.7H18.5
	L18.5,16.7z M14.9,18.3L13,21.6l3.1,5.4l4.1-2.3l-3.6-6.2C16.1,18.6,15.5,18.6,14.9,18.3L14.9,18.3z" />
    </svg>
    {{/if}}
    {{#if parentModel.integrationToolName() == "GitHub"}}
    <svg fill="#3485D2" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
    {{/if}}
    {{#if parentModel.integrationToolName() == "TFS"}}
    <svg fill="#3485D2" xmlns="http://www.w3.org/2000/svg" width="2419" height="2500" viewBox="-0.002 -0.003 500.002 516.812"><path d="M483.292 64.07L372.104 19.499l-194.08 189.002-116.873-88.967-44.441 22.351-.044 233.313 44.232 22.189 116.778-88.894 194.557 188.829 111.101-44.397-.042-388.855z" fill="000" stroke="#fff" stroke-width="33.33" /><path d="M361.037 175.128L249.98 258.15l111.101 83.673-.044-166.695zM72.192 208.596l.066 99.858 55.483-50.267-55.549-49.591z" fill="#fff" /></svg>
    {{/if}}
    {{#if parentModel.integrationToolName() == "Azure DevOps"}}
    <svg fill="#3485D2" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
        <path d="M0 11.865l2.995-3.953 11.208-4.557v-3.292l9.828 7.188-20.078 3.896v10.969l-3.953-1.141zM32 5.932v19.536l-7.672 6.531-12.401-4.073v4.073l-7.974-9.885 20.078 2.396v-17.26z" />
    </svg>
    {{/if}}

    {{#if isPushingInProgress }}
    {{numberOfCardsAlreadyPushed}} of {{numberOfCardsToPush}} card(s) pushed to {{parentModel.integrationToolName}}
    {{/if}}
    {{#ifnot isPushingInProgress }}
    Push selected cards to {{parentModel.integrationToolName}}
    {{/ifnot}}
</div>
    {{/if}}

    <div class="multiselect-item-wrapper mt-20 pa-10">
        <div class="pointer d-flex align-items-center" data-bind="click: function() { setExpandedOption('MOVE_SIDEWAYS')}">
            <svg style="transform: translateX(-5px) rotate(90deg)!important;" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sort" class="svg-inline--fa fa-sort fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.9 17-41z"></path></svg>
            <span>
                Move to another column
            </span>
        </div>
        <div class="mt-10 data-wrapper" data-bind="slideVisible: expandedOption() == 'MOVE_SIDEWAYS'">
            <div class="data-container">
                <div class="data-container-inner">
                    <div class="data description-container">
                        <select data-bind="foreach: activities, value: selectedTaskId, select: true">
                            <optgroup data-bind="attr: {label: name|fit:40}, foreach: tasks">
                                {{#if name}}
                                <option data-bind="attr: {value: id}, text: name|fit:40"></option>
                                {{/if}}
                                {{#ifnot name}}
                                <option data-bind="attr: {value: id}">Empty card</option>
                                {{/ifnot}}
                            </optgroup>
                        </select>

                        <button class="button btn-action-primary mt-10"
                                data-bind="
                            enable: selectedTaskId() != null,
                            clickAndStop: moveSelectedCardsToTask,
                            triggerClickOnEnter: true">
                            Move selected card(s)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div data-bind="click: deleteSelectedCards" class="d-flex align-items-center multiselect-item-wrapper mt-20 pa-10 pointer delete-cards">

        <svg fill="#E50C00" aria-hidden="true" focusable="false" data-prefix="far" data-icon="trash-alt" class="svg-inline--fa fa-trash-alt fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"></path></svg>
        Delete selected cards
    </div>

    <div class="mt-10">
        <a class="button btn-action-primary2" data-bind="clickAndStop: onClose">Clear selection</a>
    </div>

    <div class="mt-5">
        <span class="hint"><span class="keyboard-shortcut">x</span> - clear selection</span>
    </div>
</sliding-panel></script>
<script type="text/html" id="richmarkdowneditor"> <div class="rich-markdown-editor-container">

    {{#if autoSavePlugin && autoSavePlugin.hasSavedText() && !isInEditMode()}}
    <div class="rich-markdown-editor__unsaved-changes">
        <span class="rich-markdown-editor__unsaved-changes__text"><i class="icon-exclamation-triangle orange"></i> you have unsaved changes in card description.</span>
        <div class="rich-markdown-editor__unsaved-changes__buttons">
            <span class="rich-markdown-editor__unsaved-changes__action" data-bind="click: setToEditModeWithNotSavedText">continue editing</span>
            <span class="rich-markdow-editor__unsaved-changes__separator">|</span>
            <span class="rich-markdown-editor__unsaved-changes__action" data-bind="click: dismissNotSavedText">discard</span>
        </div>
    </div>
    {{/if}}

    {{#if isInEditMode() && params.isEditEnabled}}
    <div class="description">
        <new-editor-core params="
                         value: editingValue,
                         id: id,
                         editorMode: 'description',
                         hasMentions: params.hasMentions,
                         toolbarSet: params.toolbarSet,
                         triggerEditorFinishEdit: newEditorFinishEdit,
                         fileUploadConfig: params.fileUploadConfig,
                         addAttachmentConfig: params.addAttachmentConfig,
                         addEmbedConfig: {
                            position: 'bottom'
                         },
                         autoSavePlugin: autoSavePlugin
                         "></new-editor-core>
    </div>
    <div class="editor-buttons">
        <a href="#" class="button btn-action-primary save-btn" data-bind="click: save">Save</a>
        <a href="#" class="button btn-action-primary2 cancel-btn" data-bind="click: cancel">Cancel</a>
        {{#if params.toolbarSet === 'none'}} <!--assuming the toolbar always has a md helper-->
        <span class="markdown-editor-formatting-help" data-bind="css:{ left: false }">
            <a title="<div class=&quot;markdown-help-tip-content&quot;> <br/># Heading1<br/><br/>## Heading2<br/><br/>*Italics* or _Italics_<br/><br/>**Bold** or __Bold__<br/><br/>> This is a block-quote <br/><br/>* Unordered list item 1<br/><br/>1. Ordered list item 1<br/><br/>```javascript<br/>var s = &quot;JavaScript syntax highlighting&quot;;<br/>```<br/><br/>[Link with custom text](http://www.storiesonboard.com)<br/><br/>![alt text](http://url-to-public-image.com/public-image.jpg &quot;title&quot;)<br/><br /><a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble =true;&quot; class=&quot;inline-text-empty-link&quot;  target=&quot;_blank&quot; onmousedown=&quot;return false;&quot;>More formatting options</a><br /><br/></div>" target="_blank" onmousedown=" return false; " onclick=" return false; " data-bind="qtip: { position: params.helperPoz, classes: 'qtip-tipsy qtip-sob qtip-sob-markdownhelp', useWindowViewport : true }" href="https://storiesonboard.uservoice.com/knowledgebase/articles/488687-story-details-formating-options">formatting help</a>
        </span>
        {{/if}}
    </div>
    {{/if}}

    {{#ifnot isInEditMode}}
    {{#if params.isBoardCard && isEmpty() }}
    {{#ifnot storeProps.isViewer}}
    <div class="pa-10 pb-15" style="background: #f9f9f9;" data-bind="click: setToEditMode">
        <div class="mb-10">
            <img class="img-responsive" src="../../../../content/img/card-details-editor-placeholder.png" alt="Editor placeholder" />
        </div>
        <div>
            <span class="inline-block" style="font-size: 13px"><a style="font-size: 13px" href="http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown" target="_blank">Markdown</a> is supported</span>
            <span class="inline-block" style="margin-left: 67px; font-size: 13px;">Vimeo, Figma, Youtube, Prezi...</span>
            <span class="inline-block" style="margin-left: 25px">
                {{#if storeProps.hasStorymapAdminRights}}
                <a style="font-size: 13px" data-bind="click: openTemplateSettings" target="_blank">Open template settings</a>
                {{/if}}
            </span>
        </div>
    </div>
    {{/ifnot}}
    {{/if}}
    {{#if params.isBoardCard == false || isEmpty() === false }}
    <div class="description markdown-view-content" data-bind="css: { hidden: shouldHideDescription }, click: setToEditMode, megamark:{value: value, emptyText: emptyText, shouldHideDescription: shouldHideDescription}"></div>
    {{/if}}
    {{/ifnot}}
</div></script>
<script type="text/html" id="roadmapdropdown"> <span>
    <a class="btn-action-primary button roadmap-dropdown-btn" data-bind="btnClick: onClick">
        Roadmaps
    </a>
</span>

<context-menu params="{isOpen: isDropdownOpen, direction: 'bottom'}">
    <div class="menu-content">
        {{#if isLoading }}
        loading...
        {{/if}}

        {{#ifnot isLoading }}
        {{#ifnot roadmaps().length === 0}}
        <ul>
            <li class="small-section-title">
                LINKED ROADMAPS
            </li>
            {{#foreach roadmaps}}
            <li class="dropdown-menu-item">
                <a href="/roadmap/{{id}}" target="_blank">{{name}}</a>
            </li>
            {{/foreach}}
            {{#ifnot storeProps.isViewer }}
            <li>
                <hr />
            </li>

            <li class="dropdown-menu-item">
                <a href="/{{storeProps.productSlug}}/newroadmapfromstorymap/{{storeProps.storymapId}}" target="_blank">+ Create new roadmap from this board</a>
            </li>

            {{/ifnot}}

        </ul>
        {{/ifnot}}


        {{#ifnot roadmaps().length > 0}}
        <div class="pa-10">
            <div class="roadmaps-emtpy--text">No linked roadmaps</div>
            <div class="roadmaps-empty--img mt-10" style="max-width: 50%">
                <img class="img-responsive" src="../../../../content/img/roadmaps-empty.png" />
            </div>
            <div class="roadmaps-emtpy--text mt-10">Create a roadmap to schedule and track iterations.</div>

            {{#if storeProps.isViewer }}
            <div class="mt-10" style="font-size: 12px; color: #6E6E6E;">Only story map editors can create roadmaps</div>
            {{/if}}

            {{#ifnot storeProps.isViewer }}
            <a href="/{{storeProps.productSlug}}/newroadmapfromstorymap/{{storeProps.storymapId}}" class="roadmaps-empty--cta mt-10 btn-action-primary button">Create roadmap</a>
            {{/ifnot}}
        </div>
        {{/ifnot}}

        {{/ifnot}}
    </div>
</context-menu></script>
<script type="text/html" id="signuponboardingmodal"> <modal params="{
       title: currentStep().title,
       isOpen: isOpen,
       disableClosingFromUi: true
    }">

    <img class="stob-logo" alt="logo" src="../../../content/img/stob-logo.png">

    <div data-bind="component: {
         name: currentStep().componentStr,
         params: {
            onNext: onNext,
            onBack: onBack,
            onGoLastPage: onGoLastPage,
            onCloseModal: onCloseModal,
            data: currentStep().data
         }
    }"></div>
</modal></script>
<script type="text/html" id="signuponboardingmodalpage1"> <div class="sign-up-onboarding-modal-page-1">

    <div>Before we start, can you tell us a bit more about yourself?</div>

    <div class="line">
        <div class="half">
            <span class="texting">I'm a(n)</span>
            <select data-bind="options: roles, value: params.data.role, optionsText: 'displayText', optionsValue: 'value', optionsCaption: '', select: true"></select>
        </div>
        <div class="half right">
            <span class="texting">at a(n)</span>
            <select data-bind="options: companyType, value: params.data.companyType, optionsText: 'displayText', optionsValue: 'value', optionsCaption: '', select: true"></select>
        </div>
    </div>

    <div class="line">
        <div class="half">
            <span class="texting">working on</span>
            <select data-bind="options: productType, value: params.data.productType, optionsText: 'displayText', optionsValue: 'value', optionsCaption: '', select: true"></select>
        </div>
        <div class="half right">
            <span class="texting">with</span>
            <select data-bind="options: teamType, value: params.data.teamType, optionsText: 'displayText', optionsValue: 'value', optionsCaption: '', select: true"></select>
        </div>
    </div>

    <div class="line">
        <span class="texting">using</span>
        <select data-bind="options: projectManagementTool, value: params.data.projectManagementTool, optionsText: 'displayText', optionsValue: 'value', optionsCaption: '', select: true"></select>
        <span class="texting closing-texting">as our project management tool</span>
    </div>
    
    <div class="validation" data-bind="visible: !canGoNext() && hasClickedNext()">
        Please fill in the form to continue...
    </div>

    <div class="bottom">
        <hint>We'll use this to share hints and best practices especially for you.</hint>
        <button class="btn-action-primary" data-bind="click: onNext, css: {'disabled': !canGoNext()}">Next</button>
    </div>

</div>
</script>
<script type="text/html" id="signuponboardingmodalpage2"> <div class="sign-up-onboarding-modal-page-2">

    <div>Please tell a bit about your experience in User Story Mapping</div>

    <div data-bind="foreach: experienceLevels">
        <div class="experience-description" data-bind="click: $component.onExperienceClick, css: {'chosen': value() === $component.params.data.experience()}">{{ text }}</div>
    </div>

    <div class="validation" data-bind="visible: !canGoNext() && hasClickedNext()">
        Please choose an option from the list above.
    </div>

    <div class="bottom">
        <div>
            <hint>We'll use this to share hints and best practices especially for you.</hint>
            <a class="back-link" data-bind="click: params.onBack">back</a>
        </div>
        <button class="btn-action-primary" data-bind="click: onNext, css: {'disabled': !canGoNext()}">Next</button>
    </div>

</div></script>
<script type="text/html" id="signuponboardingmodalpage3"> <div class="sign-up-onboarding-modal-page-3">

    <div>What are you interested in?</div>

    <div class="section" data-bind="with: params.data.interests">
        <div class="half">
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: userStoryMapping.value}">
                    <span>{{ userStoryMapping.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: planningReleases.value}">
                    <span>{{ planningReleases.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: internalStakeholderCommunicator.value}">
                    <span>{{ internalStakeholderCommunicator.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: sprintPlanning.value}">
                    <span>{{ sprintPlanning.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: communicateBigPicture.value}">
                    <span>{{ communicateBigPicture.label }}</span>
                </label>
            </div>
        </div>
        <div class="half">
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: remoteTeamwork.value}">
                    <span>{{ remoteTeamwork.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: customerCommunication.value}">
                    <span>{{ customerCommunication.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: backlogManagement.value}">
                    <span>{{ backlogManagement.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: improvingTransparency.value}">
                    <span>{{ improvingTransparency.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: prioritizingWork.value}">
                    <span>{{ prioritizingWork.label }}</span>
                </label>
            </div>
        </div>
    </div>

    <div class="shared-with-section-title">Who do you plan to use StoriesOnBoard together?</div>

    <div class="section" data-bind="with: params.data.sharedWith">
        <div class="half">
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: uiDesigner.value}">
                    <span>{{ uiDesigner.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: coach.value}">
                    <span>{{ coach.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: managers.value}">
                    <span>{{ managers.label }}</span>
                </label>
            </div>
        </div>
        <div class="half">
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: devTeam.value}">
                    <span>{{ devTeam.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: clients.value}">
                    <span>{{ clients.label }}</span>
                </label>
            </div>
            <div class="checkbox-with-label">
                <label>
                    <input type="checkbox" data-bind="checkbox: {checked: marketing.value}">
                    <span>{{ marketing.label }}</span>
                </label>
            </div>
        </div>
    </div>

    <div class="bottom">
        <div>
            <hint>We'll use this to share hints and best practices especially for you.</hint>
            <a class="back-link" data-bind="click: params.onBack">back</a>
        </div>
        <button class="btn-action-primary" data-bind="click: params.onGoLastPage">Get started</button>
    </div>

</div></script>
<script type="text/html" id="signuponboardingmodalpage4"> <div class="sign-up-onboarding-modal-page-4">

    <div class="main">
        <deck-card params="
              onClick: goToCreateSampleStorymap,
              title: 'Start with our example map',
              description: 'Quick overview of a story map with top-notch hints and tricks',
              iconUrl: '../../../content/img/example-map-icon.svg'"></deck-card>
        <deck-card params="
              onClick: goToCreateNewStorymap,
              title: 'Create a new map from scratch',
              description: 'Start mapping your own product',
              iconUrl: '../../../content/img/new-map-icon.svg'"></deck-card>
        <deck-card params="
              onClick: openVideo,
              title: 'See StoriesOnBoard in action',
              description: 'Watch our short product tour',
              iconUrl: '../../../content/img/video-icon.svg'"></deck-card>
    </div>

    <div class="trailer-embed" style="display: none;">
        <a href="" class="close" data-bind="click: params.onCloseModal"></a>
        <div class="trailer-overlay"></div>
    </div>

    <div class="bottom">
        <a data-bind="click: params.onCloseModal">Close</a>
    </div>
</div>
</script>
<script type="text/html" id="storymapchooser"> <!--<div>{{ storeProps.collectionName }}</div>-->

<div class="chosen-storymap">
    <div class="chosen-storymap-inside" data-bind="css: {'story-map-name-with-collection-name': shouldShowCollectionName, 'clickable': isStorymapChooserVisible }, click: onClick">
        <div class="stoymap-name-with-toggler">
            <div class="storymap-name">{{ storeProps.storymapName }}</div>
            {{#if isStorymapChooserVisible}}
            <span class="toggler"></span>
            {{/if}}
        </div>
        {{#if shouldShowCollectionName}}
        <div class="collection-name-container">
            <div>in</div>
            <div class="collection-name">{{ storeProps.collectionName }}</div>
            <div>collection</div>
        </div>
        {{/if}}
    </div>
</div>

<context-menu params="{isOpen: isDropdownOpen, direction: 'bottom'}">
    <searchable-list params="
                     items: storymaps,
                     excludedItemsWhenNotSearching: excludeByDefault,
                     searchKey: 'name',
                     initialNumberOfItems: 5,  
                     extendedNumberOfItems: 10,
                     isLoading: isLoading,
                     isLoadingCaption: 'Loading...',
                     searchFieldPlaceholder: 'Search for story maps...',
                     resultListCaption: 'Recent story maps',
                     itemsCaption: 'story maps',
                     noMatchingResultsCaption: 'No matching story maps...',
                     actions: [
		                {caption: '+ Add a new story map', action: goToNewMapCreation, isVisible: storeProps.canCreateStorymap }
                     ]">
        <a class="storymap-link" data-bind="redirect: { url: '/m/' + slug, onNewTabWhenCtrlKey: true, before: function() { app.preloader.show(0); } }">
            <div class="name-of-storymap" data-bind="text: name"></div>
            <div class="collection-name-container">
                {{#if collectionName}}
                <div>in</div>
                <div class="collection-name">{{ collectionName }}</div>
                <div>collection</div>
                {{/if}}
                {{#ifnot collectionName}}
                <div class="no-collection">not in a collection</div>
                {{/ifnot}}
            </div>
        </a>
    </searchable-list>
</context-menu></script>
<script type="text/html" id="storymapname"> {{#ifnot isEdit}}
    <storymap-chooser></storymap-chooser>
{{/ifnot}}

{{#if isEdit}}
    <span class="storymap-name brand edit">
        <input type="text" onfocus="this.select()" data-bind="value: name, event: { blur: save, keyup: onKeyup },  hasFocus: true" />
        {{#if storeProps.collectionName}}
        <div class="collection-name-container">
            in {{storeProps.collectionName}} collection
        </div>
        {{/if}}
    </span>
{{/if}}</script>
<script type="text/html" id="storymapusernotificationpanel"> {{#if params.isOpened}}
<user-notifications-panel params="
        isOpened: params.isOpened,
        isFullSize: params.isFullSize,
        elementId: 'storymap-user-notification-panel',
        onClose: params.onClose,
        notifications: storeProps.notifications,
        isCommentingEnabledCallback: isCommentingEnabledForUser,
        onDismissAll: onDismissAll,
        trackNotificationPanel: 'track.StorymapNotifications',
        trackDirectMessagePanel: 'track.StorymapDirectMessageNotifications',
        actions: {
            onDismiss: onDismiss,
            onSelectCard: onSelectCard,
            onOpenCard: onOpenCard,
            onReply: onReply               
        }">
</user-notifications-panel>
{{/if}}</script>
<script type="text/html" id="storymapnotificationicon"> <icon-with-counter params="
        onClick: params.onClick,
        iconClass: 'icon-storymap-h-notification',
        title: 'Notifications',
        counterValue: storeProps.numberOfNonDismissedNotifications">
</icon-with-counter></script>
<script type="text/html" id="togglefavoritestorymap"> 
{{#if storeProps.shoudShow }}
    {{#if storeProps.isFavorite}}
    <a href="#" class="storymap-header-button"
       data-bind="
                attr: { title: title  },
                qtip: { position: 'bottom', adjustY: 10, delay: 1 },
                click: toggleFavorite">
        <i data-bind="class: { name: iconClass }"></i>
    </a>
    {{/if}}

    {{#ifnot storeProps.isFavorite}}
    <a href="#" class="storymap-header-button"
       data-bind="
                attr: { title: title  },
                qtip: { position: 'bottom', adjustY: 10, delay: 1 },
                click: toggleFavorite">
        <i data-bind="class: { name: iconClass }"></i>
    </a>
    {{/if}}
{{/if}}
</script>
<script type="text/html" id="togglemuteboard"> {{#if storeProps.isMuted}} 
<a href="#" class="storymap-header-button"
   title="Click to unmute notifications of this board"
   data-bind="
        qtip: { position: 'bottom', adjustY: 10, delay: 1 },
        click: toggleMute">
    <i class="icon-mute-board muted"></i>
</a>
{{/if}}
{{#ifnot storeProps.isMuted}}
<a href="#" class="storymap-header-button"
   title="Click to mute all notifications from this board"
   data-bind="
        qtip: { position: 'bottom', adjustY: 10, delay: 1 },
        click: toggleMute">
    <i class="icon-mute-board"></i>
</a>
{{/if}}
</script>
<script type="text/html" id="userstorytemplates"> <sliding-panel params="
        title: 'User story templates',
        elementId: 'ust-panel',
        isFullSize: params.isFullSize,
        isOpened: params.isOpened,
        onClose: params.onClose">

    {{#if canUseFeature }}

    <div class="ust-info-section">
        Save time on writing recurring texts into descriptions. Set up a user story template to add same text to newly created story cards. <a href="https://docs.storiesonboard.com/en/articles/6205979-user-story-templates" target="_blank">Learn more.</a>
    </div>

    <div class="control-group mt-20" style="padding-bottom: 0;">
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: {checked: isStoryTemplateEnabled}" />
                <span>User story cards (white cards)</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control" style="background: #eff1f5;" data-bind="style: {'padding': storyTemplate() ? '10px' : '0'}">
            <inline-extra-markdown params="
                                   value: storyTemplate,
                                   emptyText: function() { return !$root.currentUserIsViewer() ? 'Click to add story template. <a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot; onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;&quot; class=&quot;inline-text-empty-link&quot;>Markdown</a> is supported!' : '' },
                                   isEditEnabled: !$root.currentUserIsViewer(),
                                   onEndEdit: saveSettings
                                   isInEditMode: $data.isStoryTemplateEditing,
                                   helperPoz: 'left' ">
            </inline-extra-markdown>
        </div>
    </div>

    <div class="control-group mt-20" style="padding-bottom: 0;">
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: {checked: isActivityTemplateEnabled}" />
                <span>1st level cards (blue cards)</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control" style="background: #eff1f5;" data-bind="style: {'padding': activityTemplate() ? '10px' : '0'}">
            <inline-extra-markdown params="
                                   value: activityTemplate,
                                   emptyText: function() { return !$root.currentUserIsViewer() ? 'Click to add 1st level card template. <a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot; onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;&quot; class=&quot;inline-text-empty-link&quot;>Markdown</a> is supported!' : '' },
                                   isEditEnabled: !$root.currentUserIsViewer(),
                                   onEndEdit: saveSettings
                                   isInEditMode: $data.isActivityTemplateEditing,
                                   helperPoz: 'left' ">
            </inline-extra-markdown>
        </div>
    </div>

    <div class="control-group mt-20" style="padding-bottom: 0;">
        <div class="control">
            <label>
                <input type="checkbox" data-bind="checkbox: {checked: isTaskTemplateEnabled}" />
                <span>2nd level cards (yellow cards)</span>
            </label>
        </div>
    </div>

    <div class="control-group">
        <div class="control" style="background: #eff1f5;" data-bind="style: {'padding': taskTemplate() ? '10px' : '0'}">
            <inline-extra-markdown params="
                                   value: taskTemplate,
                                   emptyText: function() { return !$root.currentUserIsViewer() ? 'Click to add 2nd level card template. <a target=&quot;_blank&quot; href=&quot;http://docs.storiesonboard.com/getting-started/essential-functions/story-details-formatting-options-using-markdown&quot; onclick=&quot;if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;&quot; class=&quot;inline-text-empty-link&quot;>Markdown</a> is supported!' : '' },
                                   isEditEnabled: !$root.currentUserIsViewer(),
                                   onEndEdit: saveSettings
                                   isInEditMode: $data.isTaskTemplateEditing,
                                   helperPoz: 'left' ">
            </inline-extra-markdown>
        </div>
    </div>
    {{/if}}

    {{#ifnot canUseFeature}}
    <div class="ust-info-section">
        Save time on writing recurring text into descriptions. User story templates allows you to create an initial structure of user story cards. <a href="https://docs.storiesonboard.com/en/articles/6205979-user-story-templates" target="_blank">Learn more.</a>
    </div>

    <div class="ust-info-section mt-10">
        User story templates are available on Standard Plan or above.
    </div>
    
    <div class="ust-info-section mt-10">
        <a class="button btn-action-primary" href="{{globalConfig.appUrl}}/managesubscription" target="_blank" data-bind="userRole:'SubscriptionAdmin'">Upgrade plan</a>
    </div>
    {{/ifnot}}
</sliding-panel></script>
<script type="text/html" id="weblinkadder">  <context-menu params="isOpen: params.isOpen, direction: 'bottom'">
    <a class="btn-icon" data-bind="click: params.onClose">
        <i class="icon-close-dialog"></i>
    </a>
    <div class="control-group weblink-form">
        <div class="control link">
            <label>{{linkLabel}}</label>
            <input type="text" name="link" data-bind="value: link, valueUpdate: 'keyup', hasFocus: true, enterKey: save, escKey: cancel" placeholder="{{linkPlaceholder}}" />
            <span class="validation-message" data-bind="validationMessage: link"></span>
        </div>
        {{#ifnot hideLinkNameField }}
        <div class="control link-name">
            <label>Link name (optional)</label>
            <input type="text" name="linkName" data-bind="value: linkName, valueUpdate: 'keyup', enterKey: save, escKey: cancel" />
            <span class="validation-message" data-bind="validationMessage: linkName"></span>
        </div>
        {{/ifnot}}

        {{#if params.config.shouldShowEmbedHelp}}
    <div class="control">
        Embed your mockups, product videos or other resources:

        <div class="brand-icon-containter">
            <img src="../../../../content/img/icons/Figma-Icon.svg" width="15px" alt="Figma" data-bind="qtip:{ position: 'bottom' }" title="Figma" />
            <img src="../../../../content/img/icons/yt_icon_rgb.png" width="26px" alt="Youtube" data-bind="qtip:{ position: 'bottom' }" title="Youtube" />
            <img src="../../../../content/img/icons/vimeo_icon_white_on_blue_rounded.jpg" width="20px" alt="Vimeo" data-bind="qtip:{ position: 'bottom' }" title="Vimeo" />
            <img src="../../../../content/img/icons/Prezi-logo-blue.svg" width="60px" alt="Prezi" data-bind="qtip:{ position: 'bottom' }" title="Prezi" />
        </div>
    </div>
        
        
        {{/if}}
    </div>
    <div class="buttons">
        <a class="btn btn-action-primary button" data-bind="btnClick: save"><span>{{buttonLabel}}</span></a>
    </div>
</context-menu></script>
<script type="text/html" id="workflowsettings"> <modal params="{
       title: title,
       isOpen: isOpen,
       type: 'default',
       class: 'large'
    }">

    <!--<div class="header">Workflow Settings</div>-->
    {{#if canUseFeature }}



    <div class="workflow-settings d-flex justify-content-between">


        <!--Categories-->
        {{#foreach statusCategories}}
        <status-category params="statusCategory: $data"></status-category>
        {{/foreach}}
    </div>

    <div>
        <p>
            Your <span class="font-weight-bold">Default state</span> is the first item of the To Do category. New user stories will get the default state.
        </p>
        <p class="mt-5">
            You need the have at least one state in each category.
        </p>
        <p class="mt-5">
            <a href="https://docs.storiesonboard.com/en/articles/5781670-custom-workflow" target="_blank">Learn more about the custom workflow.</a>
        </p>
    </div>

    {{/if}}
    {{#ifnot canUseFeature }}
    <div class="mt-15">Tailor workflow settings to your needs by creating custom states.</div>
    <img class="img-responsive" src="{{globalConfig.appUrl}}/content/img/customworkflow.png" alt="Custom workflow" />
    <div class="mt-10">
        Custom workflow available on Standard Plan or above.
        <a class="button btn-action-primary" href="{{globalConfig.appUrl}}/managesubscription" target="_blank" data-bind="userRole:'SubscriptionAdmin'">Upgrade plan</a>
    </div>
    {{/if}}
</modal>
<delete-status-dialog></delete-status-dialog></script>
<script type="text/html" id="deletestatusdialog"> <modal params="{
       title: 'Confirmation',
       isOpen: isOpen,
       type: 'confirmation',
       class: ''
    }">

    <div class="header">Confirmation</div>

    <div class="content">
        <div class="mt-10">
            Are you sure you want to delete the '{{statusToDelete().name}}' state?
        </div>
        {{#if isInUse}}
        <div class="mt-10">
            This status may be in use on cards or integration. Please select a new state for these items:
        </div>
        <div class="mt-10 dropdown-menu" data-bind="dropdownmenu: true">
            <a href="#" data-bind="stopPropagation: true" class="trigger">
                <div class="d-flex align-items-center" style="padding: 5px; border: 1px solid #E9E9EB; background: white; min-width: 100px; justify-content: space-between;">
                    <span class="small-font board-subtask-statuses-menu-selected-option"
                          style="color: white; left: 0; padding: 3px 6px; border-radius: 2px; position: static;"
                          data-bind="style: { 'background-color': selectedStatus().color } ,text: selectedStatus().name | fit:30"></span>
                    <i class="ml-5 delete-dropdown-icon"></i>
                </div>
            </a>
            <div class="menu-content left-aligned">
                <ul data-bind="foreach: choosableStatuses">
                    <li class="status-menu-item d-flex align-items-center pointer" data-bind="dropdownmenuClick: () => $parent.selectedStatus($data)">
                        <div class="status-menu-item__color-box"
                             data-bind="css: { 'bordered': color().toLowerCase() == '#ffffff'}, style: { 'background-color': color }"></div>
                        <a class="ml-5 mr-5" data-bind="text: name"></a>
                    </li>
                </ul>
            </div>
        </div>
        {{/if}}
    </div>

    <div class="footer">
        <button class="btn-action-primary" data-bind="click: deleteStatus">Delete status</button>
        <button class="btn-action" data-bind="click: close">Cancel</button>
    </div>
</modal></script>
<script type="text/html" id="statuscategory"> <div>
    <div class="status-category__header">
        {{params.statusCategory.name}}
    </div>

    {{#foreach statuses}}
    <status-item params="
         status: $data,
         shouldShowDeleteStatusButton: $parent.shouldShowDeleteStatusButton"></status-item>
    {{/foreach}}


    <div class="mt-10 ml-20 addStatus">

        {{#if isInAddingState}}
            <input type="text" data-bind="textInput: newStatusName, focus: true, event: {blur: saveNewStatus}, enterKey: saveNewStatus" />
        {{/if}}

        {{#ifnot isInAddingState}}
            <a class="status-category__add" data-bind="click: addStatus">+ add new status</a>
        {{/ifnot}}
    </div>
</div></script>
<script type="text/html" id="statusitem"> <div class="status-item d-flex align-items-center mt-10">
    <!--<div class="status-item__color"
         data-bind="css: { 'bordered': statusColor().toLowerCase() == '#ffffff'}, style: { 'background-color': statusColor }"></div>-->
    
    <div class="dropdown-menu" data-bind="dropdownmenu: true">
        <a href="#" data-bind="stopPropagation: true" class="trigger">
            <div class="status-item__color mr-5"
                 data-bind="css: { 'bordered': statusColor().toLowerCase() == '#ffffff'}, style: { 'background-color': statusColor }"></div>
        </a>
        <div class="status-item__color-picker menu-content left-aligned">
            <ul data-bind="foreach: colors">
                <li><a class="status-item__color-picker__color" data-bind="dropdownmenuClick: function () { $parent.setColor($data); }, style: { 'background-color': $data }"></a></li>
            </ul>
        </div>
    </div>

    {{#ifnot isNameEditing}}
        <div class="status-item__name d-flex align-items-center" style="min-width: 0;">
            <div style="min-width: 0; word-break: break-all;">{{statusName}}</div> <i class="icon-storymap-bc-edit-title" data-bind="click: editName" style="flex-shrink: 0;"></i>
        </div>
        <div class="status-item__buttons ml-auto" style="flex-shrink: 0;">
            <i class="icon-chevron-up pointer" data-bind="click: moveUp"></i>
            <i class="icon-chevron-down pointer" data-bind="click: moveDown"></i>
            <i class="icon-trash-alt1 pointer" data-bind="visible: params.shouldShowDeleteStatusButton, click: onDelete"></i>
        </div>
    {{/ifnot}}

    {{#if isNameEditing}}
        <input type="text" class="statusNameEditor" data-bind="textInput: statusName, focus: true, event: {blur: saveStatusName}, enterKey: saveStatusName, escKey: cancelNameEdit" />
    {{/if}}
</div></script>
<script type="text/html" id="workspacenavigator"> <a class="brand" data-bind="text: params.workspaceName, click: onToggleContextMenu"></a>
<a data-bind="click: onToggleContextMenu" class="toggler"></a>
<span class="brand-subtext">workspace on StoriesOnBoard</span>

<context-menu params="isOpen: isContextMenuOpen, direction: 'bottom'">
    <searchable-list params="
                     items: storeProps.workspaces,
                     excludedItemsWhenNotSearching: excludeFromNavigatorByDefault,
                     searchKey: 'name',                     
                     initialNumberOfItems: 6,
                     extendedNumberOfItems: 12,
                     isLoading: isLoading,
                     isLoadingCaption: 'Loading...',
                     searchFieldPlaceholder: 'Search for workspaces...',
                     resultListCaption: 'Recently visited workspaces',
                     itemsCaption: 'workspaces',
                     noMatchingResultsCaption: 'No matching workspaces...',
                     actions: [
		                {caption: '+ Add a new workspace', action: createNewWorkspace, isVisible: true}
                     ]">
        <a data-bind="redirect: { url: url, onNewTabWhenCtrlKey: true, before: function() { app.preloader.show(0); } }"><span data-bind="text: name"></span></a>
    </searchable-list>
</context-menu></script>

    <!-- End of client templates -->


    <script src="/core?v=x0nVh4jwrpjFnyk1nAYfruq1Oy5dZDFVJqCSbanofOs1"></script>

    <script src="/ko?v=iU9T0CF4zolnqCCLPII6bObZ1Xbkt0CzQcSHfqoR2Js1"></script>

    <script src="/common?v=f2DRDNZcNECNxByxhmy_SVeqzYH9sLk-4TEdmEsM3-Y1"></script>

    <script src="/main?v=g4qZY7kgrbFLd0nlpUL-kaNzP6MQ8hD_esMtKulSh7Q1"></script>


    <script src="https://trello.com/1/client.js?key=872b42270c821ad8a8668c6c9d97342c"></script>

    <script type="text/javascript">



        var globalConfig = {
        workspaceId: '120407',
        workspacesUrl: 'https://app.storiesonboard.com',
        appUrl: 'https://vectorcb.storiesonboard.com',
        loginUrl: 'https://app.storiesonboard.com/login',
        logoutUrl: 'https://app.storiesonboard.com/login/logout',
        userRoles: 'WorkspaceMember',
        errorUrl: 'https://vectorcb.storiesonboard.com/error',
        unauthorizedUrl: 'https://vectorcb.storiesonboard.com/unauthorized',
        clientErrorLoggerUrl: 'https://vectorcb.storiesonboard.com/clienterrorlog/uncaughted',
        handledClientErrorLoggerUrl: 'https://vectorcb.storiesonboard.com/clienterrorlog/handled',
        clientSideErrorRedirectEnabled: 'True',
        pageNotFoundUrl: 'https://vectorcb.storiesonboard.com/404',
        segmentWriteKey: 'q6KGjTIaOuZA5r1gqz7QIBhN1Reo2HTh',
        currentUserFullName: 'linomarquez',
        currentUserLoginName: 'lino.marquez@citi.com.mx',
        currentUserId: '0870d40d-d956-4257-dfb3-3a0afa16589a',
        currentUserShortId: 'DdRwCFbZV0LfszoK-hZYmg',
        currentUserIpAddress: '187.188.14.234',
        throwClientErrorOnServerError: 'False',
        showAlertOnClientError: 'False',
        maximumUploadFileSizeInMegabytes: 10,
        sessionKey: '01da2689-bb32-4ce7-a05e-fdf5849c2729',
        realtimeEnabled: 'True',
        realtimeDebugLogEnabled: 'False',
        realtimeForceLongPolling: 'False',
        developerMode: false,

        helpLinkToolIntegrationCommon: 'http://docs.storiesonboard.com/tool-integrations/issue-tracker-integration',
        helpLinkConfigureJira: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-jira',
        helpLinkConfigureJiraStoryPoints: 'http://docs.storiesonboard.com/tool-integrations/advanced-use-of-integratons/how-to-sync-estimation-field-with-story-points-in-jira',
        helpLinkConfigureJiraNextgenRelease: 'http://docs.storiesonboard.com/en/articles/3692466-release-synchronization-setup-with-jira-next-gen-projects',
        helpLinkConfigureJiraIntegrationModeChange: 'http://docs.storiesonboard.com/tool-integrations/basic-use-of-intgerations/jira-hierarchy-synchronization',
        helpLinkConfigureJiraRecommendedWorkflows: 'http://docs.storiesonboard.com/tool-integrations/issue-tracker-integration',
        helpLinkConfigurePivotalTracker: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-pivotal-tracker',
        helpLinkConfigureTrello: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-trello',
        helpLinkConfigureGitHubIssues: 'https://blog.storiesonboard.com/github-integration/',
        helpLinkConfigureTfs: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-azure-devops-and-team-foundation-server',
        helpLinkConfigureVsts: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-azure-devops-and-team-foundation-server',
        helpLinkConfigureTfsStoryPoints: 'http://docs.storiesonboard.com/tool-integrations/advanced-use-of-integratons/how-to-add-story-points-or-effort-field-to-a-work-item',
        helpLinkConfigureTfsReleaseSync: 'http://docs.storiesonboard.com/tool-integrations/advanced-use-of-integratons/additional-permissions-for-release-synchronization-in-azure-devops-and-tfs',
        helpLinkConfigureTfsIntegrationModeChange: 'http://docs.storiesonboard.com/tool-integrations/advanced-use-of-integratons/azure-devops-hierarchy-synchronization-options',
        helpLinkConfigureTfsRecommendedWorkflows: 'http://docs.storiesonboard.com/tool-integrations/issue-tracker-integration',
        helpLinkPivotalTrackerApiToken: 'https://www.pivotaltracker.com/help/articles/api_token/',
        helpLinkUserApiToken: 'http://docs.storiesonboard.com/tool-integrations/how-to-setup-integration/setting-up-synchronization-with-trello',
        helpLinkTrashBin: 'http://docs.storiesonboard.com/getting-started/essential-functions/trash-bin',
        helpLinkWorkspaceRoles: 'http://docs.storiesonboard.com/subscription-pricing-billing/other-questions/workspaces-story-maps-user-roles-members-administrators-viewers',
        helpLinkStorymapRoles: 'http://docs.storiesonboard.com/subscription-pricing-billing/other-questions/workspaces-story-maps-user-roles-members-administrators-viewers',
        helpLinkHelpCenter: 'http://docs.storiesonboard.com',
        helpLinkAboutThisToolForEditors: 'https://storiesonboard.com/user-story-mapping-intro.html',
        helpLinkAboutThisToolForViewers: 'https://storiesonboard.com/user-story-mapping-intro.html',
        helpLinkAnnotation: 'http://docs.storiesonboard.com/en/articles/3197650-annotations',

        trelloPowerUpLearnMore: 'http://docs.storiesonboard.com/en/articles/3777590-trello-power-up-setup',
        trelloPowerUpUrl: 'https://trello.com/power-ups/5e63a894274699243d1e7f36',

        trailerVideo: 'https://www.youtube.com/embed/VeiwEds75lc',

        vstsBaseUrl: '^(https\\:\\/\\/)((\\*|[\\w\\d]+(-[\\w\\d]+)*)\\.)*(visualstudio)(\\.com)\\/?$',
        azureDevOpsServicesBaseUrl: '^(https\\:\\/\\/)(dev\\.azure\\.com\\/)(\\*|[\\w\\d]+(-[\\w\\d]+)*\\/?)$',

        isShowTrialPeriodIsExpired: 'False',
        trialPeriodExpiredDays: '-1',
        isShowSubcriptionIsSuspended: 'False',
        suspendedAt: '-',

        suspendAlertIsClosed: ko.observable(false),

        isShowTrialPeriodExpireSoon: 'False',
        trialPeriodExpireSoonDays: '-1',
        trialPeriodLength: '14',
        isSelfServiceCancellationEnabled: true,

        features: ko.observable(';99999;100;110;120;130;200;810;830;820;430;440;420;410;450;470;480;1100;1200;2300;2400'),
        hasToolIntegrationFeatureAddOn: 'True',

        subscriptionLimitsAreExceed: 'False',

        trialAlertIsClosed: ko.observable(false),
        subscriptionLimitsAreExceedAlertIsClosed: ko.observable(false),

        useClientFakes: 'False',
        currentUserIsDomainControlled: "True" === 'False',
        currentUserCanCreateWorkspaces: "True" === 'True',
        ssoEnabledForCurrentUser: "True" === 'False',
        ssoRequiredForCurrentUser: "True" === 'False',

        isCorporateLicenseMissing: false,
        corporateLicenseMissingInstructions: "",

        checkFileDownloadStatusUrl: '/checkfiledownloadstatus',
        workspaceSubdomain: 'vectorcb',
        currentCsrfToken: '0cd6aacd-ceeb-4281-b977-4b4b691594bd',
        csrfTokenHeaderKey: 'RequestVerificationToken'
    };

    var clientLoadableStyles = {};

    $(function() {
        appstart.run();
    });
    </script>

    
    <script type="text/javascript" src="https://api.taxamo.com/js/v1/taxamo.all.nojquery.js"></script>
    
    <script src='https://js.braintreegateway.com/web/3.52.0/js/client.min.js'></script>
    <script src='https://js.braintreegateway.com/web/3.52.0/js/three-d-secure.min.js'></script>
    <script src='https://js.braintreegateway.com/web/3.52.0/js/hosted-fields.min.js'></script>
</body>
</html>
